\documentclass[uplatex,dvipdfmx]{jsreport}
\title{集合と位相}
\author{司馬博文}
\date{\today}
\pagestyle{headings} \setcounter{secnumdepth}{4}
\input{/Users/Hirofumi Shiba/NatureOfStatistics/preamble_no_fonts.tex}
%\input{/Users/hirofumi.shiba48/NatureOfStatistics/preamble_no_fonts.tex}
\usepackage[math]{anttor}
\begin{document}
\tableofcontents

\begin{notation*}\mbox{}
    \begin{enumerate}
        \item 集合論では断らぬ限り$f:X\to Y$を写像とし，$A\subset X,B\subset Y$とする．
        \item 古典論理について，排中律は暗黙に認める．従って背理法による証明も認める．
        \item 位相空間論では集合の概念については次の３点のみを使用し，その定義については抽象化してinformalに言及する．
        \begin{enumerate}[(1)]
            \item 像写像は合併は保つが，共通部分は不完全にしか保たない（命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}）．
            \item 逆像写像は合併も共通部分も保つ（命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}）．
            \item de Morganの法則（命題\ref{prop-de-Morgan's-law}）．
        \end{enumerate}
        \item 連続写像がなす$\Map(X,Y)$の部分集合を，
        \[ C(X,Y):=\{f\in\Map(X,Y)\mid fは連続\} \]
        と表す．特に$Y=\R$の時は，$C(X):=C(X,\R)$と略記する．
        \item 集合$X$上の実数値関数全体の集合$\Map(X,\R)$のうち，有界な実数値関数全体のなす実線型空間を
        \[ \widetilde{B}(X):=\{f\in\Map(X,\R)\mid fは有界\} \]
        と置く．
        \item $B(X):=\widetilde{B}(X)\cap C(X)$．
        \item 集合$X$に対し，その有限部分集合全体からなる集合を
        \[ F(X):=\{A\in P(X)\mid|A|<\infty\} \]
        と置く．
    \end{enumerate}
\end{notation*}

\chapter{集合}

\begin{quotation}
    「現代の数学で，集合の概念は，写像とともに，数学の対象を確定し，構成し，操作するための厳密なことばとして，欠かせない役割を果たしている．」\cite{斎藤毅}

    「書くことで考えを整理し，正確に表現するためには，それなりの訓練が要る．明らかだと思ったところの方が却って思い違いがあるもので，専門の論文でも稀に見られる誤りは，簡単だから省略すると書かれているところに見つかるものである．そうならないようにするには，証明を細部まで正確に書く習慣をつけることが，一番の近道である．」\cite{斎藤毅}

    集合，圏，型，一階論理，形式言語などの概念は全て，単独で数学全体を形式化する力を持ち，特に集合と論理は一番最初に発見・採用されたものである．この集合論（ZFC公理系など）を特にmaterial set theoryといい，
    圏論的な定式化をstructural set theoryと呼ぶ．

    書籍\cite{斎藤毅}では，論理と集合（特に用語「形式論理」「集合」「条件」あたりの概念）を定義なしで認めるという公理的集合論の立場を取る．

    集合は共通部分・合併・冪集合などの構成を許す．条件は部分集合を定める．
    積の上の条件は関係を定める．これらの基盤から数学の全てが育つ．

    \begin{itemize}
        \item 論理記号と集合演算との混じり合いの構造は明らかにSequent演算みたいだ．
    \end{itemize}
\end{quotation}

\section{集合の元と部分集合，論理記号}

\begin{screen}
    material set theory（公理的集合論）と現在は呼ばれる考え方では，二項関係$\in$を無定義用語として，
    それを中心として集合の存在とその許される構成法を公理的に定義し，
    全ての数学的対象を集合として構成する．$x\in X$とは，$x$が集合$X$のメンバーであることを表す，と言ったような意味論は，あくまで定義の後から来るものである，というのが公理的集合論の立場である．
    特に，ZFC公理系は一階論理の言語で記述される．
\end{screen}

\begin{axiom}[所属関係$\in$]
    集合$X$について，$x\in X$という記号を，
    $x$は$X$に含まれるという関係を表すこととし，
    この時$x$を$X$の元という．
\end{axiom}

\begin{axiom}[集合の相等]\label{def-Extentionality}
    $X,Y$を集合とする．集合$X,Y$が等しい：$X=Y$とは，その包含する元が一致することとする：\[\forall z(z\in x\leftrightarrow z\in y)\;\;\;\rightarrow\;\;\; x=y \;\;\;\mathrm{(Extentionality)}.\]
\end{axiom}
\begin{definition}[包含関係]
    集合$X$が$Y$の部分集合である$X\subset Y$とは，$X$の元は全て$Y$の元でもあることをいう：\[x\subset y\;\;\;:\Leftrightarrow\;\;\;\forall z(z\in x\rightarrow z\in y).\]
\end{definition}

\begin{definition}[論理の用語]\mbox{}
    \begin{enumerate}
        \item 自然言語の文章を，（一階）論理記号と集合の記号のみを使って表すことを\textbf{形式化(formalization)}という．
        \item 一階述語論理の構文規則に従って書かれるものを\textbf{論理式(formula)}と呼ぶ．
        \item 論理式のうち，一階述語論理の推論規則に従って公理系から導かれるものを\textbf{定理}と呼ぶ．通常の数学では，命題，補題，系などとも呼び得る．
    \end{enumerate}
\end{definition}

\section{元についての条件と部分集合}

\begin{screen}
    公理的集合論の立場では，全体集合$X$を定めると，条件$P$と部分集合$A:=\{x\in X\mid P(x)\}$とを同一視する．
    即ち，論理記号として，条件$P$と条件$x\in A$を同値とする．
    同一視の結果得られる集合論の定理に，分配則やde Morganの法則などがある．
\end{screen}

\begin{notation}
    条件$P$について，論理式$\forall x(x\in X\rightarrow P)$を$\forall x\in X\;P$，論理式$\exists x(x\in X\land P)$を$\exists x\in X\;P$と略記する．
\end{notation}

\begin{axiom}[全体集合，部分集合]
    全体集合(universal set)を$X$，形式化可能な条件を$P$とする．
    $P$を満たす$X$の元全体からなる集合は$X$の部分集合を定め，これを$\{x\in X\mid P(x)\}$と表す(Comprehension Scheme)．
    \begin{enumerate}
        \item 特に，恒偽条件$x\ne x$が定める部分集合を空集合と呼び，記号$\varnothing,\emptyset$で表す．
        \item 部分集合$A,B\subset X$に対して，条件$x\in A,x\in B$が定める部分集合$\{x\in X\mid x\in A\land x\in B\}=:A\cap B$を，$A$と$B$の\textbf{共通部分／交叉}と呼ぶ．
        \item 部分集合$A,B\subset X$に対して，条件$x\in A$または$x\in B$が定める部分集合$\{x\in X\mid x\in A\lor x\in B\}=:A\cup B$を，$A$と$B$の\textbf{合併}と呼ぶ．
        \item 部分集合$A\subset X$に対して，条件$x\notin A$が定める部分集合$\{x\in X\mid x\notin A\}=:X\setminus A$を，$A$の\textbf{補集合}と呼ぶ．
    \end{enumerate}
\end{axiom}
\begin{remark}
    補集合演算が対合的であることが生み出す双対性を，de Morgan dualという．
\end{remark}

\begin{proposition}[共通部分と合併についての分配則]
    \begin{align*}
        (A\cup B)\cap C&=(A\cap C)\cup(B\cap C),&(A\cap B)\cup C&=(A\cup C)\cap(B\cup C).
    \end{align*}
\end{proposition}
\begin{proof}
    適切な一階論理のモデルから示せる．
    直観的にはVenn図を示せば十分である．
\end{proof}
\begin{remark}
    共通部分と合併を集合への演算だとみなすとき，特にそれぞれを積と和と呼ぶ．
\end{remark}

\begin{proposition}[de Morganの法則]
    \begin{align*}
        X\setminus(A\cup B)&=(X\setminus A)\cap(X\setminus B),&X\setminus(A\cap B)&=(X\setminus A)\cup(X\setminus B).
    \end{align*}
\end{proposition}
\begin{proof}
    適切な一階論理のモデルから示せる．Venn図を示せば十分である．また，前層の圏$[\Set^{op},\Set]$を考えることで，反変冪集合関手は集合$2$によって表現されることから，
    Bool代数$2$上の等式$\lnot(A\lor B)=\lnot A\land \lnot B$と同値であることが示せる．
\end{proof}

\begin{proposition}$A,B,C\subset X$とする．次の２つの条件は同値である．
    \begin{enumerate}
        \item $A\cup B\subset C$
        \item $A\subset C\wedge B\subset C$
    \end{enumerate}
\end{proposition}

\begin{proposition}[Russellの逆理]
    $X$を集合とする．
    \begin{enumerate}
        \item $X$の部分集合$A:=\{x\in X\mid x\notin x\}$は$X$の元ではない．
        \item 「全ての集合を元として含む集合」は存在しない．
    \end{enumerate}
\end{proposition}
\begin{proof}
    1. $A\in X$とすると，$A\in A$または$A\notin A$である．$A\in A$の時，$A$は条件$A\notin A$を満たすことになってしまうから，$A\notin A$である．しかし$A\notin A$を満たすとすると$A$は条件$x\notin x$を満たすから$A$の要素であるはずである．
    従って，$A\notin X$．

    2. 全ての集合からなる集合が存在するとし，$Y$とする．その部分集合を$B=\{y\in Y\mid y\notin y\}$と定めると，これは$B\notin Y$である．これは$Y$が全ての集合からなる集合であることに矛盾．
\end{proof}

\section{冪集合と積}

\begin{screen}
    集合論の公理を完成させ，積と自然数を構成する．
\end{screen}

\begin{axiom}[冪集合]
    $X$を集合とする．$Y$が
    \[\exists y\forall z(z\subset x\rightarrow z\in y),\;\;\;(\mathrm{Power set})\]
    を満たす時，$Y$も集合として認め，$X$の冪集合といい，$Y=P(X)$と表す．
\end{axiom}

以上で，殆どの集合論の公理は登場した．
続いて，数学で頻繁に登場する対象を構成する．

\begin{definition}[積]
    $X,Y$を集合とする．
    \begin{enumerate}
        \item $a\in X,b\in Y$に対して，$(a,b):=\{\{a\},\{a,b\}\}$を\textbf{対}と呼ぶ．
        \item このような対全体からなる集合を$X$と$Y$の\textbf{積}と呼ぶ：
        \[ X\times Y:=\{x\in P(P(X\cup Y))\mid \exists x\exists y(x\in X\land y\in Y\land z=\{\{x\},\{x,y\}\})\}. \]
        \item 対を帰納的に考えたもの$(x_1,\cdots,x_n):=(x_1,\cdots,x_{n-1},x_n)\in( X_1\times\cdots\times X_{n-1})\times X_n$を\textbf{$n$-組}という．対とは2-組のことである．
    \end{enumerate}
\end{definition}

\begin{definition}[自然数 (von-Neumannの構成, 1923)]
    空集合$\emptyset$と後者関数(ordinal successor function) $n+1:=n\cup\{n\}$によって再帰的に定義されるデータ構造を自然数とする．
    即ち，
    \begin{align*}
        0&:=\emptyset=\{\}\\
        1&:=P(\emptyset)=\{\emptyset\}=\{\{\}\}=\{0\}=0\cup\{0\}\\
        2&:=P(P(\emptyset))=\{\emptyset,\{\emptyset\}\}=\{0,1\}=1\cup\{1\}\\
        3&:=2\cup\{2\}=\{0,1\}\cup\{2\}=\{0,1,2\}\\
        \vdots&\hphantom{:=2\cup\{2\}=\{0,1\}}\;\vdots\\
        n+1&:=n\cup\{n\}=\{0,1,2,\cdots,n\}\\
        \vdots&\hphantom{:=2\cup\{2\}=\{0,1\}}\;\vdots
    \end{align*}
    とし，この方法で$\emptyset$からの有限回操作で得られる元全てからなる集合を$\N=\{0,1,2,\cdots\}$とする．
\end{definition}
\begin{remark}[基数と順序数]
    $n+1=\{0,1,2,\cdots,n\}$と書いたとき，これには$\in$による全順序が入る．また特に，この関係$\in$は整礎的である（無限降下列を持たない）．
    推移的でもある：$\cup n\subset n$．これは自然数$1,2,\cdots$が，（有限な）整列集合が同型について作る同値類の代表元となる．これを順序数という．実は有限の順序数はこのように作った自然数に限る．
    整礎性公理(ZFC公理系の１つ)により，全ての集合に対して$\in$は整礎的だとしたから，全ての集合は階数(ordinal rank)を持つ．
\end{remark}
\begin{definition}[ordinal number, (von Neumann) ordinal]
    推移的で$\in$によって全順序づけられる集合$a$を\textbf{順序数}という，順序数全体のクラス（真のクラスである）を$\ORD$と表す．
    順序数同士の関係を$\alpha<\beta:\Leftrightarrow\alpha\in\beta$と定めるとこれは$\ORD$上に全順序を定める．
    また，$\alpha=\{\beta\in\Ord\mid\beta<\alpha\}$と表せる．
\end{definition}
\begin{lemma}\mbox{}
    \begin{enumerate}
        \item 順序数の元も順序数である．
        \item 二つの順序数が同型ならば等しい．
    \end{enumerate}
\end{lemma}

\section{同値関係と順序}

\begin{screen}
    二項関係$R$は，$X$の積集合$X\times X$上の条件（即ち部分集合）と同一視される．

    二項関係のうち日常会話のように使う例として，同値関係と順序がある．
    同値関係は集合をいくつかの同値類と呼ばれる部分集合に（直和）分割する．
\end{screen}

\begin{definition}[binary relation]
    $X$を集合とする．
    \begin{enumerate}
        \item $X\times X$上の条件$R$を，$X$の\textbf{二項関係}という．
        \item 二項関係$R$が定める部分集合$\{(x,y)\in X\times X\mid R\}$を，その\textbf{グラフ}という．
        \item ２つの二項関係$R,R'$とそのグラフ$C,C'$について，$C\subset C'$の時，$R$は$R'$より\textbf{細かい}といい，逆を\textbf{粗い}という．$C=C'$であるときに，２つの二項関係$R,R'$を同値とする．
    \end{enumerate}
\end{definition}

\begin{example}[trivial relation]
    公理など先天的に認められた記号$=$について，関係$x=y$を\textbf{相等関係／自明な同値関係}という．
    この相等関係のグラフを\textbf{対角集合}といい，$\Delta_X:=\{(x,y)\in X\times X\mid x=y\}$と表す．
    この集合の特性関数$\chi_{\Delta_X}$を\textbf{Kroneckerのデルタ}ともいう．
\end{example}

\begin{definition}[equivalence relation]
    $R\subset X\times X$を関係とし，$x\sim_R y$などと表す．
    \begin{enumerate}
        \item $R$が反射律，対称律，推移律を満たすとき，$R$は\textbf{同値関係}であるという．
        \item $R$が各$a\in X$について定める$X$の部分集合$[a]=\{x\in X\mid x\sim_Ra\}$を\textbf{$a$の同値類}という．
    \end{enumerate}
\end{definition}

\begin{definition}[order]
    $R\subset X\times X$を関係とする．
    \begin{enumerate}
        \item $R$が反射律，反対称律，推移律を満たすとき，$R$は\textbf{順序}であるという．
        \item $R$がさらに任意の２元について比較可能であるとき，特に\textbf{全順序}であるという．
    \end{enumerate}
\end{definition}

\begin{problem}[AP1.4.4：部分集合Aによって生成される同値関係]
    $X$を集合とする．$A\subset X\times X$とし，${}^t\!A=\{ (x,y)\in X\times X\mid(y,x)\in A\}$と置く．$X$の元の対$(x,y)$についての次の条件$(R_A)$は$X$上の同値関係である．
    \begin{quote}
        $(R_A)$：自然数$n\ge 0$と，$X$の元$x=x_0,x_1,\cdots,x_n=y$で，全ての$i\in [n]$に対して$(x_{i-1},x_i)\in A\cup {}^t\!A$を満たすものが存在する．
    \end{quote}
\end{problem}
\begin{remark}
    このAP1.4.4は，$A$は$X$上の有向グラフを，$A\cup {}^t\!A$は$A$の定める$X$上の無向グラフを表し，条件$(R_A)$は$X$の２つの元が道で結ばれていることを表し，集合$X$をいくつかの道に直和分解する，と捉えられる．
\end{remark}

\chapter{写像}

\begin{quotation}
    特別な「関係」として写像の言葉を定義すると，一気に議論が動き出す．
    グラフのことばから集合論的に構成されるが，写像を先に認める数学基礎論もあり得る．
\end{quotation}

\section{写像の定義}

\begin{definition}[mapping]$X,Y$を集合とする．
    \begin{enumerate}
        \item 部分集合$\Gamma\subset X\times Y$が「$X$から$Y$への写像のグラフである」とは，\[\forall x\in X\, \exists y\in Y \, ((x,y)\in\Gamma\wedge \forall z\in Y((x,z)\in\Gamma\Rightarrow y=z))\]が成立することを言う．
        \item $\Gamma\subset X\times Y$を，$X$から$Y$への写像のグラフとするとき，３つ組$f=(\Gamma,X,Y)$を写像$X\to Y$と呼び，$f:X\to Y$と表す．
        \item $X$から$Y$への写像からなる集合を次のように置く．
        \[\mathrm{Map}(X,Y):=\left\{ f\in P(X\times Y)\times \{ X\}\times\{ Y\} \;\middle|\; \begin{cases}
            f=(\Gamma,X,Y)\\
            \Gamma はXからYへの写像のグラフ
        \end{cases}\right\}\]
    \end{enumerate}
\end{definition}
従って，写像$f:X\to Y,g:Z\to W$が等しいとは，$X=Z\land Y=W\land \Gamma_f=\Gamma_g$であることをいう．
特に写像のグラフの定義より，$\Gamma_f=\Gamma_g$とは$\forall x\in X=Z,\;f(x)=g(x)$と同値である．

\subsection{写像の例}

種々の写像を定義する．
\begin{example}\mbox{}
    \begin{enumerate}
        \item 対角集合$\Delta_X$をグラフとする写像$X\to X$を\textbf{恒等写像}$\id_X$と呼ぶ．
        \item 次の写像を$X$の\textbf{対角写像}と呼ぶ．
        \[ \xymatrix@R-2pc{
            X\ar[r]&X\times X\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            x\ar@{|->}[r]&(x,x)
        } \]
        \item $U\subset X$であるとき，集合$\Delta_X\cap X\times U$をグラフとする写像$X\to Y$を\textbf{包含写像}$i$と呼ぶ．
        \item 写像$f:X\to Y$に対して，$U\subset X$であるとき，集合$\Gamma_f\cap U\times Y$をグラフとする写像$(\Gamma_f\cap U\times Y,U,Y)$を\textbf{制限}$f|_U$と呼ぶ．逆に，$f|_U$からみて$f$を\textbf{延長}と呼ぶ．
        \item 殆どの場合，写像$f:X\to Y$に対して$V\subset Y$であるとき，集合$\Gamma_f\cap X\times V$をグラフとする写像は記号を流用して$f:X\to V$と書いてしまう．
        \item $\Map(X,Y)$は，$X=\emptyset$であるとき，包含写像$i=(\emptyset,\emptyset,Y)$のみからなる一元集合である（$Y$も空集合であるとき，これは特に$\id_\emptyset$となる）．$Y=\emptyset\land X\ne\emptyset$であるとき，グラフとなるべき条件を満たす集合$\Gamma\subset X\times Y$を作れないから，これは空集合である．
        \item $c\in Y$に対して，$(X\times\{c\},X,Y)$という写像$c:X\to Y$を，$c\in Y$への\textbf{定値写像}といい，記号を混用する．ただし，空集合の恒等写像$\id_\emptyset$も定値写像と呼ぶ．
        \item $Y$が数の集合$\N,\Z,\Q,\R,\C$やその積であるとき，$f$を関数と呼ぶ．
        \item $X$が$\N$やその部分集合であるとき，$f$を列といい，$(x_1,x_2,\cdots)=(x_n)_{n\in\N}\in X^\N$などとも書く．$X$が一般の場合は\textbf{族}という．
        \item $X$の部分集合$A$に対して定まる関数\[f(x)=\begin{cases}
            1&x\in Aのとき,\\0&x\notin Aのとき
        \end{cases}\]を，$A$の\textbf{特性関数}と呼び，$\chi_A:X\to 2=\{0,1\}$で表す．$X$の部分集合とその特性関数は一対一に対応する：$P(X)\simeq\Map(X,2)$．これは特に順序を保つ単調写像になる：$A\subset B\Leftrightarrow\chi_A\le\chi_B$．
        条件が定める部分集合の特性関数のことを，元の条件から見て\textbf{真理値関数}という．
        \item 次のような写像を\textbf{第$i$射影}という．\[\xymatrix@R-2pc{
            X_1\times\cdots X_i\cdots\times X_n\ar[r]&X_i\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (x_1,\cdots,x_i,\cdots,x_n)\ar@{|->}[r]&x_{i}
        }\]
        \item $f_1:X_1\to Y_1,f_2:X_2\to Y_2$に対して，写像の積$f_1\times f_2:X_1\times X_2\to Y_1\times Y_2$を，$(x_1,x_2)\mapsto (f_1(x_1),f_2(x_2))$と定義する．
    \end{enumerate}
\end{example}

\begin{definition}[restriction mapping]
	集合$X$の各部分集合$A$に対して定まる次の写像を\textbf{制限写像}という．
    \[\xymatrix@R-2pc{
        \Map(X,Y)\ar[r]&\Map(A,Y)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        f:X\to Y\ar@{|->}[r]&f|_A:A\to Y
    }\]
    これは包含写像$i:A\to X$が定める反変Hom関手$i^*:\Hom(X,Y)\to\Hom(A,Y)$に他ならない．
    同様に$B\subset Y$についても考えられるが名前はない．
\end{definition}
\begin{definition}[evaluation mapping]
	$x\in X$に対して定まる次の写像$\ev_x$を\textbf{$x$での値写像}という．
    \[\xymatrix@R-2pc{
        \ev_x:\Map(X,Y)\ar[r]&Y\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        f:X\to Y\ar@{|->}[r]&f(x)
    }\]
	これを各$x\in X$に関してcurryingする考え方より，大局的には次の写像$e$も定義されるが，定まった名前はない：
    \[\xymatrix@R-2pc{
        e:\Map(X,Y)\times X\ar[r]&Y\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (f,x)\ar@{|->}[r]&f(x)
    }\]
	この写像の第二変数$x\in X$を定める度に，値写像を得る．
\end{definition}

\begin{remark}[双対性]
    1つの対象に対し2つの等価な記述法が存在するとき，2つの記述法を取り替える操作を双対（そうつい）とよぶ。より一般に，2つの記述法（概念・理論・モデル・…）$A$,$B$が，どちらも同じ対象を表す（と信じられる）とき，$A$と$B$は互いに双対であるという。双対性は知りたい対象について特定の記述法を越えた深い構造を浮かび上がらせるため，数学や物理の最前線で活発に研究されている。\footnote{https://www.s.u-tokyo.ac.jp/ja/story/newsletter/keywords/21/06.html}
    \begin{quote}
        この写像(currying)によれば，写像の値$f(x)$は，対$(f,x)$に対して定まるものとなる．このように，対に対して値の定まる写像が定められているとき，
        一方を他方の双対的な対象と考えることが出来る．関数と点に限らず，測度と関数，ベクトル場と微分形式など，双対的な対象は数学のいろいろなところで出てくる．
    \end{quote}
    いまならわかった，積分領域と微分形式も対に対して値が定まる．また，外微分と境界作用素は双対的に感じる（というより「逆」？）．
    さらに一般化すれば，基底とその係数も双対で（双対空間の双対），この組に対して値が定まる，これは積分の考え方の一般化になっている．
    さらに一般化すれば前層$\hom(-,-):C^{op}\times C\to\Set$となるのだろうか．
\end{remark}

\section{写像の合成}

\begin{screen}
    共変と反変と可換図式，というように，写像の大事な代数が「合成」である．これは結合則を満たすことを見る．
    普通の代数的構造では等式（方程式）で表されるような条件を，写像の言葉では可換図式で表すことができる．
    どっちの見方の方がわかりやすいかは時と場合に依る．
\end{screen}

\begin{definition}[composition]
    写像$f:X\to Y,g:Y\to Z$の合成とは，
    \[\Gamma_{g\circ f}:=\{(x,z)\in X\times Z\mid \exists y\in Y\;((x,y)\in\Gamma_f\land(y,z)\in\Gamma_g)\}\]
    としたときに$g\circ f:=(\Gamma_{g\circ f},X,Z)$のことである．
	すると，写像の合成に関して，以下の写像が定まる．なお，各写像を$f:X\to Y, g:Y\to Z$とする．
    \[\xymatrix@R-2pc{
        \circ :\Map(Y,Z)\times\Map(X,Y)\ar[r]&\Map(X,Z)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (g,f)\ar@{|->}[r]&g\circ f
    }\]
	また，各写像を$f:X\to Y, g:W\to X, h:Y\to Z$として，
    \[\xymatrix@R-2pc{
        f_*:\Map(W,X)\ar[r]&\Map(W,Y)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        g:W\to X\ar@{|->}[r]&f\circ g:W\to Y}\]
    \[\xymatrix@R-2pc{f^*:\Map(Y,Z)\ar[r]&\Map(X,Z)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        h:Y\to Z\ar@{|->}[r]&h\circ f:X\to Z
    }\]
    この時の反変性，共変性とは，元となった写像$f$との向きが同じかどうかにより定まる．
    \begin{center}
        \begin{tikzcd}
                &X\ar[dd, "f"] \ar[dr, bend left, "h\circ f", ""{name=Up, inner sep=1pt,below}]\\
            W\ar[ur, bend left, "g", ""{name=U, inner sep=1pt,below}] \ar[dr, bend right, "f\circ g"', ""{name=D,inner sep=1pt}] & & Z\\
                &Y \ar[ur, bend right, "h"', ""{name=Down,inner sep=1pt}]
                \ar[Rightarrow, bend left , from=U, to=D, "f_*"] \ar[Leftarrow, bend right , from=Up, to=Down, "f^*"]
        \end{tikzcd}
    \end{center}
\end{definition}

\begin{remark}\mbox{}
    \begin{enumerate}
        \item $U\subset X$について，$f|_U=f\circ i$．
        \item 定値写像とは，$X\to 1\to Y$と分解できる写像のことである．
    \end{enumerate}
\end{remark}

\begin{definition}[写像の可換図式]
    $X,Y,S,T$を集合とし，$f,g,p,q$を写像とする．
    この時，次の\textbf{図式が可換である}とは，
    $f\circ p=g\circ q$が成立すること，
    即ち$\forall x\in T \; [f(p(x))=g(q(x)) \in S]$が成立することである．
    \[
        \xymatrix{
        T\ar[r]^-p\ar[d]_-q&X\ar[d]^-f\\
        Y\ar[r]_-g&S
        }
    \]
\end{definition}
\begin{remark}
    つまり，図式を有向グラフ（集合$X,Y,W,Z$を頂点，写像$f,g,h,k$を辺とした有向グラフ）だと思った時に，両端点を共有する全ての有向道(directed path)が，
    写像の合成について，等しい写像を与えるような図式を，可換図式であるという．
    この概念の集合論的に書いたからといって，必ずしもわかりやすいとは言い難い．
\end{remark}

\begin{proposition}[写像の合成の結合性]\label{prop-associativity-of-mapping}
    写像$f:X\to Y,g:Y\to Z,h:Z\to W$について，次の図式は可換である．
    \[\xymatrix{
        \Map(Y,Z)\ar[r]^-{f^*}\ar[d]_-{h_*}&\Map(X,Z)\ar[d]^-{h_*}\\
        \Map(Y,W)\ar[r]^-{f^*}&\Map(X,W)
    }\]
\end{proposition}

\section{可逆写像}

\begin{screen}
    多くの数学の概念は，何かの写像が可逆であることによって定まっている．
    標準的な可逆写像が存在する時，その２つの対象を同一視することがある．

    この節では，写像が可逆であるための特徴付けを３つ見る．
\end{screen}

\begin{definition}[invertible]
    写像$f:X\to Y$が\textbf{可逆}であるとは，逆向きの写像$g:Y\to X$が存在して，
    \begin{align*}
        g\circ f&=\id_X,&f\circ g&=\id_Y,
    \end{align*}
    が成り立つことをいう．この時の$g$を\textbf{逆写像}という．
    可逆射は\textbf{同型}ともいい，このことを強調して$f:X\xrightarrow{\sim}Y$とも表す．
    $X,Y$の間に同型射が存在する時，$X,Y$は同型ともいい，$X\simeq Y$と書く．
\end{definition}

\begin{definition}[逆写像の一意性]
    可逆な写像$f:X\to Y$に対し，逆写像$g:Y\to X$は一意的である．
\end{definition}
\begin{proof}
    $g,g':Y\to X$はいずれも$f$の逆写像とする：
    \begin{align*}
        g\circ f&=\id_X,&f\circ g&=\id_Y,\\
        g'\circ f&=\id_X,&f\circ g'&=\id_Y.
    \end{align*}
    すると，写像は合成について結合的でから（命題\ref{prop-associativity-of-mapping}），
    \[g=g\circ \id_Y=g\circ(f\circ g')=(g\circ f)\circ g'=\id_X\circ g'=g'.\]
\end{proof}

\begin{example}[同一視の例]\mbox{}
    \begin{enumerate}
        \item $X$を集合とする．$X$の部分集合$A$に対して，特性関数$\chi_A:X\to 2$を対応させる写像$\chi :P(X)\to \mathrm{Map}(X,2)$は可逆である．
        \item $n$-組と列の間には標準的な同型がある：$X^n\simeq\Map(I,X)$．
        \item $M(m,n;\R)\simeq\{f\in\Map(\R^n,\R^m)\mid fは線型写像\}$．
    \end{enumerate}
\end{example}

\subsection{写像が可逆であることと同値な条件の探索}

\begin{proposition}[可逆射の特徴付け]
    $f=(\Gamma_f,X,Y)$を写像とする．
    \begin{enumerate}
        \item $f$は可逆で$g=(\Gamma_g,Y,X)$を逆写像とすると，$\Gamma_f$は$\Gamma_g$の転置である：$\Gamma_g=\{(y,x)\in Y\times X\mid (x,y)\in\Gamma_f\}$．
        \item $f$が可逆であることと，次の条件は同値：$\forall y\in Y,\; \exists!x\in X,\; f(x)=y$．
    \end{enumerate}
\end{proposition}

\begin{corollary}
    \begin{enumerate}
        \item 集合$\Gamma\subset X\times Y$について，次の２条件は同値である．
        \begin{enumerate}[(a)]
            \item $\Gamma$はある写像$f:X\to Y$のグラフである．
            \item $\pr_1|_\Gamma:\Gamma\to X$は可逆である．
        \end{enumerate}
        \item 1.の同値な条件が成り立っているとすると，$\Gamma$をグラフにもつ写像$f$とは，$\gamma:X\to\Gamma$を$\pr_1|_\Gamma:\Gamma\to X$の逆写像とした時，$f=\pr_2|_\Gamma\circ\gamma$である．
    \end{enumerate}
\end{corollary}

\begin{proposition}[可逆射の普遍性による特徴付け：集合を，他の集合への写像についての述語で特徴付けること]
    $f:X\to Y$を写像とする．次の２条件は同値である．
    \begin{enumerate}
        \item $f$は可逆である．
        \item 任意の集合$Z$に対して，写像$f^*:\Map(Y,Z)\to\Map(X,Z)$は可逆である．
    \end{enumerate}
\end{proposition}

\section{集合族}

\begin{screen}
    集合と写像が入り乱れて世界こそこの上なく豊かで，
    幾何学的対象を定義するための強力な道具となってゆく．
    集合とは不思議過ぎる．

    集合族自体は，添字集合と呼ばれる集合から，
    集合の集合への写像として定義される．
    「集合族の間の演算」として，
    集合間の有限項の演算を，
    無限項の場合にまで含めて統一的に定義できることになる
    （写像も集合なので，写像の積も含めて）．組やそれに定義される射影なども，無限集合の場合にまで一般化される．
    これは解析学に於る級数の議論と全く並行である．

    自然数の集合論における定義と響き合って，記法$X^n$もうまく配置集合の記法として説明される．
    特に，自然数の計算規則（指数法則など）は全て集合論的な構成として説明がつくようだ．

    これは自然に集合中心の世界観から写像中心の世界観への静かな移行の始まりとも見れる．
    これを普遍性からの定義という．
    直和や直積と言った用語は線型代数でも使われるが違う集合を指す．これは圏論的な理由による．

    この直和や直積の定義は圏論的な意味(nPOV)では自然であるが，
    対象としては段々と複雑で不自然になって来ており，
    集合論の方からは選択公理の議論が生じる．
    なお，線型空間の基底は集合族$n\to V$のうち，その値域が，一次独立な$V$-生成系となるものである，とすると，「基底を取る」という語が理解しやすい．このように基底を集合族として定式化するなら，その基底の存在性は選択公理とZF上同値になる．
    つまり，具体的な構成を，一般の場合にcanonicalに与えることは出来ないということである．
\end{screen}

\begin{definition}[集合族]
    次の写像を，\textbf{集合$I$で添字づけられた集合の族}という：
    \[\xymatrix@R-2pc{
        (X_i)_{i\in I}:I\ar[r]&\mathfrak{X}\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        i \ar@{|->}[r] & X_i
    }\]
    \begin{enumerate}
        \item $\mathfrak{X}\subset P(X)$である時，族$(X_i)_{i\in I}$を\textbf{集合$X$の部分集合族}という．
        \item $I=\varnothing$である時，族$(X_i)_{i\in I}$は包含写像$i:\varnothing\to\mathfrak{X}$であり，特に\textbf{空な族}という．
        \item \textbf{有限族}の場合は，例えば$I=n\in\mathbb{N}$である時，$X_1,X_2,\cdots,X_n$というような列挙が可能である．
        \item 集合$\mathcal{A}\subset P(X)$を集合族と言ってしまう場合は，この$\mathcal{A}$を添字集合とした包含写像$(A)_{A\in\mathcal{A}}:\mathcal{A}\to P(X)$のことを指す，と言い換えれば今回の定義に沿う．この場合，$\bigcup_{A\in\mathcal{A}}A$を$\bigcup\mathcal{A}$と略記する．
        \item $\bigcup\mathcal{A}=X$となる時，集合族$\mathcal{A}$を$X$の被覆という．（$\mathcal{A}\subset P(X)$である必要はないこともある．）
        \item 線型空間$0$の基底は空な族$\varnothing\to\{ 0\}$と考えられる（$0$は加法の中立元かつ逆元）．その次元は添字集合の濃度から$|0|=|\varnothing |=0$である．
    \end{enumerate}
\end{definition}

\subsection{集合演算の無限への拡張}

\begin{definition}[無限項集合演算]
    $X$の部分集合の族$(X_i)_{i\in I}$の\textbf{合併}と\textbf{共通部分}を次のように定める：
    \begin{align*}
        \bigcup_{i\in I}X_i&:=\{ x\in X\mid \exists i\in I,\; x\in X_i \},&\bigcap_{i\in I}X_i&:=\{ x\in X\mid \forall i\in I,\; x\in X_i \}.
    \end{align*}
    \begin{enumerate}
        \item 今までの$X\cup Y$などは，$I=2$など$I\in\mathbb{N}$となる有限族の場合と捉えられる．添字集合$I$の概念をはっきりさせることで，この２つの集合演算（構成）と一階述語論理との対応が明快に理解される．
        \item 特に$I=\varnothing$の場合，$\bigcup_{i\in\varnothing} X_i=\varnothing ,\bigcap_{i\in\varnothing} X_i=X$．
    \end{enumerate}
\end{definition}

\begin{proposition}[集合族とその演算についての分配則とde Morgan則]\label{prop-de-Morgan's-law}
    \begin{align*}
        \left(\bigcup_{i\in I}X_i\right)\cap Y &= \bigcup_{i\in I}(X_i\cap Y), &\left(\bigcap_{i\in I}X_i\right)\cup Y &= \bigcap_{i\in I}(X_i\cup Y)\\
        X\setminus\left(\bigcup_{i\in I}X_i\right)&=\bigcap_{i\in I}(X\setminus X_i), &X\setminus\left(\bigcap_{i\in I}X_i\right)&=\bigcup_{i\in I}(X\setminus X_i)\;\;\;(この等式の\rightarrow 方向がNK)
    \end{align*}
\end{proposition}
$I=2$の場合は，ベン図を使って証明した．

\subsection{集合族からの構成}

\begin{definition}[無縁和と直和]\mbox{}
    \begin{enumerate}
        \item 族$(X_i)_{i\in I}$に対して，次のように構成された集合を直和と呼ぶ：
    \[\coprod_{i\in I}X_i := \{ (x,i)\in X\times I\mid x\in X_i \}=\bigcup_{i\in I}X_i\times\{i\}.\]
    \item 族$(X_i)_{i\in I}$の合併$\cup_{i\in I}X_i$が\textbf{無縁和}または\textbf{非交和}であるとは，$\forall i,j\in I,\; i\ne j\Rightarrow X_i\cap X_j=\varnothing$が成り立つことをいう．
    この時，次の標準的な単射
    \[\xymatrix@R-2pc{
        j_k:X_k\ar[r]&\coprod_{i\in I}X_i\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        x\ar@{|->}[r]&(x,k)
    }\]
    によって各$X_k$と$j_k(X_k)=X_k\times \{k\}$は同一視できる．
    \item $X=\cup_{i\in I}X_i$であって$\cup_{i\in I}X_i$が無縁和である時，族$(X_i)_{i\in I}$を\textbf{$X$の分割}という．
    \end{enumerate}
\end{definition}
\begin{definition}[積]
    集合$X$の部分集合族$(X_i)_{i\in I}$に対して，その元の族からなる$\Map(I,X)$の部分集合を\textbf{積}と呼ぶ：
    \[\prod_{i\in I}X_i := \{ (x_i)_{i\in I}\in \Map(I,X)\mid\forall i\in I \, x_i\in X_i \}.\]
    \begin{enumerate}
        \item $I=n$であるとき，次の標準写像による同型が存在するから，一般の$I$に対しても，$(x_i)_{i\in I}(j)\;(j\in I)$を$j$成分と呼ぶ．
    \[\xymatrix@R-2pc{
        \prod_{i\in n}X_i\ar[r]&X_0\times \cdots\times X_{n-1}\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (x_i)_{i\in n}\ar@{|->}[r] & (x_0,\cdots,x_{n-1})
    }\]
    \item 次の写像を$j$成分への\textbf{射影}と呼ぶ．
    \[\xymatrix@R-2pc{
        \pr_j:\prod_{i\in I}X_i\ar[r]&X_j\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (x_i)_{i\in I} \ar@{|->}[r] & x_j
    }\]
    \item 全ての$i\in I$に対して，$X_i=\cup_{i\in I}X_i=X$であるとき，積$\prod_{i\in I}X$は単に写像の集合$\mathrm{Map}(I,X)$と一致し，これを$X^I$と書く．\underline{$X^n$という表記の一般化と見れる}．
    \item 従って，特に$X^0=\{\varnothing\to X\}$は，$X=0$の時も，包含写像のみを元とする，一元集合である．$\id_0:0\to 0$を$0$と書くこととすると，$0^0=1$が成り立つ（集合としての相等：定義\ref{def-Extentionality}）．
    \end{enumerate}
\end{definition}

\begin{axiom}[選択公理：直積の言葉を用いた定式化]
    $\forall i\in I,\; X_i\ne\emptyset$を満たす集合族$(X_i)_{i\in I}$について，$\prod_{i\in I}X_i\ne\varnothing$．
\end{axiom}
\begin{remark}
    $I$が有限集合である場合は，$I=n$である場合と同一視でき，これは数学的帰納法により証明できる．
    一方で，元$(x_i)_{i\in I}$がしっかり書き下せる場合も多い．
    しかし$I$を一般の集合とすると，これは集合論の他の公理からは導けない主張であるので，ZFC公理系などでは公理の１つと数えられる．なおZFC公理系のCとは選択公理(Axiom of choice)を指す．
\end{remark}
以上，集合に対する演算子$\cup,\cap,\coprod,\prod$を定義した．

\subsection{写像演算}

\begin{definition}[写像の積]
    ２つの添字集合を共有した積集合$(X_i)_{i\in I},(Y_i)_{i\in I}$について，各写像$f_i:X_i\to Y_i$から以下のように構成される写像を，写像の族$(f_i)_{i\in I}$の積と呼ぶ．
    \[\xymatrix@R-2pc{
        \prod_{i\in I}f_i:\prod_{i\in I}X_i\ar[r]&\prod_{i\in I}Y_i\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (x_i)_{i\in I} \ar@{|->}[r] & (f_i(x_i))_{i\in I}
    }\]
    特に，$X_i=X, Y_i=Y, f_i=f:X\to Y$である時，$\prod_{i\in X}X_i=\mathrm{Map}(I,X), \prod_{i\in Y}Y_i=\mathrm{Map}(I,Y)$となり，ある一定の$f:X\to Y$に対して，$(f_i)_{i\in I}=f_*$である．
\end{definition}

\subsection{直和と直積の普遍性}

\begin{definition}[積の普遍性]
    $A,B,C$はある圏の対象とする．次の条件を満たすとき，$C$は$A\times B$と書かれる：
    \begin{quote}
        （積の普遍性）２つの射$\pi_1:C\to A,\pi_2:C\to B$が存在し，各$f_1:X\to A, f_2:X\to B$について，唯一つ$f:X\to C$が存在して次の図式が可換になる．
    \end{quote}
    \begin{center}\begin{tikzcd}
        & X \ar[dl] \ar[d] \ar[dr] & \\
        A & C \ar[l, "\pi_1"] \ar[r, "\pi_2"'] & B
    \end{tikzcd}\end{center}
\end{definition}

\begin{remark}
    上の状況下で，
    \begin{center}\begin{tikzcd}
        \varphi : \hom_C(C,A)\times\hom_C(C,B) \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \hom_{[C^{op},Set]}(h^C,\hom_C(-,A)\times\hom_C(-,B)) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        (f_1,f_2) \ar[r, mapsto] & \varphi_{(f_1,f_2)}
    \end{tikzcd}\end{center}
    というbijectionが存在する．特に，$(\pi_1,\pi_2)$の像は次の自然変換である．
    \begin{center}\begin{tikzcd}
        \varphi_{\pi_1,\pi_2}:\hom_C(-,C) \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \hom_C(-,A)\times\hom_C(-,B) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        f \ar[r, mapsto] & (\pi_1\circ f, \pi_2\circ f)
    \end{tikzcd}\end{center}
    これは対象$C$が$A,B$と何の関係が無くても成り立つ．この時，この自然変換$\varphi_{\pi_1,\pi_2}$が可逆でもある時，$C=A\times B$と書き，この唯一の射の組$(\pi_1,\pi_2)$を射影という．

    また従って以上より，積の普遍性は，米田の補題の特別な場合に付けた名前である．
\end{remark}

この条件を，今回集合論的に構成した「直積集合」が満たすことを見る．

\begin{proposition}[積の普遍性]
    $(T)_{i\in I}, (X_i)_{i\in I}$を集合の族，$(f_i)_{i\in I}$を写像$f_i:T\to X_i$の族とする．$(X_i)_{i\in I}$の直積を$X=\prod_{i\in I}X_i$とする．$(f_i)_{i\in I}$の直積は
    \begin{center}\begin{tikzcd}
        \prod_{i\in I}f_i:\prod_{i\in I}T=\mathrm{Map}(I,T) \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \prod_{i\in I}X_i=X \ar[d, phantom, "\rotatebox{90}{$\in$}"]\\
        (t_i)_{i\in I} \ar[r, mapsto] & (f_i(t_i))_{i\in I}
    \end{tikzcd}\end{center}
    であるが，今回特に，$(t_i)_{i\in I}$が定値写像$(t)_{i\in I}$となる場合に注目し，次の写像を$(f_i)\subset \prod_{i\in I}f_i$とする．
    \begin{center}\begin{tikzcd}
        (f_i):\mathrm{Map}(I,T) \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & X \ar[d, phantom, "\rotatebox{90}{$\in$}"]\\
        (t)_{i\in I} \ar[r, mapsto] & (f_i(t))_{i\in I}
    \end{tikzcd}\end{center}
    これは結局次の写像$f$と同一視できる．
    \begin{center}\begin{tikzcd}
        f:T \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & X \ar[d, phantom, "\rotatebox{90}{$\in$}"]\\
        t \ar[r, mapsto] & (f_i(t))_{i\in I}
    \end{tikzcd}\end{center}
    この時，こうして定義した$f$は，条件$$\forall i\in I \hspace{2mm} f_i=\mathrm{pr}_i\circ f$$
    によって特徴付けられる．
\end{proposition}
\begin{proof}
    $j\in I, t\in T$を任意に取る．$f(t)=(f_i(t))_{i\in I}$より，$\mathrm{pr}_j(f(t))=f_j(t)$である．

    $g:T\to X$が任意の$i\in I$に対して$f_i=\mathrm{pr}_i\circ g$を満たすとする．$t\in T$を任意に取り，$g(t)=(x_i)_{i\in I}$とする．すると，全ての$j\in I$に対して，$\mathrm{pr}_j(g(t))=x_j=f_j(t)$が仮定から成り立つが，これは$g$が各$t\in T$に対して，写像$I\ni i\mapsto f_i(t)\in X_i$を対応づけていることを表す．この対応は$f$に他ならず，$f=g$である．
\end{proof}

\begin{remark}\mbox{}
    \begin{enumerate}
        \item この時の写像$f:T\to \prod_{i\in I}X_i$も積といい，$(f_i)$と表す．
        写像$f_i:T\to X_i$の族$(f_i)_{i\in I}$の積$\prod_{i\in I}f_i:\mathrm{Map}(I,T)\to\prod_{i\in I}X_i$とは別物である．
        \item 特に$X_i=T$でもあり，写像$f_i:T\to T$の族$(\id_T)_{i\in I}$の積$T\to\mathrm{Map}(I,T)$を対角写像$\delta$と呼ぶ．
        \begin{center}\begin{tikzcd}
            \delta :T \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \mathrm{Map}(I,T) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
            t \ar[r, mapsto] & (t)_{i\in I}=\mathrm{Map}(I,\{ t\} )
        \end{tikzcd}\end{center}
        \item 圏論的には，組$(X, (\mathrm{pr}_i)_{i\in I})$を直積と呼ぶ．対象の族$(t(pr_i))_{i\in I}$の直積が，複数存在するなら，それらは同型である（可逆な射が存在する）ことが，普遍性から証明できる．
    \end{enumerate}
\end{remark}

\begin{proposition}
    定値写像$t_j:T\ni t\to t_j\in T$を用いて，各$j\in I$について$f\circ\mathrm{pr}_j = \prod_{i\in I}f_i\circ t_{j*}$が成り立つ．
\end{proposition}



\section{逆像と像}

\begin{screen}
    前節で写像を用いて集合の無限項演算を定義した．
    写像の効用はこれに止まらず，
    「写像が定める冪集合の間の関手」を考えると，
    写像の一段階マクロな動きを捉えられるのでより詳しく調べられる．
    このための言葉に「逆像」と「像」がある．
    この「全体と個別の間に中間的なものを設定する」のが，開集合系と位相空間の定義であるが，同様に大域と局所のズレを捉える概念装置が層である．
    像と逆像の言葉が便利なのは，これが特に関手性の多くを湛えているからである．
\end{screen}

\begin{definition}[image, inverse image]\mbox{}
    \begin{enumerate}
        \item $f(A):=\{y\in Y\mid\exists x\in A\;y=f(x)\}=\{f(x)\in Y\mid x\in A\}$
        \item $f^{-1}(B):=\{x\in X\mid f(x)\in B\}$
    \end{enumerate}
\end{definition}
\begin{remark}
    像と逆像は非対称である，写像という概念が非対称であるように．これが，1がreplacementによる集合定義，2が論理式による集合定義
    であることにも現れている気がする．そして集合定義はこの２通りであるのと同様，写像の方向も２つである．
\end{remark}

\subsection{像と逆像による表現}

\begin{proposition}[fiberの言葉による像と逆像の特徴付け]\mbox{}
    \begin{enumerate}
        \item $f(A)=\{y\in Y\mid f^{-1}(y)\cap A\ne\varnothing\}$
        \item $f^{-1}(B)=\cup_{y\in B}f^{-1}(y)$
    \end{enumerate}
\end{proposition}
\begin{proposition}[グラフと射影の言葉による特徴付け]\mbox{}
    \begin{enumerate}
        \item $f(A)=\pr_2(\pr_1^{-1}(A)\cap\Gamma)$
        \item $f^{-1}(B)=\pr_1(\pr_2^{-1}(B)\cap\Gamma)$
    \end{enumerate}
\end{proposition}

\begin{example}[像と逆像の言葉による，直和と和・直積と積の関係の特徴付け]\mbox{}
    \begin{enumerate}
        \item $\cup_{i\in I}A_i=\pr_1(\coprod_{i\in I}A_i)$
        \item $\cap_{i\in I}A_i=\delta^{-1}(\prod_{i\in I}A_i)$
    \end{enumerate}
\end{example}

\begin{example}[逆像の言葉による，グラフの特徴付け]
    $f=(X,Y,\Gamma)$として，$\Delta_Y\subset Y\times Y$とする．
    \[\Gamma=(f\times\id_Y)^{-1}(\Delta_Y)\]
\end{example}

\subsection{像と逆像の集合演算・順序構造に対する関手性}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=interactions of images and pre-images with unions and intersections]
    像写像$f_*$も逆像写像$f^*$も，包含関係に関する順序を保つ．
    しかし集合演算については，$f_*$が$\cap$に関してだけ完全には保存しない．
    pre-images preserve unions and intersections (a general reason for this being that unions are colimits, intersections are limits, and $f^\ast$ is simultaneously a left- and a right-adjoint: $f^\ast$ is right-adjoint to the existential quantifier $\exists_f$ and left-adjoint to the universal quantifier $\forall_f$).\footnote{\url{https://ncatlab.org/nlab/show/preimage}}
    またこの命題には初等的な証明だけでなく，圏論的な証明がある．The advantage of this type of proof is that, despite its utter simplicity, it generalizes to much wider contexts (beyond elementary classical set theory).
\end{tcolorbox}

\begin{proposition}[像と逆像と集合演算の絡み合い]\mbox{}\label{prop-functoriality-of-image-and-inverse-image-mappings}
    \begin{enumerate}
        \item (adjunction) $f(A)\subset B\Leftrightarrow A\subset f^{-1}(B)$．
        \item $f$の像について次が成り立つ．
        \begin{enumerate}[(1)]
            \item $A\subset f^{-1}(f(A))$．
            \item $A'\subset A\Rightarrow f(A')\subset f(A)$．
            \item $f(\cup_{i\in I}A_i)=\cup_{i\in I}f(A_i)$，$f(\cap_{i\in I}A_i)\textcolor{red}{\subset}\cap_{i\in I}f(A_i)$．
            \item $f$が単射ならば，$A=f^{-1}(f(A))$．$f$が単射で，$I$がinhabited (not empty)ならば，$f(\cap_{i\in I}A_i)=\cap_{i\in I}f(A_i)$．
        \end{enumerate}
        \item $f$の逆像について，次が成り立つ．
        \begin{enumerate}[(1)]
            \item $f(f^{-1}(B))=B\cap f(X)$，$f^{-1}(Y\setminus B)=X\setminus f^{-1}(B)$．
            \item $B\subset B'\Rightarrow f^{-1}(B)\subset f^{-1}(B')$．
            \item $f^{-1}(\cup_{i\in I}B_i)=\cup_{i\in I}f^{-1}(B_i)$，$f^{-1}(\cap_{i\in I}B_i)=\cap_{i\in I}f^{-1}(B_i)$．
        \end{enumerate}
    \end{enumerate}
\end{proposition}
\begin{remark}[proof via adjoints]
    1.の性質を，$f_*$は$f^*$のleft adjointである，という．なお，向きは，包含写像$i:f(A)\to B$の向きで左右が決まっている．
    これは内積空間での関係$\langle Ax,y\rangle=\langle x,By\rangle$から来たものである．
    あえて書くなら，$\bracket{f(A),B}=\bracket{A,f^{-1}(B)}$である．ただし$\bracket{S,T}$とは，$S\subset T$とした．in fact the analogy is not idle; see for instance Baez.
\end{remark}
\begin{proof}\mbox{}
    \begin{description}
        \item[1. adjunction] どちらも，$x\in A\Rightarrow f(x)\in B$という論理式の表現である．
        \item[2. Union, reasoning foreward/backward trick] 1.より，任意の族$(S_i)_{i\in I}$と集合$T$について，次の同値変形が成り立つ．
        \begin{align}
            \bigcup_{i\in I}f(S_i)\subset T&\Leftrightarrow \forall i\in I,\;f(S_i)\subset T\label{eq-1}\\
            &\Leftrightarrow \forall i\in I,\; S_i\subset f^{-1}(T)\label{eq-2}\\
            &\Leftrightarrow \bigcup_{i\in I}S_i\subset f^{-1}(T)\label{eq-3}\\
            &\Leftrightarrow f\paren{\bigcup_{i\in I}S_i}\subset T.\label{eq-4}
        \end{align}
        \ref{eq-1},\ref{eq-3}行目の変形は，$\cup$の定義(defining property)による．\ref{eq-2},\ref{eq-4}が1.のadjunctionを用いた世界線の飛び越えである．
        いま，$T=\cup_{i\in I}f(S_i)$とすると初めの主張が真であるから，前方向に同値変形すると$f(\cup_{i\in I}S_i)\subset\cup_{i\in I}f(S_i)$を得る．
        続いて$T=f(\cup_{i\in I}S_i)$とすると，終わりの主張が真であるから，後ろ方向に同値変形すると$\cup_{i\in I}f(S_i)\subset f(\cup_{i\in I}S_i)$を得る．
        ２つ併せて，$\cup_{i\in I}f(S_i)=f(\cup_{i\in I}S_i)$を得る．
        \item[2. Intersection, reasoning foreward/backward trick] 同様にして1.より，
        \begin{align*}
            S\subset\bigcap_{i\in I}f^{-1}(T_i)&\Leftrightarrow \forall i\in I,\; S\subset f^{-1}(T_i)\\
            &\Leftrightarrow \forall i\in I,\; f(S)\subset T_i\\
            &\Leftrightarrow f(S)\subset \bigcap_{i\in I}T_i\\
            &\Leftrightarrow S\subset f^{-1}\paren{\bigcap_{i\in I}T_i}.
        \end{align*}
        同様のreasoning foreward/backward trickにより，$\cap_{i\in I}f^{-1}(T_i)=f^{-1}(\cap_{i\in I}T_i)$を得る．
        \item[3. 像と交叉]
        \begin{align*}
            f\paren{\bigcup_{i\in I}S_i}\subset \bigcup_{i\in I}f(S_i)&\Leftrightarrow (\forall_{i\in I})\;f\paren{\bigcap_{i\in I}S_i}\subset S_i&\mathrm{defining property of intersection}\\
            &\Leftarrow (\forall_{i\in I})\;\bigcap_{i\in I}S_i\subset S_i&(\mathrm{(2)}より)
        \end{align*}
    \end{description}
\end{proof}
\begin{remarks}\mbox{}
    \begin{enumerate}
        \item 確か二重否定則を使わないと戻ってこれないのも，de Morganのうち，$\lnot\forall$や$\lnot\land$だったよな？
        絶対つながっているよな．
        \item reasoning forward/backward trickとは結局，poset上で$A=B\iff\forall T,\;A\le T\Leftrightarrow B\le T$またはその双対命題を推論しているのである．This trick is vastly extrapolated by the Yoneda lemma.
        \item Category theoristsは，像$f_*(S)$を$\exists_f(S)$と表し，像写像を$\exists_f:P(X)\to P(Y)$と存在量化子と同一視して理解する．The suggestion is to view existential quantification as corresponding to taking of a direct image. そもそも通常の命題$P\subset X\times Y$に対する存在量化された命題$(\exists_{x\in X}) P(x,y)$とは，（形式化して条件を集合と見れば）像$\pr_2^*(P)$に他ならないからである．これに軸足を移して，存在量化子の意味を，射影だけでなくより普遍的な写像について像を取ること，とみなせる．
        \item こうすると，随伴関係は$\exists_f\dashv f^*$と表せる．Which is an example of a famous slogan due to Lawvere: “Logical quantification is adjoint to substitution” (with resonances far beyond the purview of logic as ordinarily conceived).
    \end{enumerate}
\end{remarks}

\begin{problem}[A2.5.3]
    $f_*:P(X)\to P(Y)$の値域について，$f_*(P(X))=P(f(X))$．
\end{problem}
\begin{proof}
    
\end{proof}

\subsection{和と積に対する関係}

\begin{lemma}\mbox{}\label{lemma-preimage-and-product}
    \begin{enumerate}
        \item $(f,g)^{-1}(U\times V)=f^{-1}(U)\cap g^{-1}(V)$（積位相の特徴付け（命題\ref{prop-characterization-product-topology}）で使用）．
        \item $(\prod_{i\in I}U_i)\cap(\prod_{i\in I}V_i)=\prod_{i\in I}(U_i\cap V_i)$（積位相の普遍性（命題\ref{prop-universality-of-product-space}）で使用）．
    \end{enumerate}
\end{lemma}

\section{商集合と写像の標準分解}

\begin{screen}
    商集合とは，部分集合と双対的な対象である．
    包含写像と商写像の双対性は，単射と全射の双対性に似ている．
    この構成は，定義域$X$上の同値関係の言葉で記述される．一方包含写像や単射という概念は$Y$上の同値関係が記述する概念である．

    商集合とは同値関係$=$の更新であるが，集合論において$=$は$\in$と同様に公理的に定義された無定義語で，
    そのような構成の実装としては冪集合$P(X)$上への構成という手法がある．

    写像の標準分解は対称的な理解を与える，一つの標準形と言える．これでようやく圏論の見せる数理自然に到達したの感を得る．
    写像の標準分解は，まず終域を整形し，始域について同値類に畳み込み，N対1写像に対して可逆写像を定める．
    Riemann面の理論は標準分解に近いのであろうか．
    $f$が一般的な射である場合は，標準分解は同型を与える．これは\textbf{準同型定理}と呼ばれる．しかし，Topでは標準分解は成功せず，$\overline{f}$は同相写像であるとは限らない．
\end{screen}

\begin{proposition}[写像が定める同値関係]
    $f:X\to Y$を写像とする．
    \begin{enumerate}
        \item $x,x'\in X$に対し$f(x)=f(x')$であるという関係$R_f$は，$X$上の同値関係を定める．これを\textbf{$f$が定める同値関係}という．
        \item $f$が定める同値関係$R_f$のグラフ$C_f:=\{(x,x')\in X\times X\mid f(x)=f(x')\}$は$(f\times f)^{-1}(\Delta_Y)$に等しい．また$a\in X$について，その同値類はファイバー$[a]=f^{-1}(f(a))$である．
        \item $X$の部分集合の族$(f^{-1}(y))_{y\in f(X)}$は$X$の分割である．
    \end{enumerate}
\end{proposition}

\begin{definition}[quotient set]
    $X$上の同値関係$R$に対して，$x\in X$をその同値類$[x]\subset X$に写す写像$q:X\to P(X)$の値域$q(X)=:X/R$を$X$の$R$による\textbf{商集合}という．
    また$q$を\textbf{商写像}という．
\end{definition}

\begin{remark}\mbox{}
    \begin{enumerate}
        \item 商写像が$X$上に定める同値関係は$R_q=R$である．
        \item 商写像が可逆である条件は，$R$が自明な同値関係であることである．
    \end{enumerate}
\end{remark}

\begin{proposition}
    $R$を$X$上の同値関係とする．
    \begin{enumerate}
        \item 商写像$q:X\to X/R$が定める同値関係$R_q$は$R$と等しい．
        \item $A\in X/R$に対して，ファイバー$q^{-1}(A)$は$A$と等しい．
    \end{enumerate}
\end{proposition}

\begin{definition}[classification, complete set of representatives]
    $R$を$X$上の同値関係とする．
    \begin{enumerate}
        \item $X$の分割$(A)_{A\in X/R}$を，$R$による$X$の類別という．
        \item $S\subset X$であって，$q|_S:S\to X/R$が可逆になる時（右逆元即ち\textbf{切断}を持つ），$S$は$R$に関する\textbf{完全代表系}であるという．
    \end{enumerate}
\end{definition}

\begin{proposition}[canonical decomposition]
    $f:X\to Y$を写像とする．
    \begin{enumerate}
        \item 次の図式を可換にする写像$\overline{f}$が唯一つ存在する．この分解$f=i\circ\overline{f}\circ q$を\textbf{$f$の標準分解}という．\begin{center}\begin{tikzcd}
            X \ar[r, "f"] \ar[d, "q"'] & Y\\
            X/R_f \ar[r, dotted, "\overline{f}"] & f(X)\ar[u, "i"']
        \end{tikzcd}\end{center}
        \item 写像$\overline{f}$は可逆である．この$\overline{f}$を\textbf{$f$によって引き起こされる可逆写像}と呼ぶ．
        \item $f$が定める同値関係$R_f$についての商集合$X/R_f$を，\textbf{$f$の余像}と呼ぶ．
    \end{enumerate}
\end{proposition}

\section{単射と全射}

\begin{screen}
    \begin{quotation}
        写像の標準分解により，部分集合の包含写像と商集合への商写像，またこれらと可逆写像との合成は，全ての写像に付随して生じる特に基本的な意味を持つ写像であると分かった．これらをそれぞれ，単射と全射と呼び，その性質を調べる．
    \end{quotation}
    写像を標準分解形によって分類する．綺麗には分解されない場合，その形によって単射と全射と名付ける．
    単射とは可逆写像と包含写像との合成$\overline{f}\circ i$のことであり，全射は商写像と可逆写像の合成$q\circ\overline{f}$のことである．
    単射は$q$が退化している$f$であり（$q$の定義上，自明な写像になっていようと階層が違って恒等射というわけではない），全射が$i$が退化している$f$である．よって，単射の時は$X≃f(X)$，全射の時は$X/R_f≃Y$という同一視が引き起こされる．
    Set上では，単射は右可逆性，全射は左可逆性と同値になる．
\end{screen}

\begin{definition}[逆像のことばによる，全射と単射の定義]
    $f:X\to Y$を写像とする．
    \begin{enumerate}
        \item $f$が単射とは，次が成り立つことをいう：$\forall x\in X,\;f^{-1}(f(x))=\{x\}$．
        \item $f$が全射とは，次が成り立つことをいう：$\forall y\in Y,\;f^{-1}(y)\ne\emptyset$．
        \item $f$が単射でも全射でもあるとき，\textbf{全単射}という．
    \end{enumerate}
\end{definition}

\begin{proposition}[全射と単射の特徴付け]
    次の３条件は同値である．
    \begin{enumerate}
        \item $f$は単射である．
        \item $f$が定める同値関係$R_f$は相等関係と同値である．
        \item $f$が定める写像$X\to f(X)$は可逆である．
    \end{enumerate}
    次の３条件は同値である．
    \begin{enumerate}
        \item $f$は全射である．
        \item $f(X)=Y$である．
        \item $X$の同値関係$R$と商集合からの可逆写像$\overline{f}:X/R\to Y$で，$q:X\to X/R$を商写像とすると，$f=\overline{f}\circ q$を満たすものが存在する．
    \end{enumerate}
\end{proposition}

単射は左$q$退化の事象，全射は右$i$退化の事象だと知っていれば，次は明らかに思えてくる．
\begin{lemma}[単射は左$q$退化の事象，全射は右$i$退化の事象]
    $f:X\to Y, g:Y\to Z$を写像とする．
    次の条件について，1$\Rightarrow$2$\Rightarrow$3が成り立つ．
    \begin{enumerate}
        \item $f$と$g$は単射である．
        \item $g\circ f$は単射である．
        \item $f$は単射である．
    \end{enumerate}
    次の条件について，1$\Rightarrow$2$\Rightarrow$3が成り立つ．
    \begin{enumerate}
        \item $f$と$g$は全射である．
        \item $g\circ f$は全射である．
        \item $g$は全射である．
    \end{enumerate}
\end{lemma}

\begin{proposition}
    写像$f:X\to Y$について，次の２条件は同値である．
    \begin{enumerate}
        \item $f$は全単射である．
        \item $f$は可逆である．
    \end{enumerate}
\end{proposition}

\begin{proposition}
    写像$f:X\to Y,g:Y\to Z$について，次の２条件は同値である．
    \begin{enumerate}
        \item $f\circ g$は可逆である．
        \item $g$が単射で$f$が全射である．
    \end{enumerate}
\end{proposition}

\begin{itembox}[l]{単射と全射まとめ}
    \begin{theorem}[mono]\label{thm-mono}
        以下は全て写像$f:X\to Y$が単射であることの同値な定義である．
        \begin{enumerate}
            \item ［像／逆像の言葉］$\forall x\in X f^{-1}(f(x))=\{x\}$．
            \item ［その論理的変形・大域化］$\forall A\subset X f^{-1}(f(A))=A$（雪江群論）．
            \item ［左一意性］$f$が定める同値関係$R_f$は相等関係と同値である．（関係が一致するとはグラフが一致することと定義した）．
            \item ［標準分解の言葉］$f$が定める写像$X\to f(X)$は可逆になる．
            \item ［左簡約可能：monic］$g\circ f=\id_X$を満たす写像$g:Y\to X$が存在する．または，$X=\emptyset$である．
        \end{enumerate}
    \end{theorem}
    \begin{theorem}[epi]\label{thm-epi}
        以下は全て写像$f:X\to Y$が全射であることの同値な定義である．
        \begin{enumerate}
            \item ［逆像の言葉］$\forall y\in Y f^{-1}(y)\ne\emptyset$．
            \item ［右全域性］$f(X)=Y$．
            \item ［標準分解の言葉］$f=\overline{f}\circ q$となる可逆写像$\overline{f}$が存在する．
            \item ［右簡約可能：epic］$f\circ g=\id_Y$を満たす写像$g:Y\to X$が存在する．
        \end{enumerate}
    \end{theorem}
\end{itembox}

\section{引き起こされる写像}

\begin{screen}
    等化子と余等化子を考える．任意の圏で，等化子はmonicで，余等化子はepicである（２つは双対命題）．
    等化子は最大のマスク（終対象），余等化子は最小のマスク（始対象）と捉えられる．

    Setにおいて等化子は，部分集合と同一視できる．
    他の等価する射$fz=gz\Rightarrow f=g$は必ず等化子について分解する．これは最大のマスク$f(T)\subset i(X)$であることに対応する．
    これが像$f(X)$の正体である，$f:X\to Y$によって終域$Y$の部分集合を指定しているのであって，
    これを置換公理という．またその一番簡明な形が，特性関数と定値写像$1$との等化子の場合である．

    Setにおいて$R\subset X\times X$の定める商写像$\pi:X\to X/R$とは，射影の制限$\pr_1,\pr_2:R\to X$を用いて$q_\pi=\coeq(\pr_1,\pr_2)$と表せる．
    $\pi$よりも粗い同値関係を定める$f$（$f\circ \pr_1=f\circ\pr_2$を満たすもの）は，必ず$\pi$に関して分解する．
    Set上で一般の写像についての等化子$\coeq(f,g)$とは，写像$f-g$が定める同値関係についての商写像になる．

    「引き起こされた写像」とは，余等化子（Setでは商集合）の普遍性により一意に定まる射のことをいう．

    単射は足下を支え，全射は頭をスライドさせることができるための必要条件を考えると，
    これはやはりそれぞれ，像の間の包含関係と，写像の定める同値関係のグラフの間の包含関係に一致する．
\end{screen}

\begin{proposition}[等化子の普遍性：単射と一般の写像]
    $i:X\to Y$を単射，$T$を勝手な集合，$f:T\to Y$を写像とする．次の２つの条件は同値である．
    \begin{enumerate}
        \item $f(T)\subset i(X)$である．
        \item 下の図式を可換にする写像$g:T\to X$が一意的に存在する．
        \[\xymatrix{
            X\ar@{^{(}->}[r]^-i&Y\\
            T\ar@{.>}[u]^-g\ar[ur]_-f
        }\]
    \end{enumerate}
\end{proposition}
$f(T)\supsetneq i(X)$の時，$g$をどう取っても$f(T)\setminus i(X)\ne\varnothing$となってしまうため，写像として一致し得ない．

\subsection{写像が全射によって分解されるための条件を考える}

\begin{proposition}[全射と一般の写像]\label{prop-induced-mapping}
    $X,Y,Z$を集合，$p:X\to Y$を全射，$f:X\to Z$を写像とする．
    \begin{enumerate}
        \item 次の条件(1)と(2)は同値である．
        \begin{enumerate}[(1)]
            \item $f=g\circ p$を満たす写像$g:Y\to Z$が存在する．\begin{center}\begin{tikzcd}
                X \ar[r, twoheadrightarrow, "p"] \ar[dr, "f"'] & Y \ar[d, dashed, "g"]\\
                & Z
            \end{tikzcd}\end{center}
            \item 全射$p$が定める同値関係$R_p$は，写像$f$が定める同値関係$R_f$よりも細かい：$C_{R_p}\subset C_{R_f}$．
        \end{enumerate}
        \item いま，$R_p$が$R_f$よりも細かいとする．この時，次の２つの条件は同値である．
        \begin{enumerate}[(1)]
            \item $f=g\circ p$を満たすこの$g:Y\to Z$は単射である．
            \item $R_p$と$R_f$は同値である．
        \end{enumerate}
    \end{enumerate}
\end{proposition}
\begin{remark}
    写像$p$の時点で重要な何かが潰れていなければいい．このための条件は，「写像が定める同値関係」として，共通する始域$X$上の関係，またはそのグラフ（部分集合）の包含関係などで議論できる．
    $R_p$の方が$R_f$よりも細かければ，より豊富な情報を含んでいて還元出来ない部分はないから，$g$を上手く潰すように設定すれば，$f=g\circ p$と出来る．

    なお，２つの同値関係の間の関係として，「よりも細かい」とは，$\forall x,x'\in X \, p(x)=p(x')\Rightarrow f(x)=f(x')$が成り立つと言うことである．この逆も成り立つ時，２つの同値関係は同値であると言う．
\end{remark}
\begin{proof}
    1.を示す．$(1)\Rightarrow (2)$は\[ \forall x,x'\in X ,\; p(x)=p(x')\Rightarrow f(x)=f(x') \]を示せば良い．いま，実際$p(x)=p(x')$を満たす$x,x'\in X$について，$q(p(x))=q(p(x'))$であるから，$f(x)=f(x')$が従う．

    次に$(2)\Rightarrow (1)$を考える．写像$g$を構成するために，写像
    \begin{center}\begin{tikzcd}
        (p,f):X \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & Y\times Z \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        x \ar[r, mapsto] & (p(x),f(x))
    \end{tikzcd}\end{center}
    を考える．この値域$(p,f)(X)=\{ (p(x),f(x))\mid x\in X \}=:\Gamma_g$は(A)写像のグラフとなっており，そして(B)このグラフが定める写像$(Y,Z,\Gamma_g)=:g$が求める唯一つの写像であることを示す．

    (B)については，全ての$x\in X$について，$g$の定め方より$g(p(x))=f(x)$が成り立つから，確かにこれは$f=g\circ p$を満たす写像である．

    (A) $\Gamma_g$が写像のグラフとなっていることの証明を，$\mathrm{pr}_1:Y\times Z\to Y$を第一射影として，$\mathrm{pr}_1|_{\Gamma_g}$が全単射であることを示すことによって行う．
    $\mathrm{pr}_1|_{\Gamma_g}\circ (p,f)=id_Y\circ p=p$より，$p$は全射であるから$\mathrm{pr}_1|_{\Gamma_g}$も全射である．また，$(y,z),(y',z')\in\Gamma_g$について$\mathrm{pr}_1(y,z)=\mathrm{pr}_1(y',z')$即ち$y=y'$即ち
    $\exists x,x'\in X \,\mathrm{s.t.}\, p(x)=p(x')$ならば，$R_p\subset R_f$より，$f(x)=f(x')$即ち$z=z'$より，$\mathrm{pr}_1|_{\Gamma_g}$は単射でもある．
\end{proof}
\begin{remark}
    この証明の始め方自体がキーとなっている．集合論という方法論を完全に乗りこなしているかのような，先を見据えた定式化によって，いとも簡単に論理の意図を手繰り寄せる証明で，びっくりした．

    「気持ち」と定式化された「理論」の違いをご覧に入れたい．おそらくこれは定義\ref{def-relationship-between-equivalence-relation}の同値関係同士の「細かい」と言う関係の定式化が上手だからである．
    でもそれにしても$(2)\Rightarrow (1)$の証明は，今までの集合論の議論が要点を得ていることを実感する，大海の上を，非常に頑健でかつ絶妙に配置された足場を飛びながら自由に旅をしているの感がある．

    まず$(1)\Rightarrow (2)$は，$R_f=R_{g\circ p}$であるが，$R_{g\circ p}$は，$R_p$よりも$g$の分だけ同値類が統合されて粗くなっている（$g$が全単射でない限り）．従って，$R_f$は$R_p$よりも粗い．

    次に，$(2)\Rightarrow (1)$は，$p$が引き起こす可逆写像$\tilde{p}$により$Z\simeq X/R_p$だから，下の図式を可換にするような$g':X/R_p\to Z$を構成すれば良い．
    \begin{center}\begin{tikzcd}
        X/R_p \ar[r, dashed, "g'"] \ar[dr, twoheadrightarrow, tail, "\tilde{p}" near end] & Z \\
        X \ar[u, "q_p"] \ar[ur, "f" near start] \ar[r, twoheadrightarrow, "p"] & Y \ar[u, dashed, "g"']
    \end{tikzcd}\end{center}
    これは，$R_p$の同値類を巧妙に潰して$R_f$にするような$g'$，即ち$f(x)=f(x'),\hspace{0.5em} x,x'\in X \Rightarrow g(p(x))=g(p(x'))$の仕事をしてくれる$g$を選べば良い．

    これ以上踏み込めない感覚がするのは，$(1)\Rightarrow (2)$も$(2)\Rightarrow (1)$も，上記の議論では集合論的見地から，具体的な要素について論理を用いて論証していないからであろう．それを実行するには正しい道具の整備を訓練が居る，さもないとこの「所感」のように，表面だけさらって正しいような気がしてしまう．それにしてもここが突破出来るとはとても思えなかった，集合論の威力はここにある．
\end{remark}
\begin{proof}
    2.を示す．$(2)\Rightarrow(1)$． $R_p=R_f$の時，$X/R_p=X/R_f$であるから，$p,f$の標準分解は，可逆写像$\tilde{p}:X/R_p\to Y$と単射$\overline{f}:X/R_p\to Z$を定める．
    \begin{center}\begin{tikzcd}
        X \ar[r, "p"] \ar[d, "q"'] \ar[dr, "f"' near end, "\circlearrowright"' near start] & Y \ar[d, "g"] \\
        X/R_p \ar[ur, "\tilde{p}" near end, "\circlearrowright"' near start] \ar[r, "\overline{f}"'] \ar[d, dashed, "\tilde{f}"] & Z \\
        f(X) \ar[ur, dashed, "i"']
    \end{tikzcd}\end{center}
    この図式は結局全体として可換であり（$f=g\circ p$かつ$f=\overline{f}\circ q$より，$\overline{f}\circ q=g\circ p$を得る．これと$p=\tilde{p}\circ q$より），$\overline{f}\circ\tilde{p}^{-1}=g$となる．従って$g$は全射である．

    $(1)\Rightarrow(2)$．$g$が単射ならば，$g(y)=g(y')\Rightarrow y=y'$より，
    \begin{eqnarray*}
        p(x)=p(x') &\Leftrightarrow& g(p(x))=g(p(x')) \\
        &\Leftrightarrow& f(x)=f(x')
    \end{eqnarray*}
    より，$R_f=R_p$である．
\end{proof}

\begin{definition}[independent of the choice, well-defined, induced mapping]
    $p:X\to Y$を全射とし，$f:X\to Z$を写像とする．
    \begin{center}\begin{tikzcd}
        X \ar[r, twoheadrightarrow, "p"] \ar[dr, "f"'] & Y \ar[d, dashed, "g"]\\
        & Z
    \end{tikzcd}\end{center}
    $p$が定める同値関係$R_p$が，$f$が定める同値関係$R_f$より細かい時，$y\in Y$に対して，\textbf{$f(x)=g\circ p(x)\in Z$は$x\in X$の取り方に依らない}といい，\textbf{写像$g$はwell-definedである}という．なお，
    この写像$g$を\textbf{$f$によって引き起こされた写像}という．
\end{definition}

\begin{corollary}[商集合の普遍性]
    $R$を集合$X$上の同値関係とし，$q:X\to X/R$を商写像とする．
    \begin{enumerate}
        \item 写像$f:X\to Y$について，次の２条件は同値である．
        \begin{enumerate}[(1)]
            \item 次の図式を可換にする写像$g:X/R\to Y$が存在する．これは$f$によって引き起こされた写像である．\begin{center}\begin{tikzcd}
                X \ar[r, "q"] \ar[dr, "f"'] & X/R \ar[d, "g"] \\
                & Y
            \end{tikzcd}\end{center}
            \item $R$は，$f$が定める同値関係$R_f$より細かい．
        \end{enumerate}
        \item $R'$を$Y$の同値関係とし，$q':Y\to Y/R'$を商写像とする．写像$f:X\to Y$に対して，次の２条件は同値である．
        \begin{enumerate}[(1)]
            \item 写像$g:X/R\to Y/R'$で，次の図式を可換にするものが存在する．
            \begin{center}\begin{tikzcd}
                X \ar[r, "f"] \ar[d, "q'"'] & Y \ar[d, "q'"] \\
                X/R \ar[r, "g"'] & Y/R'
            \end{tikzcd}\end{center}
            \item $C\subset X\times X$を$R$のグラフとし，$C'$を$R'$のグラフとすると，$C\subset (f\times f)^{-1}(C')$である．
        \end{enumerate}
    \end{enumerate}
\end{corollary}
\begin{proof}
    1. 全射$p$について命題\ref{prop-induced-mapping}を適用して得る主張である．なお，$q$が定める同値関係$R_q$とは$R$に他ならない．
    
    2. 全射$q'\circ f$について命題\ref{prop-induced-mapping}を適用して得る主張である．
\end{proof}

\begin{definition}[Universal propoerty of quotient set]
    写像$q:X\to X'$について，任意の集合$Y$と写像$f:X\to Y$に対して，次の図式を可換にする$g$が存在するとき，この$X'$を，$q$が定める同値関係$R_q$による商集合といい，$q$をその商写像と呼ぶ．
    \begin{center}\begin{tikzcd}
        X \ar[r, "q"] \ar[dr, "f"'] & X' \ar[d, "g"] \\
        & Y
    \end{tikzcd}\end{center}
\end{definition}
\begin{remark}
    これは$q$が全射であるための条件となっている．でもこのままでは明らかに，全ての$f$に対応できるわけではない，$f$が全単射であった場合，$q$は自明な同値関係による商写像を与える全単射である．
\end{remark}

\section{双対写像}

\begin{screen}
    位相空間のlocaleとframeとしての見方を重視すると，手法が極めて代数的になる．
    代数の基礎といえば線型代数学である．
    線型代数学と並行な議論をここでも展開しておく．
    反変関手$f^*$と双対写像$f^*$はいずれも反変Hom関手であり，
    $f^*=\Hom(-,2)$か$f^*=\Hom(-,K)$かで違うのみである．
    frame morphismとは$f^*=\Hom(-,\S)$である，おそらく．
\end{screen}

\begin{definition}[dualizing object, Janusian object]
    ２つの関手$U:A\to\Set,V:B\to\Set$\footnote{\url{https://ncatlab.org/nlab/show/dualizing+object}}
\end{definition}
\begin{remark}
    ２つの圏を行き来するワープホールみたいなもので，双対的な随伴関手の組を誘導する対象．今回は$\S\in\Top$と$\Op(\S)\in\Frm$．
    \begin{itemize}
        \item Isbell speaks of objects keeping summer and winter homes;
        \item Lawvere speaks of objects sitting in two categories;
        \item Simmons speaks of schizophrenic objects.
    \end{itemize}
\end{remark}

\subsection{逆像写像について}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=逆像写像]
    逆像$f^{-1}(B)=A$の記法は混同の恐れがあるので，写像$f^*:P(Y)\to P(X)$を定めて$f^*(B)=A$と書くべきである．
    この新たな記法はpullbackから得られる．実際，逆像とは，$f:X\to Y$と$i:B\to Y$の引き戻しである：
    \[\xymatrix{
        f^*(S)\;\ar@{^{(}->}[r]\ar[d]&X\ar[d]^-f\\
        S\;\ar@{^{(}->}[r]&Y
    }\]
    sheafへの一般化，toposへの一般化を持つ．
\end{tcolorbox}

\begin{proposition}[双対命題]\label{prop-dual-maps}
    $f:X\to Y$を写像とし，$f^*:P(Y)\to P(X)$を冪集合の上に定まる写像
    \[\xymatrix@R-2pc{
        P(Y)\ar[r]&P(X)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        A\ar@{|->}[r]&f^{-1}(A)
    }\]とする．
    \begin{enumerate}
        \item $f$が単射であることと，$f^*$が全射であることは同値である．
        \item $f$が全射であることと，$f^*$が単射であることは同値である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1. $\Rightarrow$] 
        $f:X\to Y$が単射とする．$f^*$は$2$で$\{1\}\in P(2)$を普遍元として表現されるから，
        \[\xymatrix@R-2pc{
            f^*:\Hom(Y,2)\ar[r]&\Hom(X,2)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            \chi:Y\to 2\ar@{|->}[r]&\chi\circ f:X\to 2
        }\]
        が全射であることを示せば良い．即ち，任意の$\eta:X\to 2\in\Hom(X,2)$が$f$に沿って分解することを示せば良い．
        \[\xymatrix{
            X\ar@{^{(}->}[r]^f\ar[dr]_-\eta&Y\ar@{.>}[d]^-{\chi}\\
            &2
        }\]
        これは，$f$は単射であることを使えば，命題\ref{prop-induced-mapping}より，必ず分解する．
        まず，$\overline{f}:X\to f(X)$を考えると，これは全単射であるから，$R_{\overline{f}}$は自明な同値関係である．従って必ず$\eta$の定める同値関係よりも細かいから，適切な$\overline{\chi}:f(X)\to 2$が存在する．残りの$Y\setminus f(X)$については勝手に定めて$\chi:Y\to 2$を定めれば良い．
        \item[1. $\Leftarrow$] 
        $f^*:P(Y)\to P(X)$が全射の下で$x\ne y$について$f(x)=f(y)$が成り立つと仮定して矛盾を導く．$x\ne y$の時，$x\in A\land y\notin A$を満たす$A\subset X$を任意にとれば（$A=\{x\}$など$A\subsetneq f^{-1}(x)$を満たすものなら適格），$A=f^{-1}(B)$を満たす$B\subset Y$は存在しないので，$f^*$が全射であることに矛盾．
        \item[2. $\Rightarrow$] 
        $f:X\to Y$が全射とする．$\chi,\eta\in\Hom(Y,2)$について，$f^*(\chi)=f^*(\eta)$とする．即ち，$\chi\circ f=\eta\circ f$．$f$が全射の時epicであるから（定理\ref{thm-epi}），$\chi=\eta$が従う．よって，$f^*:P(Y)\to P(X)$は単射．
        \item[2. $\Leftarrow$] 
        $f^*:P(Y)\to P(X)$が単射の時，ある$x\in Y$について$f^{-1}(x)=\emptyset$とすると，$f^{-1}(x)=f^*(\{x\})=f^*(\emptyset)$となるので，$\abs{(f^*)^{-1}(\emptyset)}\ge 2$．$f^*$が単射であることに矛盾．よって，$f$は全射．
    \end{description}
\end{proof}
\begin{remarks}
    もっと簡単に示せるんじゃないか？壮大なdualityの理論があるのではないか？
    Twitterでたまたまヤヌス対象を知ったが，$K\in\Vect_K$が数えられていない．
    僕の理想とする理論はまた違う．

    本当にもっと簡単に示せた！ありがとうございます小泉さん！
\end{remarks}
\begin{proof}
    集合$S$に対して，全単射
    \[\xymatrix@R-2pc{
        \paren{\F_2^{\oplus S}}^\vee\ar[r]&P(S)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        g\ar@{|->}[r]&\{s\in S\mid g([s])=1\}
    }\]
    が存在することに着目する．ただし，$(-)^\vee$は$\F_2$-線型空間の双対を表す．

    写像$f:A\to B$は$\F_2$-線型写像$\varphi_f:\F_2^{\oplus A}\to\F_2^{\oplus B}$を誘導し，
    $f$の単射性・全射性は$\varphi_f$の単射性・全射性と同値である．
    また，双対写像$\varphi_f:\paren{\F_2^{\oplus B}}^\vee\to\paren{\F_2^{\oplus A}}^\vee$は上記の全単射により$f^*:P(B)\to P(A)$に対応する．
    よって主張は次の補題から従う．
\end{proof}
\begin{remarks}[欲しかった概念：入射的対象]
    双対写像に対応した！なんと美しい証明であるか．やはり$2$と$k$には何かしらの関連があったのだ．
    そして線型空間の理論には，$K$以外が要らないのか，もしかして．２つで一つと見做す双線型形式の見方と，テンソル積とで十分なのかもしれない．
\end{remarks}

\begin{lemma}
    $k$を体とする．$\varphi:V\to W$を$k$-線型空間の間の線型写像とし，$\varphi^*:W^\vee\to V^\vee$をその双対写像とする．
    この時，
    \begin{enumerate}
        \item $\varphi$が単射であることは，$\varphi^*$が全射であることと同値である．
        \item $\varphi$が全射であることは，$\varphi^*$が単射であることと同値である．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $0\to\Ker\varphi\to V\to W\to\Coker\varphi\to 0$は完全列である．
        \item $k$は$k$加群として入射的．即ち，関手$\Hom(-,k)$は完全となる．
        \item $0\to(\Coker\varphi)^\vee\to W^\vee\to V^\vee\to(\Ker\varphi)^\vee\to 0$は完全列である．
    \end{enumerate}
\end{proof}

\begin{proposition}[全射の双対写像]\label{prop-dual-of-epi}\mbox{}
    \begin{enumerate}
        \item $f$が全射の時，定理\ref{thm-epi}より，split epiだから，右逆射(section) $f^{-1}:Y\to X$が存在して，\[f\circ f^{-1}=\id_Y\Rightarrow (f^{-1})^*\circ f^*=\id^*_Y=\id_{P(Y)}.\]よって，$(f^{-1})^*$は$f^*$の左逆射(retraction)であるという意味で$(f^*)^{-1}$とも表し得る．
        \item $f$が全射の時，同じくsplit monoだから，あるいは命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}.3より，任意の部分集合$B\subset Y$について$f(f^{-1}(B))=\id_Y(B)=B=B\cap f(X)$．従って，$f_*\circ f^*=\id_{P(Y)}$である．
        \item 以上のことを象徴的に表せば，\[((f^*)^{-1}=(f^{-1})^*=)f^{*-1}=f_*.\]
    \end{enumerate}
\end{proposition}

\begin{proposition}[単射の双対写像]\label{prop-dual-of-mono}\mbox{}
    \begin{enumerate}
        \item $f$が単射の時，定理\ref{thm-mono}より，split monoだから，左逆射(retraction) $f^{-1}:Y\to X$が存在して，\[f^{-1}\circ f=\id_X\Rightarrow f^*\circ (f^{-1})^*=\id^*_X=\id_{P(X)}.\]よって，$(f^{-1})^*$は$f^*$の右逆射(section)であるという意味で$(f^*)^{-1}$とも表し得る．
        \item $f$が単射の時，同じくsplit monoだから，任意の部分集合$A\subset X$について$f^{-1}(f(A))=\id_X(A)=A$．従って，$f^*\circ f_*=\id_{P(X)}$である．
        \item 以上のことを象徴的に表せば，\[((f^*)^{-1}=(f^{-1})^*=)f^{*-1}=f_*.\]
    \end{enumerate}
\end{proposition}

\subsection{全射と単射}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=双対写像への全射と単射の持ち越し]
    前の節の逆像写像についての内容を一般化する．
    定理\ref{thm-mono},\ref{thm-epi}より，次のHom関手について，
    \begin{align*}
        fが単射(左簡約可能)&\Leftrightarrow f_*が単射(左簡約可能),&fが全射(右簡約可能)&\Leftrightarrow f^*が単射\\
        &\Leftrightarrow f^*が全射,&&\Leftrightarrow f_*が全射
    \end{align*}
    は，１行目がすぐに判り\footnote{\url{https://ncatlab.org/nlab/show/monomorphism}での特徴付け４つのうちの１つに含まれている}，２行目は双対原理から来る．
    $f^*$が$C$でmonic / epicであることと，$f^*$が$C^{op}$でepic / monicであることが同値なのである．$C^{op}$での$f^*$とは，postcomposition $f_*$に他ならない．
    よって，このことは単射／全射を，monic / epicに変えても一般の圏にて成り立つ．
    \[\xymatrix@R-2pc{
        f_*:\Map(Z,X)\ar[r]&\Map(Z,Y)&f^*:\Map(Y,Z)\ar[r]&\Map(X,Z)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        g\ar@{|->}[r]&f\circ g&g\ar@{|->}[r]&g\circ f
    }\]
\end{tcolorbox}

\begin{theorem}
    $f:X\to Y$を写像とする．$Z$を任意の集合として，$f^*:\Map(Y,Z)\to\Map(X,Z)$を反変Hom関手，$f_*:\Map(Z,X)\to\Map(Z,Y)$を共変Hom関手とする．
    \begin{enumerate}
        \item $f:X\to Y$が単射である$\quad\Leftrightarrow\quad f^*$が全射である．
        \item $f:X\to Y$が全射である$\quad\Leftrightarrow\quad f^*$が単射である．
        \item $f:X\to Y$が単射である$\quad\Leftrightarrow\quad f_*$が単射である．
        \item $f:X\to Y$が全射である$\quad\Leftrightarrow\quad f_*$が全射である．
    \end{enumerate}
\end{theorem}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item \begin{align*}
            fが単射&\quad\Leftrightarrow\quad fが左簡約可能&(定理\ref{thm-mono})\\
            &\quad\Leftrightarrow\quad f^*が右簡約可能&(後述)\\
            &\quad\Leftrightarrow\quad f^*が全射&(定理\ref{thm-epi})
        \end{align*}
        であるが，$\Rightarrow$は，$r\circ f=\id_X$を満たす$f$のretraction $r$に対して，$f^*\circ r^*=\id_{\Map(X,Z)}$を満たす$r^*:\Map(X,Z)\to\Map(Y,Z)$が見つかる．
        $\Leftarrow$は，$Z=X$とし，$f^*\circ r=\id_{P(X)}$を満たす$r:\Map(X,X)\to\Map(Y,X)$に対して，$r(\id_X)$が$f$のretractionとなる．実際，$f(r(\id_X))=\id_X$より，$r(\id_X)\circ f=\id_X$を得る．
        \item すでに述べた．
        \item すでに述べた．
        \item 
    \end{enumerate}
\end{proof}
\begin{remarks}
    おそらくこういうことであろう．しかし，epimorphismの定義は，任意の対象$Z$と平行な射の組$g_1,g_2:Y\to Z$について，$(g_1\circ f=g_2\circ f)\Rightarrow(g_1=g_2)$であり，これはhom-functor $\Hom(-,Z)$が単射であることの定義に他ならない．
    Sets上では単射とepimorphismが同値なので，上の定理が成り立つ．

\end{remarks}

\subsection{形式的双対性}

$2$の役割を入れ替えることによる双対が起こる．
de Morgan dualityが開集合の閉集合の双対を引き起こしていて，
第\ref{sec-duality-of-opens-and-closed}節の主眼である．
これと，反対圏が生み出す双対とどのような関係があるのだろうか？

\section{数の構成}

\begin{screen}
    自然数というデータ構造を余代数的に定める．
    その後差について整数，商について有理数，位相について実数，複素化の順に，2-組として拡張構造を入れていく．
    変位の概念，比の概念，近似の概念，空間の概念が追加されていく．
\end{screen}

\begin{definition}[three axioms of natural number]
    次を満たす集合$\mathbb{N}$を自然数と呼ぶ．
    \begin{enumerate}
        \item $0\in\mathbb{N}$．
        \item $\forall n(n\in\mathbb{N}\Rightarrow n\cup\{ n\}\in\mathbb{N})$．
        \item $\forall A((A\subset\mathbb{N}\wedge\varnothing\in A\wedge\forall n(n\in A\Rightarrow n\cup\{n\}\in A))\Rightarrow A=\mathbb{N})$．
    \end{enumerate}
\end{definition}
\begin{remark}
    条件3は帰納法の原理「1,2によって自然数とわかるもののみが自然数である」ことの論理式による表現である．
    従って，1,2を満たす最小の閉包を自然数とするのであるから，条件$P(n)$を1.2.の場合について示せば，
    自然数$\mathbb{N}$全体で成り立つことを得る．この自然数の定義上の約束を数学的帰納法と呼ぶ．

    また，$a_0\in X_0$と，$a_0\in X_0,\cdots,a_n\in X_n$がすでに定まっている際に$a_{n+1}\in X_{n+1}$を与えるルールを定めると，列$a=(a_n)\in\prod_{n\in\mathbb{N}}X_n$を定めたことになる．これを帰納的定義(recursive definition)という．
\end{remark}

\begin{proposition}[well-definedness of recursive definition]
    $(X_n)_{n\in\mathbb{N}}$を集合列とし，$c\in X_0$とする．
    \begin{enumerate}
        \item $(f_n)_{n\in\mathbb{N}}$を写像$f_n:X_0\times\cdots\times X_n\to X_{n+1}$の族とする．この時，列$(a_n)\in\prod_{n\in\mathbb{N}}X_n$であって，$a_0=c, a_{n+1}=f_n(a_0,\cdots,a_n)(n\in\mathbb{N})$を満たすものは，唯一つ存在する．
        \item (AC). $(F_n)_{n\in\mathbb{N}}$を写像$F_n:X_0\times\cdots\times X_n\to P(X_{n+1})\setminus\{\emptyset\}$の族とする．この時，列$(a_n)\in\prod_{n\in\mathbb{N}}X_n$であって，$a_0=c, a_{n+1}\in F_n(a_0,\cdots,a_n)(n\in\mathbb{N})$を満たすものが存在する．
    \end{enumerate}
\end{proposition}
\begin{proof}
    1. 族$(f_n)$が生成する元のなす階層を捉える族$(S_n)_{n\in\N}$を
    \[ S_n := \{(x_0,\cdots,x_n)\in X_0\times\cdots\times X_n\mid x_0=c,\;\forall m\in n,\; x_{m+1}=f_m(x_0,\cdots,x_m)\} \]
    と定めると，これはそれぞれ一元集合である：
    \[ \forall n\in\N,\; \exists s_n\in S_n,\;S_n=\{s_n\} \]
    ことを示す．$n=1$の時，$S_1=\{c\}$である．$s_n\in S_n$が存在して$S_n=\{s_n\}$ならば，$S_{n+1}=\{(s_n,f_n(s_n))\}$である．

    あとは，$s_n=(a_0,\cdots,a_n)\in S_n$を満たす列$(a_n=:\pr_n(s_n))_{n\in\N}$が一意的であることを示せば良い．
    実際，帰納的にこれが成り立つ．

    2. 選択公理により，任意の集合$X$について選択関数
    \[\xymatrix@R-2pc{
        g:P(X)\setminus\{\emptyset\}\ar[r]&X\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        A\ar@{|->}[r]&g(A)(\in A)
    }\]
    が存在する．さらに選択公理より，
    \[\xymatrix@R-2pc{
        \{X_n\}\ar[r]&\Map(P(X_n)\setminus\{\emptyset\},X_n)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        X_n\ar@{|->}[r]&g_n
    }\]
    を満たす族$(g_n)$が存在する．これを用いて$f_n=g_{n+1}\circ F_n$と置けば，$(f_n)$についての1.の状況に帰着する．
\end{proof}
\begin{remark}
    構成数学と非構成数学とで，使える道具の差ACを目の当たりにしている．
\end{remark}

\begin{definition}[algebraic / order structure of the natural numbers]
    $m\in\mathbb{N}$への加算と乗算を，それぞれ次のようにして，帰納的に定義する．
    \begin{align*}
        m+0=m, m+(n+1)&:=(m+n)+1,\\
        m\cdot 0=0, m\cdot (n+1)&:=(m\cdot n)+m
    \end{align*}
    順序関係を$m\le n:\Leftrightarrow m\subset n$と定める．
\end{definition}
\begin{remark}
    なお，$m\in n$は$m<n$を定める．これが自然数の特徴かもしれない．
\end{remark}

整数は，自然数の差演算についての閉包として構成できる．
\begin{definition}[Integers]
    $\mathbb{N}^2$上の同値関係$\sim$を，差が等しい関係$(n,m)\sim (n',m'):\Leftrightarrow n+m'=n'+m$として定義する．
    この時，$\mathbb{Z}:=\mathbb{N}^2/\sim$を整数全体の集合と呼ぶ．同値類$\overline{(n,m)}$を$n-m$で表すこととする．

    $Z:=\{(n,m)\in\mathbb{N}^n\mid n=0\lor m=0\}$は$\mathbb{Z}$の完全代表系である．単射$\mathbb{N}\to\mathbb{Z}:n\mapsto n-0$により，$\mathbb{N}$を$\mathbb{Z}$の部分集合と同一視し，$0-n=:-n$と表すこととする．
\end{definition}

\begin{definition}[algebraic/order structure of integers]
    \begin{align*}
        (n-m)+(n'-m')&:= (n+n')-(m+m')=\overline{(n+n',m+m')},\\
        (n-m)\cdot (n'-m')&:=(nn'+mm')-(mn'+nm')=\overline{(nn'+mm',mn'+nm')}
    \end{align*}
    として$\mathbb{N}^2/\sim$上の加法と乗法を定義し，順序関係は$n-m\le_\mathbb{Z} n'-m' :\Leftrightarrow n+m'\le_\mathbb{N} n'+m$で定める．
    また，$n\in\mathbb{N}$の時，$n,-n\in\mathbb{Z}$の絶対値を$|n|,|-n|=n$と定める．
\end{definition}

有理数は，整数の除算についての閉包として構成できる．
\begin{definition}[Rational numbers]
    $\{ (n,m)\in\mathbb{Z}^2\mid m>0 \}$上に同値関係$\sim$を，$(n,m)\sim (n',m'):\Leftrightarrow nm'=n'm$として定める（２数の比が同じ）．$\mathbb{Q}:=\{ (n,m)\in\mathbb{Z}^2\mid m>0 \}/\sim$を有理数全体の集合という．
    同値類を$\overline{(n,m)}=:\frac{n}{m}$と表す．$Q:=\{(n,m)\in\mathbb{Z}^2\mid m>0\land \gcd(n,m)=1\}$はこの完全代表系である．
    標準全射$p:\{ (n,m)\in\mathbb{Z}^2\mid m>0 \}\to\mathbb{Q}$の$Q$への制限の逆写像$p|_Q^{-1}:\mathbb{Q}\to Q$は，有理数に対して，その既約分数表現の分子と分母の組を対応させる写像である．単射$\mathbb{Z}\to\mathbb{Q}:n\mapsto\frac{n}{1}$により，$\mathbb{Z}$を，$\mathbb{Q}$の部分集合と同一視する．
\end{definition}

\begin{definition}[algebraic/order structure of the rational numbers]
    \begin{align*}
        \frac{n}{m} +_\mathbb{Q} \frac{n'}{m'} &:= \frac{nm'+_\mathbb{Z}mn'}{mm'},\\
        \frac{n}{m}\cdot_\mathbb{Q}\frac{n'}{m'} &:= \frac{nn'}{mm'}
    \end{align*}
    順序関係を$\frac{n}{m}\le\frac{n'}{m'}:\Leftrightarrow nm'\le n'm$で定め，絶対値は$\left| \frac{n}{m} \right|:\Leftrightarrow \frac{|n|}{m}$で定める．
\end{definition}

\subsection{形式的双対性について}

\chapter{実数と位相}

\begin{quotation}
    基本的に，Euclidの幾何学研究に端を発し，（解析）力学の発達から真に自律的に整備された，
    物理的発想を母体とした数学固有の空間として，Euclid空間$\R^n$がある．
    線型空間としての鋳型もここにある．
    ここから，連続性という素朴な物理空間に対する感覚は位相の概念として抽出され，最終的にEuclid空間は相対化された．
    この歴史的な自然から数学的な自然までの飛躍を一度辿ってしまうのが良い．

    初め，連続性は19世紀に$\epsilon$-$\delta$論法の形で距離空間上で明確に定義が得られた．
    従って，そこから議論を始める．
    The concept of continuity was first made precise in analysis, in terms of \textbf{epsilontic analysis on metric spaces}.\footnote{Epsilontic analysis is the now standard rigorous approach to analysis, developed by Bernard Bolzano, Augustin Cauchy, Karl Weierstraß, Richard Dedekind, and others in the mid-to-late 19th century.}
    Then it was realized that this has a more elegant formulation in terms of the more general concept of open sets.
    Adopting the latter as the definition leads to a more abstract concept of “continuous space”, this is the concept of topological spaces.\cite{nLab}
\end{quotation}

\section{実数の構成}

\begin{screen}
    Dedekindの切断は$\R\subset P(\Q)$としての構成が本質であるが，「有理数を用いて任意精度で近似できる数」という意味論としては$A\cup B=\Q$を満たす分割$A,B$の方がわかりやすい．
    $\Q$の元との比較により「上半分と下半分」に分割できるような数は，元の$\Q$よりもたくさんある．

    この構成には実数への直接的な言及は一切含まれておらず，ただ$\Q$上の順序構造を用いて間接的に言及するのみである．
    その心は，位相の言葉によって取り出されることになる，豊富な位相情報の源泉であるともいえるだろう．
    まず上限の概念が順序の言葉から定義され，これを用いて実数の連続性が理解される．
    実数列の収束の定義も上限と下限の言葉で構成され，$\epsilon$-$\delta$論法は特徴付けとして得られる．
\end{screen}

\subsection{Dedekindの構成}

\begin{definition}[Dedekind's cut; 1872]\mbox{}
    \begin{enumerate}
        \item $\mathbb{Q}$の部分集合$L$が次の３条件を満たすとき，$L$はデデキントの切断であるという．
        \begin{enumerate}[(1)]
            \item $\varnothing\subsetneq L\subsetneq\mathbb{Q}$．
            \item $x\in L \,\wedge\, y\le x \,\Rightarrow\, y\in L$．
            \item $x\in L \,\Rightarrow \exists y\in L \,\,\, x<y$．
        \end{enumerate}
        \item デデキントの切断$L$を実数と呼び，実数全体の集合を$\mathbb{R}:=\{ L\in P(\mathbb{Q})\mid Lは切断\}$と書く．
        \item 実数$L,M$について，順序関係を$L\le M :\Leftrightarrow L\subset M,\hspace{1em} L<M :\Leftrightarrow \subsetneq$と定める．
    \end{enumerate}
\end{definition}

\begin{proposition}\label{prop-order-of-the-real-numbers}　
    \begin{enumerate}
        \item $r\in\Q\Rightarrow L(r):=\{ x\in\Q\mid x<rはデデキント切断である\}$が成り立つ．
        \item 実数$L, L(r)\,(r\in\Q)$について，次の３条件は同値である．
        \begin{enumerate}[(1)]
            \item $r\in L$．
            \item $L(r)< L$．
            \item $L(r)\ngeq L$．
        \end{enumerate}
    \end{enumerate}
\end{proposition}
\begin{proof}
    1. 少なくとも$r-1\in L$であり，また$r\notin L$より，条件(1)を満たす．有理数体上の順序関係の推移性より，(2)も成り立つ．$x\in L$を勝手に取った時，$x<\frac{x+r}{2}<r$となる$\frac{x+r}{2}\in L(r)$が作れるから，(3)も成り立つ．

    2. $(1)\Rightarrow(2)$．$r\notin L(r)$より$L(r)\neq L$であるが，勝手に取った$x\in L(r)$について，$x<r$だから$r\in L$と併せて$x\in L$が従う．従って，$L(r)\subsetneq L$である．

    $(2)\Rightarrow(3)$．$L(r)\subsetneq L$とは$L\setminus L(r)\neq\varnothing$ということであるから，$L(r)\nsupseteq L$が従う．

    $(3)\Rightarrow(1)$．$L(r)\ngeq L$の時，$L\setminus L(r)\neq\varnothing$より，$x\in L\setminus L(r)$が取れる．$x\notin L \Leftrightarrow r<x$であるが，$x\in L$より，条件(2)から$r\in L$を得る．
\end{proof}
\begin{remark}
    $L$がDedekind's cutならば，$\exists r\in\mathbb{Q}\,\mathrm{s.t.}\, L=L(r)$とはならない点が，実数が有理数の拡張になっている点である．
    つまり，写像$\mathbb{Q}\ni r\mapsto L(r)\in\mathbb{R}$は単射である．系\ref{corollary-order-of-the-real-numbers}より，この写像は順序構造を保つから，この埋め込みによって$\mathbb{Q}$を$\mathbb{R}$の部分集合として同一視する．
\end{remark}

\begin{corollary}[実数体の順序]\label{corollary-order-of-the-real-numbers}　
    \begin{enumerate}
        \item $r,s\in\mathbb{Q}$について，$r<s$と$L(r)<L(s)$とは同値である．
        \item $L,M\in\mathbb{R}$について，$L\leq M, M\leq L$のいずれかが成り立つ．また，次が成り立つ．
        \[ \forall L,M\in\mathbb{R} \, L<M \Longrightarrow \exists s\in\mathbb{Q} (L<L(s)<M) \]
    \end{enumerate}
\end{corollary}
\begin{proof}
    1. 命題\ref{prop-order-of-the-real-numbers}より，各$L(r)<L(s)\Leftrightarrow r\in L(s)\Leftrightarrow r<s$．

    2. 命題\ref{prop-order-of-the-real-numbers}の$(2)\Leftrightarrow(3)$より，$L<M$または$L\ngeq M$である．従って，$L\le M$または$L\ge M$である．
    今，$L<M:\Leftrightarrow L\subsetneq M$とすると，勝手に取った$x\in M\setminus L$に対して，$x\in M$より$L(x)<M$が，$x\notin L$より$L(x)\nless L$即ち$L(x)\ge L$が，命題\ref{prop-order-of-the-real-numbers}より従い，$L\le L(x)<M$が成り立つ．
    今，$M$について条件(3)を用いて，$x<s$を満たす$s\in M$を取り直すことにより，再び命題\ref{prop-order-of-the-real-numbers}から，$L\le L(x)<L(s)<M$が成り立つ．
\end{proof}

\begin{definition}[実数の演算]\label{def-algebraic-structure-of-real-numbers}
    
    $L,M\in\R$とする．和を次のように定義する．
    \[ L+M = \{ x+y\in\Q\mid x\in L, y\in M \} \]
    $L$の加法逆元を，$L':=\{x\in\Q\mid \forall y\in L (x+y<0)\}$を用いて，次のように定義する．
    \[ -L :=\{x\in\Q\mid \exists y\in L'(x<y)\} \]
    これは確かに切断になっており，$L+(-L)=(-L)+L=L(0)$を満たす．また，$L\ge L(0)\Leftrightarrow -L\le L(0)$となる．

    積を次のように定義する．
    \[ L\cdot M=(-L)\cdot (-M) := \{ x\in\Q\mid \exists y\in L, z\in M \,\mathrm{s.t.}\, y>0, z>0, x<yz \} \]
    $(-L)\cdot M=L\cdot (-M)=:-(L\cdot M)$と定める．$L=L(0)$または$M=L(0)$である場合は，$LM=L(0)$と約束する．
\end{definition}
\begin{remark}
    $L,M$が有理数と同一視出来る場合について議論すると様子が掴みやすい．$s\in\Q$として$L=L(s)$である場合h，$L'=L(-s)\cup\{-s\}$である．これに対して，最大元を省いた集合を$-L$と定義している．

    この定義がうまくいくのは全てDedekind's cutの定義が絶妙なのである．$L+M=L(r)+L(s)$と表される場合は退化していて分かりにくいが，$L,M=L(s)$となる$s\in\Q$が見つからない場合でもこの定義は整合的にできている．
    つまりは，$L=L(x)(x\in\R)$を，実数を一切登場させることなく，順序関係$<$のことばだけで指定可能であるということを言っている．これに成功している時点で，数や距離以外の情報／ことばの体系が実数には含まれていることが予感される．
    これらのことばの自然言語への翻訳の一部が，「上界」「上限」として用意されている．
\end{remark}
\begin{proposition}[実数体]
    定義\ref{def-algebraic-structure-of-real-numbers}による実数の演算について，$\Q$に引き続き体となっている．
\end{proposition}

\subsection{実数の連続性}

\begin{proposition}[上限の特徴付け]
    $\varnothing\ne A\subset\R$とする．実数$S\in\R$に対して，次の３つの条件は同値である．
    \begin{enumerate}
        \item $S$は$A$の上限である．$S=\min\{ x\in\R\mid \forall a\in A\,a\le x \}$．
        \item $\forall L\in A \;(L\le S)$かつ$\forall T<S \; \exists L\in A\; (T<L)$．
    \end{enumerate}
\end{proposition}
\begin{proof}
    上界$S$が上限であるとは，$S$が上界のうち最小のものであるということである．即ち，$T<S$を満たす全ての$T\in\R$は上界ではない，つまり，$\exists L\in A,\; (T<L)$．
\end{proof}

\begin{theorem}[実数の連続性]\label{thm-Weierstrass's-supremum-axiom}
    $A\subset\R$とする．$A\ne\varnothing$かつ上に有界ならば，$A$の上限が存在する．
\end{theorem}
\begin{proof}
    $S:=\bigcup_{L\in A}L\subset\mathbb{Q}$と構成すれば，これは確かに切断となっており，$A$の上限に他ならないことを示す．

    (1) 仮定$A\ne\varnothing$より，切断$L\in A$が存在するから，$\varnothing\subsetneq L\subset S$．また$A$は上に有界だから，切断$M\in\mathbb{R}$が存在して$A\subset M\subsetneq\mathbb{Q}$．
    
    (2),(3) $x\in S$を任意に取ると，或る切断$L\in A$が存在して$x\in L$である．従って，$\forall y<x\; y\in L$かつ$\exists z>x z\in L$である．よって，$\forall y<x\; y\in S$かつ$\exists z>x z\in S$であり，確かに$S$も切断．

    $S$が求める上限であることを示す．$\forall a\in A\; a\le S$は，$S$の定義上任意の$a\in A$について$a\subset S$であることから従う．
    また，既に示した$A\subset M\subsetneq\mathbb{Q}$より，$S$は上界のうち最小のものであることが分かる．
\end{proof}
\begin{remark}
    なんだよ，上限の特徴付けの方を使うわけではないのか，と思ったが，その試みの中で，切断において$L(x)\subsetneq \cup A$と，$L(x)\in A$は同値だと気付いた．これは自然数の定義と，切片の議論と，似ている．
\end{remark}

\begin{notation}
    以降$[-\infty,\infty]:=\mathbb{R}\coprod\{-\infty,\infty\}\;(-\infty\ne\infty)$という記法を用いると，この範囲で実数の部分集合は必ず上限を持つ．
    ただし，$A\subset [-\infty,\infty]$について，$\sup A=-\infty \; (A\subset \{-\infty\}の時)$とする．
    写像$f:X\to\mathbb{R}\coprod\{-\infty,\infty\}\;(-\infty\ne\infty)$についても同様に定める．
    $\sup f(X)=:\sup_{x\in X}f(x)$とも書く，あるいは同値な条件を下に添えて書く．
\end{notation}

\begin{definition}[実数列の収束]
    $(x_n)\in{}^{<\omega}\mathbb{R},a\in\mathbb{R}$とする．\textbf{数列$(x_n)$が$a$に収束する}とは，次が成り立つことである．
    \[ \inf_{m\ge 0}\left(\sup_{n\ge m}|x_n-a|\right)=0 \]
    この関係を$\lim_{n\to\infty}x_n=a$と書き，$a$を極限という．

    数列$(x_n)$が有界であるという時には，その値域が上に有界であることを言う．
\end{definition}
\begin{remark}
    $\sup_{n\ge m}|x_n-a|$とは，$m$番目以降の項の，$a$からの距離の振れ幅の範囲が，この中に収まることを意味する．数列が収束するとは，$m$を十分大きく取ることで，その範囲をいくらでも小さくする／$0$に近づけることが出来ることを意味する．

    この定義なら，絶対値の構造を備える距離空間一般について拡張できそうである．
\end{remark}

\begin{proposition}[実数上の$\epsilon-\delta$論法]$(x_n)$を十数列とする．
    \begin{enumerate}
        \item 次の２条件は同値である．
        \begin{enumerate}[(1)]
            \item $\lim_{n\to\infty}x_n=a$．
            \item $\forall r\in\R_{>0}\; \exists m\in\N \; \forall n\in\N_{n\ge m} \; |x_n-a|<r$．
        \end{enumerate}
        \item 収束する数列$(x_n)$は有界である．
        \item  $(x_n)$は有界かつ単調増加であるとする．$s=\sup_{x\ge n}x_n$とすれば，$\lim_{n\to\infty}x_n=s$である．
    \end{enumerate}
\end{proposition}
\begin{remark}
    2.の逆はそのままでは成り立たないが，Bolzano-Weierstrassの定理が成り立つ．

    3.は実数の連続性の特徴付けとなる．
\end{remark}

実数は次のように表示できる．
\begin{definition}[$m$-adic decimal expression]
    $m\ge 2$を自然数とする．$a_n\in m$を満たす自然数列$(a_n)_{n\in\N}$を用いて，
    \[ s_n:=\sum^n_{l=0}\frac{a_l}{m^l} \]
    と定めた実数列$(s_n)_{s\in\N}$の極限$\sum^\infty_{n=0}\frac{a_n}{m^n}$を\textbf{$m$-進小数展開}という．
    任意の実数$r$は$m$についてこの表現を持つ．
\end{definition}

\section{Euclid空間上の開集合}

\begin{screen}
    以降$n\in\mathbb{N}$として，$n$次元Euclid空間$\R^n$の位相を考えるための言葉を整備する．
    これは実数から積の言葉のみで構成できる対象であるが，付加構造を考えるだけですでに非常に豊富な構造を持ち，古典物理学を展開する母体となる．

    Euclid空間$E^n$とは，現代的な言葉で言えば，数ベクトル空間$\R^n$であって標準内積$\langle -,-\rangle$を備え，これを用いたベクトルのノルム$\|x\|=\sqrt{\langle x,x\rangle}$を
    備える，Euclid幾何学の代表的なモデル$(\R^n,d_{\mathrm{Eucl}})$である．
    この素朴で人間的な距離の概念から，最初の位相の言葉を定義し，
    そのうち位相の概念の一般化の足掛かりとなるような性質をみる．
    距離空間は位相空間の例であることを見る．

    特に，実数の構成にて実数の連続性が順序の言葉のみから定まる（順序完備）ように，点列の収束も順序の言葉のみで言及できる．
    その距離の言葉による特徴付けを$\epsilon$-$\delta$論法といい，位相の言葉による特徴付けもある．
\end{screen}

\subsection{距離空間：Euclid space}

\begin{definition}[Euclidean norm; 300BC]
    $x=(x_1,\cdots,x_n),y=(y_1,\cdots,y_n)\in\R^n$に対し，$\langle x,y\rangle =x_1y_1+\cdots +x_ny_n\in\R$と定めた内積を，\textbf{標準内積}といい，$\|x\|:=\sqrt{\langle x,x\rangle}$を\textbf{$x$の長さ}という．
\end{definition}
\begin{definition}[distance function]
    $x=(x_1,\cdots,x_n),y=(y_1,\cdots,y_n)\in\R^n$に対し，
    \[ d(x,y)=\sqrt{(x_1-y_1)^2+\cdots +(x_n-y_n)^2} \]
    を，２点$x,y$間の距離という．この，２点の距離をベクトル$x-y$の長さ$d(x,y)=\|x-y\|$によって定めた距離を備えた系$(\R^n,d)$をEuclid空間という．
\end{definition}

\begin{proposition}[距離の公理]$x,y,z\in\R^n$に対して，次の３つが成り立つ．
    \begin{enumerate}
        \item (non-negativity，identity of indicernibles) $d(x,y)\ge 0$で，等号成立条件は$x=y$である．
        \item (symmetricity) $d(x,y)=d(y,x)$．
        \item (subadditivity) $d(x,z)\le d(x,y)+d(y,z)$．
    \end{enumerate}
\end{proposition}

\subsection{開集合と閉集合とその特徴づけ}

\begin{screen}
    Euclid空間は距離を持ち，直観的に開集合と閉集合を定義できる（開球の和で表せる集合）．
    しかし，一般の位相空間の場合は，これらの性質として得られる「和と積に対する閉性」の方を公理に据える．
\end{screen}

距離空間$E$上での開区間の定義を$n$次元に拡張すると，球という概念が表面化する．
「端点」と呼べる部分が２つに退化していたものが，一気に無限個になる．
\begin{definition}[開集合]\mbox{}
    \begin{enumerate}
        \item $a\in\R^n, r\in\R_{>0}$とする．
        \[U_r(a)=\{ x\in\R^n \mid d(a,x)<r \}\]
        を\textbf{開球}という．
        \item $U\subset\mathbb{R}^n$が\textbf{$\mathbb{R}^n$-開集合}であるとは，次の論理式を満たすことである．
        \[\forall p\in U,\; \exists r >0,\, U_r (p)\subset U\]
        \item $A\subset\mathbb{R}^n$の補集合$\mathbb{R}^n\setminus A$が$\mathbb{R}^n$-開集合である時，$A$は\textbf{$\mathbb{R}^n$-閉集合}であるという．集合$\{d(x,y)\in\mathbb{R}\mid x,y\in A\}$が有界である時，$A$は有界であるという．
    \end{enumerate}
\end{definition}

\begin{example}\mbox{}
    \begin{enumerate}
        \item $\varnothing,\mathbb{R}^n$はいずれも，開集合かつ閉集合である．前者は自明な形で，後者は普通に開集合の定義を満たし，２つは互いに補集合であるからである．この共役な２つ以外に開かつ閉な集合が存在しないことで，位相空間が連結であることがわかる（命題\ref{prop-connected-component}）．
        \item $a\in\mathbb{R}^n$とする．$\mathbb{R}^n\setminus \{a\}(n=0,1,2,\cdots)$は開集合なので，$\{a\}$は閉集合である．また，$n>0$の時，$a$を中心とした$\{a\}$に含まれる開球は存在しないので，$\{a\}$は開集合でない．$n=0$の時は，$\mathbb{R}^0=\{id_0\}\simeq 1$となり，全ての部分集合が開集合でもあり，閉集合でもある．
        \item $m<n$とし，$\mathbb{R}^m$を$\mathbb{R}^n$の部分集合$\{(x_1,\cdots,x_m,0,\cdots,0)\mid (x_1,\cdots,x_m)\in\mathbb{R}^m\}$と同一視すると，$\mathbb{R}^n\setminus\mathbb{R}^m$はあいも変わらず開集合より$\mathbb{R}^m$は$\mathbb{R}^n$-閉集合であるが，$\mathbb{R}^m$は，全く行けない次元が$n-m$次元あるので，$\mathbb{R}^n$上の開球を中に含めることは出来ず，開集合ではない．
    \end{enumerate}
\end{example}

\begin{proposition}[Euclid空間の連結性]
    $\varnothing,\mathbb{R}^n$以外に，$\mathbb{R}^n$の部分集合であって，開集合でも閉集合でもあるものは存在しない．
\end{proposition}
\begin{proof}
    命題\ref{prop-connected-component}より，$\mathbb{R}^n$が連結であることを示す．
\end{proof}

\begin{proposition}[開集合の特徴付け１]
    $U\subset\mathbb{R}^n$とする．次の２条件は同値である．
    \begin{enumerate}
        \item $U$は開集合である．
        \item $U$は開球の族の和集合である．
    \end{enumerate}
\end{proposition}
\begin{proof}
    1$\to$2を示す．$U$は開集合だから，全ての点$p$について，対応する開球$B_{\delta_p}(p)$が存在し，$B_{\delta_p}(p)\subset U$を満たす．
    従って，$U':=\bigcup_{p\in U}B_{\delta_p}(p)$とすれば，即座に$U'\subset U$である．また，$p\in U$に対して$p\in B_{\delta_p}(p)\subset U$だったのだから，$p\in U'$であるため，$U'\supset U$でもある．従って，$U=U'=\bigcup_{p\in U}B_{\delta_p}(p)$を得る．

    2$\to$1を示す．開集合の族$U:=\bigcup_{\lambda\in\Lambda}B_\lambda$を考える．勝手に取った点$p\in U$に対して，対応する$\lambda\in\Lambda$と開球$B_\lambda$が存在して，$p\in B_\lambda$を満たす．仮に$B_\lambda=B_{\delta}(q)$だったとすると，$r=\delta -\|p-q\|$として，$B_{r}(p)$は，$B_{r}(p)\subset B_\lambda\subset U$を満たす．
    こうして各点$p$に対して，それを中心として$U$に含まれる開球が存在するから，この$U:=\bigcup_{\lambda\in\Lambda}B_\lambda$は開集合である．
\end{proof}

主にこちらが，一般の集合についても位相の言葉を考えるにあたって，基点となる．
\begin{proposition}[開集合の性質]\mbox{}\label{prop-properties-of-open-set-in-metric-spaces}
    \begin{enumerate}
        \item $(U_i)_{i\in I}$が$\mathbb{R}^n$-開集合の族であるならば，合併$\bigcup_{i\in I}U_i$も$\mathbb{R}^n$-開集合である．
        \item $(U_i)_{i\in I}$が$\mathbb{R}^n$-開集合の\textcolor{red}{有限}族であるならば，共通部分$\bigcap_{i\in I}U_i$も$\mathbb{R}^n$-開集合である．
    \end{enumerate}
\end{proposition}
\begin{remark}
    $A$を一般に$\mathbb{R}^n$の部分集合とすると，無限集合族を用いて$\bigcap_{x\in\mathbb{R}^n\setminus A}\mathbb{R}^n\setminus\{x\}$として$A$が表現出来てしまう．すごい怖い．
\end{remark}

\subsection{点列の収束の特徴付け}

\begin{definition}[点列の収束]
    $(x_m)\in{}^{<\omega}\mathbb{R}^n,a\in\mathbb{R}^n$とする．\textbf{点列$(x_m)$が$a$に収束する}とは，次が成り立つことである．
    \[ \lim_{m\to\infty}d(x_m,a)=0 \]
    この関係を$\lim_{m\to\infty}x_m=a$と書き，$a$を極限という．

    点列$(x_m)$が有界であるという時には，その値域が$\mathbb{R}^n$の有界な部分集合であることを言う．
\end{definition}
\begin{remark}
    ２点の間の距離という実数値関数を利用して，実数列の収束から点列の収束を定めた．
\end{remark}

\begin{proposition}[点列の収束の位相的特徴付け]\label{prop-characterization-of-convergence-in-metric-spaces}
    $(x_m)\in{}^{<\omega}\mathbb{R}^n, a\in\mathbb{R}^n$とする．次の３条件は同値である．
    \begin{enumerate}
        \item $\lim_{m\to\infty}x_m=a$．
        \item $\forall r\in\mathbb{R}_{>0}\;\exists l\in\mathbb{N}\;\forall m\in\mathbb{N}_{\ge n}\; d(x_m,a)<r$．
        \item $a$を元として含む任意の開集合$U\subset\mathbb{R}^n$について，$\{m\in\mathbb{N}\mid x_m\notin U\}$は有限集合である．
    \end{enumerate}
    条件3.を「十分大きな$n$について$x_m\in U (m\ge n)$である，ということがある．
\end{proposition}
\begin{remark}
    点列が収束することを開集合のことば
    によって純粋に表現することに成功したわけであるが，閉集合のことばだとどうなるのであろうか？
\end{remark}

\section{連続写像}

\begin{screen}
    Euclid空間$E^n$上では極限の概念が，順序の言葉を用いて$\inf\sup$として定まる．
    するとそこから連続写像の概念が定義できる．
    位相空間の射である連続写像の同値な定義は，
    順序の言葉，$\epsilon$-$\delta$論法，開集合の言葉，点列の言葉の４つ存在する．

    しかし，開集合の言葉で特徴付けをもち，位相空間論ではこちらを定義とする．

    主要な写像$+,\cdot,{}^{-1}$が連続であることが，連続性の遺伝の正体である．
    連続関数の主要な構成が連続である理由である．

    これを利用すると，開集合も自由に構成できる．射が大事か，対象が大事か．
    対象のような原子論的対象は数学の発展において，認知科学的に重要な役割を果たした．
    \begin{quotation}
        集合を考えるもっと本質的な理由は，$\R^n$の部分集合だけでなく，$\R^n$からはみ出した空間を，
        目的に応じて設定できることにある．このような構成は，多価解析関数の自然な定義域として考えられたリーマン面を起源とし，
        現代の幾何学の舞台である多様体の定義に端的に見られるものである．
        解析学では空間のなす無限次元空間や，代数学ではイデアルによる商環の構成なども重要である．
        これらは，20世紀における，数学の抽象的な方向への発展の基盤となった．
    \end{quotation}
\end{screen}

\begin{definition}
    開集合$U\subset \R^n$について，
    \begin{enumerate}
        \item $f:U\setminus\{a\}\to\R^m$を写像とする．$b=\lim_{x\to a}f(x)$とは，次のことをいう：
        \[ \inf_{r>0}\left(\sup_{x\in U,\\0<d(x,a)<r}d(f(x),b)\right)=0. \]
        \item 写像$f:U\to\R^m$が$a\in U$で\textbf{連続}であるとは，$f(a)=\lim_{x\to a}f(x)$であることをいう．
        \item $f:U\to\R^m$が\textbf{連続写像}であるとは，全ての$x\in U$において$f$が連続であることをいう．
    \end{enumerate}
\end{definition}
\begin{remark}
    $\inf\sup$が$\limsup$のようにwell-definedな概念であることが誠に興味深い．
    まず，$f:U\setminus\{a\}\to\R^m$と正の実数$r>0$に対して，$r$近傍での「$b\in\R^m$との値のズレの振幅」：
    \[ \{d(f(x),b)\in [0,\infty)\mid x\in U,0<d(x,a)<r\}=\{d(y,b)\mid y\in f((U_r(a)\cap U)\setminus\{a\})\} \]
    が定まり，これには$[0,\infty)$の範囲で上限$S(r)=\sup_{x\in U,0<d(x,a)<r}d(f(x),b)$が見つかる．
    すると，$0<r$を自由に動かした時のこの上限$S(r)$の下限$\inf_{r>0}S(r)\in[0,\infty]$が，$r\to\infty$時の極限値が$b\in\R^m$にどれくらい近くかを指し示す．
    これが$\inf_{r>0}S(r)=0$になる時，$f(x)\xrightarrow{x\to a}b$と定義すれば良い．

    全称命題を用いることで，巧妙に無限への直接的な言及を回避している．
\end{remark}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item 加法$+:\R^2\to\R$と乗法$\cdot:\R^2\to\R$と逆元${}^{-1}:\R\setminus\{0\}\to\R$は連続である．
        \item 射影$\pr_i:\R^m\to\R\;(i\in[m])$は連続である．次の２条件は同値である．
        \begin{enumerate}[(1)]
            \item 写像$f:U\to\R^m$は$a$で連続である．
            \item $f_i:=\pr_i\circ f:U\to\R\;(i\in[m])$はそれぞれ$a$で連続である．
        \end{enumerate}
    \end{enumerate}
\end{proposition}

\begin{proposition}[連続写像の特徴付け]\label{prop-characterization-of-continuous-map-in-metric-spaces}
    $f:U\to\R^m$を開集合上の写像とする．
    \begin{enumerate}
        \item $a\in U$に対し，次の３条件は同値である．
        \begin{enumerate}[(1)]
            \item 写像$f:U\to\R^m$は$a$で連続である．
            \item $\forall q>0,\;\exists r>0,\; \forall x\in U,\; d(x,a)<r\Rightarrow d(f(x),d(a))<q$．
            \item $f(a)\in V$を満たす任意の開集合$V\subset\R^m$に対し，$a\in W\subset f^{-1}(V)$を満たす開集合$W\subset\R^n$が存在する．
        \end{enumerate}
        \item  次の２条件は同値である．
        \begin{enumerate}[(1)]
            \item $f:U\to\R^m$は連続である．
            \item 任意の開集合$V\subset\R^m$について，逆像$f^{-1}(V)\subset U$は$\R^n$の開集合である．
        \end{enumerate}
    \end{enumerate}
\end{proposition}
\begin{remark}
    連続写像$f:U\to\R$を考えれば，$U\subset\R^n$の部分集合
    $\{x\in U\mid f(x)>a\}$は$\R^n$-開集合だとわかる．
    また，$\{a\}\subset\R^m$は閉集合だから，連続写像$f:\R^m\to\R^n$を考えれば，
    $\{x\in\R^n\mid f(x)=a\}$も$\R^n$-閉集合である．
\end{remark}

\begin{corollary}
    $U\subset\R^n,V\subset\R^m$を開集合とし，$f:U\to\R^m,g:V\to\R^l$をその上の連続写像とする．
    $f(U)\subset V$を満たす時，合成写像$g\circ f:U\to\R^l$も連続である．
\end{corollary}
\begin{proof}
    開集合$W\subset\R^l$を任意に取る．
    すると，$g^{-1}(W)\subset V$も開集合だから，$(g\circ f)^{-1}(W)\subset U$も開集合である．
\end{proof}

\begin{example}[連続写像の構成：連続関数の有理式は連続である]
    $f+g:=+\circ(f,g), f\cdot g:=\cdot\circ(f,g)$
    を，写像の和と積と呼ぶ．従って，$f,g$が連続である時，これらも連続である．
    これを帰納法により一般化すると，$m$変数の多項式$F\in\R[X_1,\cdots,X_m]$について，合成関数$F(f_1,\cdots,f_m):U\to\R$も連続関数である．
    $0\notin g(U)$を満たす$g$について，$f/g:U\to\R$も連続である．
\end{example}
\begin{example}
    線型写像は連続写像である．
\end{example}

\begin{example}[Euclid空間の閉集合]\mbox{}
    \begin{enumerate}
        \item $n$次元閉円板／閉球$D^n=\{x\in\R^n\mid\|x\|\le 1\}$．
        \item $n-1$次元球面$S^{n-1}=\{x\in\R^n\mid\|x\|=1\}$．
    \end{enumerate}
    いずれも連続関数
    \[\xymatrix@R-2pc{
        \R^n\ar[r]&\R\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        {\begin{pmatrix}x_1\\\vdots\\x_n\end{pmatrix}}\ar@{|->}[r]&x_1^2+\cdots+x_n^2
    }\]
    の逆像$f^{-1}([0,1])$と$f^{-1}(1)$として理解できる．
\end{example}

\begin{proposition}[連続写像の特徴付け]
    $\R^n$-開集合上の写像$f:U\to\R^m$と$a\in U$に対し，次の２条件は同値．
    \begin{enumerate}
        \item $f:U\to\R^m$は$a$で連続である．
        \item $U$の点列$(x_k)$が$a$に収束するならば，$\R^m$の点列$(f(x_k))$は$f(a)$に収束する．
    \end{enumerate}
\end{proposition}

\section{行列の集合}

\begin{definition}[matrix]
    $\R$上の族$(x_{ij})_{(i,j)\in[m]\times[n]}$を$m\times n$行列という．
    これがなす空間を$M(m,n;\R):=\Map([m]\times[n],\R)$と表す．
    これをベクトルの空間$\R^{mn}$と同一視すると，行列の集合上に位相の概念がEuclid空間から遺伝する形で定義できる．
    このベクトルの空間の標準内積は，行列の記法で$\Tr({}^t\!XY)$と表せる．
\end{definition}

\begin{example}[GL,SL]
    行列の積は行列の成分の多項式で定義されるから，連続写像である．同様に行列式$\det:M(n,\R)\to\R$は連続写像である．
    従って，\textbf{一般線型群}
    \[ \GL(n,\R):=\{A\in M(n,\R)\mid\det A\ne 0\} \]
    は$M(n,\R)$-開集合であり，\textbf{特殊線型群}
    \[ \SL(n,\R):=\{A\in M(n,\R)\mid\det A=1\} \]
    は$M(n,\R)$-閉集合である．
\end{example}

\begin{example}
    行列$A$の余因子行列を$\Delta(A)$とすると，これは$A$の成分の多項式であるから，写像
    \[\xymatrix@R-2pc{
        {}^{-1}:\GL(n,\R)\ar[r]&M(n,\R)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        A\ar@{|->}[r]&(\det A)^{-1}\Delta(A)
    }\]
    は連続である．また転置${}^t:M(n,\R)\to M(n,\R)$も連続である．
    従って，直交群
    \[ O(n,\R):=\{A\in\GL(n,\R)\mid A{}^t\!A=1\} \]
    は$M(n,\R)$-閉集合，特殊直交群
    \[SO(n,\R):=O(n,\R)\cap\SL(n,\R)\]
    も$M(n,\R)$-閉集合である．
\end{example}

\begin{example}
    $M(m,n;\C)\simeq\C^{mn}$での標準内積は$\Tr({}^t\!X\overline{Y})$と表せる．
    一般線型群は$M(n,\C)$-開集合，特殊線型群は$M(n,\C)$-閉集合である．
    ユニタリ群
    \[ U(n):=\{A\in\GL(n,\C)\mid A^*A=1\} \]
    も，特殊ユニタリ群
    \[ SU(n):=U(n)\cap\SL(n,\C) \]
    も$M(n,\C)$-閉集合である．
\end{example}

\chapter{位相}

\begin{quotation}
    Topologyとは，全ての「空間」が持っている「型」と，それが定める射についての研究のことである．
    近傍という概念は，距離に依らずともそれ自体が論理的構造を持っている．それを数理的に抽出した型が位相である．これには論理など，たくさんの自然が映り込んでいる．特に「十分近ければ」という形の論理，即ちε-δ論法と呼ばれるような論理を内包する．これは無限を有限の中で捉える技術で，余有限位相の言葉に整備される．
    The idea of topology is to study “spaces” with “continuous functions” between them.\cite{nLab}
    現在ではより一般化された代数的対象であるロケールを研究の対象としている．

    位相空間論には，近傍と開集合系との双璧がある．第一義的には，点を抽象化するか否かである．
    「この性質が近傍で成り立つ」という発言が成り立つのは位相構造が定義されているからである．
    連続の概念だってそうである．近傍を近傍に写すことを連続という．
    近傍の概念には自然な構造がある，近傍を含む集合は近傍であり，２つの近傍の共通部分は近傍であるはずである．
    これを全称量化して，点ではなく部分集合について言及するようにすると開集合の概念を得る．
    数学原論では後者が採用された．

    Point-set topologyとは，距離空間(metric space)が19世紀を通じて数理科学の母胎であったが，そこから初めての遊離を試みた理論である．
    ここでは射である「連続写像」に$\epsilon$-$\delta$論法による翻訳があり，元はそこから連続の概念が始まったのだが，これは距離の言葉に依らずとも定まる定性的性質であることを発見した．積分と集合論と極限（体積確定）の関係のようである．
    これは，現代ではTopが距離空間の圏よりも遥かに柔軟な性質を持つこととして捉えられている， for example it admits the construction of arbitrary quotients and intersections of spaces.
    従って当然の帰結として，この圏Topや位相の言葉は，数学のあらゆる分野に特に普遍的に現れる型となった，線型代数と同じである．
    連続写像の連続変形を考える2-圏的な分野はHomotopy theoryと呼ばれている．

    こうして，現代的な数学の舞台「局所的には距離空間に思える舞台」である多様体が生まれた．
    場の量子論に向けて更なる調整が行われている．

    frameの言葉によって突如始まる代数的議論が極めて気持ち良い．この世は全て代数なのか？
\end{quotation}

\section{位相空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    \begin{quote}
        集合とは点の集まりだから，そこには全体か各点かしかなく，バラバラのものである．そこに，開集合系という，中間的なものを指定することで，集合を幾何的に考えることが出来るようになる．
    \end{quote}
    この集合論的な扱いが以下に展開されるpoint-set topologyである．この時には，距離空間では位相の性質であった命題\ref{prop-properties-of-open-set-in-metric-spaces}を，むしろ公理として据えることが，幾何的扱いの本質だと考えられる．
    従って，微積分学の基礎的な概念は全て位相の言葉による翻訳を持つ．
    関数の連続性は命題\ref{prop-characterization-of-continuous-map-in-metric-spaces}，点列の収束は命題\ref{prop-characterization-of-convergence-in-metric-spaces}など．
    積分だってそうである．
    従って確かに，空間概念のalternativeになるだけの力を持つ定義が位相空間である．Bourbaki以前は第３節で扱うような，閉包や近傍による定義が採用されていた．
    \begin{quote}
        開集合系による定義が主流となった理由には，局所的な考察や層の定義に適していることなどが考えられる．
    \end{quote}

    point-set topologyの展開は集合論と全く同様に，公理的方法を取る．
    \begin{quote}
        位相空間の定義も，公理的な定義である．公理的方法を取ることで，議論の不要な反復を避け，論理を明確にすることができる．
        しかし，公理的方法の真の効用はそのような消極的なものではなく，見かけ上かけ離れた対象を比較できるようにし，その共通点や相違点を明らかにすることにある．
    \end{quote}
    位相の言葉の扱い方は数通りある（注\ref{remark-perspective-on-topology}）．
    以下の見方を代表して，開集合系（のなす順序集合，あるいは圏または景）を$\Op(X)$と表し，frameと呼んでしまう．
    タグをつけることによって相対化するのが圏論のやり方だとみた．
    \begin{enumerate}
        \item 代数系latticeとして：無限項演算$\bigvee$を備えた束のクラス「開集合束」に見える．（これを，$\O$を集合とした時，このような束を\textbf{suplattice}と定義する）．実際完備Heyting代数となる（従って分配的）．環と近い代数的見方．
        \item 集合の集合として：「集合系$U\in\O\subset P(X)$」と言った時の意味．
        \item 圏として：poset categoryに見える．開集合系は包含写像を射として，それ自身圏Opである（定義\ref{def-category-of-open-sets}）．これは層の理論に応用がある．
        \item filterとして：ブール代数の上で考えたり，冪集合の上で考えたりする，「特別会員」「蓋」「漏斗」．どこに足がつくかで空間の形が決まる．近傍系や基本系と言った時はこの構造を意識する．
    \end{enumerate}
\end{tcolorbox}

\subsection{位相空間の定義とその特徴付け：開集合の圏Op}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    公理が代数的構造をうまく掴んでいるので，特徴付け（「開近傍」概念への注目）が秀逸である．
    開集合の合併が開であることは，全称量化することで点の言葉を用いて，
    「任意の点について，より小さい開近傍が取れる」「$U$の部分集合の中から開近傍が取れる」ことに同値．（距離空間では開近傍として開球を取っても同値）．
    開集合の有限の交叉が開であることは，特に任意の２つの交叉について開であることに同値．
\end{tcolorbox}

\begin{definition}[topology, topological space]\label{def-axioms-of-open-subsets}
    $X$を集合とする．$X$の部分集合からなる集合$\O\subset P(X)$\footnote{script Oと読む}が次の条件1,2を満たす時，これを$X$の\textbf{位相}といい，組$(X,\O)$を\textbf{位相空間}という：
    \begin{enumerate}
        \item $(U_i)_{i\in I}$が$\O$の元の族ならば，$\cup_{i\in I}U_i\in\O$．
        \item $(U_i)_{i\in I}$が$\O$の元の\textbf{有限}族ならば，$\cap_{i\in I}U_i\in\O$．
    \end{enumerate}
\end{definition}
\begin{remark}
    こちらの定義を採用したことにより，
    従来の代数的な定義よりも普遍性が上がった．
    特に組み合わせ論的な性質が，形式論理との関係を浮かび上がらせる．
    \footnote{開集合の簡明な定義（\ref{def-axioms-of-open-subsets}）と
    連続性の簡明な実装（定義\ref{def-continuous-function}）は，
    位相空間論をさらに普遍的な枠組みとした(\textbf{it gives the field of topology its fundamental and universal flavor})．
    また，この定義の組み合わせ論的な本質が形式論理との関連の深さを浮かび上がらせた(\textbf{The combinatorial nature of these definitions makes topology be closely related to formal logic})．
    このことは第\ref{sec-sober-spaces}節で議論される“sober topological space”の概念でより明白になる．
    このものの見方はlocalesに到達する（注\ref{remark-locales}）．この見方については(Vickers 89 \cite{Vickers})参照．\cite{nLab}}
    位相空間にさらに公理を加えることで，適宜，特殊な束（例えばブール代数など）と位相空間とに対応（関手）が取れる（第\ref{sec-Stone-duality}節）．この双対性を乗り移ることで，point-lessに位相空間論を展開できる\footnote{the study of topology where open-set lattices are taken as the primitive notion. \cite{Johnstone}}\footnote{枠と束は違う概念である．\href{https://ja.wikipedia.org/wiki/ストーン双対性}{ストーン双対性}によると，枠は完備Heyting代数のことを指す．特に，集合論的でないのが枠で，$(X,\O)$を一般化したものがそれぞれlocaleとframeとなる．}．
\end{remark}

\begin{definition}[open set, open-set lattice / frame of opens]
    位相空間$(X,\O)$について，
    \begin{enumerate}
        \item $U\subset X$が\textbf{$\O$の定める位相に関して$X$の開集合}であるとは，$U\in\O$であることをいう．$\O$を$X$の\textbf{開集合系}という．定義の２条件を\textbf{開集合の公理}という．
        \item $\O$は必ず$X,\emptyset$を最大・最小元とする有界半順序となり，有限項集合演算$\cap,\cup$についても閉じているので有界束にもなる．実は特に，フィルター・\textbf{完備なHeyting代数}となる．これを\textbf{開集合束}または\textbf{開集合の枠}という（特にフィルターになる\ref{exp-filter-of-neighbourhood}）．\footnote{実は，これを圏と見たもの$\Op$は景である．開集合の公理の特徴付け（命題\ref{prop-characterization-of-open-sets}）で見たように，射の族$(U_i\to U)_i$が満たす条件$\cup_iU_i=U$が，被覆であるための条件と同値である．こうして位相の構造が圏の上に乗ることとなる．
        \begin{enumerate}
            \item fiber積を備える圏$C$が，任意の対象$S\in C$について次の３公理を満たす射の族$\{\phi_i:T_i\to S\}$が定まっている時，この射の族\footnote{正確には射の族ではなく，篩(sieve)と呼ばれる対象である}を\textbf{被覆}といい，関手$J:C^\op\to\Set$を\textbf{Grothendieck位相}という．
            \item Grothendieck位相を備える圏のことを\textbf{景}という．
            \item 開集合を被覆に置き換えることにより，層の理論が景上でまったく同様にして成り立つ．こうして得られるコホモロジー理論のうち，歴史的には代数幾何学のヴェイユ予想を解決するためにアレクサンドル・グロタンディークがエタール・コホモロジーを定義する際にGrothendieck位相の概念が導入された．
        \end{enumerate}}
    \end{enumerate}
\end{definition}

\begin{proposition}[開集合の公理の特徴付け]\label{prop-characterization-of-open-sets}
    $X$を集合とし，$\O\subset P(X)$とする．
    \begin{enumerate}
        \item 次の条件は同値である．\begin{description}
            \item[(1)] $(U_i)_{i\in I}$が$\O$の元の族ならば，$\cup_{i\in I}U_i\in\O$．
            \item[(1')] $X$の部分集合$U$であって，次を満たすものは全て$\O$の元である：\[\forall x\in U,\; \exists V\in\O,\;x\in V\subset U.\]
        \end{description}
        \item 次の条件は同値である．\begin{description}
            \item[(2)] $(U_i)_{i\in I}$が$\O$の元の\textbf{有限}族ならば，$\cap_{i\in I}U_i\in\O$．
            \item[(2')] $X\in\O$である．かつ，$U,V\in\O\Rightarrow U\cap V\in\O$である．
        \end{description}
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(1')] (1')の論理式は，\textbf{$U$内部の開集合全体の集合$\U_U:=\{V\in\O\mid V\subset U\}$の和が$U$自身になる$\cup_{V\in\U_U}V=U$という条件}を表しており，(1')全体ではこれを満たすならば$U\in\O$という主張と同値である．従って，$\U_U$は$\O$の開集合の族だから，(1)$\Rightarrow$(1')．
        \item[(1')$\Rightarrow$(1)] $\O$の族$(U_i)_{i\in I}$を取る．$\cup_{i\in I}U_i=:U$と置くと，任意の元$x\in U$に対して$i\in I$が存在して$x\in U_i\subset U$が成り立つから，$U\in\O$．
        \item[(2)$\Rightarrow$(2')] $I=\emptyset$とすれば，$(U_i)_{i\in I}=X\in\O$．$I=2$とすれば，$U,V\in\O\Rightarrow U\cap V\in\O$．
        \item[(2')$\Rightarrow$(2)] $I$の濃度についての数学的帰納法より．
    \end{description}
\end{proof}
\begin{remarks}[1が「開近傍」の語の安定性の根拠である]
    結局，1では，部分集合$U\subset X$について，次の３条件が同値であることが核であった．
    \begin{enumerate}[(a)]
        \item $\forall x\in U,\;V\in\O,\;x\in V\subset U$．（どの点を取っても，フィルターの足が着く）．
        \item $\U_U:=\{V\in\O\mid V\subset U\}$とすると，$U=\cup_{V\in\U_U}V$．（フィルターの各点は，下の木構造について$\cup$の最大元）．
        \item $U$を被覆する開集合の族$\U_U$が取れる．（ほぼ基底についての成分表示？）
    \end{enumerate}
    $x,y\in V$の時，これらの点で$V\in\O$を共用するか別々に$x,y$のそれぞれを中心とした開球を取るかは問わない．距離空間では後者の方が勘弁であるというだけであり，論理的な立ち位置は同一．
    この安定した概念を$x$や$y$の\textbf{開近傍}という．共有してもしなくても構わない．距離空間では開球が基底であるが，合併を取れば十分共用可能なほどに大きくできる，というのが位相の本質だからである．
\end{remarks}

\begin{definition}[open neighborhood, isolated point]
    位相空間$X$上の点$x$を考える．
    \begin{enumerate}
        \item $x\in U$を満たす開集合$U\in\O$を，$x$の\textbf{開近傍}という．
        \item $\{x\}$が$x$の開近傍である時，$x$は$X$の\textbf{孤立点}という．\footnote{孤立点は他のどの点も含まない開近傍を持つということなので，位相的に必ず識別可能という意味だろう．「開集合のフィルターが点$x$について足をつくとき」．フィルターとは，コーヒーがしみていく時に作る筋のような，いくつもの極小値を持つような半順序集合だというイメージが形成されている．}
    \end{enumerate}
\end{definition}
\begin{remark}
    この言葉を用いて，$U$が開集合であることとは，「$U$の任意の点$x$に対して$U$の部分集合の中から開近傍が取れる」ということである（命題\ref{prop-characterization-of-open-sets}.1）．
    また，離散空間$X$とは，「任意の点が孤立点であるような空間」である．
\end{remark}
\begin{example}\mbox{}
    \begin{enumerate}
    \item $\R$に孤立点はない，一点集合は全て閉集合である．
    \item $\mathbb{S}$の点$1$は孤立点である．
\end{enumerate}
\end{example}

\subsection{位相の初源的な例}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    集合$X$に入る位相全体は束となり，$\bot$を自明な位相，$\top$を離散位相という．
    忘却関手$\Gamma:\Top\to\Set$は左随伴関手$\Disc:\Set\to\Top$と右随伴関手$\Codisc:\Set\to\Top$を持つ．これを離散位相と余離散位相という．
    $\S=(2,\{0,2,\{1\}\})$はTVの圏とも見れる，ヤヌス対象である．
\end{tcolorbox}

\begin{proposition}
    $(\tau_j)_{j\in J}$を$X$上の位相の族とする．
    包含関係$\subset$に関する上限$\lor\tau_j$と下限$\land\tau_j$が存在する．
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $\land\tau_j:=\Brace{A\in P(X)\mid \forall_{j\in J}\;A\in\tau_j}$と定めると，これは位相である．
        \item $T$を$X$上の位相であって任意の$\tau_j$より強いものとすると，$\CoDisc(X)\in T$より，$T\ne\emptyset$．これについて，$\lor\tau_j:=\land_{\tau\in T}\tau$と定めれば良い．
    \end{enumerate}
\end{proof}

\begin{definition}[discrete topology, coarsest / codiscrete topology]
    開集合の公理において，添字集合を$I=\emptyset$とすれば，$\emptyset\in\O,X\in\O$とわかる．
    \begin{enumerate}
        \item $\O=P(X)$で定まる位相を，$X$の\textbf{離散位相}という．
        \item $\O=\{\emptyset,X\}$で定まる位相を，$X$の\textbf{密着位相}または\textbf{余離散位相}という\footnote{(also indiscrete topology or trivial topology or chaotic topology (SGA4-1, 1.1.4))}．
    \end{enumerate}
    離散空間は自由対象とみなせるので，より基本的な構成と見做される．
\end{definition}

\begin{proposition}[離散・密着位相の特徴付け]\label{prop-characterization-of-disc-and-codisc-topology}
    忘却関手$\Gamma:\Top\to\Set$は左随伴関手$\Disc:\Set\to\Top$と右随伴関手$\Codisc:\Set\to\Top$を持つ：
    \[ \xymatrix{
        (\Disc\dashv\Gamma\dashv\Codisc):&\Top\ar[r]|\Gamma&\Set\ar@/^1pc/[l]^-\Codisc\ar@/_1pc/[l]_-\Disc
    }. \]
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[$\Disc:\Set\to\Top$は忘却関手の左随伴である] 
        \[\xymatrix{
            \Set\ar@{}[r]|{\rotatebox{90}{$\vdash$}}\ar@/^1pc/[r]^{\Disc}&\Top\ar@/^1pc/[l]^\Gamma
        }\Leftrightarrow \varphi:\Hom_\Top(\Disc(-),-)\xrightarrow{\sim}\Hom_\Set(-,\Gamma(-))\]
        離散空間からの写像は連続であるため，これは成り立つ．
        \item[$\CoDisc:\Set\to\Top$は忘却関手の左随伴である] 
        \[\xymatrix{
            \Top\ar@{}[r]|{\rotatebox{90}{$\vdash$}}\ar@/^1pc/[r]^{\Gamma}&\Set\ar@/^1pc/[l]^\CoDisc
        }\Leftrightarrow \varphi:\Hom_\Set(\Gamma(-),-)\xrightarrow{\sim}\Hom_\Top(-,\CoDisc(-))\]
        余離散空間への写像は連続であるため，これは成り立つ．
    \end{description}
\end{proof}

\begin{definition}[finer, coarser, complete Heyting algebra]
    $\O_1,\O_2$を$X$の位相とする．また，$T(X):=\{\O\in P(P(X))\mid \O はXの位相である\}$を，集合$X$に定まる位相全体からなる集合とする．
    \begin{enumerate}
        \item $\O_1\supset\O_2$であることを，$\O_1$は$\O_2$より細かい(finer)または強い(stronger)といい，$\O_2$は$\O_1$より粗い(coarser)または弱い(weaker)という．関係についての粗さの定義とは逆であるし，逆の文献もある．
        \item この細かいという関係は，$T(X)$上に順序を定める．これは$\Disc(X),\CoDisc(X)$
    \end{enumerate}
\end{definition}

\begin{example}[empty topological space, point topological space, trait / Sierpinski space]\mbox{}
    \begin{enumerate}
        \item 空集合$\emptyset$にはただ一つの位相$P(\emptyset)=1$が存在する．これを\textbf{空な位相空間}$\emptyset:=(\emptyset,\{\emptyset\})$という．
        \item 一点集合$1$はただ一つの位相$2=\{0,1\}$を持つ．これを\textbf{一点位相空間}$*:=(1,2)$という．これはEuclid空間$\R^0$に他ならない．
        \item 集合$2$の部分集合からなる集合$\{0,\{1\},2\}\subset P(2)$は$2$の位相であり，離散位相より真に粗く，密着位相より真に細かい．（$2$にはこれら合わせて３つの位相しか入らない）．位相空間$\mathbb{S}:=(2,\{0,\{1\},2\})$を\textbf{線}または\textbf{シェルピンスキー位相}と呼ぶ\footnote{\url{https://ncatlab.org/nlab/show/Sierpinski+space}}．これはAlexandroff位相\footnote{交叉についての有限条件を落とした公理をみたす位相のこと．}の例でもある．また，線は構成的数学の基礎にもなる．
        \item 集合$3$の位相は$9$通りある．
    \end{enumerate}
\end{example}

\begin{example}[cofinite topology / finite complement topology]\label{example-cofinite-topology}
    集合$X$の\textbf{余有限位相}または\textbf{有限補集合位相}とは，$\O$を次のように定めたものである．
    \begin{enumerate}
        \item 全ての有限部分集合$S\subset X$について，$X\setminus S\in\O$．（このような集合$X\setminus S$を余有限という）．
        \item $\emptyset\in\O$．
    \end{enumerate}
    $X$が有限集合の時，これは離散位相に一致する．この概念はZariski位相の文脈で自然に生じる．\footnote{\url{https://ja.wikipedia.org/wiki/補有限}}
    この位相は，$T_1$であるもののうち，最も粗いものとなる．
\end{example}
\begin{proof}
    $(U_i)_{i\in I}$を$\O$の族とする．de Morganの法則（命題\ref{prop-de-Morgan's-law}）より，
    $X\setminus\cup_{i\in I}U_i=\cap_{i\in I}X\setminus U_i\subset U_i$は有限である．
    $X\setminus\cap_{i\in I}U_i=\cup_{i\in I}X\setminus U_i$は，$I$が有限であるときに限って有限である．
\end{proof}

\subsection{分離公理のはなし}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    Alexandroff位相と言った有限条件を落とした公理や，$T_1$であるうち最も粗い余有限位相（例\ref{example-cofinite-topology}）
    と来た．他の公理の可能性を挙げておく．
\end{tcolorbox}

\begin{remark}[Tikhonovの分離公理のはなし]
    分離公理が「公理」であったのは歴史的な話で，現在は位相空間の公理からは排され，追加で附ける制限として使われる．
    いくつかの分離公理に"T"が付くのは「分離公理」を意味するドイツ語のTrennungsaxiomに由来する．
    \begin{enumerate}
        \item (Finite spaces) 経験として，有限位相空間は離散か，とても距離付け可能でないかのいずれかである．前者はcategorical logicに応用を持つ．
        \item (Separate axiom) 幾何学の分野では，non-freeな商空間の例として，exoticな位相空間が頻繁に現れる．このようなlocally metric spaceでさえないようなexoticな例を，どれくらい理論の中に存在を許したいかを測るために，\textbf{分離公理}が理論に追加で課されることになる．トポロジーのflavourは分離公理の選択によって全く異なる．この分離公理の研究には代数的な手法が欠かせなかった，Stoneの研究の重要性はしばしば過小評価されていることが\cite{Johnstone}で指摘されている．Algebraic topologyと呼ばれる分野が興ったのは彼らの後である．(McKinsey and Tarksiによる45年前後の研究)．50年代後半からは主にCharles Ehresmannにより，圏論の波に乗り，「代数的手法で位相空間を研究する」というより，「一般化した位相空間を研究する」という段階に移行した．その現代的な名前はDowkerによって提出されたFrameである．$\O$の代数的構造（片方しか無限演算を認めないなど）を一般の圏で考える理論である．\footnote{Ehresmann's name for such lattices was "local lattices"; but since the word "local" has other potential uses in lattice theory, we prefer the term frame, which was introduced by Dowker.\cite{Johnstone}}1972にJohn Isbellによってその効能が明確にされた．またIsbellは，$\O$の代数的構造と「一般化された空間」は反対圏なだけであるが，名前を別にした方が良いことを提案し，空間はlocaleと呼ばれる．これらは射に言及しない限り区別がつかないこととなった（sublocaleとquotient frameが等しい，など）．こうして，現代的な研究対象はlocaleの圏である．
        \item (Sobriety, locales, Topos) 分離公理のうち，最も一般的に採用されるのが，初めて開集合（あるいは近傍）に注目したHausdorffが1914の書籍\cite{Hausdorff}で採用した公理（定義\ref{def-Hausdorff-axiom}）である．しかし，おそらくMarshall Stoneが30年代後半に束との関係を研究してから，sobrietyの公理（定義\ref{def-Soberity}）の重要性が認知されるようになってきた．これは代数幾何学や理論計算機科学への応用を考える上で認めたい公理の中で最も弱いものであり（スキームはsoberである）(Vickers 89)\cite{Vickers}，また一方でtopologyが形式論理に持つ基礎(root)を十分に実現するからである．その対応は以下の通り：sober topological spaces are entirely characterized by the union-, intersection- and inclusion-relations (logical conjunction, disjunction and implication) among their open subsets (propositions).
        こうして，位相の概念は純論理的な言葉で写し取られ，“purely logic-determined spaces”が考えられる．これをlocaleという．より一般的にはトポスや高階トポスとなる．形式論理などの数学の基礎と幾何との２つの応用が，抽象的な一般位相空間論への重要な見通しの良さを提供してくれるだろう．
    \end{enumerate}
\end{remark}

\begin{definition}[分離公理：Kolmogorov, $T_1$, Hausdorff, regular, normal, sober]
    位相空間$(X,\O)$について，
    \begin{enumerate}\setcounter{enumi}{-1}
        \item 任意の相異なる２点について，少なくとも一方は，もう一方を含まない開近傍を持つような空間を$T_0$または\textbf{コルモゴロフ}という．
        \item 任意の相異なる２点について，両方とももう一方を含まない開近傍を持つ空間を$T_1$という．全ての一点集合$\{x\}$は閉集合であること，また$T_0$かつ$R_0$であることによって特徴付けられる．\footnote{accessible or Fréchet or Tikhonovともいう\url{https://en.wikipedia.org/wiki/Separation_axiom}}
        \item 任意の相異なる２点について，互いに交わらない開近傍を持つことを$T_2$または\textbf{ハウスドルフ}という．$T_0$かつ$R_1$であること，対角写像$\delta_X:X\to X\times X$が閉写像であることによって特徴付けられる（命題\ref{prop-characterization-Hausdorff}）．
    \end{enumerate}
    以降は，Hausdorff性に加えて追加の性質が成り立つことで定義する．
    \begin{enumerate}\setcounter{enumi}{2}
        \item $T_1$かつ，任意の点とそれを含まない閉集合について，互いに交わらない開近傍を持つ時，$T_3$または\textbf{正則}であるという．ある点の任意の近傍が，ある開近傍の閉包を含むことによって特徴付けられる．
        \item $T_1$かつ，任意の互いに素な２つの閉集合が，互いに交わらない開近傍を持つ時，$T_4$または\textbf{正規}であるという（定義\ref{def-normal}）．閉集合の任意の近傍が，ある開近傍の閉包を含むこと，また，Urysohn関数による特徴付けも存在する（補題\ref{lemma-Urysohn's-lemma}）．\footnote{\url{https://ncatlab.org/nlab/show/separation+axioms}}
    \end{enumerate}
    $X$が\textbf{穏健}であるとは，全ての既約閉集合（２つの真部分閉集合の合併として表せないような空でない閉集合）
    は一点集合の閉包のみであるような空間をいう．
    \[\xymatrix{
        &T_2\ar@{=>}[dl]\ar@{=>}[dr]&\\
        T_1\ar@{=>}[dr]&&\mathrm{sober}\ar@{=>}[dl]\\
        &T_0
    }\]
\end{definition}

\begin{definition}[分離条件：topologically distinguishable / disjoint, separated, ]
    $(X,\O)$を位相空間とする．
    \begin{enumerate}
        \item ２点$x,y\in X$が\textbf{位相的に識別可能}とは，２点が同じ近傍系を持たないことをいう．これはどちらか一方しか含まないような開集合$U\in\O$が存在することに同値．これは$T_0$の要件である．
        \item ２点$x,y\in X$が\textbf{分離される}とは，２点とも，他方を含まない近傍を持つことをいう．これは「位相的に識別可能」を対称的にした概念で，$R_0$という分離公理を導く．
        \item ２つの部分集合$U,V\subset X$が\textbf{分離される}とは，いずれも他方の閉包と交わらないことをいう．
        \item ２点$x,y\in X$が\textbf{近傍で分離される}とは，２点とも，他方を含まない近傍を持ち，それら２つの近傍が互いに素であることをいう．
    \end{enumerate}
\end{definition}

\begin{definition}[分離公理：symmetric, preregular, Urysohn]位相空間$(X,\O)$について，
    $X$における任意の位相的に識別可能な２点が，
    \begin{enumerate}\setcounter{enumi}{-1}
        \item 分離されることを，$R_0$または\textbf{対称的}という．
        \item 近傍によって分離されることを，$R_1$または\textbf{前正則}という．正則ならば$R_1$である．
        \item また，$X$における任意の異なる２点が，閉近傍によって分離される時，$T_{2\frac{1}{2}}$または\textbf{ウリゾン}という．
    \end{enumerate}
\end{definition}

\subsection{引き戻しと像位相}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    引き戻しと像位相の概念を定義するが，本質的には，写像（連続性不問）$f:X\to Y$が定める反変Hom関手$f^*:\Hom(Y,2)\to \Hom(X,2)$が集合代数を保存する事による「部分空間」の代数的概念と並行である．
    $2$と係数体$K$が違うだけで，線型形式の議論と全くパラレルである．実際，$2\in\Set$と$K\in\Vect_K$は同じ役割を果たすのだろうか？

    こうして，射$f:X\to Y$を通じて他の空間に誘起されて定まる位相が，引き戻しと像位相である．
    $f^*,f_*$の像がそのまま位相として的確であるだけであり，それぞれinitial, final topologyのことである（Localeの見地からのinitial, finalの語であることに注意）．
    「引き戻し」「像位相」の後も同じ方向である．
    \[\xymatrix@R-2pc{
        X\ar[r]^-f&Y\\
        P(X)&P(Y)\ar[l]_-{f^*}\\
        f^*\O&\O\ar@{|->}[l]_-{f^*の像}^-{fの逆像}&引き戻し\\\vspace{1mm}
        {}\\
        \O\ar@{|->}[r]^-{f^*の逆像}_-{fの像}&f^{*-1}\O&像位相
    }\]
    この２つの概念はバラバラの演算というより，$X,Y$に入る位相の組$(\O_X,\O_Y)$を定めていると思った方が良い．
\end{tcolorbox}

\begin{proposition}[反変関手$f^*$はframeの射である]\label{prop-pullback-and-image-topology}
    $f:X\to Y$を写像とする．
    \begin{enumerate}
        \item $\O$が$Y$の位相ならば，引き戻し$f^*\O:=\{f^{-1}(U)\mid U\in\O\}=f^*(\O)$は$X$の位相になる．
        \item $\O$が$X$の位相ならば，像位相$\O':=\{V\in P(Y)\mid  f^{-1}(V)\in\O\}=(f^*)^{-1}(\O)$は$Y$の位相である．
    \end{enumerate}
\end{proposition}
\begin{proof}
    関手$f^*$が任意の$\cap,\cup$演算を保つこと
    （命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}）により成り立つ性質である．
    \begin{enumerate}
        \item 「像空間」$f^*\O\subset P(X)$の任意の合併は，$\O\subset P(Y)$の族$(U_i)_{i\in I}\;(U_i\subset Y)$（これは再び$\O$の元）を用いて$\cup_{i\in I}f^{-1}(U_i)$と表せるから，\[\cup_{i\in I}f^{-1}(U_i)=f^{-1}(\cup_{i\in I}U_i)\in f^*\O.\]同様に，$|J|<\infty$として，\[\cap_{i\in J}f^{-1}(U_i)=f^{-1}(\cap_{i\in J}U_i)\in f^*\O.\]
        \item 「逆像空間」$\O'=f^{*-1}(\O)\subset P(Y)$の任意の合併$\cup_{i\in I}V_i$は，$V_i\in\O\subset P(X)$であって$\cup_{i\in I}f^{-1}(V_i)\in \O$従って$f^{-1}(\cup_{i\in I}V_i)\in\O$が成り立つから，$\cup_{i\in I}V_i\in\O'=f^{*-1}(\O)$が従う．有限共通部分についても同様だから，$\O'=f^{*-1}(\O)$は任意の合併と任意の有限共通部分について閉じている．
    \end{enumerate}
\end{proof}
\begin{remarks}[$f^*$とframe morphism，それに線型写像やその双対写像との関係]
    絶対に逆像写像$f^*$の言葉を使うのはなんだ？
    そうか，これはframeの射を使っているのだと捉えられるのがpoint-less topologyか！
    きっと命題\ref{prop-sober-spaces-and-frame-homomorphism}と関連がある．
    \[\xymatrix@R-2pc{
        X\ar[r]^-f&Y\\
        P(X)&P(Y)\ar[l]_-{f^*}
    }\]
    次のように「双対写像」が定まって，これがframeの射を引き起こす．
    これが定める$f^*:\O\to P(X)$の像$f^*(\O)$は$P(X)$の「部分フレーム」である．
    \textbf{線型写像の像と核が部分空間であるのと全く並行な議論}，極めて代数的な現象である．
    これがくっきり描き出せるのが「枠」か．
\end{remarks}

\begin{definition}[pull-back, relative topology / subspace topology, (topological) subspace, final topology]\mbox{}\label{def-initial-and-final-topology}
    \begin{enumerate}
        \item $f:X\to Y$を写像とし，$\O$を$Y$の位相とする．$X$の位相$f^*\O$を\textbf{$\O$の$f$による引き戻し}という．
        \item $X$を位相空間とし，$A\subset X$を部分集合とする．$X$の位相$\O$の包含写像$i:A\to X$による引き戻し$i^*\O$のことを，$A$の\textbf{相対位相}という．この時，$\O_A=i^*\O_X=\{U\cap A\mid U\in\O_X\}$となる．
        \item 相対位相により$A$を位相空間と考える時，これを$X$の\textbf{部分（位相）空間}という．
        \item $f:X\to Y$を写像とし，$\O$を$X$の位相とする．$Y$の位相$f^{*-1}(\O)$を$f$による\textbf{像位相}という．
    \end{enumerate}
\end{definition}
\begin{remark}[像位相の別記]\mbox{}
    \begin{enumerate}
        \item 任意の$V\subset f(X)\subset Y$について，$f(f^{-1}(V))=V$であるから，\textbf{$f$が全単射の場合に限って}像位相$f^{*-1}(\O_X)$は$f_*\O_X$とも書けるが，$f$が全単射ではないならば，これは一般の位相$\O_X$については成り立たない．これは$f$が全単射の時，$f^*$も全単射であり，$(f^*)^{-1}=f_*$であるという事実に対応する．補題より，一致するならば$f$は全単射である．
        \item $i:A\to X$が定める反変Hom関手$i^*:\Hom(X,2)\to\Hom(A,2)$は，$\chi_U:X\to 2$を$\chi_U\circ i:A\to 2$に写すから，即ち，$X$の位相$\O_X$を$\O_A=\{U\cap A\mid U\in\O_X\}$に写し，これが位相の条件を満たすことも命題\ref{prop-pullback-and-image-topology}にすでに含まれており，これを相対位相として定めたことになる．集合代数的には，命題\ref{prop-de-Morgan's-law}により代数構造は確かに保たれるので，$\O_A$も確かに位相である．
        \item $A\subset X$が開集合である時（即ち$i:A\to X$が連続写像である時？），$\O_A=\{U\in\O_X\mid U\subset A\}$となる．即ち，$X$の開集合のフィルターの木構造のうち，枝を一本切り落としたものがそのまま$A$の開集合のフィルターとなる，と言っている．これは少し非自明である．だが，開集合との有限共通部分は開と定めてあるので，$U\in\O$について$A\supset U\cap A\in\O$で良いのである．
        \item 特に断りがない限り，$\R^n$の部分空間にはEuclid空間の定める相対位相を入れ，$\GL_n(\R),\SL_n(\R)$や
        $O_n(\R),SO_n(\R)$には$M_n(\R)$の相対位相を入れて部分空間とみなしたものとする．
    \end{enumerate}
\end{remark}

\subsection{逆像写像と像写像の解離}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    像位相の概念を掘り下げる．$f$が全単射である場合は$f_*$と$(f^*)^{-1}$は一致する（命題\ref{prop-dual-of-epi}，\ref{prop-dual-of-mono}）のだが，
    $f_*$ではなく$f^*$を使う理由は，その通常時の振る舞いの良さにある．
    この振る舞いの良さは本質的には全て命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}から流入してきたものである．つまり，写像の定義の非対称性による．
    結果として，$(f^*)^{-1}$による定義は常に位相を定める（構造を保存する）が，$f_*$はあらかた$f^*$と同じに振る舞うが，構造を崩してしまいかねない．
    \textbf{$f_*$が適格なのは，彼が全単射であり（$f$が全単射であることと同値），（一般的に）$(f^*)^{-1}$に一致すると認められる場合のみ}である．
    差もなくば一般性が足りず，hackableである．
\end{tcolorbox}

\begin{lemma}
    $f:X\to Y$を写像とする．
    \begin{enumerate}
        \item $f$が全単射でない場合は，$f_*(\O_X)\subsetneq (f^*)^{-1}(\O_X)$となることも，$(f^*)^{-1}(\O_X)\supsetneq f_*(\O_X)$となることもある．
        \item 一般には$f^*\circ f_*=\id_{P(X)},f_*\circ f^*=\id_{P(Y)}$は成り立たない．
        \item $f$が全単射の時，$f^*$も全単射で，$(f^*)^{-1}=(f^{-1})^*=f_*$である．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $f_*(\O_X)\subsetneq (f^*)^{-1}(\O_X)$は$f$が全射でないときに起こる．$a\in Y\setminus f(X)$を取る．$U\in f_*(\O_X)$とすると，$U\cup\{a\}$は$(f^*)^{-1}(\O_X)$の元であるが，像にはなり得ないので$f_*(\O_X)$の元ではない．
        これを単純化すると次の例のようになる．$1:\S\to 2$を定値写像とする．$f_*(\Op(\S))=\Op(\S)$となるが，$(f^*)^{-1}(\S)=P(2)$となるので後者は離散位相を定める．

        一方，$(f^*)^{-1}(\O_X)\supsetneq f_*(\O_X)$は$f$が単射でないがために起こる．
        恒等写像$\id_2$と$2\mapsto 1$の和写像$3\to 2$は全射だが単射ではない．$3$の位相$\Op(3)=\{0,3,\{1\}\}$を考えると，$f_*(\Op(3))=\Op(\S)$となるが，$(f^*)^{-1}(\Op(3))=\{0,2\}$となり，後者は密着位相を定める．
        \item 1の例を引き合いに出せば，そこ$\O_X\in P(X)$において恒等性は崩れる．
        \item 命題\ref{prop-dual-of-mono}，\ref{prop-dual-of-epi}より．
    \end{enumerate}
\end{proof}
\begin{remarks}
    命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}を見るとおり，一般の$f$について$A\subset f^{-1}(f(A)),f(f^{-1}(B))\subset B$が成り立つ．
    前者は非単射性から生じ，後者は非全射性から生じる．反例構成ではこれしか使っていない．
\end{remarks}

\begin{proposition}
    写像$f:X\to Y$と$X$の位相$\O$に対して，$f_*\O:=\{f(U)\in P(Y)\mid U\in\O\}$と定める．
    \begin{enumerate}
        \item $f$が全射でなければ，$f_*\O$は$Y$の位相になり得ない．
        \item $f:X\to Y$が全射であっても，$f_*\O$は$Y$の位相であるとは限らない．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $f$が全射でない限り$Y\in f_*\O$を満たさないので．
        \item 集合演算の$f(\cap_{i\in I}U_i)\subset \cap_{i\in I}f(U_i)$（命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}）をhackする．$f:4\to 3$を，$\Op(4)=\{0,4,\{0,1\},\{2,3\}\}$とし，$f(0)=0,f(1)=f(2)=1,f(3)=2$とすると，$f_*(\Op(4))=\{0,3,\{0,1\},\{1,2\}\}$より，これは位相にはならない．
        この原理は，$f(\{0,1\}\cap\{2,3\})=f(\emptyset)=\emptyset\ne\{1\}=\{0,1\}\cap\{1,2\}=f(\{0,1\})\cap f(\{2,3\})$ということである．
    \end{enumerate}
\end{proof}


\section{連続写像}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    Topが圏論の一つの重要な霊性の源である．
    線型写像と同様，連続写像によって殆どの位相空間の言葉が翻訳できる．
    例えば，連続写像の可逆性が微妙な位相の消息の違いを捉える．
    極限も連続の言葉で特徴付けられる，写像の極限とは「連続延長」である（定義\ref{def-accumulation-point}）．
    特に複素解析の分野では，連続性と正則性がはっきりと概念的に近い．

    連続写像は第一義的には集合論的な言葉で，$f^*:P(Y)\to P(X)$がframeの射を$\O_Y\to\O_X$の間に\textbf{引き起こす}こととして定義される．その特徴付けは
    \[f^*(\O_Y)\subset\O_X\Leftrightarrow\O_Y\subset f^{*-1}(\O_X)\]
    であり，また各点ごとの言葉による特徴付けは，$f^*(\O_Y)\subset\O_X$を「フィルター$\O_X$は個々の点$f^*(V)$より深い（自身も含めて）」として設定すると特徴付けになる．
    前者は代数的な定義（自動で部分空間になるので深さに言及しなくていい），後者は領域理論的な，数学基礎論的な議論になっている気がする（深さに言及せずに$=$で結ぶと，位相として適格でない可能性がある）．
    frameの射を引き起こすところの反変Hom関手$f^*$が極めて有用で，連続写像の合成が連続であること（命題\ref{prop-composition-is-continuous}）が簡明に示せる．これは自然である．
    背後の構造をよく抉り出している．
\end{tcolorbox}

\subsection{連続写像の定義とその特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    連続性をinitial topology / final topologyの言葉で定義すると，射としての結合性を満たすことを瞬時に得る（この拡張が命題\ref{prop-2-morphism-in-Top}である，initial, final topologyは同時に連続になるという意味で関手的である）．
    しかしこの一見高度に圏論的な条件は各点連続性にbreak downできる還元性も備えている点があっぱれである．
    filterの言葉で各点ごとに「$f^*\Op(Y)$は$\Op(X)$ほど深くない」ことを確認できれば，写像全体の連続性に昇華できる．元々はこの道を通って構成した概念である．
\end{tcolorbox}

\begin{definition}[continuous mappings]\label{def-continuous-function}
    $X,Y$を位相空間とし，$f:X\to Y$を写像とする．
    \begin{enumerate}
        \item $f$が\textbf{連続写像}であるとは，$\Op(X)$が$\Op(Y)$の引き戻し$f^*\Op(Y)$よりも細かいこと：$f^*(\Op(Y))\subset\Op(X)$，即ち，次が成り立つことをいう：\[\forall V\in\O_Y,\;f^{-1}(V)\in\O_X.\]
        \item $f$が\textbf{$a\in X$で連続}であるとは，次が成り立つことをいう：$f(a)$の任意の開近傍$V$に対し，$a$の開近傍$U$であって$U\subset f^{-1}(V)$であるようなものが存在する．
    \end{enumerate}
\end{definition}
\begin{remark}
    写像$f:X\to Y$が連続であるとは，その双対$f^*:P(Y)\to P(X)$が$\O_X,\O_Y$の間に射を定めることをいう．
    これは射としては不思議な条件で，「すでに$X,Y$に入っている構造とmatchするかどうか？」が基準になっているような気もする．
\end{remark}

\begin{proposition}[連続写像のframe morphismの言葉による特徴付け]\label{prop-characterization-of-continuous-mapping-in-terms-of-frame-morphism}
    $X,Y$を位相空間とし，$f:X\to Y$を写像とする．
    \begin{enumerate}
        \item 次の３条件は同値である．\begin{enumerate}[(1)]
            \item $f$は連続．
            \item $f$による引き戻し$f^*\O_Y$が$\O_X$よりも粗い．
            \item $f$による像写像$f^{*-1}(\O_X)$が$\O_Y$よりも細かい．
        \end{enumerate}
        \item 次の２条件は同値である．\begin{enumerate}[(1)]
            \item $f$は連続．
            \item $X$の任意の点$x$に対して，$f$は$x$で連続である．
        \end{enumerate}
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] ３条件はそれぞれ，これが定める写像$f^*:P(Y)\to P(X)$についての次の論理式と同値．
        \begin{enumerate}[(1)]
            \item $\forall V\in\O_Y,\;f^*(V)\in\O_X$．
            \item $f^*(\O_Y)\subset\O_X$．
            \item $\O_Y\subset f^{*-1}(\O_X)$．
        \end{enumerate}
        (1)$\Leftrightarrow$(2)は像という言葉を用いた言い換えである．(2)$\Leftrightarrow$(3)は命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}.1による．
        \item[2. (1)$\Rightarrow$(2)] 任意に開近傍$a\in V\subset Y$を取る．$a\in X$の開近傍$a\in f^{-1}(V)\subset f^{-1}(V)\subset X$が条件を満たす．
        \item[(2)$\Rightarrow$(1)] $V\in\O_Y$を任意に取る．$x\in f^{-1}(V)$に対して，$x\in U_x\subset f^{-1}(V)$を満たす$U_x\in\O_X$が存在する．$f^{-1}(V)=\cup_{x\in f^{-1}(V)}U_x\in\O_X$が導かれるから，$f$は連続．この議論は命題\ref{prop-characterization-of-open-sets}で，$(U_x)_{x\in f^{-1}(V)}$を$\U_{f^{-1}(V)}$として議論していた．
    \end{description}
\end{proof}
\begin{remarks}
    2の(2)$\Rightarrow$(1)が成り立つには，命題\ref{prop-characterization-of-open-sets}の1'同様，
    開集合のフィルターのupward-closednessに訴える必要があるのでこの定義になっている．
    本来なら「$a\in Y$で連続とは，$a$の任意の$Y$-開近傍の逆像が開」でも良さそうなものだが．
    それと同値な$\O_X\ni U\subset f^{-1}(V)$の存在として語る．
\end{remarks}

\begin{proposition}[連続写像は合成について閉じてる]\label{prop-composition-is-continuous}
    $f:X\to Y,g:Y\to Z$を連続写像とする．$g\circ f$も連続である．
\end{proposition}
\begin{proof}
    \[\xymatrix@R-2pc{
        P(Z)\ar[r]^-{g^*}&P(Y)\ar[r]^-{f^*}&P(X)\\
        \rotatebox{90}{$\subset$}&\rotatebox{90}{$\subset$}&\rotatebox{90}{$\subset$}\\
        \O_Z\ar[r]&\O_Y\ar[r]&\O_X
    }\]
    この系列の合成$f^*\circ g^*=(g\circ f)^*$は，frameの射$\O_Z\to\O_X$を定めている．従って，$g\circ f:X\to Z$は連続である．
\end{proof}

\subsection{写像が連続であることによる位相の言葉の特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    線型代数の手法と同様，開集合であるということを，射が連続であるための条件としてcodeしていく．
    ただし唯一違うところは，Topの射の向きは本質的にはVectとは逆である．
    $X$の構造が豊かであるほど射が出やすい．構造が薄いほど射が入りやすい．
    これは随伴$\Disc,\CoDisc$に注目するとわかりやすい．
    \begin{enumerate}
        \item 位相の細かさは部分圏$\End_{\Top}(X)$に書かれている．
        \item $X$の位相が細かいほど射が入りやすい．$\Hom_\Top(\Disc(X),Y)=\Hom_\Set(X,Y)$である．
        \item $Y$の位相が細かいほど射が入りにくい．$\CoDisc(Y)$への連続写像は，その台写像が局所定数写像であることと同値．
        \item $\Hom_\Top(\Disc(X),\CoDisc(Y))$の元は定値写像のみである．
        \item initial, final topologyは同時に連続になる（命題\ref{prop-2-morphism-in-Top}）．その例は，相対位相である．
        \item 開集合$U\subset X$と連続な特性関数$\chi_U:X\to\S$とは同一視できる．$(\chi_U)^*(\Op(\S))=\{0,X,U\}$という構造のみをハイライトするからである．
        \item 位相空間とは，$X$と関手$\Op:X\to\S$（$\Map(X,2)$のうちどれを連続と数えるか）を１つ定める代数である．
    \end{enumerate}
\end{tcolorbox}

\begin{proposition}[位相の細かさの特徴付け，定値写像の特徴付け]\mbox{}
    \begin{enumerate}
        \item 集合$X$の位相$\O_1,\O_2$により位相空間とみなしたものをそれぞれ$X_1,X_2$とする．$\O_1$が$\O_2$より細かい$\O_1\supset\O_2$とは，恒等写像$\id_X:X_1\to X_2$が連続であることに同値．
        \item 写像$f:X\to Y$が定値写像であることと，$X$の密着位相と$Y$の離散位相に関して連続になることは同値．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $\id_X:X_1\to X_2$が連続であるとは，これが定めるframeの射$\id_X^*=\id_{P(X)}:\O_2\to\O_1$が$\id_X^*(\O_2)\subset\O_1$を満たすことをいう．即ち，$\id_X^*=\id_{P(X)}$は包含写像だから，即ち，$\O_2\subset\O_1$．
        \item $f$が定値写像ならば，$V\in\O_Y$に対して$f^*(V)$の値は$\emptyset$か$P(X)$かのいずれかなので，定値写像$f$は位相の入れ方に拘らず必ず連続．
        逆に，$f$が$Y$の離散位相について連続の時，局所定数関数である．さらに$X$が密着位相の時は$f|_\emptyset=0$で，かつ$f|_X$が定数関数である必要があるから，$f$は定数関数．
    \end{enumerate}
\end{proof}

\begin{definition}[locally constant]
    一般に$X$の位相が細かければ細かいほど，$f:X\to Y$は連続になりやすい．
    \begin{enumerate}
        \item $X$が離散空間ならば，全ての写像$f:X\to Y$は連続になる（命題\ref{prop-characterization-of-disc-and-codisc-topology}）：$C(A,X)=\Map(A,X)$．充満忠実．
        \item $a$が$X$の孤立点ならば，任意の写像$f:X\to Y$は$a$で連続になる．どんな$f(a)$の開近傍$V$の引き戻しも，$a$の開近傍$\{a\}\subset f^{-1}(V)$を含むからである．あるいはフィルターとして$\uparrow a\subset\O_Y$だからである．
        \item $Y$の位相が離散位相ならば，写像$f:X\to Y$が連続であるとは，任意の$x\in X$に対し，$x$の開近傍$U$であって，$U$への制限$f|_U:U\to Y$が定値写像となるようなものが存在することである（$U$を各fiber $U_x=f^{-1}(x)$とすれば良いが，これより細かくても十分）．このような写像$f$を\textbf{局所定数関数}という．
    \end{enumerate}
\end{definition}

\begin{proposition}[Topの2-射]\label{prop-2-morphism-in-Top}
    $(Y,\O_Y)$を位相空間とし，$X$を写像$f:X\to Y$による$Y$の位相の引き戻し$\O_X=f^*\O_Y$により位相空間と考える（と，これについて$f$は連続になる）．
    この時，任意の位相空間$T$と写像$g:T\to X$に対して，$g$が連続であることと$f\circ g:T\to Y$が連続であることは同値になる．
    特に，$X\subset Y$で，$g=i:X\to Y$が包含写像である時にも成り立つ．
    \[\xymatrix{
        X\ar[r]^-f&Y&f^*\O_Y=\O_X\ar[dr]_-{g^*}&\O_Y\ar[l]_-{f^*}\ar@{.>}[d]\\
        &T\ar[ul]^-g\ar@{.>}[u]&&\O_T
    }\]
    これは極限の議論とも繋がるのであろうか．$g$が$g\circ f$を定めるのが「連続延長」になる時を極限というのか．
\end{proposition}
\begin{proof}
    $g\in\Hom(T,X)$が連続の時，$f\circ g\in\Hom(T,Y)$も連続である．問題は逆である．
    $f\circ g\in\Hom(T,Y)$が連続である時，$(f\circ g)^*$はframeの射を定める．$(f\circ g)^*=g^*\circ f^*$より，$g^*:\O_X\to\O_T$もframeの射であるから，$g:T\to X$も連続．
\end{proof}

\begin{notation}[連続写像の空間]
    連続写像がなす$\Map(X,Y)$の部分集合を，
    \[ C(X,Y):=\{f\in\Map(X,Y)\mid fは連続\} \]
    と表す（$\Hom_\Vect(X,Y)$が$Y^X$の部分空間であるのに似ている，いずれも具体圏）．特に$Y=\R$の時は，$C(X):=C(X,\R)$と略記する．
\end{notation}

\begin{proposition}[位相の特徴付け]\mbox{}
    \begin{enumerate}
        \item 位相空間$X$の部分集合$U$が開集合であることと，特性関数$\chi_U:X\to\S$が連続であることとは同値．
        \item 特性関数とそれが指定する部分集合との間の標準的な同型$\Map(X,2)\to P(X)$の，$C(X,\S)$への制限は，$X$の位相への可逆写像$C(X,\S)\to\O$を定める．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $\O_\S$は３元しかなく，うち２つは自明．残り１つの主張はfiber $\chi_U^{-1}(1)=U\in\O_X$であることである．
        \item うまくいく．
    \end{enumerate}
\end{proof}

\begin{remark}[$C$というタグ]
    $C$は関手なのか？？
\end{remark}

\subsection{圏Topが定まった}\label{subsec-Top}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    位相空間は代数構造が強いとは誰もが感じていただろうが，これはSet上の$F$-代数$(X,F)$として統一的視点に至るのか！？
    位相空間とは，集合$X\in\Set$と，反変関手$\Op:\Top^\op\to\Set$を１つ定めることによって定まる．
    $\Op\simeq\Hom_\Top(-,\S)\in[\Top^\op,\Set]$は前層である．
\end{tcolorbox}

\begin{definition}[反変関手Op]
    次のように反変関手$\Op:\Top^\op\to\Set$が定まる．
    \[\xymatrix@R-2pc{
        \Op:\Top^\op\ar[r]&\Set\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        X\ar@{|->}[r]&\Op(X):=\O_X\simeq C(X,\S)\\
        f\ar@{|->}[r]&f^*:\O_Y\to\O_X
    }\]
    ただし，$f^*$とは，反変Hom関手$\Hom(Y,2)\to\Hom(X,2)$が引き起こすframeの射とした．
    $C(X,\S)$を定めることで，$X$上の位相が定まる，というものの見方はもしかして層に近いのか？
\end{definition}
\begin{remark}
    well-definednessとしては，関手性$(g\circ f)^*=f^*\circ g^*$と$(1_X)^*=1^*_{\O_X}$を確かめれば良い．
\end{remark}

\begin{definition}\label{def-category-of-open-sets}
    集合$X$と\textbf{開集合のなす圏}$\Op(X)^\op$との組$(X,\Op(X)^\op)$を位相空間という．
\end{definition}

\begin{proposition}[Opの表現可能性]\mbox{}
    \begin{enumerate}
        \item $P^*:\Set^\op\to\Set$は，$\{1\}\in P(2)$を普遍元として表現される．即ち，$P\simeq\Hom(-,2)$である．
        \item $\Op^*:\Top^\op\to\Set$は，忘却関手$\Gamma:\Top\to\Set$が定める双対関手$\Gamma^\op:\Top^\op\to\Set^\op$と$P^*:\Set^\op\to\Set$の合成関手$P^*\circ\Gamma^\op$の制限（\textbf{部分関手}）である．
        \item 反変関手$\Op:\Top\op\to\Set$は，$\{1\}\in\Op(\S)$を普遍元として，線$\S$で表現される．
    \end{enumerate}
\end{proposition}
\begin{remark}
    $2\in\Set,\S\in\Top,K\in\Vect_K$に共通点があるのかな．
\end{remark}

\subsection{同相写像と埋め込み}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    枠の射$f^*$に注目する傾向はさらに進んでいく．
    $f:X\to Y$が同相写像であるためには，ただ全単射であるだけでなく，
    全単射$f^*:P(Y)\to P(X)$について$f^*(\O_Y)=\O_X$である必要がある．これは２つの圏が重なっているからである．

    Topにおけるsplit mono（左簡約可能な射）を定義する．
    これは，同型と包含とに標準分解することと同値で，
    そのような射は埋め込み(imbedding)と呼ばれる．
    標準分解するための必要十分条件は，initial topologyの言葉で，
    「単射$f:X\to Y$で，$\O_X=f^*\O_Y$であるもの」と定義できる（$f$が全射でもあれば同型）．
    単射は標準分解するから，その双対を取ることでこのように自然にTopでも標準分解するようなsplit monoを定義できる．
    ２つの圏が重なっているからこそできる調整である．
    すると，埋め込みとは部分空間への同相写像で，そのための必要十分条件は，連続なretractionが存在することである．
    \begin{enumerate}
        \item 埋め込みとは，Topのsplit monoである．この左逆元をretractionという．
        \item 連続単射$f=i\circ\overline{f}$にretraction $r$はSet上で存在し，$\overline{f}^{-1}=r\circ i$である．これがTop上でもretractionであるためには，$r\circ i$が連続であればよく，これは$f$が$f^*(\O_Y)=\overline{f}^*(i^*(\O_Y))=\O_X$を満たすことに同値．
        \item この条件は$f$が単射かつ$f^*\O_Y=\O_X$である．単射の時$f^*\O_Y=\overline{f}^*\circ i^*(\O_Y)=\O_X$で$\overline{f}$は可逆だから，「部分空間への同型」と言い換えられる．
        \item 部分空間への同型ならば，同型と包含とにsplitである．これで議論が循環した．これら２つは同値な定義である．
    \end{enumerate}
\end{tcolorbox}

\begin{definition}[homeomorphism]
    $X,Y$を位相空間とする．
    \begin{enumerate}
        \item 連続写像$f:X\to Y$が可逆であり，その逆写像$f^{-1}:Y\to X$も連続である時，これを\textbf{同相写像}または\textbf{位相同型}という．
        \item 同相写像$f:X\to Y$が存在する時，位相空間$X,Y$は\textbf{同相}であるという．\footnote{Both regarded as topological spaces, are “the same” for the purposes of topology.}
    \end{enumerate}
\end{definition}
\begin{remark}[algebraic topology]
    トポロジーの興味の１つは，同相写像の不変量(“topological properties”)を調べることである．
    これにより，２つの空間が等しいかどうかを判定する代数的手法を得る．基本群(how many ways there are to wind loops inside a topological space)など．
    さらに条件を2-圏的手法で緩めて，ホモトピー同値を調べるなども考えられる．
    このような分野を代数トポロジーという．
    \begin{enumerate}
        \item 空でない開区間$(a,b)$は$\R$と同相である．半開区間$[a,b)$と開区間$[a,b]$は$\R$に同相ではない．これらは連結性やコンパクト性から示せる．
        \item $\R^n\to\R^m$は一般に可逆写像が存在するが，同相であるための必要十分条件は$n=m$である．これはhomology群を考えることで示せる．
    \end{enumerate}
\end{remark}

\begin{lemma}[位相同型の特徴付け]\mbox{}\label{lemma-characterization-of-homeomorphism}
    \begin{enumerate}
        \item $f:X\to Y$が位相同型であるとは，$f$が可逆写像かつ$f^*\O_Y=\O_X$であることに同値．
        \item 全単射な連続写像であって同相写像でない例があるのが位相空間の特徴である．例えば離散空間$2$からの恒等写像$2\to\S$である．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $f:X\to Y$が可逆の時，$f^*:P(Y)\to P(X)$も可逆である．実際，$(f^{-1})^*:P(X)\to P(Y)$が逆写像である．実はこれが，$f$の逆写像$f^{-1}$の定める反変Hom関手$(f^{-1})^*=(f^*)^{-1}$である．従って，$f^{*-1}\O_X\to\O_Y$でもあり，命題\ref{prop-characterization-of-continuous-mapping-in-terms-of-frame-morphism}より，$f^{-1}$も連続．よって，$f$は位相同型．
    \end{enumerate}
\end{proof}
\begin{remark}
    $(f^*)^{-1}$と$(f^{-1})^*$は一致しない可能性があるから，先生は括弧を外さずに書いていたのか！
\end{remark}

\begin{definition}[imbedding, retraction]
    $X,Y$を位相空間とし，$f:X\to Y$を連続写像とする．
    \begin{enumerate}
        \item $f:X\to Y$が単射であり，$X$の位相が$f$による$Y$の位相の引き戻しである時，$f$を\textbf{埋め込み}であるという．
        \item 連続写像$r:Y\to X$が$r\circ f=\id_X$を満たす時（連続な左逆元），$r$は$f$の\textbf{レトラクション}であるという．
    \end{enumerate}
\end{definition}
\begin{remarks}\mbox{}
    \begin{enumerate}
        \item 定義の意図としては，$f$が埋め込みであるとは，$f$が$f(X)\subset Y$への同相写像を定める（包含写像$f(X)\to Y$と分解する）ということである．\footnote{部分空間への同相写像というのが定義であるが，違うものを「埋め込み」と呼ぶこともある．}
        \[\xymatrix{
            X\ar[r]^-f\ar[dr]_-{\overline{f}}^-{\rotatebox{135}{$\sim$}}&Y&\O_X=f^*\O_Y&\O_Y\ar[d]^-{i^*}\ar[l]_-{f^*}\\
            &f(X)\ar[u]_-i&&i^*\O_Y\ar[ul]^-{\overline{f}^*}_-{\rotatebox{145}{$\sim$}}
        }\]
        相対位相自体を包含写像$i$の引き戻しによって定義したから，$\overline{f}$が同型である時$\overline{f}^*$も同型（命題\ref{prop-dual-maps}）だから，$f$は部分空間$f(X)\subset Y$への同相写像となっている．逆に，部分空間への同相写像は，全体空間への埋め込みを一意的に定める．
        \item 連続な単射だからと言って埋め込みであるとは限らないのが位相空間の特徴である．
        \item $f$が同相であるとは，$f$が埋め込みかつ全射であることに同値．補題\ref{lemma-characterization-of-homeomorphism}から明らか．
        \item retactionがある(=split monoである)ならば，埋め込みである．\footnote{retractionといえば連続としたが，圏論的には一般の左逆元をretractionと言ってしまうこともある．}
    \end{enumerate}
\end{remarks}

\begin{proposition}\label{prop-split-epi-then-imbedding}
    $f:X\to Y$を連続写像とする．$f$の連続なretraction $r:Y\to X$が存在するならば，$f$は埋め込みである．
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[集合論的議論] $f$にretractionが存在するなら，split monoであるから，定理\ref{thm-mono}より単射である．
        \[\xymatrix@R-2pc{
            X\ar@{^{(}->}[r]^-f&Y\ar[r]^-r&X\\
            P(X)\ar@{^{(}->}[r]^-{r^*}&P(Y)\ar[r]^-{f^*}&P(X)
        }\]
        $r\circ f=\id_{X}$より，$(r\circ f)^*=f^*\circ r^*=\id_{P(X)}=\id^*_X$．よって，$f^*(r^*(\O_X))=\O_X$であるが，
        $r$が連続であることより，命題\ref{prop-characterization-of-continuous-mapping-in-terms-of-frame-morphism}.1の(2)から$r^*(\O_X)\subset\O_Y$．
        従って$f^*(r^*(\O_X))=\O_X\subset f^*(\O_Y)$．
        $f$も連続であることより，命題\ref{prop-characterization-of-continuous-mapping-in-terms-of-frame-morphism}.1の(3)より，$(f^*)^{-1}(\O_X)\supset\O_Y$．
        命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}.1より，$f^*(\O_X\supset\O_Y$．よって，$f^*\O_X=\O_Y$．よって，$f$は引き戻しである．
        \item[圏論的議論] $f$が定める全単射$\overline{f}:X\to f(X)$の逆写像も連続ならば，$f$は部分空間$f(X)$への同型であるから，埋め込みであるとわかる．
        $f=i\circ\overline{f}$より，$r\circ i$が$\overline{f}$の逆射であるから，これは連続だとわかる．
    \end{description}
\end{proof}
\begin{remarks}
    Set上でsplit monoといえば，単射と同値だから，$f=i\circ\overline{f}$と分解できるもののことである．左簡約可能である由縁は，左側からなら$i$と合体した結果$\overline{f}$の逆射になるような写像が作れるからである．
    命題\ref{prop-section-existence-implies-initial-topology}の双対命題である．
\end{remarks}

\begin{corollary}
    $m\le n$とし，連続単射$i$を
    \[\xymatrix@R-2pc{
        i:\R^m\ar[r]&\R^n\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (x_1,\cdots,x_m)\ar@{|->}[r]&(x_1,\cdots,x_m,0,\cdots,0)
    }\]
    連続全射$p$を
    \[\xymatrix@R-2pc{
        i:\R^n\ar[r]&\R^m\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (x_1,\cdots,x_n)\ar@{|->}[r]&(x_1,\cdots,x_m)
    }\]
    とすると，$p\circ i=\id_{\R^m}$だから，命題より$i:\R^m\to\R^n$は埋め込みである．
\end{corollary}

\section{閉集合，近傍，閉包}\label{sec-duality-of-opens-and-closed}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    昔は位相空間の定義として働いていた古参の用語たちを定義する．
    これらは今までの位相空間の用語を全く書き換える能力を持つから，これらの特徴付けを証明していく．
    使用感は代数的で切れ味が良い．基底の語も何処か線型代数に通じるものがある．
    像写像と逆像写像の集合代数に対する関手性（命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}）をフルに活用していて，双対性もくっきり浮かび上がる対称的な扱いをする．
\end{tcolorbox}

\subsection{閉集合・近傍・閉包の定義と，開集合の公理との等価性}

\begin{definition}[closed set, interior point, closure, interior / open kernel, dense]\label{def-closure}
    $X$を位相空間とし，$A\subset X$を部分集合とする．
    \begin{enumerate}
        \item $A$の補集合$X\setminus A$が$X$の開集合である時，$A$は$X$の\textbf{閉集合}であるとする．
        \item $x\in X$について，$A$が$x$の開近傍$U$を部分集合として含む$U\subset A$時，$A$は$x$の\textbf{近傍}であるといい，$x$は$A$の\textbf{内点}であるという．
        \item 次の$X$の部分集合を$A$の\textbf{閉包}と呼ぶ：\[ \overline{A}:=\{x\in X\mid xの任意の近傍Uに対してU\cap A\ne\emptyset\}. \]
        \item 次の$X$の部分集合を$A$の\textbf{内部}または開核と呼ぶ：\[A^\circ:=\{x\in A\mid xはAの内点である\}.\]
        \item $X=\overline{A}$である時，$A$は\textbf{稠密}であるという．
        \item $A\subset U$を満たす開集合$U$を，\textbf{$A$の開近傍}という．
    \end{enumerate}
\end{definition}
\begin{remark}
    2.と6.より，点$x$の開近傍と部分集合$A$の開近傍という用語を定義した．また一般に開とは限らない部分集合$x\in A$を近傍と呼ぶことも2で定義した．（となると，部分集合$A$は大きく取るほど近傍になりやすい，という現象が起こる）．
    これより開集合とは，任意の元に対して自身が近傍となっているような点のことをいう．
    なお「稠密」の定義を今まで失敬していた，随分狭い意味を持っていたのか．
    これを用いて，近傍とは短調な埋め込み$i:\Op(X)\to P(X)$に沿って，$U\le A$となるような$A$のことである．
\end{remark}

\begin{proposition}[内部，閉包，稠密の特徴付け]
    $X$を位相空間とし，$A$を$X$の部分集合とする．
    \begin{enumerate}
        \item $A$の内部$A^\circ$について，次が成り立つ．
        \begin{enumerate}[(1)]
            \item $A$の内部$A^\circ$は$X$の開集合である．
            \item $A^\circ\subset A$である．
            \item $A^\circ$とは，$A$に部分集合として含まれる開集合のうち最大のものである（開核）．
        \end{enumerate}
        \item (双対命題) $A$の閉包$\overline{A}$について，次が成り立つ．
        \begin{enumerate}[(1)]
            \item $A$の閉包$\overline{A}$は$X$の閉集合である．
            \item $A\subset\overline{A}$である．
            \item $\overline{A}$とは，$A$を部分集合として含む閉集合のうち最小のものである．
        \end{enumerate}
        \item 次の条件は同値である．\begin{enumerate}[(1)]
            \item $A$は稠密．
            \item 任意の空でない開集合$U$に対して，$A\cap U\ne\emptyset$である．
        \end{enumerate}
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.]
        $A$に含まれる開集合全体の集合を$\U_A=\{U\in\O\mid U\subset A\}$とおくと，$A^\circ=\cup_{U\in\U_A}U\in\O_X$である．
        $U\in\U_A\Rightarrow U\subset A^\circ$であるから，$A^\circ=\max\U_A$．
        \item[2.]
        $B=X\setminus A$と置けば，$\overline{A}=X\setminus B^\circ$である．$x\in B^\circ$は，$x$のある近傍$U$について，$U\subset B$即ち$U\cap(X\setminus A)=U$即ち$U\cap A=\emptyset$より，$a\in\overline{A}$に同値．
        \item[3.]
        (1)$\Rightarrow$(2)は，$\overline{A}=X$の時，任意の空でない開集合$U$について，$x\in U$を取ると，$x\in X=\overline{A}$だから，$x$の近傍である$U$は$U\cap A\ne\emptyset$となる．
        (1)$\Leftarrow$(2)は，$x\in X$という条件は，任意の$x$の開近傍$U$を取れば$U\cap A\ne\emptyset$なのだから，$x\in\overline{A}$と同値になる．よって，$X=\overline{A}$．
    \end{description}
\end{proof}
\begin{remark}[$A$に含まれる開集合全体の集合$\U_A$，閉包と内部の双対に気づけたか]
    $\U_A=\{U\in\O\mid U\subset A\}$の手法は，完備Heyting代数$\O_X$の２番目に小さい元は
    単射$i:X\to P(X)$の像のどれかである．だから，$A^\circ$は内部より，任意の$x\in A^\circ$に開近傍$U_x$が取れて……とはせずとも，
    $\U_A$で，$i(X)\cap\O_X$の生成する部分に言及できてしまう．
    
    また，2で初めて開閉の双対に出会ったわけだが，もっと形式的に定式化できるはずだ．$\O_A=i^*\O_X$として，
    \begin{align*}
        \overline{A}&=\{x\in X\mid \forall U\in x\uparrow\cap\O_A\;\;\;U\cap A\ne\emptyset\},\\
        A^\circ&=\{x\in X\mid \exists U\in x\uparrow\cap\O_A\;\;\;U\cap A=U\}.
    \end{align*}
\end{remark}

\begin{remark}[開集合・閉集合の歴史的特徴付け]
    こうして開集合の特徴付け$A=A^\circ$，閉集合の特徴付け$A=\overline{A}$を得る．これはこれで代数的で良い定義に思う．
\end{remark}

\begin{definition}[boundary, exterior]
    位相空間$X$の部分集合$A$について，$X$は閉集合$\overline{A}\setminus A^\circ$と２つの開集合$A^\circ,X\setminus\overline{A}$に分割される．
    \begin{enumerate}
        \item 閉集合$\overline{A}\setminus A^\circ=:\partial A$を\textbf{境界}と呼び，その元を\textbf{境界点}と呼ぶ．
        \item 内点と境界点を合わせて\textbf{触点}と呼ぶ．
        \item 開集合$X\setminus\overline{A}$を$A$の\textbf{外部}と呼び，その点を\textbf{外点}と呼ぶ．
    \end{enumerate}
\end{definition}

\begin{proposition}[実数の部分集合の上限の特徴付け]\label{prop-characterization-of-supremum}
    $A\subset\R$を上に有界な空でない部分集合とする．実数$s\in\R$に対して，次は同値．
    \begin{enumerate}
        \item $s=\sup A$．
        \item $s\in\overline{A}\subset(-\infty,s]$．
    \end{enumerate}
\end{proposition}

\subsection{連続写像の特徴付け，開集合系の基底と開近傍の基本系によるものも}

\begin{screen}
    連続写像の位相演算子の言葉による特徴付けとしては，
    閉包演算子$\overline{ }$の構造を
    緩く保つ射$f$が連続なのである：
    $f(\overline{A})\subset\overline{f(A)}$．
    
    閉集合と開集合が平等な対象として現れ，むしろ閉包演算子$\overline{ }$が部分空間の生成のように，
    重要な演算となる．
    必然的に議論は集合論臭くなり，第二章への参照が増える．
    さらに線型代数学の集合論的な手法を取り入れて，全体空間の生成系として基底を考えることができる．
    これはフィルターの基として普遍性を持つ概念で，近傍系もフィルターであるから近傍系にも定まる，その場合を基本系と呼び分ける．
    近傍系のフィルターについての条件として，連続写像の一点における連続性条件は特徴付けることができる．他は生成の言葉で自動で決まるからである．
    「基底の行き先が決まれば写像（の性質）が大域的に決まる」とは，少し線型代数の基底っぽい性質である．
\end{screen}

\begin{proposition}[連続写像の双対命題，閉包演算]\label{prop-continuous-map-and-closure}
    写像$f:X\to Y$について，次の３条件は同値である．
    \begin{enumerate}
        \item $f$は連続．
        \item (双対命題) $Y$の任意の閉集合$B$に対して，逆像$f^{-1}(B)$は$X$の閉集合である．
        \item $X$の任意の部分集合$A$に対し，$f(\overline{A})\subset\overline{f(A)}$である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Leftrightarrow$(2)] 命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}.3より，$f^{-1}(Y\setminus B)=f^{-1}(Y)\setminus f^{-1}(B)=X\setminus f^{-1}(B)$より，$f$が連続ならば，$B$が閉集合ならば$f^{-1}(B)$も閉集合で，これが成り立つならば$f^{-1}$は開集合$Y\setminus B$の逆像$f^{-1}(Y\setminus B)$は開集合だとわかる．
        \item[(2)$\Rightarrow$(3)] $f(A)\subset\overline{f(A)}$である．命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}.1より，$A\subset f^{-1}(\overline{f(A)})$である．閉集合の逆像$f^{-1}(\overline{f(A)})$は閉集合だから，引き続き$\overline{A}\subset f^{-1}(\overline{f(A)})$であり，再び命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}より，$f(\overline{A})\subset \overline{f(A)}$．世界を行って$X$の結果を引き連れて戻ってきた．
        \item[(3)$\Rightarrow$(2)] 閉集合$B\subset Y$を取ると，$B=\overline{B}$である．
        $f^{-1}(B)=\overline{f^{-1}(B)}$を導く．$f^{-1}(B)\subset\overline{f^{-1}(B)}$は成り立つから，$f^{-1}(B)\supset\overline{f^{-1}(B)}$を得れば良い．
        命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}.3の(1)より，$B\supset f(f^{-1}(B))$であるが，$B$が閉集合であることより，$B\supset\overline{f(f^{-1}(B))}\supset f(\overline{f^{-1}(B)})$を得る．
    \end{description}
\end{proof}

\begin{definition}[basis, fundamental system, neighbourhood basis]\label{def-basis-fundamental-sysmte}
    $X$を位相空間とし，$\mathcal{U}\subset\O_X$を部分集合とする．
    \begin{enumerate}
        \item (downward-directed) $\mathcal{U}$がフィルター$\O_X$の\textbf{基底}であるとは，次が成り立つことをいう：\[\forall U\in\O_X,\;\forall x\in U,\; \exists V\in\mathcal{U},\;x\in V\subset U.\]
        \item (downward-directed) $x\in X$とする．$\mathcal{U}$が\textbf{$x$の開近傍の基本系}であるとは，$V\in\mathcal{U}$ならば$V$も$x$の開近傍であり，また，$x$の任意の開近傍$U$に対して$V\subset U$を満たす元$V\in\mathcal{U}$が存在することをいう．
        \item $x$の近傍の集合が\textbf{近傍の基本系}であることも同様に定義する．これを\textbf{基本近傍系}ともいう．
    \end{enumerate}
\end{definition}
\begin{remark}\mbox{}
    \begin{enumerate}
        \item 位相の基底とは，$\cup$-生成系のことである．生成系でなきゃならないから，「横に十分長く(downward-directed)」なきゃいけない．準基とは$\cup,\cap$-生成系のことである．しかしこちらはむしろ代数構造をすっ飛ばして，定義\ref{def-subbasis}のような形で定義される．
        \item 基本系とは，位相を$\O_X\hookrightarrow P(X)$によって飛び出して考えた語で，（開）近傍のフィルター$x\uparrow\cap\O_X$の$\cup$-生成系をいう．特に$P(X)$全体で「生成」させる際に必要な「基底」を基本近傍系という．
        \item これは距離空間における「開球の言葉による位相の定義」の一般化ともみれる．これらの言葉により，距離空間の位相とは，開球を基底として生成される位相のことである，と表現できる．
        実際，$\R^n$について，\[\mathcal{U}=\{U_r(x)\mid x\in\R^n,r\in\R_{>0}\}\]は$\R^n$の基底である．
        $\mathcal{U}_x=\{U_r(x)\mid r\in\R_{>0}\}$は$x$の開近傍の基本系である．
        \item 線型代数の基底と異なり，基底の濃度は一意的ではない．
        \item 開基は開被覆のうち，次を満たすようなもののことである．
    \end{enumerate}
\end{remark}

\begin{lemma}[基の特徴付け：生成系である]\label{lemma-characterization-of-basis}
    $\O_X$を$X$の位相とすると，次は同値．
    \begin{enumerate}
        \item $\U$は$\O_X$の基底である．
        \item $\O_X$に属する任意の開集合は，$\U$の合併として表せる．
    \end{enumerate}
    \cite{nLab}では，2の方を定義とし，1をrecognition of topological basesとして特徴付けとしている．
\end{lemma}
\begin{proof}\mbox{}
    \begin{description}
        \item[1$\Rightarrow$2] 
        $U\in\O_X$を任意に取る．各$x\in U$について$U_x\in\U$が存在して$x\in U_x\subset U$が成り立つような，$\U$の族$(U_x)_{x\in U}$が取れる．これについて，$U=\cup_{x\in U}U_x$である．
        \item[2$\Rightarrow$1] 
        任意の$U\in\O_X$と$x\in U$を取る．$\U$の族$(U_i)_{i\in I}$で$U=\cup_{i\in I}U_i$となるものが存在する．$x\in U=\cup_{i\in I}U_i$より，$\exists i\in I\;x\in U_i\in\U$だから，これについて$x\in U_i\subset U$．
    \end{description}
\end{proof}

\begin{proposition}[連続写像の特徴付け：開近傍の基本系の言葉で．基底の行き先が決まれば写像が決まる]\label{prop-continuousness-in-terms-of-basis}
    $f:X\to Y$を写像とする．$\mathcal{U}_a$を$a\in X$の開近傍の基本系，$\mathcal{V}_b$を$b:=f(a)$の開近傍の基本系とすると，次の２条件は同値である．
    \begin{enumerate}
        \item $f$は$a$で連続．
        \item $\forall V\in\mathcal{V}_b,\;\exists U\in\mathcal{U}_a,\;f(U)\subset V$．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1$\Rightarrow$2] 
        $V\in\mathcal{V}_b$を任意に取る．$f$は$a$で連続より，$a$の開近傍$U$であって$a\in U\subset f^{-1}(V)$を満たすものが存在する．この時，$\U_a$が$a$の開近傍の基本系であることより，$U'\in \U_a$が存在して$a\in U'\subset U\subset f^{-1}(V)$を満たすから，$U'\subset f^{-1}(V)\Leftrightarrow f(U')\subset V$（命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}.1）．
        \item[2$\Rightarrow$1] 
        開近傍$b\in V$を任意に取ると，$b\in V'\subset V$を満たす$V'\in\mathcal{V}_b$が存在する．すると，$a\in U\subset f^{-1}(V')\subset f^{-1}(V)$を満たす開近傍$U\in\U_a$が存在するから，$f$は連続．
    \end{description}
\end{proof}
\begin{remark}
    2$\Rightarrow$1について連続写像の定義が緩くて助かった．
\end{remark}

\begin{definition}[open covering]
    位相空間$X$の開集合の族$(U_i)_{i\in I}$が$X=\cup_{i\in I}U_i$を満たす時，$(U_i)_{i\in I}$を\textbf{$X$の開被覆}という．
\end{definition}
\begin{remark}[Riemann's esprit]
    この開被覆を調べるという方法がRiemannのespritから始まり，それを継承した岡潔が居り，層（第\ref{sec-sheaf}節）にまとまる．
    \begin{quotation}
        位相空間$X$に対し，その開被覆$(U_i)_{i\in I}$を考えると１つ１つの開集合$U_i$は元の空間$X$よりも簡単であることがよくある．そのような時に，まずそれぞれの開集合を調べて，次にそれを総合して全体の性質を調べる方法がよく使われる．
        層とそのコホモロジーは，この方法の典型的な例である．

        それぞれの開集合に注目して調べることを局所的に調べるといい，$X$全体の性質を大域的性質という．\cite{斎藤毅}
    \end{quotation}
\end{remark}

\subsection{開写像と閉写像}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=開写像と閉写像]
    $f^*$の言葉によって理解できるが，開核／閉包作用素による特徴付けが美しい．
    より代数的な定義により，開写像と閉写像とが射として活躍するはずの跡地のような寂しさを感じる．
\end{tcolorbox}

\begin{definition}[open mapping, closed mapping]
    $f:X\to Y$を写像とする．
    \begin{enumerate}
        \item 任意の開集合$U\subset X$に対して$f(U)$も$Y$の開集合になる時，$f$は\textbf{開写像}であるという．即ち，$f_*\O_X\subset \O_Y$の時である．
        \item 任意の閉集合$A\subset X$に対して$f(A)$も$Y$の閉集合になる時，$f$は\textbf{閉写像}であるという．
    \end{enumerate}
    連続写像は開写像とは限らず，開写像が連続とも限らない．$f_*=f^{*-1}$にしか言及していないからである，連続性の消息$f^*$とは即時の関係はない．
\end{definition}

\begin{remark}[open imbedding]\label{remark-open-imbedding}
    $f:X\to Y$が埋め込みで，$f(X)$が$Y$の開集合である時，$f$を\textbf{開埋め込み}という．
    \begin{enumerate}
        \item 連続単射に対して，それが開埋め込みであるための条件は，開写像であることである．なぜならば，frame morphismの言葉に翻訳すれば，$f$連続ならば$\O_X\supset f^*(\O_Y)$．$f$が開写像ならば$f_*\O_X\subset\O_Y\Leftrightarrow \O_X\subset f^*\O_Y$より，$\O_X=f^*\O_Y$．この下で$f$が単射であることが$f$が引き戻しであることに等しい．
        \item 特に$U$が$X$の開部分空間ならば，包含写像$i:U\to X$は開写像である．というより開埋め込みである．
        \item $\C$の連結な開集合上で定義された正則関数は，開写像であるか定数関数であるかのいずれかである（補題\ref{lemma-regular-then-constant-or-open}）．
    \end{enumerate}
\end{remark}

\begin{remark}[closed imbedding：双対命題]
    $f:X\to Y$が埋め込みで，$f(X)$が$Y$の閉集合である時，$f$を\textbf{閉埋め込み}という．
    \begin{enumerate}
        \item 連続単射に対して，それが閉埋め込みであるための条件は，閉写像であることである．
        \item 特に$A$が$X$の閉部分空間ならば，包含写像$i:A\to X$は閉写像である．
    \end{enumerate}
    閉写像はコンパクト空間を調べるときに重要な役割を果たす．
\end{remark}

\begin{lemma}
    積位相の特徴付け\ref{prop-characterization-product-topology}より，開写像の積は開であるが，閉写像の積は閉とは限らない．
\end{lemma}

\begin{proposition}[演算子による開／閉写像の特徴付け]\mbox{}
    \begin{enumerate}
        \item $f$が開写像であることと，$\forall A\in P(X),\;f(A^\circ)\subset f(A)^\circ$であることとは同値である．
        \item $f$が閉写像であることと，$\forall A\in P(X),\;f(\o{A})\subset \o{f(A)}$であることとは同値である．
    \end{enumerate}
\end{proposition}

\begin{theorem}
    $f:X\to Y$を開／閉な連続写像とする．
    \begin{enumerate}
        \item $f$が全射$\quad\Rightarrow\quad f$は商写像$\quad\Leftrightarrow\quad f$はsectionを持つ（final topology）．
        \item $f$が単射$\quad\Rightarrow\quad f$は埋め込み$\quad\Leftrightarrow\quad f$はretractionを持つ（initial topology）．
        \item $f$が全単射$\quad\Leftrightarrow\quad f$は同相写像．また，$f$が全単射の時，$f$が開写像であることと閉写像であることが同値で，$f$が全単射でない場合はそのどちらも一般的には成り立たない．
    \end{enumerate}
\end{theorem}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $f$が全射ならば，section $g:Y\to X$が存在して，$f\circ g=\id_Y$を満たす．
        即ち，
        ちなみに$\forall U\in P(X),\;g(U)=f^{-1}(U)$より，$f$の開閉に拘らず$g$は開写像になる．
        \item 任意の部分集合$U\subset X$について\[f(X\setminus U)\overset{単射の時}{=}f(X)\setminus f(U)\overset{全射の時}{=}Y\setminus f(U)\]
        が成り立つため，$f$が単射の時は，部分空間への同相写像となっている．
        \item $f^*\O_Y=\O_X$が成り立つため．上の関係$f(X\setminus U)=Y\setminus f(U)$は全射性と単射性のどちらか１つでも欠けると通れない．
    \end{enumerate}
\end{proof}
\begin{remarks}
    いずれの場合も，起こっている現象は$f^*\O_Y=\O_X$である．それぞれに対する表現が違うだけである．足元に誘発される場合はfinal topology，頭上に誘発される場合はinitial topology，全単射である場合は同相写像．
    この聖域は，コンパクト集合からHausdorff空間への射で起こる．
\end{remarks}

\subsection{filterへ}

\begin{problem}[一点コンパクト化の位相の構成（フィルターの言葉で）]\label{problem-construction-of-topology-in-terms-of-filter-on-onepoint-compactification}
    $Y$を位相空間，$X\subset Y$を部分空間とし，補集合は一点集合：$Y\setminus X=\{c\}$とする．$i:X\to Y$を包含写像とし，$Y$の開集合系を$\O_Y$，$X$の開集合系を$\O_X$とする．
    $\mathcal{V}:=\{i^*(U)=U\cap X\mid U\in\O_Yはcの開近傍\}$とする．
    \begin{enumerate}
        \item $\mathcal{V}$は次の２条件を満たす．
        \begin{enumerate}[(1)]
            \item (upward-closed) $U\in\O_X,V\in\mathcal{V}$について，$V\subset U\Rightarrow U\in\mathcal{V}$．
            \item (downward-directed) $(V_i)_{i\in I}$が$\mathcal{V}$の有限族ならば，$\cap_{i\in I}V_i\in\mathcal{V}$．
        \end{enumerate}
        \item 次の条件は，$c$が$Y$の孤立点でないことに同値．
        \begin{enumerate}[(1)]\setcounter{enumii}{2}
            \item (proper) $\emptyset\notin\mathcal{V}$．
        \end{enumerate}
        \item $X$が$Y$の開部分空間であることと，$Y$の開集合系が$\O_Y=\O_X\coprod\{V\coprod\{c\}\mid V\in\mathcal{V}\}$であることとが同値である．
        \item $X$を位相空間とし，$\O_X$を$X$の開集合系，$\mathcal{V}\subset\O_X$を(1),(2)を満たす部分集合とする．無縁和$Y=X\coprod\{c\}$に対して，$\O\subset P(Y)$を$\O=\O_X\coprod\{V\coprod\{c\}\mid V\in\mathcal{V}\}$と定めるとこれは$Y$の位相であることを示せ．
    \end{enumerate}
\end{problem}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item (1)は，$V\in\mathcal{V}$ならば，$V\cup\{c\}\in\O_Y$は$c$の開近傍．$V\subset U$の時，$U\cup\{c\}=(U\cup V)\cup\{c\}$も$c$の開近傍だから，$U\in\mathcal{V}$．(2)は，各$V_i\cup\{c\}$が$c$の開近傍だから，$\cap_{i\in I}(V_i\cup\{c\})=\paren{\cap_{i\in I}V_i}\cup\{c\}$も$c$の開近傍である．よって，$\cap_{i\in I}V_i\in\mathcal{V}$．
        \item $c$が$Y$の孤立点であることは，$\{c\}\in\O_Y$が$c$の開近傍であることだから，これは$\{\}\in\mathcal{V}$であることに同値．
        \item $X\in\O_Y$であるとき，$X$は開部分空間である．$X$が開部分空間であるとき，$i:X\to Y$が開埋め込みであるから，$\O_X=i^*\O_Y$であるが，$\O_Y\setminus\O_X$は全て$c$の開近傍であるから，$\O_Y\setminus\O_X=\{V\coprod\{c\}\mid V\in\mathcal{V}\}$である．
        \item $(U_i)_{i\in I}$を$\O_X$の族，$(V_j)_{j\in J}$を$\{V\coprod\{c\}\mid V\in\mathcal{V}\}$の族として，族$(W_i)_{i\in I\coprod J}:=(U_i)_{i\in I}\coprod(V_j)_{j\in J}$を考えても一般性は失われない．$\cup_{i\in I\coprod J}W_i=(\cup_{i\in I}U_i)\cup(\cup_{j\in J}V_j)$は$\mathcal{V}$の条件(1)より，$\O$の元である．同様にして有限族の共通部分についても$\O$の元であることがわかる．
    \end{enumerate}
\end{proof}

\chapter{位相空間の構成}

\begin{quotation}
    \begin{description}
        \item[生成] 
        With any kind of structure on sets, it is of interest how to “generate” such structures from a small amount of data.\cite{nLab}第１節で引き続き線型代数的な手法「生成」を定義し，そして第２節でそれを用いて距離空間の定める位相（位相の研究の母胎）を導入する．これは関数$d:X^2\to\R$が$X^2$のコンパクト部分集合上で$\min$を持つことを利用した，自然言語的に自然な使用感で使える飛び道具である．
        \item[普遍構成] 
        第３，４節で互いに双対的なUniversal Constructionである誘導位相と像位相を考える．
        これらはinitial topology inducedとfinal topology inducedと呼び分けることもある．\footnote{\url{https://ncatlab.org/nlab/show/weak+topology}}
        
        この言葉を用いると，積位相とは，付随する射である標準射影$\pr$の定める誘導位相で，商位相とは，付随する標準全射である$p$の定める像位相である．
        （標準単射$i$の定める誘導位相が相対位相なのであった）．
        言い換えれば，これらの射を連続にするような位相の中で，最も粗いもの／細かいものである（命題\ref{prop-characterization-of-continuous-mapping-in-terms-of-frame-morphism}）．\footnote{後者の像位相は，そのまま位相となるという違いがある．}
        「最低限これくらいは欲しい」という定め方であるという意味で，非常に圏論的であり，initial / final topologyはそれぞれ等化子／余等化子の概念に相等する．
        なお，有限の場合の積位相は，生成の言葉でも記述される．
        添字集合が一点集合である時は，誘導位相とは引き戻しであり，
        像位相は像位相であった（定義\ref{def-initial-and-final-topology}）．
        \item[final topology] $\cup_{i\in I}f_i^*(\O_i)$が生成する位相．集合族の積位相や，写像の空間の位相はこの例である．
        \item[initial topology] $\cap_{i\in I}f_i^{*-1}(\O_i)$という位相．集合族の商位相や，直和位相はこの例である．
    \end{description}
    これらを飼い慣らすために分離公理が考えられる．例えば最も初期に採用されていた公理がHausdorffのものである．
\end{quotation}

\section{生成される位相}

\begin{screen}
    位相空間の構成の中でも，昔ながらの代数的な定義を用いて，特に線型代数学とパラレルな手法で考えられるものを考える．
    それは，冪集合の部分集合$\U$が$\cap,\cup$-生成する位相（＝$\U$を含む最も粗い位相）である（命題\ref{prop-generated-topology}），まさに線型空間の部分集合が生成する部分空間とanalogousである．
    \textbf{開集合にしたい集合を指定することで自動で位相が定まる算譜が存在する}．
    命題\ref{prop-generated-topology}.2より，確かに部分空間のような序列を保っている．
    また，準基について開集合の条件が満たされれば，写像全体が連続であることがわかる（命題\ref{prop-continuity-is-determined-by-subbasis}）．この手法も特に線型写像っぽい．
\end{screen}

\subsection{開基}

\begin{proposition}[$\cap,\cup$-生成]\label{prop-generated-topology}
    $X$を集合，$\U\subset P(X)$を部分集合とする．
    \begin{enumerate}
        \item 次のように定めた$\O_\U\subset P(X)$は$X$の位相であり，$\U\subset\O_\U$を満たす：\[ \O_\U:=\left\{U\in P(X)\;\middle|\;\begin{array}{l}x\in Uならば，\U の元の有限族(U_i)_{i\in n}で\\x\in\cap_{i\in n}U_i\subset Uを満たすものが存在する\end{array}\right\}. \]
        \item $X$の位相$\O$について，次の２条件は同値．\begin{enumerate}[(1)]
            \item $\O_\U$は$\O$より粗い：$\O_\U\subset\O$．
            \item $\U\subset\O$である．
        \end{enumerate}
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] 
        $\O_\U$が開集合の公理の特徴付け（命題\ref{prop-characterization-of-open-sets}）(1'),(2')を満たすことを示す．
        \begin{enumerate}
            \item ある部分集合$U\subset X$が$\forall x\in U,\;\exists V\in\O_\U,\;x\in V\subset U$を満たすとする．この時，$\U$の有限族$(U_i)_{i\in n}$で，$x\in\cap_{i\in n}I_i\subset V\subset U$を満たすものが存在する．よって，$U\in\O_\U$でもある．
            \item 任意に$x\in X$を取ると，$\U$の空な族について$x\in\cup_{i\in 0}U_i=X\subset X$より，$X\in\O_\U$．次に，$x\in U\cap V$を任意に取る．$x\in U$より，$x\in\cap_{i\in n}U_i\subset U$，$x\in V$より，$x\in\cap_{i\in m}V_i\subset V$を満たす$\U$の族$(U_i)_{i\in n},(V_i)_{i\in m}$が存在する．これについて，$\U$の族を$(W_i)_{i\in n+m}$を$W_i=U_i(i\in n), W_i=V_{i-n}(n\le i\le m-1)$と定めれば，$x\in\cap_{i\in n+m}W_i=\cap_{i\in n}U_i\cap\cap_{i\in m}V_i\subset U\cap V$が成り立つ．よって，$U\cap V\in\O_\U$．
        \end{enumerate}
        \item[2.] $\Rightarrow$は$\U\subset\O_U\subset\O$より．$\Leftarrow$を示す．
        $\U\subset\O$とする．$U\in\O_\U$は，任意の$x\in U$について，$\cap_{i\in n}U_i\in\O$が存在して$x\in\cap_{i\in n}U_i\subset U$が成り立つから，開集合の公理の特徴付け（命題\ref{prop-characterization-of-open-sets}）より，$U\in\O$．よって，$\O_\U\subset\O$．
    \end{description}
\end{proof}

\begin{definition}[generated topology, subbasis]\label{def-subbasis}
    $X$を集合とする．
    \begin{enumerate}
        \item $\U\subset P(X)$に対し，命題\ref{prop-generated-topology}で定まる位相$\O_\U$を，\textbf{$\U$によって生成される位相}という．
        \item $\O$が$\U$によって生成される時，$\U$を$\O$の\textbf{準基}であるという．$\U$が$\O$の基底ならば，準基である．
    \end{enumerate}
\end{definition}

\begin{example}[生成される位相として定義される位相の例]\mbox{}
    \begin{enumerate}
        \item $X$の離散位相とは，$\U:=\{\{x\}\mid x\in X\}$が生成する位相である．自明なフィルターの基．
        \item $X$の密着位相とは，$\U=\emptyset$が生成する位相である．
        \item $\S$の位相は，$\U=\{\{1\}\}\subset P(2)$が生成する位相である．
        \item （距離位相）$\R^n$の位相は，$\U=\{U_r(x)\mid x\in\R^n,r\in(0,\infty)\}$が生成する位相である．
        \item 他に，積位相，compact-open位相も生成の言葉で定義される．
    \end{enumerate}
\end{example}

\begin{proposition}[準基の特徴付け：$\cap,\cup$-生成元である]
    $\O$を$X$の位相とすると，次は同値．
    \begin{enumerate}
        \item $\U$は$\O$の準基である．
        \item $\O$に属する任意の開集合は，$\U$の\textbf{有限個の}共通部分の合併として表せる．
    \end{enumerate}
    \cite{nLab}では1の方をrecognition of topological basesとしている．
\end{proposition}

\begin{proposition}[準基について連続ならば大域的に連続である]\mbox{}\label{prop-continuity-is-determined-by-subbasis}
    \begin{enumerate}
        \item $X$を集合とし，$\U$を冪集合$P(X)$の部分集合とする．$\O_\U$を$\U$が生成する位相とし，$X$を$\O_\U$によって位相空間と考える．この時，任意の位相空間$T$と任意の写像$f:T\to X$について，次の２条件は同値．
        \begin{enumerate}[(1)]
            \item $f$は連続である．
            \item 任意の$U\in\U$に対し，逆像$f^{-1}(U)$が$T$の開集合である．
        \end{enumerate}
        \item $\R$の位相は，合併$\{(-\infty,t)\mid t\in\R\}\cup\{(t,\infty)\mid t\in\R\}$が生成する位相である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $X$に$f:T\to X$により定まる像位相を$\O$とすると，命題\ref{prop-characterization-of-continuous-mapping-in-terms-of-frame-morphism}.1より，(1)は$\O_U\subset\O$に同値．(2)は$\U\subset\O$に同値だから，命題\ref{prop-generated-topology}より従う．
        \item $\R$の位相を$\O$とし，$\U:=\Brace{(-\infty,t)\subset\R\mid t\in\R}\cup\Brace{(t,\infty)\subset\R\mid t\in\R}$とすると，$\U\subset\O$より，$\O_\U\sbs\O$だから，$\O\sbs\O_\U$を示せば良い．
        任意の$U\in\O$の任意の点$x\in U$について，$x\subset V\subset U$を満たす$V\in\O_\U$を構成すれば良いが，$\exists_{r>0}\;x\in U_r(x)=(-\infty,x+r)\cap(x-r,\infty)\subset U$より，$V:=U_r(x)\in\O_\U$とすれば良い．
    \end{enumerate}
\end{proof}
\begin{remarks}
    $\R$の開基である開球の系が作り出せる開集合族は全て準基になる．
\end{remarks}

\subsection{上半連続と右連続}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    生成する位相の言葉によって定義できる連続性のクラスに，上半連続と右連続がある．
    最初は極めて技巧的に感じる．
    確率変数の集合のうち，特に重要なクラスはこのような半連続性で特徴付けられる．
    その理由は，特性関数との相性の良さ故かもしれない\ref{exp-upper-semi-continuous}．
    また，$(t,\infty)$は下半連続の位相の準基であるが，この補集合$(-\infty,t]$上に定まる関数が累積分布関数であった．
    $(t,\infty)$はBorelクラス$\B(\R)$を生成する．
\end{tcolorbox}

\begin{definition}[upper semi-continuous, right continuous]
    \begin{align*}
        \U&=\{(-\infty,t)\in P(\R)\mid t\in\R\},&\mathcal{V}&=\{[s,t)\in P(\R)\mid s,t\in\R\},
    \end{align*}
    が生成する位相によって$\R$を位相空間と考えたものをそれぞれ$\R_\U,\R_\mathcal{V}$で表す．なお，$\U$で生成される位相は，空の族についての条件のみが加算されて$\U\cup\{\R,\emptyset\}$である．
    $X$を位相空間とする．
    \begin{enumerate}
        \item 関数$f:X\to\R_\U$が連続である時，$f$は\textbf{上半連続}であるという．
        \item $A$を$\R_\mathcal{V}$の部分空間とし，$a\in A$とする．写像$f:A\to X$が$a$で連続である時，$f$は$a$で\textbf{右連続}であるという．
    \end{enumerate}
\end{definition}
\begin{example}\label{exp-upper-semi-continuous}
    閉集合$F\subset X$について，$\chi_F:X\to2\to\R$は上半連続であり，
    開集合$G\osub X$について，$\chi_G:X\to2\to\R$は下半連続である．
\end{example}

\begin{lemma}[上半連続性の特徴付け]
    関数$f:X\to\R_\U$について，
    \begin{enumerate}
        \item $f$は上半連続である．
        \item 任意の$a\in X$と任意の$r>0$について，開近傍$a\in U\osub X$が存在して，$U\subset\Brace{x\in X\mid f(x)<f(a)+r}=f^{-1}((-\infty,f(a)+r))$を満たす．%すなわち，$f(U)\subset(-\infty,f(a)]$を満たす．
        \item 任意の$a\in X$について，$\limsup_{x\to a}f(x)\le f(a)$が成り立つ．
    \end{enumerate}
    ただし，位相空間$(X,\O)$において$\limsup_{x\to a}f(x):=\lim_{a\in G\in\O}\sup_{x\in G}f(x)$と定めた．
\end{lemma}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] 
        任意の$a\in X,r>0$について，$(-\infty,f(a)+r)$は$\R_\U$の開集合であるから，$f^{-1}(-\infty,f(a)+r)$は$a$の開近傍である．
        \item[(2)$\Rightarrow$(1)]
        任意の$t\in\R$について，$f^{-1}((-\infty,t))$が開と示せば良い．任意の$a\in f^{-1}((-\infty,t))$について，$r>0$が存在して$t=f(a)+r$が成り立つから，$a\in U\subset f^{-1}((-\infty,t))$を満たす開集合$U\osub X$が存在する．
        \item[(2)$\Leftrightarrow$(3)] 実質定義．
    \end{description}
\end{proof}

\begin{corollary}
    $X$を位相空間とする．関数$f:X\to\R$に対して次の条件は同値．
    \begin{enumerate}
        \item $f$は連続．
        \item $f$は上半連続かつ下半連続．
    \end{enumerate}
\end{corollary}
\begin{proof}
    命題\ref{prop-continuity-is-determined-by-subbasis}(2)より，$\U:=\Brace{(-\infty,t)\subset\R\mid t\in\R}\cup\Brace{(t,\infty)\subset\R\mid t\in\R}$は$\R$の準基だから，どちらも「$\Brace{x\in X\mid f(x)<t}$と$\Brace{x\in X\mid f(x)>t}$が$X$の開集合である」ことに同値である．
\end{proof}

\begin{proposition}[上半連続性の遺伝]
    $(f_i)_{i\in I}$を上半連続関数$f_i:X\to\R$の族とし，任意の$x\in X$に対して$\inf_{i\in I}f_i(x)\in\R$が存在するとする．関数$f:X\to\R$を$f(x):=\inf_{i\in I}f_i(x)$と定めると，$f$も上半連続である．
\end{proposition}
\begin{proof}
    \[f^{-1}((-\infty,t))=\Brace{x\in X\mid \inf_{i\in I}f_i(x)<t}=\bigcup_{i\in I}\Brace{x\in X\mid f_i(x)<t}\]
    より．
    \begin{align*}
        \inf_{i\in I}f_i(x)<t&\Leftrightarrow \forall_{y\in\R}\;[(\forall_{i\in I}\;y\le f_i(x))\Rightarrow y<t]\\
        &\Leftrightarrow \forall_{y\in\R}[y\ge t\Rightarrow\exists_{i\in I}\;y\ge f_i(x)]\\
        &\Leftrightarrow \exists_{i\in I}\;t>f_i(x).
    \end{align*}
    より．
\end{proof}

\section{距離空間とノルム空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    任意の２点間に実数的な構造を埋め込める時，距離が入るという．豊穣圏の発想である．\footnote{距離空間の理論は，豊穣圏の理論の特殊化であることを暴き出した概念がLawvere metric space．特に完備化．}
    $\R$の構造に引き戻すことで，人間にとって理解可能にする技法．

    確率変数の終域は一般に距離空間上で考えられる．
    関数空間の解析も距離を導入してなされることが多い．
\end{tcolorbox}

\subsection{距離の定義と例}

\begin{definition}[metric space, metric topology]
    $X$を集合とする．
    \begin{enumerate}
        \item 関数$d:X\times X\to[0,\infty)$が次の３条件を満たす時，$d$は$X$の\textbf{距離(metric)}であるという．
        \begin{enumerate}[(1)]
            \item (separation) $\forall x,y\in X,\; d(x,y)=0\Rightarrow x=y$．
            \item (point inequality) $\forall_{x\in X}\;0\ge d(x,x)$．
            \item (symmetry) $\forall x,y\in X,\; d(x,y)=d(y,x)$．
            \item (triangle inequality) $\forall x,y,z\in X,\; d(x,z)\le d(x,y)+d(y,z)$．
        \end{enumerate}
        \item $d$を$X$の距離とする．$a\in X,r\in\R_{>0}$に対し，$U_r(a):=\{x\in X\mid d(x,a)<r\}$と定め，\textbf{開球}と呼ぶ．開球からなる$P(X)$の部分集合$\{U_r(x)\mid x\in X,r>0\}$が生成する位相を，\textbf{$d$が定める位相}という．
        \item $X$の部分集合$A$が有界であるとは，$\R$の部分集合$\{d(x,y)\in\R\mid x,y\in A\}$が有界であることをいう．$A$が有界である時，$d(A):=\sup_{x,y\in A}d(x,y)\in [0,\infty)$と定め，\textbf{$A$の直径}という．
        \item $d_1,d_2$はいずれも$X$の距離とする．$d_1,d_2$が$X$に同じ位相を定める時，$d_1,d_2$は\textbf{同値}であるという．
    \end{enumerate}
    $X$とその上の距離$d$の組$(X,d)$を\textbf{距離空間}という．
\end{definition}

\begin{example}[discrete metric, $L^1$-距離，$L^\infty$-距離]\mbox{}
    \begin{enumerate}
        \item 任意の集合$X$に対し，$X\times X\setminus\Delta_X$の特性関数は$X$の距離である．これが定める$X$の位相は離散位相である．
        \item $X=C([0,1])$とする．\begin{align*}
            d_\infty(f,g)&=\max_{x\in[0,1]}|f(x)-g(x)|,&d_1(f,g)&=\int^1_0|f(x)-g(x)|dx
        \end{align*}と置くと，これらはいずれも$X$の距離を定める．$d_1(f,g)\le d_\infty(f,g)$より，$d_\infty$の定める位相$\O_\infty$は$d_1$の定める位相$\O_1$より細かいことが従う．
        実はこの２つは等しくなく，$d_1,d_\infty$は同値ではない．
    \end{enumerate}
\end{example}

\subsection{距離位相の取り扱い}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    metric topologyでは，開球が開基となる．
    従って，この代数的な言葉を用いて開集合が完全に特徴付けられる．
    $\epsilon$-$\delta$論法とは，「基本系の行き先が決まれば，写像が連続と決まる」代数的現象を言っている．
    集合の$\cup,\cap$-代数としての構造を，球に注目することで支配したのである！

    最後に，$\exists c>0,\; d_Y(f(x),f'(x))\le c\cdot d_X(x,x')$という連続性よりも強い条件(Lipschitz連続性)に移行して，
    距離空間の射を定義する．
\end{tcolorbox}

\begin{proposition}[距離空間での開集合の特徴付け：開球の方法]\label{prop-open-balls-is-basis}
    $X$を距離空間とする．部分集合$U\subset X$について，次の２条件は同値．
    \begin{enumerate}
        \item $U$は距離$d$が定める位相について，$X$の開集合である．
        \item $x\in U$ならば，$U_r(x)\subset U$を満たす実数$r>0$が存在する．
    \end{enumerate}
\end{proposition}
\begin{proof}
    「距離$d$が定める位相」とは，定義より，$\{U_r(x)\mid r>0,x\in X\}$を準基として生成する位相であるから，
    2$\Rightarrow$1は成り立つ．1$\Rightarrow$2について．
    1が成り立つ時，$X$の開球の有限族$(U_{r_i}(x_i))_{i\in n}$が存在して，
    $\cap_{i\in n}U_{r_i}(x_i)\subset U$を満たす．
    いま，特に$r_0-d(x,x_0),\cdots,r_{n-1}-d(x,x_{n-1})>0$が成り立つから，
    $r=\min\{r_0-d(x,x_0),\cdots,r_{n-1}-d(x,x_{n-1})\}$とすれば，
    $U_r(x)\subset\cap_{i\in n}U_{r_i}(x_i)\subset U$．
\end{proof}

\begin{proposition}[$\epsilon$-$\delta$論法]\label{prop-epsilon-delta-conditioin-on-basis}
    $X,Y$を距離空間とし，$f:X\to Y$を写像とする．$a\in X$について，次の２条件は同値である．
    \begin{enumerate}
        \item $f$は$a$で連続．
        \item $\forall q\in\R_{>0},\;\exists r\in\R_{>0},\;f(U_r(a))\subset U_q(f(a))$．
    \end{enumerate}
\end{proposition}
\begin{proof}
    $\U_a=\{U_r(a)\mid r>0\},\mathcal{V}_b=\{U_r(b)\mid r>0\}$はいずれも$a\in X,b\in Y$の開近傍の基本系だから，
    命題\ref{prop-continuity-is-determined-by-subbasis}より従う．
\end{proof}
\begin{remark}
    この$\epsilon$-$\delta$論法は要は可換図式だよな？$=$でなく$\cup$なのは「圏同値」なのを許しているからだ．
    \[\xymatrix{
        &f(U_r(a))\\
        U_r(a)\ar[ur]^-{f_*}&U_q(b)\ar@{^{(}->}[u]\\
        \{a\}\ar@{^{(}->}[u]&\{b\}\ar@{^{(}->}[u]
    }\]
\end{remark}

\begin{corollary}[Lipschitz連続性：距離空間の射への移行]\mbox{}\label{cor-characterization-distance-function}
    \begin{enumerate}
        \item $d_X,d_Y$を距離空間$X,Y$の距離とし，$f:X\to Y$を写像とする．実数$c>0$であって，任意の$x,x'\in X$に対して，$d_Y(f(x),f'(x))\le c\cdot d_X(x,x')$を満たすものが存在するならば，$f$は連続である．
        \item $d_1,d_2$を$X$の距離とする．実数$c_1,c_2>0$であって，任意の$x,y\in X$に対して$c_1\cdot d_1(x,y)\le d_2(x,y)\le c_2\cdot d_1(x,y)$を満たすものがあれば，$d_1,d_2$は同値である．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $c>0$に対して，$r=q/c$と置けば，任意の$q$に対して$d_X(x,x')<r\Rightarrow d_Y(f(x),f(x'))\le c\cdot d_X(x,x')<q$が$\forall x\in X$について成り立つ．命題\ref{prop-epsilon-delta-conditioin-on-basis}より$f$は連続．
        \item $d_2(x,y)\le c_2\cdot d_1(x,y)$部と1より，$\id_X:(X,d_1)\to(X,d_2)$は連続写像である．同様に$1/c_1>0$より，$\id_X:(X,d_2)\to(X,d_1)$より，$(X,d_1),(X,d_2)$は同相である．
    \end{enumerate}
\end{proof}
\begin{remarks}
    (2)の証明に(1)(Lipschitz定数が存在するならば連続)を用いるとは，あまりにうますぎる．息を飲むばかりだ．
\end{remarks}

\begin{definition}[点と集合の距離]
    $\emptyset\ne A\subset X$を空でない部分集合とする．
    \[ d(x,A):=\inf_{a\in A}d(x,a)\in[0,\infty)\;\;\;(x\in X) \]
    と置き，この写像$d(-,A):X\to\R$を点$x$の$A$からの距離という．
\end{definition}

\begin{proposition}[閉包の距離関数による特徴付け]\label{prop-characterization-of-closure-in-terms-of-metric-function}
    $d(-,A):X\to\R$を$\emptyset\ne A\subset X$からの距離とする．
    \begin{enumerate}
        \item $|d(x,A)-d(y,A)|\le d(x,y)$が成り立つ．また関数$d(-,A):X\to\R$は連続である．
        \item $\overline{A}=\{x\in X\mid d(x,A)=0\}$である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 三角不等式より，\[\forall x,y\in X,\forall a\in A,\;d(x,a)\le d(x,y)+d(y,a)\]
        である．両辺の下限をとって，$d(x,A)\le d(x,y)+d(y,A)\Rightarrow d(x,A)-d(y,A)\le d(x,y)$．同様に$d(y,A)-d(x,A)\le d(x,y)$も成り立つから，$|d(x,A)-d(y,A)|=\max\{d(x,A)-d(y,A),d(y,A)-d(x,A)\}\le d(x,y)$．
        すると，$d_\R=|xーy|$に注意して，系\ref{cor-characterization-distance-function}.1より，$d(-,A):X\to\R$は連続．
        \item $\overline{A}=\{x\in X\mid \forall r>0,\;U_r(x)\cap A\ne 0\}$より．
    \end{enumerate}
\end{proof}


\subsection{距離空間の圏Met}

\begin{definition}[Met]
    Lawvere距離空間とshort mapの圏を$\Met$で表し，通常の距離空間のなす充満部分圏を$\Met_\ord$で表す．
\end{definition}

\begin{definition}[isometry, global isometry]\mbox{}
    \begin{enumerate}
        \item $(X,d_X),(Y,d_Y)$を距離空間とする．写像$f:X\to Y$が$d_X=f^*d_Y$，すなわち，
        $\forall x,x'\in X,\; d_Y(f(x),f(x'))=d_X(x,x')$を満たす時，これを\textbf{等長写像}という．
        \item 等長写像が全単射であり，逆写像も等長写像であるとき，\textbf{大域的等長写像}という．
    \end{enumerate}
\end{definition}
\begin{remark}
    距離空間の等長写像は全単射とは限らないが，必ず単射ではある．
    距離空間の等長写像は全単射ならば必ず大域的である（Metの射の可逆性はSetの射としての可逆性に一致）．
    しかし，Riemann多様体では同様のことは成り立たず，全単射等長写像と大域的等長写像は違う概念となる．
\end{remark}

\begin{definition}[部分距離空間]
    $A\subset X$について，$d:X\times X\to\R$の$A\times A$への制限によって距離空間と考えたものを$X$の\textbf{部分距離空間}という．
\end{definition}

\begin{proposition}[部分距離空間のwell-definedness]\label{prop-部分距離空間のwell-definedness}\mbox{}
    \begin{enumerate}
        \item $f:X\to Y$が等長写像ならば，$f$は埋め込みである．
        \item 部分距離空間$A\subset X$の定める位相は，$X$の部分位相としての$A$の位相と等しい．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 系\ref{cor-characterization-distance-function}より，$f$は特に連続である．
        また，$f(x)=f(x')$とすると，$d_X(x,x')=d_Y(f(x),f(x'))=0$だから，$x=x'$が従うので$f$は単射である．
        あとは$f^*\O_Y=\O_X$を示す．連続性より，$f^*\O_Y\supset\O_X$を示せば良い．
        $f$の連続性より，$\U_X\subset f^*\U_Y\subset f^*\O_Y$．命題\ref{prop-generated-topology}より$\O_X\subset f^*\O_Y$が従う．
        \item 包含写像$i:A\to X$は等長写像だから，埋め込みである．よって，$i:A\to X$は部分距離空間の$A$と部分空間$A$は同相である．
    \end{enumerate}
\end{proof}
\begin{remark}
    包含写像$A\to X$は等長写像であり，埋め込みである．
    これで，$\Met$は$\Top$の部分圏であるとわかる．
\end{remark}

\begin{proposition}
    $\Met$は完備である．
\end{proposition}
\begin{remark}
    しかし，$\Met_\ord$は完備でなく，例えば可算積については閉じているが，任意の積については閉じていない．これが距離付け可能な位相空間にも尾を引いている\ref{subsec-metrizable-spaces}．
\end{remark}

\begin{proposition}
    忘却関手$\Ban\to\Met$は忠実である．ただし，$\Ban$はBanach空間とshortな線型作用素とがなす圏とした．
\end{proposition}

\subsection{関数空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    関数の空間にも，ノルムが定める距離と，それが定める位相が入るので，幾何的に扱うことが出来るようになる．
    歴史的にはこのことが，位相の研究の源の一つになった．
    \begin{quotation}
        有界関数の空間には，上限ノルムによって一様収束位相が定まる．
        有界連続関数のなす部分ノルム空間は，一様収束位相に関して閉集合である．
    \end{quotation}
\end{tcolorbox}

\begin{definition}[normed space]
    $V$を実線型空間とする．関数$\|\;\;\|:V\to\R$が次の３条件を満たす時，$\|\;\;\|$は$V$の\textbf{ノルム}であるという．
    \begin{enumerate}
        \item $\forall x\in V,\; \|x\|\ge 0$．（ただし，等号成立条件は$x=0$）．
        \item $\forall x\in V,a\in\R,\; \|ax\|=|a|\|x\|$．
        \item $\forall x,y\in V,\;\|x+y\|\le\|x\|+\|y\|$．
    \end{enumerate}
    組$(V,\|\;\;\|)$を\textbf{ノルム空間}といい，$d(x,y):=\|x-y\|$を\textbf{ノルムが定める距離}という．
\end{definition}
\begin{remark}
    $V$が有限次元ならば，ノルムの定める距離は全て等しいが（だから線形代数学では位相の議論は表に出てこない），無限次元の時にはそうとは限らない．
\end{remark}

\begin{example}[uniform norm / $L^\infty$-norm, compact-open topology, $L^1$-norm]\label{exp-uniform-norm}
    集合$X$上の実数値関数全体の集合$\Map(X,\R)$のうち，有界な実数値関数全体のなす部分線型空間を
    \[ \widetilde{B}(X):=\{f\in\Map(X,\R)\mid fは有界\} \]
    と置く．
    \begin{enumerate}
        \item $\widetilde{B}(X)$上に定まるノルム\[\|f\|_\infty:=\sup_{x\in X}|f(x)|\in[0,\infty]\]を\textbf{上限ノルム}または\textbf{一様ノルム}という．このノルムについて関数列が収束することと，その収束が（広義）一様収束であることとが同値だからである．
        一様ノルム$\|\;\;\|_\infty$が定める$\widetilde{B}(X)$の位相を\textbf{一様収束位相}または\textbf{コンパクト開位相}という．コンパクト集合を開に移す写像が開となる最弱の位相だからである．
        また，特に$X=\N$の時，この$\R^\N$の部分空間を$l^\infty$と表す．
        \item $X$を位相空間とすると，共通部分$B(X):=\widetilde{B}(X)\cap C(X)$は上限ノルムの制限により，部分ノルム空間となる．
        \item $\|f\|_1:=\int^1_0|f(x)|dx$で定まる$C([0,1])$のノルムを，\textbf{$L^1$-ノルム}という．
    \end{enumerate}
\end{example}

\begin{lemma}
    $(f_n)$をコンパクト開位相空間$C([0,1])$上の関数列とする．次の３条件は同値である．
    \begin{enumerate}
        \item $\exists_{f\in C([0,1])}\;\lim_{n\to\infty}d(f,f_n)=0$．
        \item $\exists_{f\in C([0,1])}\;f_n\text{は}n\to\infty\text{について一様収束}$．
        \item $(f_n)$は$d$についてCauchy列である．
    \end{enumerate}
\end{lemma}

\begin{proposition}[有界連続関数のなす部分空間は，一様収束位相に関して閉集合である]\label{prop-有界連続関数のなす部分空間は，一様収束位相に関して閉集合である}
    $X$を位相空間とし，$\widetilde{B}(X)$を上限ノルムによりノルム空間と考える．
    $B(X):=\widetilde{B}(X)\cap C(X)$は，$\widetilde{B}(X)$の閉部分空間である．
\end{proposition}
\begin{proof}
    $f\in\overline{B(X)}$を任意に取ると，これが連続であることを示すことで，$\overline{B(X)}=B(X)$より結論を導く．
    いま，任意の$g\in B(X)$と$x,a\in X$に対して，
    \begin{align*}
        |f(x)-f(a)|&\le |f(x)-g(x)|+|g(x)-g(a)|+|g(a)-f(a)|\\
        &\le 2\|f-g\|_\infty+|g(x)-g(a)|
    \end{align*}
    と評価できることに注意．任意にとった$q>0$に対して，$g\in B(X)\cap U_{q/2}(f)(\ne\emptyset)$と，$r:=q-2\|f-g\|_\infty>0$と取れば（$f\in\overline{B(X)}$より），上述の評価は
    \begin{align*}
        \forall x\in g^{-1}(U_r(g(a)))&\\
        |f(x)-f(a)|&\le 2\|f-g\|_\infty+|g(x)-g(a)|\\
        &<2\|f-g\|_\infty+r=q
    \end{align*}
    のように応用できる．つまり，$g^{-1}(U_r(g(a)))\subset f^{-1}(U_q(f(a)))$を得た．
    基底についてこれが成り立つのだから，$f$は連続である（命題\ref{prop-continuity-is-determined-by-subbasis}）．
\end{proof}

\subsection{距離空間概念の一般化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Lawvere距離空間の観点からすると，short mapが正確にenriched functorとなる．
    これが，Metの射は連続写像でも，一様連続写像でもなくて，short mapが圏論的には良さそうだという指針になる．
\end{tcolorbox}

\begin{definition}[extended, pseudo-, quasi-, Lawvere]\mbox{}
    \begin{enumerate}
        \item 距離関数$d$の終域を$d:X\to[0,\infty]$としたものを，\textbf{拡大距離空間}という．終域を一般の有向集合とすると，一様空間の概念を得る．
        \item 公理(1) Separationを除いたものを，\textbf{擬距離}（または半距離）という．関数空間上の半ノルムが生成する．擬距離が距離であることと，生成する位相が$T_0$であることは同値．
        \item 公理(3) Symmetryを除いたものを，\textbf{準距離}という．\footnote{一方通行や坂道の概念など，日常にはありふれている距離概念である．}
        \item 擬距離であり，準距離でもある拡張距離空間を，\textbf{Lawvere距離空間}という．
    \end{enumerate}
\end{definition}

\begin{lemma}
    Lewvere距離空間$M$は，順序集合$([0,\infty],\le)$を加法$+$によってモノイド圏とみなして，この上の豊穣圏とみなせる．
    順序集合自体が$2$を積$\cdot$によってモノイド圏とみなした上の豊穣圏とみなせるから，$M$での射の合成は三角不等式と一致する．\footnote{Thus generalized, many constructions and results on metric spaces turn out to be special cases of yet more general constructions and results of enriched category theory. }
\end{lemma}

\section{積位相と誘導位相}

\subsection{積位相の定義}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=積位相とは，開集合の積が$\cup$-生成するもの]
    積位相を生成の言葉で定義し，族の積位相を定義する際に圏論的なものに移行する．
    特徴付けは，開集合の積の族はすでにdownward-directedであるために，これが基底になることである．
    すると，誘導位相という極めて普遍的な圏論的構成法が見えてくる．
\end{tcolorbox}

\begin{definition}[product topology, product space]
    $(X,\O_X),(Y,\O_Y)$を位相空間とする．$\mathcal{U}=\{U\times V\mid U\in\O_X,V\in\O_Y\}$によって生成される$X\times Y$の位相$\O_\U$を，$X\times Y$の\textbf{積位相}といい，位相空間$(X\times Y,\O_\mathcal{U})$を\textbf{積空間}という．
\end{definition}
\begin{remarks}\label{remarks-cup-onliness-of-product-topology}
    例えば$(-1,1)\times(-1,1)\subset\R^2$は$U\times V$の形であるが，$U_1(0)\subset\R^2$などはそうではない．
    このような分を，$\cup$演算によって生成する必要がある．$\cap$演算の必要はない（$\U$が基底である）ことが次の命題からわかる．
\end{remarks}

\begin{proposition}[積の普遍性：積位相の基底，積写像と射影の連続性への現れ]\label{prop-characterization-product-topology}
    $X,Y$を位相空間とする．
    \begin{enumerate}
        \item 部分集合$W\subset X\times Y$について，次の２条件は同値．（即ち，$\mathcal{U}$は積位相$\O_\U$の基底である(downward-directed)）．
        \begin{enumerate}[(1)]
            \item $W$は積位相に関して開集合である．
            \item $W$の任意の点$(x,y)$に対して，$x$の開近傍$U$と$y$の開近傍$V$であって，$U\times V\subset W$を満たすものが存在する．
        \end{enumerate}
        \item 任意の位相空間$T$と任意の写像$f:T\to X,g:T\to Y$に対し，次の２条件は同値．
        \begin{enumerate}[(1)]
            \item 積写像$(f,g):T\to X\times Y$が連続である．
            \item $f:T\to X,g:T\to Y$がそれぞれ連続である．
        \end{enumerate}
        \item 射影$\pr_1:X\times Y\to X,\pr_2:X\times Y\to Y$は連続な開写像である．
        \item $f:X\to Y$が連続写像ならば，積写像$g=(1,f):X\to X\times Y$は埋め込みである．$g$の値域は$f$のグラフ$\Gamma_f\subset X\times Y$である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $W\in\O_\U$とは，任意の点$(x,y)\in W$に対して，$X\times Y$の開近傍の族$(U_i\times V_i)_{i\in n}$であって，$(x,y)\in\bigcap_{i\in n}U_i\times V_i\subset W$を満たすものが存在することをいう．いま，$\bigcap_{i\in n}U_i\times V_i=\cap_{i\in n}U_i\times\cap_{i\in n}V_i$より，$\cap_{i\in n}U_i\in\O_X,\cap_{i\in n}V_i\in\O_Y$であるから(2)が導かれ，逆はすぐに成り立つ．
        \item 命題\ref{prop-continuity-is-determined-by-subbasis}より，積空間$X\times Y$への積写像$(f,g):T\to X\times Y$が連続であるための必要十分条件は，$X\times Y$の積位相の基底（特に準基）$U\times V\;(U\in\O_X,V\in\O_Y)$について，$(f,g)^{-1}(U\times V)$が開集合であることである．実は，
        \begin{equation}
            (f,g)^{-1}(U\times V)=f^{-1}(U)\cap g^{-1}(V)
        \end{equation}
        実際，$s\in(f,g)^{-1}(U\times V)$を取ると，$(f,g)(s)=(f(s),g(s))\in U\times V$よって，$f(s)\in U,g(s)\in V$より$s\in U\cap V$．
        逆に$t\in f^{-1}(U)\cap g^{-1}(V)$とすると，$f(t)\in U\land g(t)\in U$．よって，$(f,g)(t)=(f(t),g(t))\in U\times V$だから，$t\in (f,g)^{-1}(U\times V)$．
        よって，(2)$\Rightarrow$(1)はすぐに従う．$V=Y$に固定して考えると$f$が連続，$U=X$に固定して考えると$g$が連続であることが従うから(1)$\Rightarrow$(2)もわかる．
        \item 積写像$(\id_X,\id_Y):X\times Y\to X\times Y$について2より，$\pr_1,\pr_2$は連続とわかる．$W\subset X\times Y$を開集合とする．基底の特徴付け（補題\ref{lemma-characterization-of-basis}）より，$W=\cup_{i\in I}(U_i\times V_i)=\cup_{i\in I}U_i\times\cup_{i\in I}V_i$となる$X,Y$の開集合の族$(U_i)_{i\in I},(V_i)_{i\in I}$が存在する．よって，$\pr_1(W)=\cup_{i\in I}U_i\in\O_X,\pr_2(W)=\cup_{i\in I}V_i\in\O_Y$より，それぞれ開写像．
        \item 写像$1,f$は連続だから，2より$g=(1,f)$も連続．射影$\pr_1:X\times Y\to X$はこれに対する連続なretractionだから，命題\ref{prop-split-epi-then-imbedding}より$g$は埋め込みである．
    \end{enumerate}
\end{proof}
\begin{remark}\mbox{}
    積の普遍性が，位相の言葉にどう現れるかについての命題であった．例えば2の結果はあまりに自明だと思っていたが，証明は補題\ref{lemma-preimage-and-product}が必要で，一癖あった．
    \begin{enumerate}
        \item 1より$\U$が積位相の基底であるから，$\{U\times V\mid U\in\U_x,V\in\mathcal{V}_x\}$が$(x,y)\in X\times Y$の開近傍の基本系になることが従う．これより，$A,B$をそれぞれ$X,Y$の部分空間とすると，$A\times B$は$X\times Y$の部分空間になる．もっと形式化できないか？
        \item $\pr_1\circ(f\times g)=f\circ\pr_1$と$\pr_2\circ(f\times g)=g\circ\pr_2$は連続だから，積写像$(\pr_1\circ(f\times g),\pr_2\circ(f\times g))=f\times g$も連続である．\[\xymatrix{
            X\ar[r]^-f&X'\\
            X\times Y\ar[u]^-{\pr_1}\ar[d]_-{\pr_2}\ar[r]^-{f\times g}&X'\times Y'\ar[d]^-{\pr_2}\ar[u]_-{\pr_1}\\
            Y\ar[r]_-g&Y'
        }\]
        \item 2は標準写像$C(T,X\times Y)\to C(T,X)\times C(T,Y)$が可逆であることを言っている．これを\textbf{積空間の普遍性}という．これの事実自体は今回の証明と全く別経路で得られそうなものである．この普遍構成はなんだ？
        \item 射影は閉写像とは限らない．任意の位相空間$Y$に対して射影$\pr_2:X\times Y\to Y$が閉写像となるような位相空間$X$をコンパクト空間という．
    \end{enumerate}
\end{remark}

\subsection{距離空間の積位相}

\begin{screen}
    距離空間の積位相は，距離関数の言葉で翻訳しておくのが良い．
    （$\R^2$の開集合系の基底$\{U_r(x)\}_{x\in\R^2,r\in\R_{>0}}$は$\R\times\R$の積位相であると見た時自明ではない$U_r(x,y)\ne U_r(x)\times U_r(y)$ではないので．）
    積位相と一致し，特に振る舞いのいい距離に$L^p$距離がある．
    $L^\infty$の場合が積位相を定めることの証明が容易である．
    次に，$L^1,L^2$距離が$L^\infty$距離と同値であることから，
    特にManhattan距離$L^1$から，一般の距離関数が積位相について連続になることがわかる．
    この時の評価が全て三角不等式の上で行われるから，これが距離の公理に含まれている．

    積を得るとほとんどの距離，代数構造が生まれるように，そのほとんどの概念が連続だと示せる．
\end{screen}

\begin{proposition}[$L^1,L^2,L^\infty$距離は同値で，いずれも積位相を定める]\label{prop-metric-topology-of-l1-l2-lmax}
    $(X,d_X),(Y,d_Y)$を距離空間とする．
    \begin{align*}
        d_1((x,y),(x',y'))&=d_X(x,x')+d_Y(y,y'),\\
        d_2((x,y),(x',y'))&=\sqrt{d_X(x,x')^2+d_Y(y,y')^2},\\
        d_\infty((x,y),(x',y'))&=\max(d_X(x,x'),d_Y(y,y'))
    \end{align*}
    と置くと，これらは
    \begin{enumerate}
        \item いずれも$X\times Y$の距離であり，
        \item 互いに同値であり，
        \item 全て$X\times Y$の積位相を定める．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item いま，$a,b,c,a',b',c'\in\R_{\ge 0},a\le b+c,a'\le b'+c'$を任意にとった$X,Y$の２点の距離とすると，次が成り立つことを示せば良い．
        \begin{align*}
            a+a'&\le b+b'+c+c',&\sqrt{a^2+a'^2}&\le\sqrt{b^2+b'^2}+\sqrt{c^2+c'^2},\\
            \max\{a,a'\}&\le\max\{b,b'\}+\max\{c,c'\}.
        \end{align*}
        $\R$上の３点$0,(b,b'),(b+c,b'+c')$についての三角不等式$\sqrt{(b+c)^2+(b'+c')^2}\le\sqrt{b^2+b'^2}+\sqrt{c^2+c'^2}$を挟めば，全て従う．
        \item \[\forall a,b\in\R_{>0},\;\max\{a,b\}\le\sqrt{a^2+b^2}\le a+b\le 2\max\{a,b\}\]
        と系\ref{cor-characterization-distance-function}より．
        \item $(a,b)\in X\times Y$を任意に取る．族$(U_r(a),U_q(b))_{r,q>0}$は，命題\ref{prop-open-balls-is-basis}より開集合系の組の族で，これは命題\ref{prop-characterization-product-topology}.1より，積位相に関する$(a,b)$の近傍系の基本系となる．
        ところで，必要あらば十分小さく取ることで，$(U_r(a),U_r(b))_{r>0}$も基本系となる．
        距離$d_\infty$に関して，$U_r(a,b)=U_r(a)\times  U_r(b)$だから，基本系の一致により，$d_\infty$の定める位相は積位相に他ならないことがわかる．
    \end{enumerate}
\end{proof}
\begin{remark}[Manhattan distance, Euclid  distance, uniform distance]\mbox{}
    \begin{enumerate}
        \item 3とか，こんな証明思いつきますかね？
        まさか$\max:X\times Y\to\R$が一番理論的に素直で，ここから他の$L^1$距離とEuclid距離に流すとは．
        \item $d_1$を\textbf{マンハッタン距離}，$d_2$を\textbf{ユークリッド距離}，$d_\infty$を\textbf{一様距離}ともいう．
    \end{enumerate}
\end{remark}

\begin{corollary}[距離関数は連続である]
    距離空間$X$の距離$d:X\times X\to\R$は，$d$が定める位相の積位相について連続である．
\end{corollary}
\begin{proof}
    $x,y,a,b\in X$について，三角不等式の公理から，
    \begin{align*}
        |d(x,y)-d(a,b)|\le|d(x,y)-d(a,y)|+|d(a,y)-d(a,b)|\le d(x,a)+d(y,b)=d_1((x,y),(a,b))
    \end{align*}
    である．よって，系\ref{cor-characterization-distance-function}より，$d:(X\times X,d_1)\to (\R,d_2)$は連続である．
\end{proof}

\begin{example}[torus]\mbox{}
    \begin{enumerate}
        \item $\R^n$の位相は$\R$の位相の積位相である．命題\ref{prop-metric-topology-of-l1-l2-lmax}を機能的に適用することでわかる．
        \item 円周$S^1$の積空間$(S^1)^n$を，\textbf{$n$次元トーラス}といい，$T^n$で表す．$n\ge 2$では$S^n$と$T^n$は同相ではない．これを示すにはHomology群の方法がある．
    \end{enumerate}
\end{example}

\begin{corollary}[代表的な演算は連続である]
    加法$+:\R\times\R\to\R$と乗法$\cdot:\R\times\R\to\R$も積位相に関して連続である．
    行列の積も連続である．従って，行列とベクトルの積も連続である．
\end{corollary}

\subsection{族の積位相：引き戻しの言葉による特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=族の積位相とは，開集合の単一引き戻しが有限$\cap$-生成する集合が基底となり，$\cup$-生成するもの]
    積位相の定義を$\pr$の引き戻しとして定め直す．
    今回は$\cup$-生成のみを考えれば良いという訳には行かないが，
    圏論的に統一的に見えるように（$X\times X$は$2$からの写像の空間$X^2$とみるように），このために最初から生成の言葉で定義したのである．
    積の普遍性が基底の言葉で自然に得られる．
    これは相対空間の$i$による定義と並行である．
\end{tcolorbox}

\begin{definition}[族の積位相]
    $(X_i,\O_i)_{i\in I}$を位相空間の族とし，$X=\prod_{i\in I}X_i$とする．
    射影$\pr_i:X\to X_i$による引き戻しの合併$\cup_{i\in I}\pr_i^*\O_i$によって生成される位相を，$X$の\textbf{積位相}と呼ぶ．
\end{definition}
\begin{remark}
    めちゃくちゃ多様体みたいだ！！貼り合わせてるように見える．
    最初の手札は$X_1\times\cdots\times X_{i-1}\times U\times X_{i+1}\times\cdots$
    である．この時の生成には二段階ある．
    まず$\cap$-生成によって基底に辿り着く．
    特に$\R^n$で考えれば開球を好きなように．次に$\cup$-生成で積位相に至る．
    ただ，無限次元空間での開の定義は不思議である．ハメル基底のように，無限積$\cap$を考えない．
\end{remark}

\begin{proposition}[積位相の普遍性，拡張になっていることのwell-definedness]\label{prop-universality-of-product-space}
    $(X_i)_{i\in I}$を位相空間の族とし，$X=\prod_{i\in I}X_i$を積空間とする．
    \begin{enumerate}
        \item $X$の部分集合$U$について，次の２条件は同値．
        \begin{enumerate}[(1)]
            \item $U$は$X$の開集合である．
            \item $x=(x_i)_{i\in I}\in U$ならば，$x_i\in X_i$の開近傍$U_i\in\O_{X_i}$の族$(U_i)_{i\in I}$で，$\{i\in I\mid U_i\subsetneq X_i\}$は有限集合であり，$\prod_{i\in I}U_i\subset U$を満たすものが存在する．つまり，\[ \U:=\left\{\prod_{i\in I}U_i\;\middle|\;\begin{array}{l}(U_i)_{i\in I}は開集合U_i\subset X_iの族であり，\\\{i\in I\mid U_i\subsetneq X_i\}は有限集合である\end{array}\right\} \]は積位相$\O$の基底である．
        \end{enumerate}
        \item 任意の位相空間$T$と任意の写像の族$(g_i:T\to X_i)_{i\in I}$に対し，次の２条件は同値．
        \begin{enumerate}[(1)]
            \item 積写像$g=\prod_{i\in I}g_i:T\to\prod_{i\in I}X_i$は連続である．
            \item 任意の$i\in I$に対して，$(g_i):T\to X_i$が連続．
        \end{enumerate}
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1. (2)$\Rightarrow$(1)] 
        $x=(x_i)_{i\in I}\in U$を任意に取る．すると，各$x_i\in X_i$の開近傍の族$(U_i)_{i\in I}$が存在して，$J:=\{i\in I\mid U_i\subsetneq X_i\}$とおくと，\begin{align*}
            \prod_{i\in I}U_i&\subset U,&|J|&<\infty
        \end{align*}
        が成り立つ．するとこの時，$\prod_{i\in I}U_i=\cap_{i\in J}\pr^*_i(U_i)$であるから，$\prod_{i\in I}U_i\in\O$．よって，$\U\subset\O$を導けた．命題\ref{prop-characterization-of-open-sets}より，$X$の積位相$\O$の第一公理の特徴付けから$U\in\O$である．
        \item[(1)$\Rightarrow$(2)]
        各$j\in I$に対して，族$(U_i)_{i\in I}$を$U_i=\begin{cases}
            X_i&i\ne j,\\
            U_j\in\O_j&i=j,
        \end{cases}$とすると，これは開集合の族で$(U_i)_{i\in I}\in\U$．これを用いて，$\O$の各基底は
        \[\pr^{-1}_{j}(U_j)=\prod_{i\in I}U_i\in\U\]
        と表現でき，$U_j\in\O_j$も$j\in I$も任意に取ったから，
        \[\bigcup_{i\in I}\pr^*_i\O_i\subset\U\subset\O\]
        より，$\O$は$\U$によっても生成される．あとは，$\U$が定義\ref{def-basis-fundamental-sysmte}の意味で基底であることを示せば良い．
        これは，位相の基底の，フィルター基としての条件(downward-directedness, 定義\ref{def-filterbase-filtersubbase})を確かめることによって行う．
        \begin{align*}
            (\prod_{i\in I}U_i)\cap(\prod_{i\in I}V_i)=\prod_{i\in I}(U_i\cap V_i)
        \end{align*}
        より（補題\ref{lemma-preimage-and-product}），$\U$の元の有限共通部分は再び$\U$の元である．
        \item[2.]
        族$X=\prod_{i\in I}X_i$の積位相を$\O_X$，$T$の位相を$\O_T$とする．
        $f$は連続であることは，命題\ref{prop-continuity-is-determined-by-subbasis}より，$\O_X$の準基$\cup_{i\in I}\pr^*_i\O_i\subset\O_X$についての条件
        \[g^*(\cup_{i\in I}\pr^*_i\O_i)=\{g^{-1}(U)\mid U\in\cup_{i\in I}\pr^*_i\O_i\}\subset\O_T\]
        と同値．
        左辺は$g^*(\cup_{i\in I}\pr^*_i\O_i)=\cup_{i\in I}g^*(\pr^*_i\O_i)=\cup_{i\in I}g^*_i\O_{X_i}$と等しい．即ち，各$g_i$が連続であることと同値．
        \[\xymatrix{
            \O_{X_i}\ar[dr]^-{g^*_i}\ar[d]_-{\pr_i^*}\\
            \O_X\ar[r]^-{g^*}&\O_T
        }\]
    \end{description}
\end{proof}
\begin{remark}\mbox{}
    \begin{enumerate}
        \item (2)の有限条件が不思議だったが，これは$\prod_{i\in I}U_i=\cap_{i\in J}\pr^*_i(U_i)$と$J$を取れるようにするための族$(U_i)_{i\in I}$への制約だったのか．人工的だが便利だ．少し無限次元線型空間への付け焼き刃的対処法にも似ている．
        \item (2)の有限条件により何が起こるかを形式的にまとめると，$I$が有限集合でなければ，定数関数$1:I\to 2$からなる一点集合$\{1\}\subset\S^I$は積位相に関して開集合ではなくなる．基底$\U$の合併として決して表せないからである．このことはコンパクト集合の性質の証明で重要になる．
        \item 積位相の定義を$\pr$の引き戻しとしたから，積空間のTopの普遍性が，双対圏Frmの直和の普遍性から理解できて，極めてわかりやすくなった．
    \end{enumerate}
\end{remark}

\subsection{小数展開と力学系}

\begin{screen}
    まずは，先節で定義した族の積空間の例をみる．$m$進小数展開や関数空間などがその例である．要は数列と関数の空間だが，$\ev_x$が$\pr_i$の一般化になっていると初めて気づいた．
    こうして次第に，族の積空間における\textbf{引き戻し$\pr^*$を一般の写像$f^*$に一般化}することで，誘導位相という型が見えてくる．
    こうして，\textbf{族の積位相とは，射影$\pr$の定める誘導位相}のことであったのだ．

    積位相自体も，有限の場合は生成の言葉で定義したが，誘導位相の例になっている．
    相対位相も誘導位相の例である．
    誘導位相の例には始位相がある，名前の付け方が整合的である．\footnote{引き戻し$\cup_{i\in I}f^*_i\O_i$によって位相が定まる時，Topでの射は始位相と同じく，位相を定めたい集合から飛び出す方向である．}
    始位相は誘導位相のうち一番弱いものである．この弱さが各点収束性に対応している．
    解析学の直観が回収されていく．
\end{screen}

\begin{problem}[$m$進小数展開は連続]\label{problem-m-adic-expansion-is-continuous}
    $m\ge 2$を自然数とする．$m$を離散空間とし，無限積空間$m^\N$からの写像$e_m:m^\N\to[0,1]$を$m$進小数展開
    \[ e_m((x_n)):=\frac{1}{m}\sum^\infty_{n=0}\frac{x_n}{m^n} \]
    で定める．この時，$e_m$は連続である．
\end{problem}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 自然数$n\in\N$に対し，$n$番目以降を切断する写像\[\xymatrix@R-2pc{
            q_n:m^\N\ar[r]&m^n\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (x_l)\ar@{|->}[r]&(x_0,\cdots,x_{n-1})
        }\]
        は連続である．実際，任意の$(x_0,\cdots,x_{n-1})\in m^n$に対して，逆像は$q_n^{-1}(x_0,\cdots,x_{n-1})=\{x_0\}\times\{x_1\}\times\cdots\times\{x_{n-1}\}\times m\times m\times\cdots\in\U$は$m^\N$の開集合系の基底である．
        よって，これを用いて$V_n(x):=q_n^{-1}(q_n(x))$とおくと，これは$x$の開近傍である．
        \item \[e_m(V_n(x))=\left[\frac{1}{m}\sum^{n-1}_{l=0}\frac{x_l}{m^l},\frac{1}{m}\sum^{n-1}_{l=0}\frac{x_l}{m^l}+\frac{1}{m^n}\right]\]である．
        左端は$x(i)=0\;(i\ge l)$となる数列，右端は$x(i)=m-1\;(i\ge l)$となる数列で，全体として閉区間で，直径は$\frac{1}{m^n}$である．
        \item 任意の実数$r>0$に対し，$m^nr>1$を満たすように$n$を取ると，\[\forall x\in m^\N,\;e_m(V_n(x))\subset U_r(e_m(x))\]である．
        よって，任意の$e_m(x)\in[0,1]$の任意の開近傍の基本系の逆像は，その下に開集合が見つかる訳だから，命題\ref{prop-continuousness-in-terms-of-basis}より，
        $e_m:m^\N\to\R$は連続．
    \end{enumerate}
\end{proof}
\begin{remarks}
    書籍の方では$\{V_n(x)\}_{n\in\N}$が開近傍の基本系であることを確認せずに証明しているの，実はやばくないか？
    それにしても，射影$\pr_i$が連続写像になるだけでなく，その拡張（？）$q_n$も連続写像になり，$n\in\N$の調節によって自由にピントを合わせることができる，という道具立てを使う．
\end{remarks}

\begin{proposition}[区間縮小法によるHeine-Borelの定理の証明]
    $[0,1]$はコンパクトである．
\end{proposition}
\begin{proof}
    連続全射$e_2:2^\N\to[0,1]$の像$e_2(2^\N)=[0,1]$はcompactである（系\ref{cor-image-of-compact-set-is-compact}）．
\end{proof}

\begin{definition}[simple convergence / pointwise convergence, weak / coarse / initial / induced topology]\mbox{}
    \begin{enumerate}
        \item $X$を集合とし$Y$を位相空間とする．集合$\Map(X,Y)$の積位相を\textbf{単純収束位相}または\textbf{各点収束位相}，あるいは\textbf{弱位相}や\textbf{始位相}と呼ぶ．
        \item 各点収束というのは，集合$\Map(X,Y)$に入る積位相とは$\cup_{x\in X}\ev_x^*\O_x$であった．$\pr_x^*\O_x$の各々は，成分$x$については$Y$の位相の引き戻しで，他の成分については$X$である．従って，漏斗のようなフィルターになっている．これの合併は，各$x\in X$で着地しているような（次の3の意味で）「極小」のフィルターで，これが各点収束性である．もっと点が互いに強くてつながっているのが強位相であり，一様収束位相である．
        \item そもそも積位相とは，集合$\Map(X,Y)$に入る位相であって$(\pr_x)_{x\in X}$を連続にするものの中で一番弱いものである．これを，射影ではなく一般の写像の族としたものが誘導位相なので，弱位相を単に誘導位相と呼ぶことも多い．\footnote{\url{https://ncatlab.org/nlab/show/weak+topology}}
        \item $\Map(X,\R)$の積位相
        \item だがいずれにしろ，$\Map(X,Y)$の位相は$\R$などと比べるとゆるゆるなのだな．しかし関数も「点」としてのアナロジーが効く点が面白い．
        \item この双対概念を\textbf{強位相}という．$I$が一点集合の時の商位相がその例である．
    \end{enumerate}
\end{definition}

\begin{proposition}
    $X$を集合とする．包含写像$i:\widetilde{B}(X)\to\Map(X,\R)$は$\widetilde{B}(X)$の一様収束写像と，$\Map(X,\R)$の単純収束位相に関して，連続である．
\end{proposition}
\begin{proof}
    積空間の普遍性より，各$x\in X$について$\ev_x\circ i=\ev_x|_{\widetilde{B}(X)}$が連続であることを示せば良い．
    \[\xymatrix{
        \widetilde{B}(X)\ar[r]^-i\ar@{.>}[dr]&\Map(X,\R)\ar[d]^-{\ev_x}\\&\R
    }\]
    これは，任意の$\epsilon>0$に対して，
    \[\forall x\in X\forall f,g\in\widetilde{B}(X),\;\|f-g\|_\infty<\epsilon\Rightarrow |\ev_x(f)-\ev_x(g)|=|f(x)-g(x)|\le\|f-g\|_\infty <\epsilon\]
    より，$i$は連続である．
\end{proof}
\begin{remark}\mbox{}
    \begin{enumerate}
        \item 単純収束位相の弱さのおかげで，$i$は連続たることが出来ている．
        \item $X$が有限の場合，これは特に同相写像である．収束もクソもないからである．
        \item $X$が無限ならば，これは埋め込みでさえない．
    \end{enumerate}
\end{remark}

\subsection{誘導位相}

\begin{definition}[induced topology]
    $X$を集合とし，$(X_i,\O_i)_{i\in I}$を位相空間の族，$(f_i:X\to X_i)_{i\in I}$を写像の族とする．
    合併$\cup_{i\in I}f^*_i\O_i$によって$X$に生成される位相を，写像の族$(f_i)_{i\in I}$による\textbf{誘導位相}という．
\end{definition}
\begin{remark}
    添字集合が一点集合である時は，誘導位相とは$f$による引き戻しのことに他ならない．
    $f$が埋め込みならば，$X$の位相は$f$による誘導位相となっている．
    特に，部分空間の相対位相とは，包含写像による誘導位相である．
\end{remark}

\begin{proposition}[誘導位相の普遍性]\label{prop-universality-of-final-topology}
    $(X_i)_{i\in I}$を位相空間の族，$(f_i:X\to X_i)_{i\in I}$を写像の族とし，$X$を誘導位相により位相空間と考える．
    \begin{enumerate}
        \item $X$の部分集合$U$について，次の２条件は同値．
        \begin{enumerate}[(1)]
            \item $U$は$X$の開集合である．
            \item $x\in U$ならば，有限部分集合$J\subset I$と$f_i(x)\in X_i$の開近傍の有限族$(U_i)_{i\in J}$で，$\cap_{i\in J}f^{-1}_i(U_i)\subset U$を満たすものが存在する．
        \end{enumerate}
        \item 任意の位相空間$T$と任意の写像$g:T\to X$に対し，次の２条件は同値．
        \begin{enumerate}[(1)]
            \item $g$は連続である．
            \item 任意の$i\in I$に対して，$f_i\circ g$が連続．
        \end{enumerate}
    \end{enumerate}
\end{proposition}

\section{商位相と像位相}

\subsection{商位相の定義}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=商空間には，商写像の逆像が開になりえるものは全部開と定める位相を入れる．これはfinestなfinal topologyを定める．]
    $X$が位相空間である時，写像$f:X\to Y$に対して像位相とは，定義\ref{def-initial-and-final-topology}では，逆像写像$f^*$を用いて引き戻した．
    生成を挟まず，$f^{*-1}(\O_X)$がそのまま$Y$の位相である．
    $Y$を一般の位相空間とする時，連続写像の特徴付け（命題\ref{prop-characterization-of-continuous-mapping-in-terms-of-frame-morphism}.1）より，$f$が連続であるとは，$Y$の位相が像位相よりも粗いことに等しい．
    
    像位相はframeの言葉で直接（生成を挟まず）定義される位相であるから，他の部分空間や積空間との関係は，frameの射についての図式追跡によって示される．
    ここでも，Setでの消息とTopでの消息はしっかりズレる（２つの補題のこと）．
    像位相の定義が難しいのは，開集合の像を開とするのでは，その逆像が開と限らず，失敗するからである．
    引き戻しの方向とは逆に，命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}の非対称性があらわになっている．
\end{tcolorbox}

\begin{definition}[quotient topology, quotient space]
    $X$を位相空間，$R$をその上の同値関係とする．商集合$X/R$の商写像$p:X\to X/R$による像位相を，$R$による\textbf{商位相}という．
    商集合$X/R$を商位相により位相空間と考えたものを\textbf{商空間}という．
\end{definition}
\begin{remarks}
    実際やっていることは，各$U\in\O$に対して，$q^{*-1}(U)=\{V\in X/R\mid q^{-1}(V)=U\}$を対応づけているのみである．
    $R$に対する潰し方に合わせて，開集合もまとめてしまう．
\end{remarks}

\begin{proposition}[universality of quotient space]
    $f:X\to Y$が写像$g:X/R\to Y$を引き起こすならば，$f$が連続なことと$g$が連続なことは命題\ref{prop-characterization-of-continuous-mapping-in-terms-of-frame-morphism}.1より同値になる（商写像のframeの射を考えれば良い）．
    これをTop上の\textbf{商空間の普遍性}という．
\end{proposition}
\begin{proof}
    $X$の位相を$\O_X$，$Y$の位相を$\O_Y$とすると，$X/R$の位相は商写像$p$を用いて$p^{*-1}(\O_X)$と表せる．
    \[\xymatrix{
        X\ar[r]^-p\ar[dr]_-f&X/R\ar@{.>}[d]^-g\\
        &Y
    }\]
    $f^*=(g\circ p)^*=p^*\circ g^*$より，
    \begin{align*}
        f^*(\O_Y)\subset\O_X&\Leftrightarrow p^*(g^*(\O_Y))\subset\O_X\\
        &\Leftrightarrow g^*(\O_Y)\subset p^{*-1}(\O_X).
    \end{align*}
\end{proof}

\begin{remark}[位相空間論には手放しの準同型定理はない]
    $f$が連続ならば，$f$が引き起こす可逆写像$\overline{f}:X/R_f\to f(X)$は連続な全単射であるが，同相写像とは限らない．
    これが成り立つための必要条件は$X$がコンパクトで，$Y$がハウスドルフであることである（系\ref{cor-Compact-Hausdorff}）．
\end{remark}

\begin{lemma}[部分空間との関係]
    $q:X\to X/R$を商写像とし，$i:A\to X$を包含写像とする．
    \[\xymatrix{
        X\ar[r]^-q&X/R\\
        A\ar[u]^-i\ar@{.>}[ur]
    }\]
    \begin{enumerate}
        \item $q\circ i$は連続である．
        \item $R_A$を連続写像$q\circ i$が定める同値関係とすると，これが定める連続単射$\o{q\circ i}:A/R_A\to X/R$は埋め込みとは限らない．
    \end{enumerate}
\end{lemma}
\begin{proof}
    $X$の位相を$\O_X$とすると，
    \begin{enumerate}
        \item \begin{align*}
            &(g\circ i)^*(g^{*-1}(\O_X))\subset i^*(\O_X)\\
            \Leftrightarrow\quad&i^*(g^*\circ g^{*-1}(\O_X))\subset i^*(\O_X)\\
            \Leftrightarrow\quad&i^*(\O_X)\subset i^*(\O_X)
        \end{align*}
    \end{enumerate}
\end{proof}

\begin{lemma}[積空間との関係]
    $q:X\to X/R,q':Y\to Y/R'$を商写像とする．
    \[\xymatrix{
        X\ar[r]^-q&X/R\\
        X\times Y\ar[u]\ar@{.>}[r]^-{q\times q'}\ar[d]&(X/R)\times(Y/R')\ar[u]\ar[d]\\
        Y\ar[r]^-{g'}&Y/R'
    }\]
    \begin{enumerate}
        \item 積写像$q\times q'$は連続である．
        \item $q\times q'$の定める同値関係を$R\times R'$とすると，連続全単射$\o{q\times q'}:(X\times Y)/(R\times R')\to(X/R)\times(Y_R)$が定まるが，これは$R'$が自明な同値関係であったとしても同相写像とは限らない．
    \end{enumerate}
\end{lemma}
\begin{proof}
    $X,Y$の位相を$\O_X,\O_Y$とすると，$\pr^*_1(\O_X)\cup\pr^*_2(\O_Y)$が$\O_{X\times Y}$の準基だから，
    $(X/R)\times(Y/R')$の準基に対して，次が成り立てば十分．
    \begin{align*}
        &(q\times q')^*(\pr_1^*(q^{*-1}(\O_X))\cup\pr_2^*(q'^{*-1}(\O_Y)))\subset\pr^*_1(\O_X)\cup\pr^*_2(\O_Y)\\
        \Leftrightarrow\quad&(q\times q')^*(\pr_1^*(q^{*-1}(\O_X)))\cup(q\times q')^*(\pr_2^*(q'^{*-1}(\O_Y)))\subset\pr^*_1(\O_X)\cup\pr^*_2(\O_Y)
    \end{align*}
    これは，各
    \[(q\times q')^*(\pr_1^*(q^{*-1}(\O_X)))\subset\pr^*_1(\O_X) \]
    が成り立つことから示される．
    任意の$U\in\O_X$について，$q^{*-1}(U)=:U'$と置くと，$q^*(U')=U$で，右辺は$U\times Y$となり，左辺は
    $(q\times q')^*(U'\times Y/R)=U\times Y$となる．
\end{proof}
\begin{remarks}
    このような準基の間の綺麗な性質が成り立つのは，frameの射によって位相を定めたため，図式チェイスによってそれを再現できるのは当たり前のことである．
\end{remarks}

\subsection{商位相の例：射影空間}

\begin{definition}[一点に潰して得られる空間]\label{def-一点に潰して得られる空間}
    $X$を位相空間とし，$A$を空でない部分空間とする．$X$の同値関係$R_A$を$R_A:=\Delta_X\cup (A\times A)$とする．
    商空間$X/R_A$を\textbf{$A$を一点に潰して得られる空間}という．
\end{definition}

\begin{example}\mbox{}
    \begin{enumerate}
        \item $\R^n$上の同値関係$x-y\in\Z^n$による$\R^n$の商を$\R^n/\Z^n$と表す．$n=1$の時は
        \[\xymatrix@R-2pc{
            f:\R\ar[r]&S^1\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            t\ar@{|->}[r]&{\begin{pmatrix}\cos 2\pi t\\\sin 2\pi t\end{pmatrix}}
        }\]は周期$1$より，同相写像$\R/\Z\to S^1$を定める．この積写像$f^n:\R^n\to T^n=(S^1)^n$は同相写像$\R^n/\Z^n\to T^n$を定める．この事実はコンパクト空間からハウスドルフ空間への連続全単射は同相写像であることからも導ける．
        \item 単位円板$D^n:=\{x\in\R^n\mid \|x\|\le 1\}$について，周$S^{n-1}\subset D^n$を一点に潰して得られる空間は$S^n$と同相である．
    \end{enumerate}
\end{example}

$\R^n$の部分空間として定義されるわけではない位相空間の重要な例が射影空間である．

\begin{definition}[projective space, homogeneous coordinate]
    \textbf{$n$次元実射影空間}とは，集合
    \[ \P^n(\R):=\{L\in P(\R^{n+1})\mid Lは\R^{n+1}の１次元部分空間\} \]
    のことを指す．
    \[\xymatrix@R-2pc{
        p:\R^{n+1}\setminus\{0\}\ar[r]&\P^n(\R)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        x\ar@{|->}[r]&\R x
    }\]
    は全射であり，この値を$p(x_1,\cdots,x_{n+1})=:(x_1:\cdots:x_{n+1})$と表し，\textbf{同次座標}という．
    この全射による像位相を$\P^n(\R)$の位相と呼ぶ．

    同様にして$n$次元複素射影空間$\P^n(\C)$と全射$p:\C^{n+1}\setminus\{0\}\to\P^n(\C)$とそれによる位相も定める．$n=1$の$\P^1(\C)$を\textbf{射影直線}という．
\end{definition}
\begin{remark}
    $\P^n(\R),\P^n(\C)$は代数幾何の記法であり，トポロジーでは$\R\P^n,\C\P^n$などと書く．
\end{remark}

\subsection{セクションと商位相}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily, title=$Y$の位相が全射$f$による像位相であるための十分条件]
    sectionの存在は像空間の十分条件である．
    この事実は，像位相がinitial topologyであるというequalizer性に由来する．
    initial topologyとしての像位相の特徴付けは命題\ref{prop-characterization-of-continuous-mapping-in-terms-of-frame-morphism}から来る．
\end{tcolorbox}

\begin{definition}[section]
    連続写像$f$に対して，連続写像$s:Y\to X$が$f\circ s=\id_Y$を満たす時，$s$は$f$の\textbf{セクション}であるという．
\end{definition}

\begin{proposition}\label{prop-section-existence-implies-initial-topology}
    連続写像$f:X\to Y$のセクション$s:Y\to X$が存在すれば，$Y$の位相は$f$による像位相である．
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[図式追跡による証明] 
    $X,Y$の位相を$\O_X,\O_Y$とすると，$f,s$は連続だから，
    \begin{align*}
        f^*(\O_Y)&\subset\O_X,&\O_Y&\supset s^*(\O_X)
    \end{align*}
    より，$\O_Y=s^*\circ f^*(\O_Y)\subset s^*(\O_X)\subset\O_Y$だから，$s^*\O_X=\O_Y$．
    これは，$f^{*-1}(\O_X)=s^*\O_X$より，$f^{*-1}(\O_X)=\O_Y$を意味する．
    \item[普遍性のような証明]
    $f$による像位相として$Y$を位相空間と考えたものを$Y'$とすると，命題\ref{prop-characterization-of-continuous-mapping-in-terms-of-frame-morphism}より，$\id_Y:Y'\to Y$は連続になる．
    すると，命題の仮定より，逆射$f\circ s=\id_Y:Y\to Y'$も連続だから，$Y\simeq Y'$．
    \[\xymatrix{
        X\ar[dr]_-f&Y\ar[l]_-s\\
        &Y'\ar[u]_-{\id_Y}
    }\]
    \end{description}
\end{proof}
\begin{remarks}[射に注目する有効性：Category theory in working]
    \begin{enumerate}
        \item ２つ目の証明は結局命題\ref{prop-characterization-compact-space-in-terms-of-filters}というframe morphismの消息から来るが，
        その始位相性を強調すると証明が簡潔になる．これが，いつまでも集合論的な定義に戻るのではなく，適切な圏の上で考えるべき理由であろう．
        \item これは像位相が最も細かい位相であるから言えることなのだろう．命題\ref{prop-split-epi-then-imbedding}の双対命題である．
    \end{enumerate}
\end{remarks}

\begin{corollary}
    $X,Y$を位相空間とする．$\pr_2:X\times Y\to Y$による像位相は，$X$が空集合でなければ$Y$の元の位相であり，$X$が空集合ならば離散位相である．
\end{corollary}
\begin{proof}
    $x\in X$に対して，写像$s:Y\to X\times Y$を$s(y):=(x,y)$と定めると，これは連続．\footnote{$\O_{X\times Y}$の$\pr_2$による像は$Y$-開．}
    また，$\id_Y=\pr_2\circ s$より，これはsectionである．よって命題\ref{prop-section-existence-implies-initial-topology}より，
    $Y$の位相は$\pr_2$による像位相である．
\end{proof}
\begin{remarks}
    私がやっているのは，代数の手前のような議論なのだなと気づいた．
    集合論も位相論も，圏論前夜なので，その気分であっているはずである．
    ここに進入してきた圏論を，frameという概念を大事にして学んでいる．
    $\pr^{-1}(U)$は逆像という付け焼き刃的な概念である．
    $U$を真の変数として再び採用し，記法を$\pr^*(U)$と改めると$\pr^*$は
    再び写像に戻る．ここで$\pr^{*-1}$という使い方をすると，これは位相空間論である．
    集合をスタートとなる素朴な認知的道具とするなら，位相空間論とは，一切の意味を捨象したデータ構造である．
    これに代数的な意味を持たせれば，ここから圏論が始まるのだろう．
\end{remarks}

\subsection{族の像位相}

\begin{proposition}[像位相の特徴付け]
    $X$を集合とし，$(X_i)_{i\in I}$を位相空間の族とする．$(f_i:X_i\to X)_{i\in I}$を写像の族とする．
    \[ \O=\{U\in P(X)\mid \forall i\in I,\; f^{-1}_i(U)\in\O_{X_i}\}=\bigcap_{i\in I}f^{*-1}(\O_{X_i}) \]
    は$X$の位相である．この位相を，写像の族$(f_i)_{i\in I}$による\textbf{像位相}という．
\end{proposition}
\begin{proof}
    開集合の公理を満たすことを示す．$(U_j)_{j\in J}$を$\O$の族とする．
    \begin{enumerate}
        \item 任意の$i\in I$について$f^{-1}_i(\cup_{j\in J}U_j)=\cup_{j\in J}f^{-1}_i(U_j)\in\O_{X_i}$が成り立つから，$\cup_{j\in J}U_j\in\O$．
        \item $\abs{J}<\infty$とする．任意の$i\in I$について$f^{-1}_i(\cap_{j\in J}U_j)=\cap_{j\in J}f^{-1}_i(U_j)\in\O_{X_i}$が成り立つから，$\cap_{j\in J}U_j\in\O$．
    \end{enumerate}
\end{proof}
\begin{remarks}
    位相の任意個$I$の共通部分はまた位相となる例である．
\end{remarks}

\begin{proposition}[誘導位相の普遍性の双対命題]\label{prop-universality-of-initial-topology}
    $X$を写像の族$(f_i:X_i\to X)_{i\in I}$による像位相によって位相空間と見做す．
    任意の位相空間$Y$と任意の写像$g:X\to Y$に対し，次の２条件は同値．
    \begin{enumerate}
        \item $g:X\to Y$は$\O$に関して連続である．
        \item 任意の$i\in I$に対し，$g\circ f_i:X_i\to Y$が連続である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] 像位相は各$f_i$を連続にする最も細かい位相であるから，$f_i$は連続．(1)より$g$も連続であるから，$g\circ f_i$は連続．
        \item[(2)$\Rightarrow$(1)] 任意の$U\in\O_Y$に対して，$g^{-1}(U)\in\O$を示せば良い．
        \begin{align*}
            &(g\circ f_i)^{-1}(U)\in\O_{X_i}\\
            \Leftrightarrow\quad&f^{-1}_i(g^{-1}(U))\in\O_{X_i}\\
            \Leftrightarrow\quad&g^{-1}(U)\in\O.
        \end{align*}
    \end{description}
\end{proof}
\begin{remarks}
    $(X_i)_{i\in I}$というバックアップが居て，彼らから直接$Y$へ射が出るのと，$X$というrepresenting objectから$Y$へ射が出ることが同値になるとは，テンソルの普遍性でも見られる現象である．
\end{remarks}

\subsection{直和位相と開被覆}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily, title=$Y$の位相が全射$f$による像位相であるための十分条件]
    像位相の普遍性の例であるが，この形の典型は直和の普遍性である．
    ということで，商空間に加えてもう一つの「像位相の例」として直和位相をみる．
    
    包含写像が定める像位相が直和位相なのであるが，その例としては開被覆がこうみなせる．
\end{tcolorbox}

\begin{definition}[direct sum topology]
    直和$\coprod_{i\in I}X_i$の，標準単射の族$j_i:X_i\to\coprod_{i\in I}X_i$による像位相を\textbf{直和位相}という．
\end{definition}

\begin{lemma}
    任意の$i\in I$に対して標準単射$j_i:X_i\to\coprod_{i\in I}X_i$は開埋め込みであり，$(j_i(X_i))_{i\in I}$は$\coprod_{i\in I}X_i$の開被覆である．
\end{lemma}
\begin{remarks}
    積位相の普遍性\ref{prop-characterization-product-topology}の双対命題である．
    積位相は付随する射$\pr_i$を連続にする最も粗い位相で，$\pr_i$は開写像で全射になる．
    直和位相は付随する射$j$を連続にする最も細かい位相で，$j$は開埋め込みになる．
\end{remarks}

\begin{proposition}[開被覆の像位相としての見方]
    $X$を位相空間とし，$(U_i)_{i\in I}$を$X$の開被覆とする．
    \begin{enumerate}
        \item $X$の位相は，包含写像の族$(j_i:U_i\to X)_{i\in I}$による像位相である．
        \item $\U_i$を$U_i$の開集合系とすると，$X$の位相は$\U=\cup_{i\in I}\U_i$によって生成位される位相である．
    \end{enumerate}
\end{proposition}
\begin{proof}
    $\O$を$X$の位相とし，$\O_\U$を$\U$が生成する位相，$\O'$を像位相とする．
    $\O_\U\subset\O\subset\O'\subset\O_\U$を示す．
    最左辺は$\U\subset\O$による．中辺は$\O'$が包含写像を連続にする最も細かい位相であることによる．
    最後に最右辺は，任意の$U\in\O$に対して，$U=\cup_{i\in I}(U\cap U_i)$と$\O_\U$の元の合併として表せるから，$U\in\O_\U$．
\end{proof}
\begin{remarks}
    要は，開被覆$\U\subset\O_X$に対して，これが生成する位相$\O_\U$としても，
    この像位相$\cap_{i\in I}j_i^{*-1}(U_i)$としても，$\O_X$が再現できる．
    開被覆には，位相の情報が完全に詰まっているのである．
\end{remarks}

\chapter{位相空間の性質}

\begin{quotation}
    位相とは，集合と数の間に存在する静的な模様である．
    そのうち特に普遍的な模様，即ち広汎な範囲に仕える概念装置を考える．
    集合とはある意味で論理を写しとったobjectであるが，ひたすらそれをいじくりまわしたのを感じる．
    その結果「位相空間」と言った時，必要最低限の３公理しか仮定していない．
    ここからどのような公理を追加することによって，新たにどのように模様が移動するかの，逆数学的tinkeringである．
    
    以下，特徴付けをまとめる．
    \begin{enumerate}
        \item ハウスドルフ空間とは，$\Delta_X$が$X\times X$-閉集合となるような空間である．また，連続写像$f:T\to X$のグラフ$\Gamma\subset T\times X$が閉集合となる空間$X$である．
        \item 実数の区間が持つ性質のうち，中間値の定理を成り立たせるのに必要な位相的性質は正確に「連結性」である．
        \item 実数の閉区間が持つ性質のうち，最大値の定理を成り立たせるのに必要な位相的性質は正確に「コンパクト性」である．
        \item コンパクト性の定義を積位相の言葉を使って言い換えることで，コンパクト集合の性質が導ける．任意の$Y$と$y\in Y$について，$A\times\{y\}$の開近傍$W\subset X\times Y$の間に，基底$U\times V$が挟まる．また，$\pr_2:X\times Y\to Y$が開写像かつ閉写像となる．また，$!:X\to 1$が固有写像である．
        \item ハウスドルフ空間のコンパクト集合は閉集合である．閉集合がコンパクトであるためには，全体空間がコンパクトである必要がある．
        \item compact Hausdorff空間への開埋め込みが存在するような空間として，局所コンパクト空間という中間的属性が，開集合のfilterの言葉で定義できる．コンパクト集合の補集合を，新たに開集合系に追加すべき候補として拡張することで，位相空間を拡張する手法がある．これがうまくいき，特に１点コンパクト化を実行した場合はHausdorffな空間が完成するために必要な条件が，局所コンパクト性である．\textbf{局所コンパクトだと，拡大分$Y\setminus f(X)$が近傍によって分離することが可能になる}からである．
        また，射影直線のコンパクト性から，代数学の基本定理が得られる．
    \end{enumerate}
    位相は$P(X)$内に部分半順序をなす．その模様を，いくつかの公理によって制限することができる．
    例えば，ハウスドルフ位相よりも細かい位相はハウスドルフであり，コンパクト位相よりも粗い位相はコンパクトである．従って，コンパクト・ハウスドルフ位相は，ハウスドルフ位相の中でも極小であり，コンパクト位相の中で極大である．
    値域のハウスドルフ性は$\R$のモデルであり，始域のコンパクト性は幾何学的対象のモデルである気がする．

    コンパクト性の議論では，積位相の特徴付け\ref{prop-characterization-product-topology}.4でも準備があったように，連続写像$f$のグラフが焦点となる．
    Hausdorff性についても，２つの特徴付けはいずれも積位相の言葉を用いる．

    明らかに$\R$や距離空間を意識して構築されている理論体系であり，その点少しスッキリしないが，これは$\C$と同様モデル空間だと思えばいい．
    ヤヌス対象みたいなものだろう．
    $\C$については，特に祈りの高いデータ構造が生成され，そのHom集合の元は正則関数と呼ばれる．

    基本的には定義から始まり，射の言葉で特徴付けることで，射に沿った伝播を定義できるようになり，定理に至る，という流れの理論展開をする．
\end{quotation}

\section{Hausdorff空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=Hausdorff空間]
    \begin{itemize}
        \item 距離空間はHausdorffで，特に正規である（命題\ref{prop-metric-space-is-normal}）．
        \item Hausdorff空間への連続写像は，稠密な部分集合への制限さえ判れば一意的に定まる（系\ref{cor-Hausdorff空間への連続写像は，稠密な部分集合への制限で一意的に定まる}）．
    \end{itemize}
\end{tcolorbox}

\subsection{Hausdorff空間の定義}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily]
    Hausdorff空間とは，近傍によって２点が分離できる空間のことをいう．
    従って，極限とは近傍の言葉による点の指定に他ならないので（命題\ref{prop-uniqueness-of-limit-in-Hausdorff-space}），極限の言葉によって一意に点が指定できる空間に他ならない．
\end{tcolorbox}

\begin{definition}[Hausdorff]\label{def-Hausdorff-axiom}
    $X$を位相空間とする．$X$が次の条件(H)を満たす時，$X$は\textbf{ハウスドルフ空間}であるという．
    \begin{quote}
        (H) $\forall x,y\in X,\; x\ne y\Rightarrow [\exists (x\in )U\in\mathcal{O}, \exists(y\in)V\in\mathcal{O},\;U\cap V=\varnothing]$
    \end{quote}
\end{definition}

\begin{remark}
    Hausdorff空間では極限は一意的である（命題\ref{prop-uniqueness-of-limit-in-Hausdorff-space}）．
\end{remark}

\begin{remark}[separated space]
    ドイツの数学者Hausdorffが公理的位相空間論を確立した際にこの条件(H)を含めていたことに因む．フランス系の文献では\textbf{分離空間}という．
\end{remark}

\begin{remark}
    位相が細かければ細かいほどHausdorffになりやすい．離散空間はHausdorffである．
    \begin{enumerate}
        \item 密着空間$X$がハウスドルフであるならば，$|X|\le 1$が必要．
        \item $\mathbb{S}$では，$0\in\mathbb{S}$を含む開集合は$\mathbb{S}$のみであり，$1$と区別ができないのでハウスドルフではない．
    \end{enumerate}
\end{remark}

\begin{proposition}\label{prop-metric-space-is-Hausdorff}
    距離空間はHausdorffである．
\end{proposition}
\begin{proof}
    $d:X\times X\to\R_{\ge 0}$を距離とする．任意の相異なる２点$x,y\in X$を取る．
    $r=\frac{d(x,y)}{2}>0$と置くと，$U_r(x),U_r(y)$が$x,y$を分離するそれぞれの近傍である．
\end{proof}

\subsection{Hausdorff性の積位相による特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=集合論による計算の本領]
    まず，積空間$X\times X$を考えることによる翻訳がある．この空間においては，条件(H)は$\Delta_X$が閉であることに等しくなる．
    $\Delta_X$から少しでもズレる$(x,y)$では，分離する開近傍が積位相に定める開集合$U_x\times U_y$は$\Delta_X$と交叉しない（$U_x\cap U_y=\emptyset$なので）．よって，$X\times X\setminus\Delta_X$は開．
    この集合論的な翻訳が全ての源流となる．殆どが積位相の特徴付け\ref{prop-characterization-product-topology}によって編み上げられている．
    \begin{itemize}
        \item $f$が単射であることの商空間への翻訳：$(f\times f)^{-1}(\Delta_Y)=\Delta_X$と併せることも出来る．
        \item $\Ker(f,g)=(f,g)^{-1}(\Delta_X)$，$\Gamma=\Ker(f\circ\pr_1,\pr_2)$が使える．
        \item Hausdorff性は直積について伝播することは$\Delta_X=\cap_{i\in I}(\pr_i\times\pr_i)^{-1}(\Delta_{X_i})$から分かる．
    \end{itemize}
    殆ど全てが，集合と写像の言葉による「方程式」から得る結論である．
\end{tcolorbox}

\begin{proposition}[Hausdorff空間の特徴付け：対角集合が閉集合となる空間]\label{prop-characterization-Hausdorff}
    $X$を位相空間とする．
    \begin{enumerate}
        \item 次の２条件は同値である．
        \begin{enumerate}[(1)]
            \item $X$はHausdorffである．
            \item 対角集合$\Delta_X$が積空間$X\times X$の閉集合である．
        \end{enumerate}
        \item $X$がHausdorffならば，任意の$x\in X$について$\{x\}$は$X$の閉集合である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 次の条件は全て同値である．
        \begin{description}
            \item[(2)] $\Delta_X$が閉集合である．
            \item[(1.75)] $(X\times X)\setminus\Delta_X$が開集合である．
            \item[(1.5)] 任意の点$(x,y)\in(X\times X)\setminus\Delta_X$に対して，$x$の開近傍$U$と$y$の開近傍$V$が存在して，$((x,y)\in )U\times V\subset (X\times X)\setminus\Delta_X$を満たすものが存在する（積位相の特徴付け\ref{prop-characterization-product-topology}より）．
            \item[(1.25)] 任意の点$(x,y)\in(X\times X)\setminus\Delta_X$に対して，$x$の開近傍$U$と$y$の開近傍$V$が存在して，$U\times V\cap\Delta_X=\emptyset$を満たすものが存在する．
            \item[(1)] 任意の点$(x,y)\in(X\times X)\setminus\Delta_X$に対して，$x$の開近傍$U$と$y$の開近傍$V$が存在して，$U\cap V=\emptyset$を満たすものが存在する．
        \end{description}
        \item 任意の元$x\in X$に対して，写像$i_x:X\to X\times X$を$i_x(y):=(x,y)$と定めると，これは連続である．\footnote{例えば，$\pr_2:X\times X\to X$が開写像であるため（積位相の特徴付け\ref{prop-characterization-product-topology}）．}$\{x\}$はこれによる閉集合$\Delta_X$の逆像$\{x\}=i^{-1}_x(\Delta_X)$である．
    \end{enumerate}
\end{proof}
\begin{remarks}\mbox{}
    \begin{enumerate}
        \item 1.はこんなに近い事実だったのか．積位相に於ける開集合とは，\textbf{開近傍の積で埋め尽くすことの出来る部分}である（積位相の特徴付け\ref{prop-characterization-product-topology}より）．
        つまり，$\cup$-生成しか使わないのであった（所感\ref{remarks-cup-onliness-of-product-topology}）．
        \item $i_x$が連続なのは，そのframe morphism $i_x^*$の値が$\O_X$に含まれていることが命題\ref{prop-characterization-product-topology}から分かるからである．即ち，$\pr_2$が開写像であること．
    \end{enumerate}
\end{remarks}

\begin{proposition}\label{prop-Hausdorff性は連続単射によって足に感染る}
    $f:X\to Y$を連続単射とする．$Y$がHausdorffならば，$X$もHausdorffである．
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $f$が連続ならば，$f\times f$は連続である（積位相の特徴付け\ref{prop-characterization-product-topology}.2）．
        \item $f$が単射ならば，$(f\times f)^{-1}(\Delta_Y)=\Delta_X$である．
        \item 連続写像$f\times f$による逆像$(f\times f)^{-1}(\Delta_Y)=\Delta_X$は閉集合である．
    \end{enumerate}
\end{proof}
\begin{remarks}
    地味に直感に反する．単射性は，対角集合を正確に引き戻すこと（$f:X\to Y$が単射$\Leftrightarrow f^{-1}(\Delta_Y)=\Delta_X$）として翻訳を持つことなど意識したことがなかった．
\end{remarks}

\begin{corollary}\label{cor-subspace-of-Hausdorff-is-Hausdorff}
    $X$をHausdorff空間とする．$X$の部分空間$A$はHausdorffである．
\end{corollary}
\begin{proof}
    包含写像$i:A\to X$は連続単射である．
\end{proof}

\subsection{Hausdorff性の等化子による特徴付け}

\begin{proposition}[Hausdorff性の特徴付け：等化子]\label{prop-characterization-of-Hausdorff-in-terms-of-equalizer}
    位相空間$X$について，次の３条件は同値である．
    \begin{enumerate}
        \item $X$はHausdorffである．
        \item 任意の位相空間$T$と任意の連続写像$f,g:T\to X$に対して，$\Ker(f,g)=\{t\in T\mid f(t)=g(t)\}$は$T$の閉集合である．
        \item 任意の位相空間$T$と任意の連続写像$f:T\to X$に対し，$f$のグラフ$\Gamma=\{(t,x)\in T\times X\mid f(t)=x\}$は$T\times X$の閉集合である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] 
        $\Ker(f,g)=(f,g)^{-1}(\Delta_X)$である．$f,g$が連続であることと$(f,g)$が連続であることは同値（積位相の特徴付け\ref{prop-characterization-product-topology}）．よって，$\Delta_X$が閉集合ならば，$\Ker(f,g)$は閉集合である．
        \item[(2)$\Rightarrow$(3)] 
        $\Gamma=\Ker(f\circ\pr_1,\pr_2)$である．
        \item[(3)$\Rightarrow$(1)] 
        対角集合$\Delta_X$とは，$\id_X:X\to X$のグラフである．
    \end{description}
\end{proof}

\begin{corollary}[Hausdorff空間への連続写像は，稠密な部分集合への制限で一意的に定まる]\label{cor-Hausdorff空間への連続写像は，稠密な部分集合への制限で一意的に定まる}
    $X$を位相空間とし，$Y$をHausdorff空間とする．
    $A$が$X$の稠密な部分集合ならば，制限写像$i^*:C(X,Y)\to C(A,Y)$は単射である．
\end{corollary}
\begin{proof}
    任意の$f,g\in C(X,Y)$について，$f|_A=g|_A\Rightarrow f=g$を示す．
    仮定は即ち$A\subset\Ker(f,g)$と同値であるが，$Y$がHausdorffならば，$\Ker(f,g)$は閉集合である．よって，$\Ker(f,g)=X$．
    即ち，$f=g$．
\end{proof}
\begin{remarks}[稠密性の分だけゆるい！]\mbox{}
    \begin{enumerate}
        \item これはすごい！$i^*:\Map(X,Y)\to\Map(A,Y)$が単射であることの同値命題は$i$が全射であることであるが，
        これが定める写像$C(X,Y)\to C(A,Y)$が単射であるための条件はもっと緩い．稠密性の分だけゆるい．
        \item なんだか不定域イデアルみを感じる．
    \end{enumerate}
\end{remarks}

\begin{proposition}[直積へのHausdorff性の伝播]\mbox{}
    \begin{enumerate}
        \item $(X_i)_{i\in I}$をHausdorff空間の族とすると，積空間$\prod_{i\in I}X_i$もHausdorffである．
        \item $X$と$Y$を位相空間とし，$X\times Y$がHausdorffであるとする．$Y$が空でなければ$X$はHausdorffである．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $\Delta_X=\cap_{i\in I}(\pr_i\times\pr_i)^{-1}(\Delta_{X_i})$．仮定より，$\Delta_{X_i}$は閉集合である．$\pr_i$は$\prod_{i\in I}X_i$の積位相について連続写像であるから，$\pr_i\times\pr_i$も連続である（積位相の特徴付け\ref{prop-characterization-product-topology}）．
        \item 各$b\in Y$に対して，写像$f:X\to X\times Y$を$f(x):=(x,b)$と定めると，これは連続で単射である．よって，命題\ref{prop-Hausdorff性は連続単射によって足に感染る}より．
    \end{enumerate}
\end{proof}

\subsection{正規性}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=$T_4$]
    $T_1$(Hausdorff)かつ，互いに素な閉集合について，互いに素な開近傍を持つことを，$T_4$という．
    その手前の，閉集合$A$と一点$x\notin A$が開近傍によって分離できることを$T_3$または正則という．
\end{tcolorbox}

\begin{definition}[normal]\label{def-normal}
    Hausdorff空間$X$について，任意の（空でない）閉集合$A,B$について次の条件(N)が成り立つ時，$X$は\textbf{正規}であるという．
    \begin{quote}
        (N) $A\cap B\ne\emptyset$ならば，$A$の開近傍$U\subset X$と$B$の開近傍$V\subset X$で，$U\cap V=\emptyset$となるものが存在する．
    \end{quote}
\end{definition}
\begin{remark}
    「空でない」という条件をのぞいいて良いのは，$A=\emptyset$ならば，$U=\emptyset$とすれば形式上(N)は成り立つ．
    「近傍による分離」という自然言語訳にはそぐわないが．
    $B,V$についても同様である．
\end{remark}

\begin{proposition}[距離空間は$T_4$である]\label{prop-metric-space-is-normal}
    $X$が距離空間ならば，$X$は正規である．
\end{proposition}
\begin{proof}
    $A,B$を$X$の空でない互いに素な閉集合とする．
    \begin{enumerate}
        \item \begin{align*}
            U:=\{x\in X\mid d(x,A)<d(x,B)\}\\
            V:=\{x\in X\mid d(x,A)>d(x,B)\}
        \end{align*}
        とすると，いずれも$X$の開集合である．$-:\R^2\to\R$は連続な写像の積なので連続\footnote{curryingしても示せそう}，
        だから，$d(-,B)-d(-,A):\R\to\R$は連続写像で，開集合$(0,\infty)$の逆像なのでいずれも開．
        また，２つの条件は背反だから，$U\cap V=\emptyset$である．
        \item 命題\ref{prop-characterization-of-closure-in-terms-of-metric-function}の閉包の特徴付け
        より$x\in\o{A}(=A)\Leftrightarrow d(x,A)=0$．よって，$x\in A$ならば$x\notin B$より，$d(x,A)=0<d(x,B)$．従って$x\in U,x\notin V$．よって$A\subset U$で，同様にして$B\subset V$．
    \end{enumerate}
\end{proof}

\begin{proposition}[正則性の特徴付け]
    $X$をHausdorff空間とする．
    \begin{enumerate}
        \item 閉集合$A$と一点$x\notin A$が開近傍によって分離できる．
        \item 任意の点$x\in X$の近傍$x\in V$について，$x$の開近傍$x\in U$が存在してその閉包を含む：$\overline{U}\subset V$．
        \item 空でない任意の閉集合$A$について，これを一点に潰して得られる空間$X/(\Delta_X\cup(A\times A))$もHausdorffである（正規性の命題\ref{prop-one-point-compactification}に当たる見方）．
    \end{enumerate}
\end{proposition}

\begin{proposition}[正規性の特徴付け]\label{prop-characterizatioin-of-normality}
    $X$をHausdorff空間とする．
    \begin{enumerate}
        \item 互いに交わらない任意の閉集合$A,B$について，開近傍によって分離できる．
        \item 任意の閉集合$A$の近傍$A\subset V$について，$A$の開近傍$A\subset U$が存在してその閉包を含む：$\overline{U}\subset V$．
        \item 互いに交わらない任意の閉集合$A,B$について，Urysohnの距離関数によって分離できる（補題\ref{lemma-Urysohn's-lemma}）．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] 
        $B:=X\setminus V$と定めると，$A\cap B\ne\emptyset$より，$U\cap W=\emptyset$を満たす開近傍$A\subset U,B\subset W$が存在する．再び$C:=X\setminus W$と置くと，$A\subset U\subset C\subset V$が成り立つが，$C$は閉集合より，$\o{U}\subset C$を得る．２つ併せて，$A\subset\o{U}\subset V$である．
        \item[(1)$\Rightarrow$(3)] Urysohnの補題\ref{lemma-Urysohn's-lemma}

    \end{description}
\end{proof}

\section{連結性}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=連結性]
    閉区間上で定義された実数値関数については中間値の定理が成り立つ．
    この「区間」が持つ性質を，中間値の定理を頼りに一般化する形で，連結性の概念を得る．
    中間値の定理の成立は連結性の特徴づけとなる．
    するとむしろ，中間値の定理の$f:X\to 2$への応用が，連結性の理論展開において中心的な役割を果たす主軸となる．

    連結性とは，２つの互いに素な（相対）開集合に分解できないことである．
    これは数学的帰納法の聞くような$F$-余代数的なデータ構造の母体となる属性である．
\end{tcolorbox}

\subsection{定義と特徴付けと中間値の定理}

\begin{definition}[connected]\label{def-連結性}
    $X$を位相空間とし，$\varnothing\subsetneq A\subset X$について，
    \begin{enumerate}
        \item $A$が\textbf{連結}であるとは，$X$の開集合$U,V$であって$A\subset U\cup V,A\cap U\cap V=\varnothing, A\cap U\ne\varnothing, A\cap V\ne\varnothing$を満たすものは存在しないことをいう．
        \item $A$が\textbf{弧状連結}であるとは，任意の２点$x,y\in A$に対して，これらを結ぶ$[0,1]$からの連続写像$f:[0,1]\to A, f(0)=x, f(1)=y$が存在することをいう．
    \end{enumerate}
\end{definition}
\begin{remark}[連結性とは何か]\mbox{}
    \begin{enumerate}
        \item その本質は，「開かつ閉な空でない部分集合が，全体集合のみ」ということである（命題\ref{prop-charactorization-of-connectedness}.4）．
        \item 連結性は位相空間に限らず，その任意の部分集合に定義される．そのために一般的に記述されているが，$A$の相対位相であるための表記を省いて読めば，$A\subset U\cup V\Leftrightarrow A=(A\cap U)\cup(A\cap V), A\cap U\cap V=\varnothing\Leftrightarrow (A\cap U)\cap(A\cap V)=\varnothing$だから，「集合$A$が連結とは，$A$が２つ以上の互いに素な$A$-開集合に直和分割することが出来ない」ことを主張している．即ち，空でない位相空間$X$が連結とは，$X=U\rotatebox[origin=c]{180}{$\prod$}V\Rightarrow U=\varnothing\lor V=\varnothing$」．
        空間を複数の（空でない）開集合に分割できることを指摘すれば，連結でないことを示したこととなる（命題\ref{prop-charactorization-of-connectedness}.3）．
        \item 位相空間の連結性は，開集合の梯子が全体集合にまで直通していることを表していると見ると，\textbf{帰納法の連続濃度対応版}ともみれる．例えば，連結な空間全体で何かの性質が満たされることを示す時，1. 空でないある部分集合で成立する 2. その部分集合は開かつ閉 を示せば，連結な空間で開かつ閉な空でない部分集合とは全体集合に他ならない．
        \item なお今回の定義では，空集合には連結性は定義されないとした．
    \end{enumerate}
\end{remark}

\begin{example}\mbox{}
    \begin{enumerate}
        \item 離散空間$X$が連結であるためには$|X|=1$が必要．
        \item $\mathbb{S}=(2,\{\emptyset,\{1\},2\})$は，$0\in S$が開集合ではないので連結．また，開集合$U:=[0,1)$の特性関数$\chi_U:[0,1]\to\mathbb{S}$は連続（$\chi_U^{-1}(1)=[0,1)$が開集合）だから，$\mathbb{S}$は弧状連結でもある．
    \end{enumerate}
\end{example}

\begin{proposition}[連結性の特徴付けとintermediate value theorem]\label{prop-charactorization-of-connectedness}
    空でない位相空間$X$に対し，次の５条件は同値である．
    \begin{enumerate}
        \item $X$は連結である．
        \item （\textbf{中間値の定理}）任意の連続関数$f:X\to\R$と任意の$u,v\in X, c\in\R$に対し，$f(u)\le c\le f(v)\Rightarrow[\exists t\in X\;(c=f(t))]$．
        \item $f:X\to 2$が離散位相空間$2=\{0,1\}$への連続写像ならば，$f$は定数関数である．
        \item $U$が$X$の開集合であり閉集合でもあるならば，$U=X\lor U=\varnothing$．
        \item $p:X\to 1$を定値写像とすると，任意の離散位相空間$Y$に対して，$p^*:C(1,Y)\to C(X,Y)$が可逆である．
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] 
        $f\in C(X,\R)$を任意の連続関数とする．任意の$f(u)<c<f(v)$を満たす$u,v,c$について$f(t)=c$を満たす$c\in X$を構成すれば良い．
        いまこの$c\in\R$について，
        \begin{align*}
            U&=\{x\in X\mid f(x)<c\},&V&=\{x\in X\mid f(x)>c\},
        \end{align*}
        と定めるといずれも開区間の連続写像による逆像であるから，開集合である．
        また，$U\cap V=\emptyset$で，少なくとも$u\in U,v\in V$であるからいずれも空でない．
        $X$が連続ならば，$X\subset U\cup V$も満たす開集合$U,V$は存在しないから，$X\not\subset U\cup V$即ち$X\setminus(U\cup V)\ne\emptyset$である．
        この任意の元$t\in X\setminus(U\cup V)$を取ると，$f(t)\in\R\setminus((-\infty,c)\cup(c,\infty))$なので，
        $c=f(t)$である．
        \item[(2)$\Rightarrow$(3)]
        $f\in C(X,2)$を連続写像とする．$2$を離散位相空間と見ているので，$\R$への関数$f:X\to\R$と考えたものも連続である（離散位相空間$2$は$\R$の部分空間とみなせるので，$i:2\to\R$とすると連続で，$f'=i\circ f$と考えれば良い）．
        従って，(2)より，$f(X)=2$ならば，$f(t)=1/2$を満たす$t\in X$が存在するはずだが，これは矛盾．従って，$f(X)\subsetneq 2$即ち$f$は定数関数である．
        \item[(3)$\Rightarrow$(4)]
        $U\subset X$は開かつ閉とする．すると，特性関数$\chi_U:X\to 2$は，$2$の離散位相に対しても連続になる（通常はSierpiński位相についてのみ連続）．
        従って，$U=\emptyset\lor X$．
        \item[(4)$\Rightarrow$(1)]
        $X$の開集合$U$が最初の２条件$X\subset U\cup V,X\cap U\cap V=\emptyset$を満たすとは，無縁和$X=U\coprod V$を意味する．すると，$U,V$はいずれも開かつ閉であり，(4)より，$U=\emptyset\lor V=\emptyset$．
        よって，条件を満たす分割はなく，$X$は連結である．
        \item[(5)$\Leftrightarrow$(2)]
        任意の離散空間$Y$への連続写像$f\in C(X,Y)$は，$y\in Y$が存在して定値写像$f=y$に限る，ということである．これは，埋め込み$i:Y\to\R$が取れる場合については(2)$\Rightarrow$(3)の時と同様に示せる．
    \end{description}
\end{proof}
\begin{remarks}\mbox{}
    \begin{enumerate}
        \item 中間値の定理が成り立つならば，$X$が連結であるという方向性については証明が難しいために(3),(4)があるのだろうか．
        \item (3)で一度$2$に話を集めているのが，ヤヌス対象的で良い．回転数の議論に似ている．\textbf{連結な空間から離散空間への写像は定値になる}．$\R$に埋め込めるので．
        \item (3)$\Rightarrow$(4)は美しすぎる．自在過ぎる．
        \item 終域が$\R$であるために，距離空間が正規であることの証明と似た議論になる（命題\ref{prop-metric-space-is-normal}）．
    \end{enumerate}
\end{remarks}

\subsection{連結であるための条件}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=連結性]
    一般に弧状連結ならば連結であるが，逆は成り立たない．
    $\R$の部分集合においてはこの２条件は同値であり，また区間であることとも同値である．
    こうして区間$[0,1]$をモデルとして得る．
    $\R^2$ではこの２条件は同値ではない．
\end{tcolorbox}

\begin{corollary}[連結性の伝播]\label{cor-connectedness-over-union}
    $X$を位相空間とする．$A,B\subset X$とする．
    \begin{enumerate}
        \item $A$が連結とする．このとき，$B$が$A\subset B\subset\overline{A}$を満たすならば，$B$も連結である．特に，$\overline{A}$も連結である．
        \item $A,B$が連結とする．$A\cap B\ne\varnothing$ならば，$A\cup B$も連結である．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 任意に$f\in C(B,2)$を取り，これが定数関数であることを示す．
        勝手に$a\in A$を取って$c:=f(a)$と置くと，$f|_A=c$である．
        離散位相空間$2$はHausdorff（$0,1$が近傍によって分離可能）で，$A$は$B$上稠密だから，系\ref{cor-Hausdorff空間への連続写像は，稠密な部分集合への制限で一意的に定まる}より，
        $f=c$を得る．
        \item 任意に$f\in C(A\cup B,2)$を取り，これが定数関数であることを示す．
        $A\cap B\ne\emptyset$なので，勝手に$a\in A\cap B$を取って$c:=f(a)$と置くと，$f|_A=f|_B=c$である．よって，$f=c$を得る．
    \end{enumerate}
\end{proof}
\begin{remarks}[殆どが(2)による，集合の拡大を関数の拡大と見る．]
    2は，$A\cap B\ne\emptyset$である場合は，$(A\cup B)\setminus A$が$A\cup B$-開にならないのが肝である．
    これを$A\coprod B\to 2$に仮託すると，$f|_A=0,f|_B=1$で連続関数が作れてしまうのがいけない，という議論に帰着できる．
    天才的な形式の祈りである．
    \textbf{集合の拡大に対する属性の引継ぎを，関数の拡大の議論に落とし込む}この見方が，多変数複素解析の論の進め方に似ているのではないか．ひいては層や圏論の見方に繋がる．
\end{remarks}

\begin{proposition}\label{prop-closed-interval-is-connected}
    $a<b$を実数とする．閉区間$[a,b]$は連結である．
\end{proposition}
\begin{proof}
    連続関数$f\in C([a,b],2)$を任意に取り，これが定数関数$f(a)$となることを背理法で示す．
    $f(c)\ne f(a)$となる$c\in[a,b]$が存在したと仮定する．

    いま，$A:=f^{-1}(f(a))\cap[a,c]$とすると，$\{f(a)\}$が閉より，$A$は少なくとも$a\in A$を持つ閉集合となるから，$s:=\sup A\in A$が存在する．$s\in A$は命題\ref{prop-characterization-of-supremum}による．
    これについて，$f(s)=f(a)\ne f(c)$より，$s<c$．よって，$(s,c]\cap A=\emptyset$より，勝手に取った$t\in(s,c]$に対し，$f(t)=f(c)$（$f$は二値写像であることに注意）．
    しかし$f$は連続だから，$[s,c]$上で$f=f(c)$．よって，$f(s)$の値について矛盾．
    従って，$f$は定数関数である．
\end{proof}
\begin{remarks}[閉区間と離散空間$2$は連続に結べない]
    最大値の原理の議論に似ている．定数関数じゃない部分$c\in[a,b]$を見つけたら，反証算譜が存在するのである．
    まず，$a$を取る部分を$A$として確保すると上限$s$が存在するから，残り$(s,c]$を考えることができ，これは全て$f(c)$を取る．２値に絞ったことがここで活きる．
    すると，系\ref{cor-Hausdorff空間への連続写像は，稠密な部分集合への制限で一意的に定まる}から$[s,c]$上に延長できて，$s$に於て矛盾が起こる．
    これは確かに「連結」性を感じる．
    ２つの開集合に分別する関数$f:[a,b]\to 2$が存在した場合，どこで切っても矛盾するので，結局ドミノ倒し的に全て$f(a)$の値のままである．
    これは確かに数学的帰納法の源泉を感じる．
\end{remarks}

\begin{corollary}[区間上の単調写像は開埋め込み]\label{cor-monotone-map-over-intervals}
    $a<b$を実数とする．
    \begin{enumerate}
        \item $f:[a,b]\to\R$を連続関数とする．$f(a)\le f(b)$ならば，$[f(a),f(b)]\subset f([a,b])$である．
        \item $f:(a,b)\to\R$を連続関数とする．任意の$a<s<t<b$に対し，$f(s)<f(t)$ならば，$f:(a,b)\to\R$は開埋め込みである．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 閉区間$[a,b]$は連結であるから，$f(a)<c<f(b)$を満たす$c\in[f(a),f(b)]$について，$t\in[a,b]$が存在して$c=f(t)\in f([a,b])$である（命題\ref{prop-charactorization-of-connectedness}）．
        \item 連続写像$f$はこのとき単射だから，あとは開写像であることを示せば良い．
        $U\subset(a,b)$を開集合としたとき，$f(U)$が$\R$の開集合であることを示す．
        任意に$y\in f(U)$を取ると，$\exists x\in U,\; f(x)=y$である．
        よって，$x\in(s,t)\subset U$を満たす実数$a<s<x<t<b$が存在する（$\epsilon$-近傍などを取れば良い，$\epsilon$-近傍は$(a,b)$の位相の基底であるため）．
        $f$は単射だから$f((s,t))=f([s,t])\setminus\{f(s),f(t)\}$で，単調性と1.より，$[f(s),f(t)]=f([s,t])$から，右辺は$(f(s),f(t))$とわかる．
        こうして，$f(y)\in(f(s),f(t))\subset U$と開近傍が取れたことになる．
        以上より，$f(U)$は開集合である．
    \end{enumerate}
\end{proof}

\begin{corollary}[弧状連結ならば連結]
    位相空間$X$が弧状連結ならば，$X$は連結である．
\end{corollary}
\begin{proof}
    任意に連続関数$f\in C(X,2)$を取り，これが定数関数であることを示す．
    $a\in X$を勝手に取る．
    $X$は弧状連結だから，任意の$x\in X$に対して，連続写像$g:[0,1]\to X$であって$g(0)=a,g(1)=x$を満たすものが存在する．
    すると，$f\circ g:[0,1]\to 2$は連続であるが，$[0,1]$は連結であるから（命題\ref{prop-closed-interval-is-connected}），
    命題\ref{prop-charactorization-of-connectedness}より，定値写像$f\circ g=f(a)$である．よって，$f(x)=f(a)$．
    以上より，$f=f(a)$である．
\end{proof}

\begin{proposition}[$\R$の連結集合の分類]
    $\R$の部分集合$A$に対し，次の３条件は同値である．
    \begin{enumerate}
        \item $A$は連結である．
        \item $A$は弧状連結である．
        \item 次の条件のどれか１つが成り立つ．
        \begin{enumerate}[(i)]
            \item $A=\R$である．
            \item $a\in R$であって，$A$が$[a,\infty),(a,\infty),(-\infty,a),(-\infty,a]$のどれかと等しくなるようなものが存在する．
            \item 実数$a<b$であって，$A$が$(a,b),(a,b],[a,b),[a,b]$のどれかと等しくなるものが存在する．
            \item $a\in R$であって，$A=\{a\}$となるものが存在する．
        \end{enumerate}
    \end{enumerate}
\end{proposition}

\subsection{連結性の射に対する伝播}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=連結性と射]
    $C(A,2)$が定数関数の集合に退化するような$A\subset X$が連結集合である，という特徴付けを得た以降は，
    圏論的な性質の獲得が速い．全射$f:A\to f(A)$によってHom集合は忠実に$\Hom(A,2)\to\Hom(f(A),2)$にうつされるから，連結性も$f(A)$に遺伝する．
\end{tcolorbox}

\begin{proposition}[連続写像は連結性を保存する]\label{prop-connectedness-over-morphism}
    $f:X\to Y$を連続写像とする．$A$が$X$の連結部分集合ならば，$f(A)$は$Y$の連結部分集合である．
\end{proposition}
\begin{proof}
    $A$が連結ならば$A\ne\emptyset$としたから，$f(A)\ne\emptyset$より，$g\in C(f(A),2)$が取れる．これが定数関数であることを示す．
    すると，$g\circ f|_A\in C(A,2)$であるから，$g\circ f|_A$は定数関数．
    $f|_A$は全射だから$g$も定数関数と判る．
    \[\xymatrix{
        X\ar[r]^-f\ar@{.>}[dr]&Y\ar[d]^-g\\
        &2
    }\]
\end{proof}

\begin{corollary}[積への伝播]
    $X,Y$を位相空間とする．次の２条件は同値である．
    \begin{enumerate}
        \item $X,Y$はそれぞれ連結である．
        \item $X\times Y$は連結である．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] 
        任意に取った$(a,b)\in X\times Y$に対して，任意の$f\in C(X\times Y,2)$が$f=f(a,b)$を満たす定数関数だと示せば良い．
        任意の$(x,y)\in X\times Y$に対して，$X\simeq X\times\{y\},Y\simeq\{a\}\times Y$なので，命題\ref{prop-connectedness-over-morphism}より，これらも連結．
        よって，$f|_{X\times\{y\}},f|_{\{a\}\times Y}$は定数関数．よって，$f(x,y)=f(a,y)=f(a,b)$．$(x,y)\in X\times Y$は任意に定めたから，$f=f(a,b)$．
        \item[(2)$\Rightarrow$(1)]
        連続写像$\pr_1:X\times Y\to X,\pr_2:X\times Y\to Y$の像である（命題\ref{prop-connectedness-over-morphism}）．
    \end{description}
\end{proof}

\subsection{連結成分}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=連結成分：連結の中間的・動的な様子を，同値類の言葉で捉える装置．]
    \begin{enumerate}
        \item 位相空間がこれ以上開集合分割できるか否かの性質を連結性という．この言葉を用いて，一般の空間の，極大な連結部分集合への標準分解が存在する．これを連結成分という．ただし，部分空間が連結であるとは，その部分空間の相対位相について言うという定義\ref{def-連結性}に注意．
        \item 極大性が崩れるのは，自明な同値関係になる場合，すなわち，一点集合$\{x\}$意外に連結な$X$の部分集合が存在しない＝全ての２点以上を含む部分集合は分解できてしまうバッラバラな空間のことを，全不連結という．
        \item この「極大性」には，同値類の言葉で一番自然に言及できる．同値類は連結な閉集合となるという結論を直ちに得る．\textbf{分割が有限の場合は}，任意の成分は開かつ閉であることが直ちに従う．\footnote{距離空間としての有理数全体の集合は全不連結で，連結成分は一点集合であるが，これらは開ではない．Cantor集合も完全不連結であるが，離散空間ではない．}
    \end{enumerate}
\end{tcolorbox}

\begin{proposition}[極大の連結部分集合は同値類である]\label{prop-connected-component}
    $X$を位相空間とする．
    \begin{enumerate}
        \item $x,y\in X$に対し，$x$と$y$を元として含む連結な部分集合$A\subset X$が存在するという条件は，$X$上の同値関係$R$を定める．
        \item $A$をこの同値関係$R$に関する同値類とすると，$A$は連結な閉集合である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 各$x\in X$に対して$\{x\}$は連結だから，反射律は成り立つ．対象律は明らか．連結部分集合$A,B$が存在して$x,y\in A,y,z\in B$の時，$A\cap B\ne\emptyset$より，$x,y,z\in A\cup B$も連結（系\ref{cor-connectedness-over-union}）で，推移律も成り立つ．
        \item $a\in A$を任意に取る．$f\in C(A,2)$を任意に取り，$c:=f(a)$を置く．
        任意の$x\in A$に対して，$\{x,a\}\subset B$を満たす連結部分集合$B\subset A$が存在するが，これについて$f|_B=c$．よって，$f(x)=c$を得るが，$x\in A$は任意に取ったから$f=c$．
        よって，$A$は連結．系\ref{cor-connectedness-over-union}より$\overline{A}$も連結であるが，$A$の極大性より$\overline{A}\subset A$．よって，$A$は閉．
    \end{enumerate}
\end{proof}
\begin{remarks}\mbox{}
    \begin{enumerate}
        \item 連結成分$A$はその極大性より，閉になる．閉包演算子が恒等的に作用すると捉えるとわかりやすい．だが開集合であるとは限らない．$\R^n$では，$X$が$\R^n$の開集合ならば，$X$の連結成分は$X$-開である．
        \item この命題により，連結空間とは，連結成分が全体空間$X$となるような空間（同値関係が$X\times X$となっている）であるという特徴付けを得る．
    \end{enumerate}
\end{remarks}

\begin{definition}[connected component, totally disconnected]
    $X$を位相空間とし，$R$を命題\ref{prop-connected-component}による同値関係とする．kyokudai
    \begin{enumerate}
        \item $X$の$R$による同値類を，$X$の\textbf{連結成分}という．商集合$X/R$を$\pi_0(X)$と表す．
        \item $R$が自明な同値関係となる時，$X$は\textbf{全不連結}であるという．
    \end{enumerate}
\end{definition}

\begin{lemma}\mbox{}
    \begin{enumerate}
        \item (極大性) 連結成分$A$の元$x\in A$について，集合$x\in U$が連結であるとする．この時，$U\subset A$である．
        \item $X:=\Q$を$\R$の相対位相，すなわちEuclid距離の定める位相を入れて位相空間とし，$A:=[-1,1]\cap\Q$とする．部分集合$A\subset X$は連結でない．\footnote{$[-1,1]$は$\R$で連結だが，$[-1,1]\cap\Q$は$\Q$で連結でない．}
        \item $\Q$は完全不連結である．
        \item $\R^2\setminus\{(0,0)\}$は連結だが，単連結ではない．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 任意の$y\in U$について，$x\sim y$であり，$A$はこの同値関係についての同値類だから，$y\in A$．
        \item $U:=(-\pi,1/\sqrt{2})\cap\Q,V:=(1/\sqrt{2},\pi)\cap\Q$とするとこれは$X$の開集合であって，\begin{enumerate}[1.]
            \item $A\subset U\cup V=\paren{(-\pi,\pi)\cap\Q}\setminus\{1/\sqrt{2}\}$．
            \item $A\cap U\cap V\subset U\cap V=\emptyset$．
            \item $A\cap U\ne\emptyset,A\cap V\ne\emptyset$．
        \end{enumerate}
        より，２つの$A$-開集合$U\cap A,V\cap A$に分割できた．
        \item 任意の部分集合$A\subset\Q$で２点以上を含むものは，２つ以上の連結成分を持つことを示せば良い．仮定より，$x\ne y\in A$が取れる．この間の無理数$z\in(x,y)$についてのDedekind切断$(-\infty,z),(z,\infty)$を考えると，これは$A$の相対位相として開で，$A$を分割する．
        \item 
    \end{enumerate}
\end{proof}

\begin{lemma}[極大性：quasi-component]
    $\Gamma_x$を$x$を含む連結成分，$\Gamma'_x$を$x$を含む全てのclopen setの交わりとする．
    \begin{enumerate}
        \item $\Gamma_x\subset\Gamma'_x$である．
        \item $X$がcompact Hausdorffまたは局所連結ならば，$\Gamma'_x\subset\Gamma_x$である．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 任意の$X$のclopen set $U$について，$U\subsetneq\Gamma_x$ならば，$\Gamma_x=(U\cap\Gamma_x)\coprod(\Gamma_x\setminus U)$と２つの開集合で分割できてしまい，矛盾．
    \end{enumerate}
\end{proof}

\begin{screen}
    \begin{remarks}
        任意に$f\in C(A,2)$を取る前に，任意に$a\in A$を取っておくというトリックが普遍的．
    \end{remarks}
\end{screen}

\section{コンパクト性と実数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=コンパクト性]
    閉区間$[a,b]$で定義された連続関数$f$の積分$\int^b_af(x)dx$は必ず収束するのに対して，開区間の場合は発散することもある．
    この差の元となる開区間と閉区間の違いをクリティカルに捉えた概念がコンパクト性である．
    「ぎっしり詰まっていて欠けていない」ならば，このような性質を満たすはずである．
    厳密に言えば，閉区間の持つ性質のうち，最大値の定理の証明の中で使われる部分を抽象化したものである．
\end{tcolorbox}

\subsection{定義と特徴付け}

\begin{definition}[compact]
    $X$を位相空間とし，$A$を部分集合とする．$A$が\textbf{コンパクト}であるとは，
    $X$の開集合の任意の族$\{U_i\}_{i\in I}$について，次の条件(C)が成り立つことをいう．
    \begin{quote}
        (C) $A\subset\cup_{i\in I}U_i$ならば，$I$の有限部分集合$\{i_1,\cdots,i_n\}$であって，$A\subset U_{i_1}\cup\cdots\cup U_{i_n}$を満たすものが存在する．
    \end{quote}
    任意の開被覆に必ず有限な部分被覆が存在する，ということである．
\end{definition}
\begin{remark}[quasicompact]\label{remark-quasicompcat}
    Bourbakiやその他フランス系の文献では，この概念を\textbf{準コンパクト}と呼び，
    それが分離である時に特にコンパクトと呼ぶ．
    位相が粗ければ粗いほどコンパクト（準コンパクト）になりやすく，細かければ細かいほどハウスドルフ（分離）になりやすい．
    そのちょうどいい具合をハウスドルフかつコンパクト（コンパクト）というのである．
\end{remark}

\begin{example}\mbox{}
    \begin{enumerate}
        \item 離散空間$X$がコンパクトであるためには，$|X|<\infty$が必要．
        \item 密着空間$X$はコンパクトである．開被覆がそもそも$\{X\}$のみである．
    \end{enumerate}
\end{example}

\begin{proposition}[コンパクト性の特徴付け：閉集合の言葉による双対命題]\label{prop-characterization-of-compactness-as-space}
    位相空間$X$の部分集合$A$に対して，次の３つの条件は同値である．
    \begin{enumerate}
        \item $A$はコンパクトである．
        \item $X$の閉集合の任意の族$(F_i)_{i\in I}$について，次の条件(C')が成り立つ．\begin{quote}
            (C') $I$の任意の有限部分集合$\{i_1,\cdots,i_n\}$に対して，$A\cap F_{i_1}\cap\cdots\cap F_{i_n}\ne\emptyset$ならば，$A\cap\bigcap_{i\in I}F_i\ne\emptyset$である．
        \end{quote}
        \item $X$の部分位相空間$A$はコンパクトである．
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{description}
        \item[(1)$\Leftrightarrow$(2)] 条件(C)の対偶「有限部分被覆が存在しないならば，それはそもそも開被覆ではない」は
        \begin{quote}
            (C'') 任意の$I$の有限部分集合$\{i_1,\cdots,i_n\}$について$A\not\subset U_{i_1}\cup\cdots\cup U_{i_n}$ならば，$A\not\subset \cup_{i\in I}U_i$である．
        \end{quote}
        となる．$F_i:=X\setminus U_i$と定めるとこれは閉集合で，
        \begin{align*}
            A\not\subset U_{i_1}\cup\cdots\cup U_{i_n}&\Leftrightarrow A\cap F_{i_1}\cap\cdots\cap F_{i_n}\ne\emptyset,\\
            A\not\subset \cup_{i\in I}U_i&\Leftrightarrow A\cap\bigcap_{i\in I}F_i.
        \end{align*}
        \item[(1)$\Leftrightarrow$(3)]
        \begin{align*}
            A\subset\bigcup_{i\in I}U_i&\Leftrightarrow A=A\cap\bigcup_{i\in I}U_i\Leftrightarrow \bigcup_{i\in I}(A\cap U_i)
        \end{align*}
        より．
    \end{description}
\end{proof}
\begin{remarks}
    (3)についてだが，開被覆は$A$上の相対位相に引き継がれ，コンパクト性の条件も同時に引き継がれるということである．
\end{remarks}

\subsection{最大値の定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=コンパクト集合とは，最大値を持つような部分集合のこと．正則領域みたいな．]
    コンパクト空間上定義された実数値連続関数について最大値の定理を示し，特に閉区間上の場合について導く．

    関数を立てると，その関数が特定の性質を満たすような部分集合，という研究の方法が連結性と一致するし，多変数複素解析にも通じる．
    今回は値域は$2$ではなく$\R$で，特に距離空間の場合について詳細に調べられる．
    一般の距離空間でコンパクト集合は有界である．有界ならばなんでも良いわけではなく，$\R$では閉区間である．
\end{tcolorbox}

\begin{proposition}[maximum value theorem]\label{prop-maximum-value-theorem}
    $X$を位相空間とし，$f:X\to\R$を連続関数とする．$A$が$X$のコンパクト集合であり空でないならば，$f$の$A$への制限には最大値が存在する．
\end{proposition}
\begin{remark}
    逆は，$X$が距離空間で，$A$が閉集合ならば成り立つが，一般的には成り立たない．
\end{remark}
\begin{proof}
    $\forall x\in A,\;\exists y\in A,\; f(x)<f(y)$と仮定して，矛盾を導く．
    これは，$A$の元$y\in A$に対して$U_y:=f^{-1}((-\infty,f(y)))$と定めると，$A=\cup_{y\in A}U_y$となる，と翻訳できる．
    任意の$x\in A$に対して，$y$が存在して$x\in U_y$を満たす，ということである．

    こうして$A$の開被覆$(U_y)_{y\in A}$を得たが，$A$はコンパクトであるから，有限個の元$y_1,\cdots,y_n\in A$で$A\subset U_{y_1}\cup\cdots\cup U_{y_n}$を満たすものが存在する．
    すると，このうちで$f(y_i)$を最大にする$y_i$が定まるから，$y\in A\subset U_{y_1}\cup\cdots\cup U_{y_n}=U_{y_i}$となってしまうが，これは$y_i\in f^{-1}(-\infty,f(y_i))=f(y_i)\in(-\infty,f(y_i))$を意味し，矛盾．
\end{proof}
\begin{remarks}
    凄すぎる．最大値の定理の議論を見事に集合の言葉に引き込んでいる．
    が，一体なぜ矛盾が生じたのか見えにくい．すごく動作原理は込み入っていて，技巧的な証明と言わざるを得ない．
    後知恵としては$f|_A:A\to\R$が閉写像になるからであるが，・・・
\end{remarks}

\begin{definition}[maximum norm]
    $X$をコンパクト空間とすると，その上の連続写像には最大値が存在し，有界であるから，$C(X)=B(X)$が成り立つ．
    従って$C(X)$上にノルム$\|f\|_\infty=\max_{x\in X}|f(x)|$が定義できる．
    これを$f$の\textbf{最大値ノルム}という．
\end{definition}

\begin{corollary}[距離空間のコンパクト集合]\label{cor-compact-sets-in-metric-space-is-bounded}\mbox{}
    \begin{enumerate}
        \item $X$を距離空間とする．$A$が$X$のコンパクト部分集合ならば，$A$は有界である．
        \item $A$が$\R$の空でないコンパクト集合ならば，$A$は最大元を持つ．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $A$が空でない場合について示せば良い．勝手に$a\in A$を取り，連続関数$d(-,a):A\to\R$について最大値の定理\ref{prop-maximum-value-theorem}を適用すれば，最大値$M$を得る．三角不等式より，任意の$x,y\in A$について，$d(x,y)\le d(x,a)+d(y,a)\le 2M$．
        \item 恒等写像$A\to A\subset\R$は連続だから，これに最大値の定理\ref{prop-maximum-value-theorem}を適用すれば良い．
    \end{enumerate}
\end{proof}

\begin{theorem}[Heine-Borel / Borel-Lebesgue]\label{thm-Heine-Borel}
    $a\le b$を実数とする．閉区間$[a,b]$は$\R$のコンパクト集合である．
\end{theorem}

\begin{corollary}
    $f:[a,b]\to\R$を連続関数とする．$f$の最大値$M$と最小値$m$が存在し，$f([a,b])=[m,M]$である．
\end{corollary}
\begin{proof}
    最大値の定理より，$f$の最大値$M$が存在する．関数$-f$も最大値$M'$をもち，$m:=-M'$が$f$の最小値である．
    よって，$f([a,b])\subset[m,M]$．一方で，系\ref{cor-monotone-map-over-intervals}より，$[m,M]\subset f([a,b])$でもある．
\end{proof}

\subsection{全有界，ルベーグ数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=距離空間とコンパクト性]
    $\R$だけでなく，一般の距離空間がコンパクトであるための特徴付けを建立することを考える．
    全有界で，任意の開被覆がLebesgue数を持つ$X$が，コンパクト集合となる．
\end{tcolorbox}

\begin{definition}[totally bounded, Lebesgue number]\label{def-Lebesgue-number}
    $X$を距離空間とする．
    \begin{enumerate}
        \item $X$が\textbf{全有界}であるとは，任意の実数$r>0$に対して，$X=U_r(a_1)\cup\cdots\cup U_r(a_n)$を満たす有限個の点$a_1,\cdots,a_n\in X$が存在することをいう．
        \item $(U_i)_{i\in I}$を$X$の開被覆とする．実数$r>0$が次の条件(L)を満たす時，$r$は$(U_i)_{i\in I}$の\textbf{ルベーグ数}であるという．
        \begin{quote}
            (L) 任意の空でない部分集合$A\subset X$に対して，$A$の直径が$r$以下ならば，$A\subset U_i$を満たす$i\in I$が存在する．
        \end{quote}
    \end{enumerate}
\end{definition}
\begin{remarks}
    $A=\{a_1,\cdots,a_n\}$と置けば，全有界の条件とは$\forall x\in X,\;d(x,A)<r$ということである．
    有界とは，$r>0$を十分大きくとれば$\Abs{A}=1$と出来る，ということである．
    全く住み分けている．
\end{remarks}

\begin{proposition}[距離空間がコンパクトであることの特徴付け]\label{prop-距離空間がコンパクトであることの特徴付け}
    $X$を距離空間とする．次の２条件は同値である．
    \begin{enumerate}
        \item $X$はコンパクトである．
        \item $X$は全有界であり，$X$の任意の開被覆$(U_i)_{i\in I}$に対し，$(U_i)_{i\in I}$のルベーグ数が存在する．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] $X$をコンパクトとする．
        \begin{enumerate}
            \item 任意の$r>0$に対して，$r$-開球$(U_r(x))_{x\in X}$は$X$の開被覆だから，$X=U_r(a_1)\cup\cdots\cup U_r(a_n)$を満たす$a_1,\cdots,a_n\in X$が存在する．
            \item $(U_i)_{i\in I}$を$X$の任意の開被覆とし，そのLebesgue数が存在することを示す．$X=\emptyset$ならば，$r\in\R$は任意に取ればいい．$X\ne\emptyset$とする．
            これに対して，\[B:=\{(x,r)\in X\times(0,\infty)\mid \exists i\in I,\;U_{2r}(x)\subset U_i\}\]
            とすると，$(U_i)_{i\in I}$が開被覆であることから，$(U_r(x))_{(x,r)\in B}$も開被覆である．従って$X$がコンパクトであることより，$(x_1,r_1),\cdots,(x_n,r_n)\in B\;(n\ge 1)$が存在して，$X\subset U_{r_1}(x_1)\cup\cdots\cup U_{r_n}(x_n)$が成り立つ．
            \item $r:=\min(r_1,\cdots,r_n)>0$とすれば，これが開被覆$(U_i)_{i\in I}$のLebesgue数であること，即ち条件(L)を満たすことを示す．
            $A\subset X$を，任意の，直径$r$以下の空でない部分集合とする．勝手な$a\in A$に対して，$a\in U_{r_j}(x_j)$を満たす$j\in[n]$が存在するから，$\exists i\in I,\;A\subset\overline{U_r(a)}\subset U_{2r}(x_j)\subset U_i$．
        \end{enumerate}
        \item[(2)$\Rightarrow$(1)]
        $(U_i)_{i\in I}$を任意の開被覆とし，$r>0$をそのLebesgue数とする．これの有限被覆を構成すれば良い．
        \begin{enumerate}
            \item まず，全有界より，$X=U_{\frac{r}{2}}(a_1)\cup\cdots\cup U_{\frac{r}{2}}(a_n)$を満たす$a_1,\cdots,a_n\in X$が存在する．
            \item 各開球の直径は$r$以下だから，$U_{\frac{r}{2}}(a_1)\subset U_{i_1},\cdots,U_{\frac{r}{2}}(a_n)\subset U_{i_n}$を満たす部分族$i_1,\cdots,i_n\in I$が存在する．
            \item この時，$X=U_{i_1}\cup\cdots\cup U_{i_n}$である．
        \end{enumerate}
    \end{description}
\end{proof}
\begin{remarks}
    (2)$\Rightarrow$(1)で全有界とLebesgueはどうやって使うのかがよくわかったが，まだまだ直接的だと感じる．
    特に全有界の概念は，今まで横で切っていたものを，$r>0$のパラメータを使って縦で切っている気がして馴染まない．
\end{remarks}

\section{コンパクト性と積位相}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=コンパクト性の概念の遊離：積位相で見ると一点と同じ開近傍の様子を持つ]
    まずコンパクト性の積位相を用いた特徴付けを得て，最大値の定理から飛翔させる．
    命題\ref{prop-characterization-of-compactness-in-terms-of-product-topology}は，積空間での開近傍の様子について，コンパクト集合とは１点だけからなる集合と同じ近傍系の条件（積位相の準基が開近傍の基本系となっている）を満たすことを表している．
    一方で命題\ref{prop-characterization-of-compactness-in-terms-of-projection}は，これを閉集合の言葉で言い換え，射影を使った表現に直したものである．$K$がコンパクト空間のとき，任意の$Y$に対して射影$\pr_2:K\times Y\to Y$は開かつ閉となる．
    圏論的には射の固有性を軸に据え，終対象へのただ一つの射$!:X\to 1$が固有である空間$X$がコンパクト集合であるとする．
\end{tcolorbox}

\subsection{コンパクト性の積位相の言葉による特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=コンパクト性の特徴付けとその応用]
    命題\ref{prop-characterization-of-compactness-in-terms-of-product-topology}の(3)の特徴付けを用いて，以下の結果を得る．
    \begin{itemize}
        \item コンパクト集合の，閉集合との共通部分はコンパクトである（コンパクト空間では閉集合はコンパクトである）．
        \item コンパクト集合の有限共通部分は，全体空間$X$がHausdorffならばコンパクトである（閉とコンパクトが同値になるのは，$X$がコンパクト・ハウスドルフである場合に限る，命題\ref{prop-compact-set-in-Hausdorff-spaces}）．
        \item コンパクト集合の有限合併はコンパクトである．
        \item 連続写像によるコンパクト集合の像はコンパクトである．
    \end{itemize}
    証明は，命題\ref{prop-characterization-of-compactness-in-terms-of-product-topology}の(3)の$Y=\S^I$を除いて，$Y$としては勝手な位相空間を用意してしまえば十分なのである．不思議だ．
\end{tcolorbox}

\begin{proposition}[コンパクト性の積位相の言葉による特徴付け]\label{prop-characterization-of-compactness-in-terms-of-product-topology}
    $X$を位相空間とし，$A$を$X$の部分集合とする．次の３条件は同値である．
    \begin{enumerate}
        \item $A$はコンパクトである．
        \item $Y$を任意の位相空間とし，$y\in Y$を任意の点とする．$A\times\{y\}$の任意の開近傍$W\subset X\times Y$に対し，$A$の開近傍$U\subset X$と$y$の開近傍$V\subset Y$で，$U\times V\subset W$を満たすものが存在する．
        \item $Y$を任意の位相空間とし，$y\in Y$を任意の点とする．$A\times\{y\}$の任意の開近傍$W\subset X\times Y$に対し，$y$の開近傍$V\subset Y$で，$A\times V\subset W$を満たすものが存在する．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] 
        \begin{enumerate}
        \item 
        $W\subset X\times Y$を$A\times\{y\}$の任意の開近傍として，$U\times V\subset W$を満たす$A$の開近傍$U$と$y$の開近傍$V$を構成すれば良い．
        積位相の特徴付けより，任意の$x\in A$に対して，$(x,y)\in U_x\times V_x\subset W$を満たす$x$の開近傍$U_x$と$y$の開近傍$V_y$が存在するから，これらの族$(U_x,V_x)_{x\in A}$を取ると，
        $A\times\{y\}\subset\cup_{x\in A}(U_x\times V_x)\subset W$を満たす．が，$\cup_{x\in A}(U_x\times V_x)\subset (\cup_{x\in A}U_x)\times(\cup_{x\in A}V_x)$であって，等号は成り立たないので，
        まだ$U,V$は構成できない．\textbf{ここで$A$がコンパクトであることが効いてくる}のである．
        \item
        いま，族の定め方より$A\subset\cup_{x\in A}U_x$で，$A$はコンパクトであるために，族$(U_x,V_x)_{x\in A}$のうち$(U_1,V_1),\cdots,(U_n,V_n)$が存在して，$A\subset\cup_{i\in[n]}U_i$を満たす．
        この時，$U:=\cup_{i\in[n]}U_i,V:=\cap_{i\in[n]}V_i$とすれば，いずれも開集合で，
        \[A\times\{y\}\subset U\times V=\cup_{i\in[n]}U_i\times V\subset\cup_{i\in[n]}(U_i\times V_i)\subset W\]
        を満たす．
        \end{enumerate}
        \item[(2)$\Rightarrow$(3)]
        $U\times V\subset W$を満たす$A$の開近傍$U$が存在するならば，$A\times V\subset U\times V\subset W$である．
        \item[(3)$\Rightarrow$(1)] $(U_i)_{i\in I}$を$X$の開集合の族で，$A\subset\cup_{i\in I}U_i$を満たすものとする．このうちの有限部分被覆を構成する算譜を与えれば良い．
        \begin{description}
            \item[場面設定して(3)を使う] 
            位相空間$Y$を積空間$Y:=\S^I$とし，点$y:=(1)_{i\in I}\in Y$を定数関数$1:I\to 2$とする．
            族$(V_i)_{i\in I}$を逆像$V_i:=\pr_i^{-1}(1)$と定めるとこれは開集合の族で，
            $W:=\cup_{i\in I}(U_i\times V_i)$とすると$X\times Y$の開集合の族が定まる．
            これについて，
            \begin{align*}
                (X\times\{y\})\cap W&=\cup_{i\in I}(U_i\times(\{y\}\cap V_i))&(\forall i\in I,\;X\cap U_i=U_i)\\
                &=\cup_{i\in I}U_i\times\{y\}&(\forall i\in I,\;\{y\}\cap V_i=\{y\})
            \end{align*}
            が成り立つから，
            \[A\times\{y\}\subset\cup_{i\in I}U_i\times\{y\}=(X\times\{y\})\cap W\subset W\]
            がわかり，$W$は$A\times\{y\}$の開近傍である．よって，(3)より，$A\times V\subset W$を満たす開近傍$1\in V\subset Y$が存在する．
            \item[構成]
            $I$の有限部分集合$J$に対して，$V_J:=\{1\}^J\times\S^{I\setminus J}$と書くこととする．
            すると，族の積位相の特徴付け（命題\ref{prop-universality-of-product-space}）より，
            開集合$V$に対して，$y\in V_J\subset V$となる$J$が存在する．
            \textbf{ここで，空間$Y$の決め方が効いてくる}．
            $\chi_J\in V_J$が成り立つ．これより，
            \[A\times\{\chi_J\}\subset A\times V_J\subset A\times V\subset W\]
            である．これと$(X\times\{\chi_J\})\cap W=\cup_{i\in J}U_i\times\{\chi_J\}$と併せて，$A\subset\cup_{i\in J}U_i$を得る．
        \end{description}
    \end{description}
\end{proof}
\begin{remarks}\mbox{}
    \begin{enumerate}
        \item (2)の条件は技術的なもので，あまりに「なにそれ」という感じだ．こういうものは認知容易性についての祈りがない．これを1に還れるのに十分な範囲で条件を削ぎ落とし，使いやすくしたのが(3)である．
        \item (1)$\Rightarrow$(2)の肝は2である．$A$がコンパクトである場合，積空間$X\times Y$の基底の中から，$A\times\{y\}$に密着する開近傍を$W$に対して必ず選べる．
        \item (3)$\Rightarrow$(1)となると技巧的である．(3)の条件があれば，$A$の開被覆の中から有限のものが選び出せる．$Y$として特性関数の空間$\S^I$を指定し，積によって$X$に接続して$A\times\{y\}\subset X\times Y$を得る．
        定数関数$y:I\to 2$を包む開集合$V$が必ず選べるのなら，\textbf{積位相の特徴付けから}，
        から$X\times Y$の位相の基底のメンバーでもあるもの$V_J$が作れて$A\times\{y\}\subset A\times V_J$と密着している．
        即ち，有限個の$I$の元である．
    \end{enumerate}
\end{remarks}

\begin{corollary}[有限個の合併，閉集合との共通部分はコンパクトである]\label{cor-union-intersection-of-compact-sets-is-compact}
    $X$を位相空間とする．
    \begin{enumerate}
        \item $A\subset X$をコンパクト集合とする．$B$が$X$の閉集合ならば，$A\cap B$もコンパクト集合である．特に$X$がコンパクト空間ならば，$X$の閉集合$B=X\cap B$はコンパクト集合である．
        \item $A_1,\cdots,A_n$が$X$の有限個のコンパクト集合ならば，合併$A_1\cup\cdots\cup A_n$もコンパクト集合である．
    \end{enumerate}
\end{corollary}
\begin{proof}
    任意の位相空間$Y$とその点$y\in Y$を用意する．
    \begin{enumerate}
        \item $(A\cap B)\times\{y\}$の開近傍$W\subset X\times Y$を取り，$(A\cap B)\times\{y\}\subset (A\cap B)\times V\subset W$を満たす$y$の開近傍$V$が構成できることを示せば良い．
        いま$W\cup((X\setminus B)\times Y)$を考えれば，$B$は$X$-閉集合だから，これは$A\times\{y\}$を含む開集合，即ち開近傍で，$A$はコンパクトだから，$y$の開近傍$V\subset Y$が存在して，$A\times\{y\}\subset A\times V\subset W\cup((X\setminus B)\times Y)$を満たす．これについて，
        $(A\cap B)\times\{y\}\subset(A\cap B)\times V\subset W$である．
        \item 
        $(A_1\cup\cdots\cup A_n)\times\{y\}$の開近傍$W\subset X\times Y$を取り，
        \[(A_1\cup\cdots\cup A_n)\times\{y\}\subset (A_1\cup\cdots\cup A_n)\times V\subset W\]
        を満たす$y$の開近傍$V$を構成すれば良い．
        各$A_i\;(i\in[n])$はコンパクトで，$W$は$A_i\times\{y\}$の開近傍でもあるから，$A_i\times\{y\}\subset A_i\times V_i\subset W$を満たす$y$の開近傍の族$(V_i)_{i\in[n]}$が見つかる．これに対して，$V:=\cap_{i\in[n]}V_i$と定めれば良い．
        実際，これは再び$y$の開近傍で，
        \[(A_1\cup\cdots\cup A_n)\times\{y\}\subset (A_1\cup\cdots\cup A_n)\times V\subset\cup_{i\in[n]}(A_i\times V_i)\subset W\]
        を満たす．
    \end{enumerate}
\end{proof}
\begin{remarks}
    1.は$B$が閉集合だと，コンパクト集合$A$に対して，開近傍$(A\cap B)\times\{y\}\subset W$から開近傍$A\times\{y\}\subset W\cup((X\setminus B)\times Y)$を作り出す算譜が存在するということである．これについての条件(3)から，$y$の開近傍$V$を流用すれば良い．
    2.は命題\ref{prop-characterization-of-compactness-in-terms-of-product-topology}の(1)の2.の$V$の構成に似ている．$(A_1\cup\cdots\cup A_n)\times V\subset\cup_{i\in[n]}(A_i\times V_i)$を成り立たせるために，有限共通部分と定めるのである．
\end{remarks}

\begin{corollary}[連続写像はコンパクト性を保存する]\label{cor-image-of-compact-set-is-compact}
    $f:X\to Y$を連続写像とする．$A\subset X$をコンパクト集合とすると，$f(A)\subset Y$もコンパクト集合である．
\end{corollary}
\begin{proof}
    任意の位相空間$Z$とその点$z\in Z$を用意する．
    $f(A)\times\{z\}$の開近傍$W\subset Y\times Z$を任意に取り，$f(A)\times\{z\}\subset f(A)\times V\subset W$を満たす$z$の開近傍$V\subset Z$を構成すれば良い．

    $f\times 1:X\times Z\to Y\times Z$は連続写像より，$W':=(f\times 1)^{-1}(W)\subset X\times Z$は$A\times\{z\}$の開近傍である．$A$はコンパクトであるから，
    $A\times\{z\}\subset A\times V\subset W'$を満たす$z$の開近傍$V\subset Z$が存在する．これについて，
    \begin{align*}
        (f\times 1)(A\times\{z\})\subset(f\times 1)(A\times V)\subset(f\times 1)(W')\\
        \Leftrightarrow\quad&f(A)\times\{z\}\subset f(A)\times V\subset W
    \end{align*}
    である．
\end{proof}
\begin{remarks}
    $A\times\{z\}$への議論を写すときに，$W$をどう移動させてから戻せば良いか悩んでいた．
    しかしこういう操作は，射の言葉でやる他ないのである．積を考えているのだから，積写像の言葉を使わない手はない．
    才能ではなく道具の祈りを．逆像の像は元に戻る，という代数ルールに助けられるのも偶然ではあるまい．
\end{remarks}

\subsection{コンパクト性の射影の言葉による特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=コンパクト性の特徴付けとその応用]
    命題\ref{prop-characterization-of-compactness-in-terms-of-projection}の特徴付けは，命題\ref{prop-characterization-of-compactness-in-terms-of-product-topology}の特徴付けの双対命題を射影の言葉を使って表現したものである．
    コンパクト集合$X$については，任意の空間$Y$に対して，第二射影$\pr_2:X\times Y\to Y$が開写像であるだけでなく閉写像にもなる．
    これを用いて，以下の結果を得る．
    \begin{itemize}
        \item コンパクト集合の積は，積位相についてコンパクトである．
        \item すると，$\R^n$の有界閉集合はコンパクトであると分かる．
        \item 連続写像のコンパクト集合の像はコンパクトであることから，射影空間などはコンパクトであると分かる．
    \end{itemize}
\end{tcolorbox}

\begin{proposition}[コンパクト性の射影の言葉による特徴付け]\label{prop-characterization-of-compactness-in-terms-of-projection}
    位相空間$X$について，次の２条件は同値．
    \begin{enumerate}
        \item $X$はコンパクトである．
        \item 任意の位相空間$Y$に対して，$\pr_2:X\times Y\to Y$は閉写像である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)を積位相の言葉に翻訳] 
        $Y$を任意の位相空間，$y\in Y$を任意の点とすると，$X$がコンパクトであることは，任意の$X\times\{y\}$の開近傍$W\subset X\times Y$に対して，$X\times\{y\}\subset X\times V\subset W$を満たす$y$の開近傍$V\subset Y$が存在することに同値．
        \item[さらに閉集合の言葉に翻訳]
        $F:=(X\times Y)\setminus W$と置いて，$X\times Y$の開集合$W$を考える代わりに，閉集合$F$を考える．
        すると，$X\times\{y\}=\pr_2^{-1}(y)$より，射影の言葉を使うと，
        \begin{enumerate}
            \item $X\times\{y\}\subset W\Leftrightarrow\pr_2^{-1}(y)\cap F=\emptyset\Leftrightarrow y\in Y\setminus\pr_2(F)$．
            \item $X\times V\subset W\Leftrightarrow\pr_2^{-1}(V)\cap F=\emptyset\Leftrightarrow V\subset Y\setminus\pr_2(F)$．
        \end{enumerate}
        と書き換えられる．以上をまとめると，(1)は
        \begin{quote}
            (3') 任意の位相空間$Y$に対して，$X\times Y$の任意の閉集合$F$と任意の点$y\in Y\setminus\pr_2(F)$に対し，$y$の開近傍$V\subset Y$で，$V\subset Y\setminus\pr_2(F)$を満たすものが存在する．
        \end{quote}
        と同値．
        \item[さらに点$y\in Y$を抽象化する]
        (3')の任意にとった$Y,F$に対する条件は，$\pr_2(F)$が$Y$の閉集合であるということと同値．よって(2)と同値．
    \end{description}
\end{proof}
\begin{remark}
    It makes possible a very direct hands-on proof of the Tychonoff theorem（定理\ref{thm-Tychonoff}）, without the need for infrastructure such as ultrafilters or nets.\footnote{\href{https://ncatlab.org/nlab/show/closed-projection+characterization+of+compactness}{closed-projection characterization of compactness}}
\end{remark}

\begin{definition}[proper map]
    連続写像$f:X\to Y$が\textbf{固有}であるとは，任意のコンパクト集合$C\subset Y$に対して，逆像$f^{-1}(C)$がコンパクトであることをいう．\footnote{While every continuous map sends compact subsets to compact subsets, it is not true in general that the preimage of a compact set along a continuous map is compact.}
\end{definition}
\begin{remark}[コンパクト性の終対象の言葉による特徴付け]
    固有とは，連続写像の定義をさらに強めたものになる．コンパクトは閉集合の特別な場合であると考えられる．
    この特徴付けは，一点からなる空間$1$へのただ一つの写像$X\to 1$が\textbf{固有}であることを表している．
    なぜならば，$!:X\to 1$は$Y=1$としたときの$\pr_2:X\times 1\to 1$という特別な場合であり，$!$がstably closedであるとき，$\pr_2^*!$もそうであるから，必然的に$\pr_2$もstably closedであることと同値である．
    \[\xymatrix{
        X\ar[r]^-{!}&1\\
        Y\times X\ar[u]^-{\pr_2}\ar[ur]_-{\pr_2^*!}
    }\]
    Thus, properness is a “relativized” version of compactness.\footnote{\url{https://ncatlab.org/nlab/show/compact+space\#compact_spaces_and_proper_maps}}
\end{remark}

\begin{corollary}[積もコンパクト]\label{cor-product-of-compact-sets-is-compact}
    $X,Y$を位相空間とする．$A\subset X,B\subset Y$がコンパクト集合ならば，$A\times B\subset X\times Y$もコンパクト集合である．
\end{corollary}
\begin{proof}
    命題\ref{prop-characterization-of-compactness-as-space}より，$A=X,B=Y$の場合について示せば十分である．
    $Z$を任意の位相空間とする．
    $X$がコンパクトという仮定より，射影$\pr_{23}:X\times(Y\times Z)\to Y\times Z$は閉写像で，$Y$がコンパクトより，射影$\pr_2:Y\times Z\to Z$は閉写像である．
    合成$\pr_3=\pr_2\circ\pr_{23}$も閉写像であるから，$X\times Y$はコンパクトである．
\end{proof}
\begin{remarks}
    命題\ref{prop-characterization-of-compactness-as-space}ってこう使うのか！
\end{remarks}

\begin{proposition}\label{prop-compact-sets-in-R^n}
    $\R^n$の有界な閉集合はコンパクトである．
\end{proposition}
\begin{proof}
    Heine-Borelの定理\ref{thm-Heine-Borel}より，閉区間$[-N,N]$は$\R$のコンパクト集合である．
    従って，系\ref{cor-product-of-compact-sets-is-compact}より，$[-N,N]^n$も$\R^n$のコンパクト集合である．

    $A$を$\R^n$の有界な閉集合とすると，$A\subset[-N,N]^n$を満たす$N\in\N$が存在する．
    $A$はコンパクト空間$[-N,N]^n$の閉部分空間だから，系\ref{cor-union-intersection-of-compact-sets-is-compact}より，$A$はコンパクトである．
\end{proof}
\begin{remarks}
    これはものすごく明快な論理である．有界な閉集合は，Heine-Borelの定理より，コンパクト空間の部分空間と閉みなせるから，コンパクトなのである．
\end{remarks}

\begin{example}[射影空間はコンパクトである]
    射影空間に付随する標準全射
    \[\xymatrix@R-2pc{
        p:\R^{n+1}\setminus\{0\}\ar[r]&\P^n(\R)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        x\ar@{|->}[r]&\R x
    }\]
    の球面$S^{n-1}$への制限は連続全射であり，$S^{n-1}$は$\R^n$の有界閉集合，即ちコンパクトだから$\P^{n-1}(\R)$もコンパクトである．
\end{example}

\begin{theorem}[Tychonoff]\label{thm-Tychonoff}
    $(X_i)_{i\in I}$をコンパクト空間の族とする．この時，積空間$\prod_{i\in I}X_i$はコンパクトである．
\end{theorem}

\section{コンパクト性とハウスドルフ空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=位相空間論の聖域への到達]
    コンパクト空間からハウスドルフ空間への連続写像は閉写像になる．
    この性質は，コンパクト空間には「欠落がない」ということを表している．

    ハウスドルフ位相よりも細かい位相はハウスドルフであり，コンパクト位相よりも粗い位相はコンパクトである（注\ref{remark-quasicompcat}での準コンパクトの概念の通り）．従って，コンパクト・ハウスドルフ位相は，ハウスドルフ位相の中でも極小であり，コンパクト位相の中で極大である．
    位相空間の圏は公理が「足りず」，準同型定理が成り立たない（コンパクトハウスドルフでは系\ref{cor-Compact-Hausdorff}）．
    これには，足元にコンパクト性，頭上にハウスドルフ性分だけ足りない．
    ２つを揃えたときのHom集合では，連続全単射と同相写像とが同値になる．
    随分奇妙な風景だ．

    compact Hausdorff spaceは，任意の点列に一意的な極限が存在する空間である．
\end{tcolorbox}

\begin{definition}[perfect set, derived set]
    集合$S\subset X$が\textbf{完全}であるとは，閉集合であり，かつ孤立点を持たないことをいう．
    即ち，$S$の列の極限（＝集積点）からなる集合(\textbf{導来}集合 derived set)を$S'$とすれば，$S=S'$が成り立つことをいう．
\end{definition}

\subsection{コンパクト空間からハウスドルフ空間への射}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=コンパクト空間とハウスドルフ空間との間のHom集合]
    コンパクト空間とハウスドルフ空間との間の射は，閉写像で，かつproperである．また，従って，全単射であることと同相であることが一致する．
\end{tcolorbox}

\begin{proposition}\label{prop-continuous-map-from-compact-to-Hausdorff}
    $X$を位相空間，$Y$をHausdorff空間とし，$f:X\to Y$を連続写像とする．
    \begin{enumerate}
        \item $X$がコンパクトならば，$f$は閉写像である．
        \item $A$が$X$のコンパクト集合ならば，$f(A)$は$Y$の閉集合である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item \begin{description}
            \item[場面設定] 任意の閉集合$A\subset X$について，像$f(A)\subset Y$が閉であることを示せば良い．$f$のグラフ$\Gamma\subset X\times Y$を考えると，$f(A)=\pr_2(\pr_1^{-1}(A)\cap\Gamma)$である．
            \item[終域Hausdorff性] $Y$がHausdorffであるため，$\Gamma$は閉である（Hausdorff性の特徴付け\ref{prop-characterization-of-Hausdorff-in-terms-of-equalizer}）．
            \item[挿入曲] $\pr_1^{-1}(A)$が閉集合であるため，$\pr_1^{-1}(A)\cap\Gamma$も閉集合である（積位相の特徴付け\ref{prop-characterization-product-topology}より，射影は連続）．
            \item[始域compact性] $X$がcompactであるため，$\pr_2:X\times Y\to Y$は閉写像である．よって，$f(A)=\pr_2(\pr_1^{-1}(A)\cap\Gamma)$は閉（コンパクト性の特徴付け\ref{prop-characterization-of-compactness-in-terms-of-projection}）．
        \end{description}
        \item 
        1.より，制限$f|_A:A\to Y$は閉写像である．その閉集合$A$の像$f(A)$は閉である．
    \end{enumerate}
\end{proof}
\begin{remarks}
    Hausdorffとcompactについて全ての特徴付けの準備が整っているので，一気にパズルのピースが揃っている感じがする．
\end{remarks}

\begin{corollary}\label{cor-Compact-Hausdorff}
    $X$をコンパクト空間，$Y$をハウスドルフ空間とし，$f:X\to Y$を連続写像とする．
    \begin{enumerate}
        \item $f$が全単射ならば，$f$は同相写像である．
        \item $f$が単射ならば，$f:X\to Y$は閉埋め込みである．
        \item 像$f(X)$は$Y$の閉集合であり，$f$が引き起こす可逆写像$\overline{f}:X/R_f\to f(X)$は商空間から部分空間への同相写像である．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 逆写像$g:Y\to X$が連続だと示せば良い．任意の開集合$U\subset X$について，$F:=X\setminus U$は閉より，$g^{-1}(U)=g^{-1}(X\setminus F)=Y\setminus g^{-1}(F)=Y\setminus f(F)$は$Y$の開集合である．
        \item $f:X\to Y$は閉写像でもあるから，閉埋め込みになる．
        \item 命題\ref{prop-continuous-map-from-compact-to-Hausdorff}より，$f(X)$は閉集合になる．
        系\ref{cor-image-of-compact-set-is-compact}より，商空間$X/R_f=p(X)$はコンパクトである．
        系\ref{cor-subspace-of-Hausdorff-is-Hausdorff}より，Hausdorff空間$Y$の部分空間$f(X)$はHausdorffである．よって，1.より，全単射$\overline{f}$は同型である．
    \end{enumerate}
\end{proof}
\begin{remarks}
    $f$が閉写像というのは，$f^*\O_Y=\O_X$ということなのか？
    $f$に単射が加わると埋め込みで，$f$に全射も加わると同型になる．
\end{remarks}

\subsection{Hausdorff空間内でのコンパクト性}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=Hausdorff空間内でのコンパクト集合はもっと詳細に特徴付けることが出来る]
    ハウスドルフ空間でのコンパクト集合は閉である．一点集合が閉であるのはその例として考えられる．
    コンパクトハウスドルフ空間では，コンパクト集合と閉集合は同値である．
    コンパクトでない空間$\R^n$では，閉集合だからと言ってコンパクトとは限らない．
    コンパクトだがハウスドルフではない空間$\S$では，コンパクトだからと言って閉集合だとは限らない．例えば$\{1\}$はコンパクトだが閉集合ではない．
\end{tcolorbox}

\begin{proposition}[Hausdorff空間内でのコンパクト集合]\label{prop-compact-set-in-Hausdorff-spaces}
    $X$をハウスドルフ空間とする．
    \begin{enumerate}
        \item $X$の部分集合$A$についての２条件
        \begin{enumerate}[(1)]
            \item $A$はコンパクト集合である．
            \item $A$は閉集合である．
        \end{enumerate}
        は，(1)$\Rightarrow$(2)が成り立つ，$X$がコンパクト空間である時に逆も成り立つ．
        \item $A,B$が$X$のコンパクト集合ならば，$A\cap B$も$X$のコンパクト集合である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $\Rightarrow$は包含写像$i:A\to X$の像$i(A)=A$は閉であることから従う．$\Leftarrow$は系\ref{cor-union-intersection-of-compact-sets-is-compact}より，$X$がコンパクト空間であるとき，閉集合$A(=X\cap A)$はコンパクトである．
        \item 系\ref{cor-product-of-compact-sets-is-compact}より，コンパクト集合の積$A\times B$は積空間$X\times X$のコンパクト集合である．
        $X$はHausdorff空間であるから，特徴付け\ref{prop-characterization-Hausdorff}より，$\Delta_X\subset X\times X$は閉集合である．よって，$(A\times B)\cap\Delta_X=(A\cap B)\times(A\cap B)$は$X\times X$のコンパクト集合である．
        連続写像$\pr_2:X\times X\to X$の像$\pr_2((A\cap B)\times (A\cap B))=A\cap B$もコンパクトである．
        なお，この事実は，積位相の特徴付け\ref{prop-characterization-product-topology}により，
        対角写像$X\to X\times X$が埋め込みであり，その制限により定まる同型$A\cap B\to(A\times B)\cap\Delta_X$からも分かる．
    \end{enumerate}
\end{proof}
\begin{remarks}
    これも命題\ref{prop-continuous-map-from-compact-to-Hausdorff}同様，パズルのピースがハマるかのように得られる．
\end{remarks}

\begin{corollary}[コンパクトではない空間でのコンパクト集合]
    $X$を距離空間とし，$X$の部分集合$A$について，次の２条件
    \begin{enumerate}[(1)]
        \item $A$はコンパクトである．
        \item $A$は有界閉集合である．
    \end{enumerate}
    は，(1)$\Rightarrow$(2)が成り立つ，$X=\R^n$の時に逆も成り立つ．
\end{corollary}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] 
        \begin{enumerate}
            \item 距離空間内のコンパクト集合は有界である（系\ref{cor-compact-sets-in-metric-space-is-bounded}）．距離函数に最大値の定理を適用することからえる．
            \item 距離空間はハウスドルフである（命題\ref{prop-metric-space-is-Hausdorff}）．距離函数は実数に値をとっているために，自由に点を近傍によって分離できるのである．
            \item ハウスドルフ空間のコンパクト集合は閉集合である（命題\ref{prop-compact-set-in-Hausdorff-spaces}）．
        \end{enumerate}
        \item[(2)$\Rightarrow$(1)]
        命題\ref{prop-compact-sets-in-R^n}．$\R^n$では有界閉集合は，Heine-Borelの定理の帰結だが，コンパクト空間の閉集合となる．
    \end{description}
\end{proof}

\subsection{コンパクトハウスドルフ空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily]
    ハウスドルフ空間のうち，コンパクト空間を一点に潰しても，ハウスドルフである．
    コンパクトハウスドルフ空間のうち，コンパクト空間を一点に潰しても，コンパクトハウスドルフである．
    コンパクトハウスドルフ空間は$T_4$である．
\end{tcolorbox}

\begin{proposition}[ハウスドルフはコンパクト集合を一点に潰してもハウスドルフである]\label{prop-compact-Hausdorff-after-one-point-quotient-map}
    $X$をハウスドルフ空間とし，$A\subset X$を空でないコンパクト集合とする．
    $A$を一点に潰して得られる空間$Y$はハウスドルフである．
    さらに，$X$がコンパクトなら，$Y$もコンパクトである．
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[商空間の復習] 
        $R_A:=(A\times A)\cup\Delta_X$とする．$q:X\to X/R_A=Y$を商写像とし，$q(A)=:\{c\}$とする．
        この一点集合は像位相について閉だから，$Y\setminus\{c\}$は開である．
        実際，Hausdorff空間内のコンパクト集合$A\subset X$は閉より，$X\setminus A$は開であり，$q^{-1}(Y\setminus\{c\})=X\setminus q^{-1}(c)=X\setminus A$を満たす集合$Y\setminus\{c\}$は開である．
        従って，制限$q|_{X\setminus A}:X\setminus A\to Y\setminus\{c\}$は同相写像である．
        \item[命題の言い換え]
        この値域$Y\setminus\{c\}$は，Hausdorff空間$X$の部分空間（これもまたHausdorff）と同相だから，Hausdorffである．
        証明としては，逆写像について命題\ref{prop-Hausdorff性は連続単射によって足に感染る}による．
        以下，任意の点$x\in X\setminus A$に対して，$c$の開近傍$U\subset Y$と$q(x)$の開近傍$V\subset Y$で互いに素なものを構成すれば良い．
        \item[$A$がcompactだと$q(A)=c$が近傍によって分離できる理由] \mbox{}\\
        コンパクト性の特徴付け\ref{prop-characterization-of-compactness-in-terms-of-product-topology}を用いる．
        $W:=(X\times X)\setminus\Delta_X$を考えると，$X$がHausdorffより，これは開で，$x\notin A$より，これは$A\times\{x\}$の開近傍である．
        $A$はコンパクトだから，
        \[A\times\{x\}\subset\tilde{U}\times\tilde{V}\subset W\]
        を満たす$A$の開近傍$\tilde{U}\subset X$と$x$の開近傍$\tilde{V}\subset X$が存在する．$\tilde{U}\times\tilde{V}\subset W$とは，任意の$u\in\tilde{U}$と$v\in\tilde{V}$について$u\ne v$ということだから，
        $\tilde{U}\cap\tilde{V}=\emptyset$である．

        この像を$U:=q(\tilde{U}),V:=q(\tilde{V})$と置けば，$q$は$A$を潰す商写像だから，$q^{-1}(\tilde{U})=U,q^{-1}(\tilde{V})=V$が成り立つ．
        よって$q^{-1}(\tilde{U}\cap\tilde{V})=U\cap V=\emptyset$で，また，$U\subset Y$は$q(A)=c$の開近傍で，$V\subset Y$は$q(x)$の開近傍である．
        よって，$Y$はHausdorffである．
        \item[コンパクト性] $X$がコンパクトなら，その$q$による像である$Y$もコンパクトである．
    \end{description}
\end{proof}
\begin{remarks}
    商写像$q:X\to Y$を，同相部分$X\setminus A\to Y\setminus\{c\}$と，非単射な部分$A\to\{c\}$に分解して考察する．
    だが，$A$がコンパクトであることを実際に使う部分は極めて技巧的である．
\end{remarks}

\begin{corollary}[コンパクト・ハウスドルフ空間の互いに交わらない閉集合は，開集合で分離できる]\label{cor-compact-Hausdorff-space-is-normal}
    $X$がコンパクト・ハウスドルフ空間ならば，$X$は正規である．
\end{corollary}
\begin{proof}
    $A,B\subset X$を互いに素な空でない閉集合とする．
    $A$の開近傍$U\subset X$と，$B$の開近傍$V\subset X$で，$U\cap V=\emptyset$を満たすものを構成すれば良い．
    \begin{description}
        \item[空間$Z$の構成] 
        compact-Hausdorff空間の閉集合とはcompact集合であるから（命題\ref{prop-compact-set-in-Hausdorff-spaces}），
        これを１点に潰して得られる空間$Y:=X\setminus(A\times A)\cup\Delta_X$はcompact-Hausdorffである（命題\ref{prop-compact-Hausdorff-after-one-point-quotient-map}）．この商写像を$q:X\to Y$とすると，これは連続だから，$B':=q(B)$もcompactである（系\ref{cor-image-of-compact-set-is-compact}）．
        こうして，$Y$を１点に潰して得られる空間$Z:=Y\setminus(B'\times B')\cup\Delta_Y$もcompact-Hausdorffである．
        この商写像を$q':Y\to Z$とする．
        \item[Hausdorff性から結論を得る]
        $p:=q'\circ q:X\to Z$とし，$a,b\in Z$を$p^{-1}(a)=A,p^{-1}(b)=B$で定まる１点の名前とする（$A\cap B=\emptyset$よりwell-definedである）．
        $a\ne b$だから，$a$の開近傍$U'\subset Z$と$b$の開近傍$V'\subset Z$で$U'\cap V'=\emptyset$を満たすものが存在する．
        $U:=p^{-1}(U'),V:=p^{-1}(V')$と置けば良い．
    \end{description}
\end{proof}
\begin{remarks}
    一点に潰して考えるのか，すごいなあ．
    すると，compact-Hausdorff空間の$T_4$性は，潰した先のHausdorff空間$Z$のHausdorff性に由来しているのだ．
    これもコンパクト性の特徴付け\ref{prop-characterization-of-compactness-in-terms-of-product-topology}と同様に，compact集合が，一点集合と同じ近傍系の様子を持つことの表現と考えられる．
\end{remarks}

\section{局所コンパクト空間とコンパクト化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=compact-Hausdorff空間という聖域の構成の試み]
    ハウスドルフ空間がコンパクトであるとは「欠落がない」場合である．
    欠落部を補ってコンパクトに構成する方法がある．
    これが成功するには，空間が局所コンパクトである必要がある．
    Euclid空間はコンパクトではないが，局所コンパクトではある．
    こうして，聖域の次の階層として，局所コンパクト空間が考えられる．
    これはコンパクトを考えることで，コンパクト・ハウスドルフ空間からコンパクト部分集合を取り除いたものとして扱うことができる．
    また，Cartesian Closedでない圏Topで$\Hom_\Top(X\times Y,Z)\simeq\Hom_\Top(X,Z^Y)$が成り立つのは，$Y$が局所コンパクトであることが必要（十分？）である．
\end{tcolorbox}

\subsection{局所コンパクトなハウスドルフ空間の１点コンパクト化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=１点コンパクト化]
    １点コンパクト化は，コンパクト集合の補集合（余コンパクト）を，新たに追加すべき開集合の候補として挙げることで空間を拡張しようとする．
    これはAlexandroff拡大といい，一般に成功する（問題\ref{problem-construction-of-topology-in-terms-of-filter-on-onepoint-compactification}）．
    しかし，ハウスドルフな空間が完成するためには，$X$は局所コンパクトである必要がある（必要十分条件）．
    位相の構成の仕方もfilterチックで，局所コンパクトの概念もfilter的な消息である．
    ここに位相の泥臭さが垣間見れる．
\end{tcolorbox}

\begin{definition}[relatively compact, locally compact, compactification, (Alexandroff) one-point compactification]
    $X$をハウスドルフ空間とする．
    \begin{enumerate}
        \item 部分集合$A\subset X$の閉包$\overline{A}$がコンパクトである時，$A$は\textbf{相対コンパクト部分空間}であるという．
        \item $X$の任意の点$x\in X$に対し，$x$の相対コンパクトな開近傍$U$が存在するとき，$X$は\textbf{局所コンパクト}であるという．
        \item $Y$がコンパクト・ハウスドルフ空間であり，$f:X\to Y$が開埋め込みである時，$f$により，$Y$は$X$の\textbf{コンパクト化}であるという．
        \item さらに，$Y\setminus f(X)$が一点集合である時，$Y$は$X$の\textbf{一点コンパクト化}または\textbf{アレクサンドロフのコンパクト化}であるといい，この点を\textbf{無限遠点}という．
    \end{enumerate}
\end{definition}
\begin{remarks}[相対コンパクトや局所コンパクトは，フィルター上の消息である]
    相対コンパクト空間は，距離空間（または一様空間）の有界／全有界の概念とanalogousである．
\end{remarks}

\begin{remark}\mbox{}\label{remark-locally-compact}
    \begin{enumerate}
        \item \textbf{相対コンパクト集合は$P(X)$の中でイデアルをなす}．\textbf{この相対コンパクト集合のイデアルが全体空間を被覆することを局所コンパクトという}．
        \item コンパクト空間の閉部分集合はコンパクトであること（系\ref{cor-union-intersection-of-compact-sets-is-compact}）に注意すると，あるコンパクト集合$C\subset X$の部分集合$A\subset C$ならば，$A$は相対コンパクトである．これが名前の由来であろう．従って局所コンパクト性とは，\textbf{filterの中空部の消息「コンパクト集合で被覆できるか」である}．コンパクト性の第二階層目という感じがする．
        \item 開埋め込みとは，開部分集合への同型のことである（注\ref{remark-open-imbedding}）．
        \item ハウスドルフ空間$X$の部分集合$A$が相対コンパクトであるためには，$A$を部分集合として含むコンパクト集合$K\subset X$が存在すれば良い（命題\ref{prop-compact-set-in-Hausdorff-spaces}）．（コンパクトならば閉集合であるという消息や系\ref{cor-Hausdorff空間への連続写像は，稠密な部分集合への制限で一意的に定まる}と関係がある？）．が，一般に相対コンパクトであることの方が条件が緩い．
        \item 距離空間の相対コンパクトな部分集合は，有界である．距離空間はHausdorffで，相対コンパクトなものはそれを含むコンパクト集合があるということである．これは距離空間では有界を意味する（系\ref{cor-compact-sets-in-metric-space-is-bounded}）．
        \item コンパクトハウスドルフ空間は局所コンパクトである．任意の集合$A$について閉包がコンパクトだからである．離散空間も局所コンパクトである．
        \item コンパクトハウスドルフ空間と違って，局所コンパクト空間は正規とは限らない．
        \item 従って，正規空間の開部分空間も正規とは限らない．
        \item アレクサンドロフ拡大は、位相空間の圏（固有連続写像を射とする）から連続写像$c: X \to Y$ を対象とする圏への函手と見ることができる。
        \item 用語法としては，コンパクト空間$Y$と開埋め込みの組$(Y,f:X\to Y)$をAlexandroff拡大といい，$Y$がHausdorffでもあるとき，この組をAlexandroff compactificationという．
    \end{enumerate}
\end{remark}

\begin{example}[局所コンパクト：球面，射影空間]\mbox{}
    \begin{enumerate}
        \item $n\ge 1$ならば，$\R^n$はコンパクトではないが，局所コンパクトではある．コンパクト空間$X=[0,1]\times [0,1]$の部分空間$X\setminus(\{0\}\times(0,1])$は局所コンパクトではない．
        \item 立体射影$p:S^n\setminus\{(0,\cdots,0,1)\}\to\R^n$の逆写像により，$S^n$は$\R^n$の一点コンパクト化である．
        \item 開埋め込み$j_1:\R^n\to\P^n(\R)$により，射影空間$\P^n(\R)$は$\R^n$のコンパクト化である．$n=1$ならば一点コンパクト化であり，$n\ge 2$ならば一点コンパクト化ではない．
    \end{enumerate}
\end{example}

\begin{proposition}[局所コンパクトなハウスドルフ空間ならば，１点コンパクト化可能である]\label{prop-one-point-compactification}
    $X$をハウスドルフ空間とする．次の３条件は同値である．
    \begin{enumerate}
        \item $X$は局所コンパクトである．
        \item $X$のコンパクト化が存在する．
        \item $X$の１点コンパクト化が存在する．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[(3)$\Rightarrow$(2)] １点コンパクト化は，コンパクト化の特別な場合である．
        \item[(2)$\Rightarrow$(1)] \mbox{}\\
        \begin{description}
            \item[証明方針] 
            コンパクト化$f:X\to Y$が存在する時，$Y$がcompact Hausdorff，$f$が開埋め込みだから，閉集合$A\subset Y$が存在して$f(X)=Y\setminus A$と同相．よって，$X\simeq Y\setminus A$として，$X$が局所コンパクトであると示せば良い．
            
            任意に$x\in X$を取る．$x\notin A$であるから，$Y$が正規より（系\ref{cor-compact-Hausdorff-space-is-normal}），$x$の開近傍$U$と$A$の開近傍$V$が存在して$U\cap V=\emptyset$を満たす．
            この時，
            \[U\subset K:=Y\setminus V\subset X=Y\setminus A\]
            であるが，$K\subset Y$は閉集合であるから，compactである（命題\ref{prop-compact-set-in-Hausdorff-spaces}）．よって，$U$は相対コンパクトである．
        \end{description}
        \item[(1)$\Rightarrow$(3)] $X$を局所コンパクト空間として，その１点コンパクト化$i:X\to Y:=X\coprod\{c\}$を構成する．
        \begin{description}
            \item[証明方針] $\O_X\subset P(X)$を$X$の開集合系とし，新たに開集合とすべき集合を$\mathcal{V}:=\{V\in\O_X\mid X\setminus VはXのコンパクト集合\}$とする．
            $\O\subset P(Y)$を，$\O:=\O_X\cup\{V\coprod\{c\}\mid V\in\mathcal{V}\}$とおくと，$\mathcal{V}$がfilterの公理を満たすため，$\O$は$Y$の位相であり（問題\ref{problem-construction-of-topology-in-terms-of-filter-on-onepoint-compactification}.4），$i:X\to Y$が開埋め込みであることを示す．続いて，こうして得た$(Y,\O)$がcompact Hausdorffであることを示す．
            \item[$i,\O$の定義]
            \begin{enumerate}[(1)]
                \item $U\in\O_X,V\in\mathcal{V}$について，$V\subset U$とする．このとき$X\setminus U\subset X\setminus V$はcompact集合の閉部分集合だからコンパクトであり（命題\ref{cor-union-intersection-of-compact-sets-is-compact}），$U\in\mathcal{V}$である．
                \item $(V_i)_{i\in I}$を$\mathcal{V}$の有限族とすると，$X\setminus\cap_{i\in I}V_i=\cup_{i\in I}(X\setminus V_i)$は系\ref{cor-union-intersection-of-compact-sets-is-compact}よりコンパクトである．よって，$\cap_{i\in I}V_i\in\mathcal{V}$．
            \end{enumerate}
            以上より，問題\ref{problem-construction-of-topology-in-terms-of-filter-on-onepoint-compactification}.4より，$\O$は$Y$の位相であり，$i:X\to Y$は開埋め込みである．
            \item[Hausdorff性]
            $X$はHausdorffであるから，あとは任意の$x\in X$に対して$c$と近傍によって分離できることを示せば良い．
            $X$は局所コンパクトであるから，$x$の開近傍$U$とコンパクト集合$K$であって，$x\in U\subset K\subset X$を満たすものが存在する．$V:=Y\setminus K\in\O$とすると，これは$c$の開近傍であり，$U\cap V=\emptyset$である．
            \item[compact性]
            $Z$を任意の位相空間とし，$z\in Z$を任意の点とする．任意の$Y\times\{z\}$の開近傍$W\subset Y\times Z$を取る．

            今，積位相の特徴付け\ref{prop-characterization-product-topology}への，$c\in Y$の開近傍$U\subset Y$と$z\in Z$の開近傍$V\subset Z$であって，$U\times V\subset W$を満たすものが存在する．
            $U\cap X\in\mathcal{V}$より，補集合$A:=Y\setminus U=i(X\setminus(U\cap X))$はcompactである．$W$は$A\times\{z\}$の開近傍でもあるから，$A\times\{z\}\subset A\times V'\subset W$を満たす$z$の開近傍$V'\subset Z$が存在する．
            すると，$z$の開近傍$V\cap V'$について，
            \begin{align*}
                Y\times\{z\}&\subset Y\times(V\cap V')\\
                &\subset (U\times V)\cup(A\times V')&\because Y=U\cap A,V\cap V'\subset V,V'\\
                &\subset W
            \end{align*}
            が成り立つ．よって，コンパクト性の特徴付け\ref{prop-characterization-of-compactness-in-terms-of-product-topology}より，$Y$はコンパクトである．
        \end{description}
    \end{description}
\end{proof}
\begin{remarks}
    (2)$\Rightarrow$(1)はすごいなあ．$A$に取れる分離する開近傍$A\subset V\subset Y$の補集合が閉即ちcompactだから，任意の$x\in X$には必ず相対コンパクトな$U$が取れるのである．
    (1)$\Rightarrow$(3)の構成は，コンパクト集合の補集合を新たな開集合の候補として採用することである．コンパクト集合とはこうやって使うのか！
\end{remarks}

\begin{lemma}[１点コンパクト化の位相の定め方のwell-definedness]
    $X$を局所コンパクト空間，$Y$をコンパクトハウスドルフ空間とし，$f:X\to Y$を$X$の一点コンパクト化とする．
    $\{c\}=Y\setminus f(X)$と置くと，次が成り立つ．
    \begin{enumerate}
        \item $\{U\in P(Y)\mid UはYの開集合でc\notin U\}=\{f(V)\mid VはXの開集合\}$，
        \item $\{U\in P(Y)\mid UはYの開集合でc\in U\}=\{Y\setminus f(A)\mid AはXのコンパクト集合\}$．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $f$は開埋め込みだから，$\overline{f}:X\to Y\setminus\{c\}$は同相写像．$c\notin U$を満たす部分集合$U\subset f(X)$が開集合であることは，$U$がある$X$の開集合の像であることに同値である．
        \item $Y$はcompact Hausdorffだから，命題\ref{prop-compact-set-in-Hausdorff-spaces}より，$U$が開集合であることと，$Y\setminus U$がcompactであることは同値．特に$c\in U$の時は補集合$Y\setminus U$が$f^{-1}(Y\setminus U)=X\setminus f^{-1}(U)$と同相だから，これは$U$があるcompact集合$A:=f^{-1}(U)$の像の補集合であることと同値．
    \end{enumerate}
\end{proof}
\begin{remarks}
    問題\ref{problem-construction-of-topology-in-terms-of-filter-on-onepoint-compactification}では直和によって表現されている消息である．
    $\O_Y$の位相は，無限遠点$c\in Y\setminus X$を含む開集合と含まない開集合に分離できて，片方はただの$\O_X$の元，もう片方は$c$の$\O_Y$開近傍であるが，これは$X$の側からはコンパクト集合の言葉で（間接的に）指定可能なのである．
\end{remarks}

\subsection{コンパクト・ハウスドルフ空間$\P^1(\C)$と代数学の基本定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=連結性でシュートを決める代数学の基本定理]
    射影直線のコンパクト性から，代数学の基本定理が導かれる．
    retraction（これは集合の同型であり，射影直線の複素多様体としての座標近傍の一つ）
    \[\xymatrix@R-2pc{
        \pi_1:U_1\ar[r]&\C\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        \C{\begin{pmatrix}\zeta_1\\\zeta_2\end{pmatrix}}\ar@{|->}[r]&\zeta_2/\zeta_1
    }\]
    が存在するために（$U_1=\left\{\C\begin{pmatrix}\zeta_1\\\zeta_2\end{pmatrix}\middle|\;\zeta_1\ne 0\right\}$とした），
    連続単射
    \[\xymatrix@R-2pc{
        j:\C\ar[r]&\P^1(\C)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        z\ar@{|->}[r]&(z:1)
    }\]
    は開埋め込みであり，補集合$\P^1(\C)\setminus j(\C)$は一点$\infty=(1:0)$のみからなるから，$\P^1(\C)$は$\C$の一点コンパクト化である．
    このことが代数学の基本定理の基礎の１つになっている．
    一体どうしてなのか．
    これさえ踏まえれば，あとは開写像定理と連結性から，結論を得る．
\end{tcolorbox}

\begin{lemma}
    射影直線$\P^1(\C)$はコンパクトハウスドルフである．
\end{lemma}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 複素射影直線の構成写像は次の商写像である：
        \[\xymatrix@R-2pc{
            p:\C^2\setminus\{0\}\ar[r]&\P^1(\C)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            {\begin{pmatrix}\alpha\\\beta\end{pmatrix}}\ar@{|->}[r]&\C{\begin{pmatrix}\alpha\\\beta\end{pmatrix}}
        }\]
        この制限$p|_{S^3}:S^3\to\P^1(\C)$は連続全射であり，$S^3\subset\C^2$は有界閉集合よりコンパクトだから，$\P^1(\C)$もコンパクト．
        \item 実射影空間で一般的に考える．
        次の写像を考える．
        \[\xymatrix@R-2pc{
            V:\R^n\setminus\{0\}\ar[r]&M_n(\R)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            x\ar@{|->}[r]&\frac{x{}^t\!x}{{}^t\!xx}
        }\]
        ${}^t\!xx\in\R$に注意．するとこれは，次のように連続単射$\overline{V}:\P^{n-1}(\R)\to S^{n^2-1}$を引き起こす．
        \[\xymatrix{
            \R^n\setminus\{0\}\ar[r]^-V\ar[d]_-p\ar@{-->}[dr]^-V&M_n(\R)\\
            \P^{n-1}(\R)\ar@{.>}[r]^-{\overline{V}}&S^{n^2-1}\ar[u]_-i
        }\]
        なぜならば，
        \begin{enumerate}[(1)]
            \item 行列$V(x)$のノルムは内積の一般化で$\Tr({}^t\!V(x)V(x))$で得られるから，
                \begin{align*}
                    \|V(x)\|^2&=\frac{1}{({}^t\!xx)^2}\Tr({}^t\!xx\cdot x{}^t\!x)\\
                    &=\frac{1}{({}^t\!xx)^2}{}^t\!xx\Tr(x{}^t\!x)\\
                    &=\frac{({}^t\!xx)^2}{({}^t\!xx)^2}=1
                \end{align*}
            より，値域は$S^{n^2-1}$に含まれる．
            \item 任意の$a\in\R^\times$について，$V(ax)=V(x)$であるから，$R_p\subset R_V$より，確かに$\overline{V}:\P^{n-1}(\R)\to S^{n^2-1}$は一意に定まる．
            \item これが単射であるのは，$R_p\supset R_V$でもあるためである．
            実際，行列$V(x)$の列ベクトルが生成する空間とは$\R x$に他ならない．よって，行列が一致するならその列ベクトルが生成する空間も一致するはずで，$V(x)=V(y)\Rightarrow p(x)=p(y)$が従う．
            総じて，$R_p=R_V$．よって，$\overline{V}$の定める同値関係は自明な同値関係で，$\overline{V}$は連続単射である．
        \end{enumerate}
        連続単射$\overline{V}:\P^{n-1}(\R)\to S^{n^2-1}$の値域はHausdorffだから，系\ref{cor-Hausdorff空間への連続写像は，稠密な部分集合への制限で一意的に定まる}より，$\P^{n-1}(\R)$もHausdorffである．
    \end{enumerate}
\end{proof}
\begin{remarks}
    謎の写像を使うが，これはひょっとしたら一次分数変換の一般化であろうか．$\overline{V}$の全射性は示せないのか．きっと事実はそれなんだろうが．
    特殊線型群であることを$S^{n^2-1}$と表現できるのか．
\end{remarks}

\begin{lemma}\mbox{}\label{lemma-regular-then-constant-or-open}
    \begin{enumerate}
        \item $f\in\C[X]$について，$f(\C)$は$\C$-閉集合である．
        \item (開写像定理) $U$を$\C$の連結開集合とし，$f:U\to\C$を正則関数とする．$f$が定数関数でなければ，$f$は開写像である．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item \begin{description}
            \item[証明方針] 
            $f$が定数$f=c$ならば，$f(\C)=\{c\}$より閉である．$f$が定数でないとする．$z\in\C$倍写像は閉写像であることより，最高次係数は１として考えても一般性は失われない．
            $f=X^n+a_1X^{n-1}+\cdots+a_n\in\C[X]$と置く．
            \item[compact Hasdorff空間上で考える]
            いま，写像を
            \[\xymatrix@R-2pc{
                \tilde{f}:\C^2\ar[r]&\C^2\\
                \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
                (z,w)\ar@{|->}[r]&(z^n+a_1z^{n-1}w+\cdots+a_nw^n,w^n)
            }\]
            と定めると，これは連続写像の積だから連続．これについて，
            \begin{enumerate}
                \item $\tilde{f}(\C^2\setminus\{0\})\subset\C^2\setminus\{0\}$，
                \item $\forall a\in\C^\times,\;\tilde{f}(az,aw)=a^n\tilde{f}(z,w)$．即ち，$R_p\subset R_{\overline{f}}$．
            \end{enumerate}
            が成り立つ．従って，$\tilde{f}|_{\C^2\setminus\{0\}}$を考えると，これは連続写像$\overline{f}:\P^1(\C)\to\P^1(\C)$を引き起こす．
            $\P^1(\C)$はcompact Hausdorffだから，$\overline{f}(\P^1(\C))$は$\P^1(\C)$の閉集合である．
            \item[結論]
            ここで，次の図式が可換である．
            \[\xymatrix{
                \C\ar[r]^-j\ar[d]_-f&\P^1(\C)\ar[d]^-{\overline{f}}\\
                \C\ar[r]^-j&\P^1(\C)
            }\]
            実際，
            \[\overline{f}(j(z))=\overline{f}((z:1))=(z^n+a_1z^{n-1}+\cdots+a_n:1)=j(z^n+a_1z^{n-1}+\cdots+a_n)=j(f(z))\]
            である．
            従って，$f(\C)=j^{-1}(\overline{f}(\P^1(\C)))$が成り立つ．閉集合の連続写像による逆像は閉なので，$f(\C)$は閉である．
        \end{description}
        \item
        \begin{description}
            \item[証明方針] 任意に開集合$V\subset U$をとり，$f(V)$が$\C$の開集合であることを示す．任意の点$a\in V$について，$f(a)$の開近傍であって$f(V)$に含まれるものを構成する．
            \item[構成] 
            $f^{-1}(f(a))$は$U$の離散部分集合であるから，$[\Delta(a,r)]\subset V$かつ$[\Delta(a,r)]\cap f^{-1}(f(a))=\{a\}$を満たす実数$r>0$が存在する．これについて，$C:=\partial\Delta(a,r)$と置くと，これはcompactだから，最小値
            $m:=\min_{z\in C}\abs{f(z)-f(a)}$が存在する．$C$の定め方より，$f(a)\notin f(C)$だから，$m=d(f(a),f(C))>0$が成り立っている．
            \item[証明]
            この$m$について，$U_{\frac{m}{2}}(f(a))\subset f(V)$と示す．
            任意に$w\in U_{\frac{m}{2}}(f(a))$を取ると，
            \begin{align*}
                \min_{z\in C}\abs{f(z)-w}&=d(w,f(C))\ge d(f(a),f(C))-d(f(a),w)>\frac{m}{2},\\
                \min_{z\in [\Delta(a,r)]}\abs{f(z)-w}&\le \abs{f(a)-w}<\frac{m}{2},
            \end{align*}
            が成り立つ．ここで，$w\notin f(V)$とすると，$f-w$が$V$上に零点を持たないことと同値である．
            $f-w:V\to\C$に零点が存在しないならば，各$z\in V$について，$g(z):=((f-w)(z))^{-1}$と定めて得る正則関数$g:V\to\C$
            についての最大値の原理より，有界閉集合$[\Delta(a,r)]$上で最小値を持つならばその境界点においてである：$\min_{z\in C}\abs{f(z)-w}=\min_{z\in [\Delta(a,r)]}\abs{f(z)-w}$．
            よって，矛盾．従って，$w\in f(V)$である．
        \end{description}
    \end{enumerate}
\end{proof}
\begin{remarks}\mbox{}
    \begin{enumerate}
        \item 1.でまさか射影空間に射を移動して考えるとは！
        一体どういう意味論を付与すればいいのか全くわからない．どうやって思いつくのか．
        $S^2$と$\P^1(\C)$の間にあるはずの同型も私の心の地図にはない．
        \item 2.は，各$a\in V$について，$f(a)$のfiberが離散的であることを利用して，$f(a)$の近くの図形$f(a)\subset f(C)\subset f(V)$を取り出し，そこから開球として取るべき半径$m/2$を設定できる算譜が存在することを言っている．
        開写像定理の証明に，平地先生は回転数を用いていて，正直こっちの方が自然だと思った．円周が写った先の図形$f(C)$が$f(a)$を囲んでいることが示せればそれで良いためであり，こっちの方が幾何学的に自然に感じる．
    \end{enumerate}
\end{remarks}

\begin{theorem}[fundamental theorem of algebra]
    $f=X^n+a_1X^{n-1}+\cdots+a_n\in\C[X]$が定数でなければ，方程式$f(X)=0$の複素数解$X=z\in\C$が存在する．
\end{theorem}
\begin{proof}
    開写像定理\ref{lemma-regular-then-constant-or-open}.2より，
    定数でない正則関数$f$は開写像であるから，$f(\C)$は開．
    また，補題\ref{lemma-regular-then-constant-or-open}.1より$f(\C)$は閉でもある．
    $\C$の連結性より，$f(\C)=\C$より，$0\in f(\C)$．
\end{proof}
\begin{remarks}[$f(\C)=\C$があまりに美しい]
    なるほど！補題\ref{lemma-regular-then-constant-or-open}の特に2を示したのちでは，
    極めてしっくりくる．特に最大値の原理の文脈で．
    
    開写像定理と最大値の原理はどうやら関係が深い．実際，次のような代数学の基本定理の証明も考えられる．
    $\C$は領域だから，定数でない正則関数$f$はこの上では最大値を持たないはずである．
    ……，いや，無理か．正則関数$f:\C\to\C$が零点を持つとはどういうことかわからない．
\end{remarks}

\section{局所弧状連結}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=compact-Hausdorff空間という聖域の構成の試み]
    局所コンパクトとは，用語の定義を分けただけで，コンパクト集合のみからなる開集合の基底が存在することをいう．
    任意の点$x\in X$に対して，$x$の閉近傍$U$でコンパクトなものが存在することをいう．
    これら定義は同値ではない．
    一方で，局所連結とは，連結開集合のみからなる基底を持つことをいう．
\end{tcolorbox}

\begin{example}\mbox{}
    \begin{enumerate}
        \item 一点集合は連結である．任意の離散空間は一点集合を開とするから，局所連結である．
        \item 完全不連結空間が局所連結であるとは，連結集合が一点集合しかないのだからこれが基底になるしかない，すなわち，離散であることは同値である．$\Q$は離散ではなく，局所連結ではない，完全不連結空間である．
    \end{enumerate}
\end{example}

\begin{proposition}[locally connected]
    次の条件は同値である．
    \begin{enumerate}
        \item $X$は局所連結である．すなわち，連結集合からなる開基をもつ．
        \item 任意の開集合$U\subset X$の連結成分は，$U$-開である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[$\Rightarrow$] $W\subset U$を$U$の連結成分とする．任意に$x\in W$を取ると，(1)より，$x\in V\subset U$を満たす連結開集合$V$が存在する．\footnote{開集合の基底をなすから，$U$なら基底が見つかる．$W$に対して直接は$x\in V\subset W$とは言えない．}$x$を含む連結成分は極大だから，$V\subset W$である．よって，$W$は開である．
        \item[$\Leftarrow$] 任意の$x\in X$と開近傍$x\in U$に対して，$x\in V\subset U$を満たす連結開近傍を構成すれば良いが，$U$の連結成分への分解のうち，$x$を含む連結成分を$V$とおけば，(2)よりこれは開である．
    \end{description}
\end{proof}
\begin{remarks}
    $\Leftarrow$は，連結成分への分解を利用している．
    局所コンパクトの時もそうであったが，大域と局所の不思議な関係である．
\end{remarks}

\begin{corollary}
    局所連結空間から完全不連結空間への連続関数は局所定数である．
\end{corollary}

\section{Sober topological spacesとpoint-less topology}\label{sec-sober-spaces}

\begin{screen}
    集合論の蒙昧から目覚めると，位相空間論はトポス理論に接続される．その接続だけ見て，代数幾何学的内容には深くは立ち入らない．
    \begin{quotation}
        It is here that the real point of pointless topology begins to emerge; the difference between locales and spaces is one that we can (usually) afford to ignore if we are working in a "classical" universe with the axiom of choice available, but when (or if) we work in a context where choice principles are not allowed, then we have to take account of the difference—and usually it is locales, not spaces, which provide the right context in which to do topology. This is the point which, as I mentioned earlier, André Joyal began to hammer home in the early 1970s; I can well remember how, at the time, his insistence that locales were the real stuff of topology, and spaces were merely figments of the classical mathematician's imagination, seemed (to me, and I suspect to others) like unmotivated fanaticism. I have learned better since then.\cite{Johnstone}
    \end{quotation}
\end{screen}

\begin{definition}[Sober space]\label{def-Soberity}
    $X$が\textbf{穏健}であるとは，全ての既約閉集合（２つの真部分閉集合の合併として表せないような空でない閉集合）
    は一点集合の閉包のみであるような空間をいう．
\end{definition}

\begin{proposition}[穏健空間の特徴付け]
    位相空間$(X,\O)$について，次の３条件は同値である．\footnote{\url{https://ncatlab.org/nlab/show/sober+topological+space}}
    \begin{enumerate}
        \item $X$は穏健空間である．
        \item $\O$の
    \end{enumerate}
\end{proposition}

\begin{proposition}[穏健空間は十分多くの点を持ったロケールである]\label{prop-sober-spaces-and-frame-homomorphism}
    $(X,\tau_X),(Y,\tau_Y)$をsober空間とする．任意のフレーム準同型$\tau_X\leftarrow\tau_Y:\phi$について，ただ一つの連続写像$f:X\to Y$が存在して，そのpre-image functionに一致する：$\phi=f^*$．
\end{proposition}

\begin{remark}[point-less topology / locale theory]\label{remark-locales}
    これはすごい，今なら一発で悲願だと分かる．
    直感的には感づいていたような，\textbf{反変冪集合関手$f^*$が引き起こす}対応をframeという言葉で見事に描き出した．
    完全に対応するために必要なのがsober spaceということで，Topの充満部分圏Sobからの充満な埋め込み$\mathrm{Sob}\to\Locale$を描き出したのがこの命題ということである．
    この圏論的構造だけが位相空間論を形作るのである．
    命題\ref{prop-sober-spaces-and-frame-homomorphism}はしばしば，穏健空間は“locales with enough points”(\cite{Johnstone2}, II 1.)と翻訳される．
    たまたま十分多くの点があるので，$f:X\to Y$によって特徴付けられるくらいには，frame $\tau_X,\tau_Y$で事足りるのが，穏健空間というクラスである，ということである．
\end{remark}

\begin{definition}[spacial]
    A frame is spatial if it is isomorphic to a $\Omega( X )$. There are plenty of non-spatial ones and this fact turned out to be helpful in several problems. \footnote{\url{https://en.wikipedia.org/wiki/Pointless_topology}}
\end{definition}

\begin{definition}[frame, locale]\label{def-frame-and-locale}
    フレーム$\O$とは，次の構造を満たすposetである．
    \begin{enumerate}
        \item small coproductについて閉じている：交わり$\bigvee$と表される．
        \item finite limitについて閉じている：結び$\land$と表される．
        \item ２つの演算は無限分配則を満たす：$x\land(\bigvee_i y_i)\le \bigvee_i(x\land y_i)$．（逆も成り立つので結局$=$である）．
    \end{enumerate}
    フレームの射とは，arbitrary joinsとfinite meetsを保つposetの射である．
    枠は圏をなし，Frmと表される．
    この反対圏を$\Locale=\Frm^\op$と表し，その対象をロケールという．
\end{definition}
\begin{remark}[位相の見方総集結]\label{remark-perspective-on-topology}
    「開集合の◯◯」というのがめんどくさいので，frameと考えてしまうのが良い．この構造が本質的で，この中に「空間的」な要素が含まれているのである，と言えるのならば，point-less topologyこそが悲願である．
    \begin{enumerate}
        \item 代数系latticeとして：無限項演算$\bigvee$を備えた束のクラスに見える．（これを，$\O$を集合とした時，このような束を\textbf{suplattice}と定義する）．実際完備Heyting代数となる（従って分配的）．環と近い代数的見方．
        \item 集合の集合として：「集合系$\O\subset P(X)$」と言った時の意味．
        \item 圏として：poset categoryに見える．開集合系は包含写像を射として，それ自身圏Opである（定義\ref{def-category-of-open-sets}）．これは層の理論に応用がある．
        \item filterとして：ブール代数の上で考えたり，冪集合の上で考えたりする，「特別会員」「蓋」「漏斗」．どこに足がつくかで空間の形が決まる．近傍系や基本系と言った時はこの構造を意識する．
    \end{enumerate}
\end{remark}

こうして，localeとframeは$(n,1)$-toposの特殊な例として定義できる．
トポス理論に繋いだところで，これ以上はもう立ち入らない．

\section{Stone duality}\label{sec-Stone-duality}

\begin{definition}[Stonean space]
    \textbf{ストーン空間}とは，compact extremally disconnected Hausdorff空間のことである．
\end{definition}

\begin{theorem}[Stone duality]
    ブール代数の圏と，Topの充満部分圏である，compact totally disconnected Hausdorff空間の圏との間に，反変圏同値が存在する．\footnote{\url{https://ncatlab.org/nlab/show/complete+Boolean+algebra}}
\end{theorem}

\subsection{CABA}

特に，余離散空間$(X,P(X))$は特殊なブール代数に対応し，CABAと呼ばれる．

\begin{corollary}
    Assuming excluded middle, complete atomic Boolean algebras are (up to isomorphism) precisely power sets.
\end{corollary}
\begin{proof}
    次の補題で示される冪集合関手$P:\Set\to\Bool^\op$が定める本質的に全射な充満忠実関手が，圏同値$\Set\to\textrm{CompAtmBoolAlg}$を引き起こす．
\end{proof}

\begin{lemma}
    In fact, taking power sets defines a fully faithful functor from the opposite category of Set to Comp Bool Alg whose essential image consists of the complete atomic boolean algebras.
    冪集合関手$P:\Set\to\Bool^\op$は忠実関手である．
\end{lemma}

\begin{definition}[CABA]
    These abstract representations of power sets are important enough to have their own abbreviation: ‘CABA’.
\end{definition}

\subsection{Stone双対性のSober空間への一般化}

\begin{theorem}
    Sober空間の圏Sobと空間的な完備Heyting代数の圏SFrmに，反変同値が存在する．\footnote{\url{https://ja.wikipedia.org/wiki/ストーン双対性}}
\end{theorem}
\begin{remark}
    不思議な注釈がある．
    \begin{quote}
        SFrmもSLocも対象は空間的完備ハイティング代数である。しかしSFrmとSLocが圏としては違う事を強調する為に、SFrmの対象とみなした場合には空間的完備ハイティング代数を「枠」といい、SLocの対象とみなした時には空間的完備ハイティング代数を「ロケール」という。
    \end{quote}
    これは，$X$と$\O$とが結局いずれも集合であることに関係しているのだろうか？
    $X$の射と$\O$の対応が反変的で，引き戻し$f^*\O$が大事な概念になったように，向きが違うことしか本質は残らない，と？
    もしそうだとしたら素晴らしい理論だ．
\end{remark}

\chapter{濃度}

\begin{quotation}
    
\end{quotation}

\section{自然数と可算集合}

\subsection{有限濃度とその閉包}

\begin{definition}[finite set, infinite set]
    集合$X$が次を満たす時，\textbf{有限集合}であるという：
    \[ \exists n\in\N,\; \Isom(n,X)\ne\emptyset. \]
    有限集合でない集合を\textbf{無限集合}という．
\end{definition}

\begin{proposition}[有限集合には元の個数が定まる]\mbox{}
    \begin{enumerate}
        \item $n,m\in\N$の間に全単射$f:n\to m$が存在するならば，$n=m$．
        \item $\N=\{0,1,\cdots\}$は無限集合である．
\end{enumerate}
\end{proposition}
\begin{proof}
    1. $n$に関する帰納法で示す．$n=0$の時，$m\ne 0$ならば逆写像の空間$\Map(m,n)$が空なので，不適．従って$m=0$．
    この時確かに全単射$\emptyset:n\to m$が存在する．
    $n>0$の時，$f(n-1)$の値を$l$と置くと，互換$(l\;m-1)=:g$を考えると，$g^2=\id_{m}$よりこれは全単射．従って$g\circ f$も全単射．
    この$g\circ f$は，全単射$g\circ f|_{n-1}:n-1\to m-1$を引き起こす．この時帰納法の仮定より$n-1=m-1$が必要．従って$n=m$．

    2. これは背理法ではなく直接次の命題
    \[ \forall n\in\N,\;\Isom(n,\N)=\emptyset \]
    を帰納法で示す．
    $\N\ne\emptyset$より，$n=0$の時は確かに成り立つ．$n>0$の時，$f\in\Isom(n,\N)$が取れたとする．
    この時に全単射$n-1\to\N$が構成できてしまうことを示す．
    $f(n)=:m$と置く．$m$を潰す全単射$g:\N\setminus\{m\}$を
    \[g(i)=\begin{cases}
        i,&i<mのとき,\\
        i-1,&i>mのとき,
    \end{cases}\]
    と準備すると，$f|_{n-1}:n-1\to\N\setminus\{m\}$も全単射だから，$g\circ f_{n-1}:n-1\to\N$は全単射．よって帰納法の仮定に矛盾．
    従って，$\Isom(n,\N)=\emptyset$．
\end{proof}
\begin{remarks}[無限降下法は背理法と帰納的構造との合体]
    2. は無限降下法で示した．つまり，全体の大定理
    \[ \exists n\in\N,\; \Isom(n,X)\ne\emptyset \]
    を直接背理法で示すのではなく，帰納法の仮定の中で背理法を試みる．
    すると，$\N$の整礎性に違反する．

    互換$(l\;m-1)$の使い方とか，$m$の潰し関数とか，すごく基礎論や「還元」の精神を感じる．

    2. の証明をしていて感じたのは，\textbf{有限と無限の違いは，その間の射の違いで捉えられる}．
    無限の方は１つ潰しても達磨おとしのように射の可逆性に響かないが，有限の方は整礎性に違反する（限りがある）．
\end{remarks}

\begin{definition}[cardinality / power, countable]
    集合$X$について，
    \begin{enumerate}
        \item 全単射$n\to X$が存在するとき，$n$を$X$の\textbf{濃度}といい，$n=\Card X$と表す．
        \item 全単射$\N\to X$が存在するとき，$X$は\textbf{可算無限集合}であるといい，$\Card X=\aleph_0,\omega$などと表す．
        \item 有限集合と可算無限集合を併せて\textbf{可算集合}という．
    \end{enumerate}
\end{definition}

\begin{example}[$\Z$は可算無限集合]
    \[f(n)=\begin{cases}
        m,&n=2mのとき,\\
        -m,&n=2m-1のとき
    \end{cases}\]
    と定めた$f:\N\to\Z$は可逆．
\end{example}

\subsection{自然数上の潰し関数と可算集合}

\begin{proposition}[自然数の部分集合は可算（有界なら有限，非有界なら可算無限）]
    $A\subset\N$に対し，count関数$C_A:\N\to\N$を，帰納的に
    \begin{align*}
        C_A(0)&=0,\\
        C_A(m+1)&=\begin{cases}
            C_A(m)+1,&m\in Aのとき,\\
            C_A(m),&m\notin Aのとき,
        \end{cases}
    \end{align*}
    と定める．$C_A(n)$の値は$n=\{0,1,\cdots,n-1\}$までに何個が$A$に含まれていたかの数を格納する．あるいは潰し関数だと思っても良い．
    \begin{enumerate}
        \item $A\subset n$のとき，$\Card A=C_A(n)\le n$であり，$C_A|_A:A\to\Card A$は可逆．$C_A(n)=n$ならば$A=n$である．
        \item $A\subset n$を満たす自然数$n$は存在しないと仮定する．このとき，$C_A|_A:A\to\N$は全単射である．
    \end{enumerate}
\end{proposition}
\begin{proof}
    1. $n=0$のとき，$A=\emptyset$．このとき全ての条件は成り立つ．$n>0$とする．
    $A'=A\setminus\{n-1\}$とする．$n-1\in A$のとき，
    \[ \Card A=\Card A'+1=C_A(n-1)+1=C_A(n)\le (n-1)+1=n. \]
    $C_A|_A$は，$C_{A'}|_{A'}$の$n-1\mapsto n-1$についての延長なので可逆．$C_{A'}(n-1)=n-1$ならば$A'=n-1$だったから，$C_{A'}(n)=n$ならば$A=n$．
    $n-1\notin A$の場合も同様．

    2. 自然数$n\in\N$に対して$A_n:=A\cap n$と置く．
    $C_A|_A:A\to\N$が単射であると示す．$x,y\in A$について，$C_A|_A(x)=C_A|_A(y)$とする．$n:=\max(x,y)+1$とおけば，$x,y\in A_n$であるから，グラフについて$C_A|_{A_n}=C_{A_n}|_{A_n}$であることも併せて，$C_{A_n}|_{A_n}(x)=C_{A_n}|_{A_n}(y)$．
    1.より$C_{A_n}|_{A_n}:A_n\to\Card A_n$は可逆であるから，$x=y$．

    続いて
    \[ \forall n\in\N,\;n\in C_A(A) \]
    を帰納法によって示す．
    $0\in C_A(A)$については，ある$m$について$A_m\ne\emptyset$を考えれば，
    $C_{A_m}|_{A_m}:A_m\to\Card A_m$は可逆だから，$0\in C_{A_m}|_{A_m}(A_m)\subset C_A|_A(A)$．\footnote{$A_m=\emptyset$となる場合は$C_{A_m}|_{A_m}(A_m)=0=\{\}$となってしまうので$0\in C_A(A)$を示すためには使えない．}
    続いて$n>0$とする．仮定より$n-1\in C_A(A)$としたから$C_A(m)=n-1$を満たす$m$が存在する．このときい$C_A(m+1)=n$だが，$m+1\in A$とは限らない．
    しかし必ず$m'\in A\setminus A_{m+1}$が取れて$C_A(m')\ge C_A(m+1)=n$を満たすから，$n\in C_A(A)$．
    以上より，$\N\subset C(A)$で，$C_A|_A$は全射でもある．
\end{proof}

\begin{corollary}
    $A\subset\N$を部分集合とする．
    \begin{enumerate}
        \item $A$は可算．さらに，次の２条件は同値．\begin{enumerate}[(1)]
            \item $\exists n\in\N,\;A\subset n$．
            \item $A$は有限集合．
        \end{enumerate}
        \item $A$が空でなければ，全単射$C_A|_A:A\to C_A(A)$による$0\in C_A(A)$の逆像$l:=C_A^{-1}(0)$は$A$の最小元である．
    \end{enumerate}
\end{corollary}

\begin{corollary}
    $f:X\to Y$を写像とする．
    \begin{enumerate}
        \item $f$を単射とする．$Y$が可算ならば$X$も可算．$Y$が有限ならば$X$も有限で$\Card X\le\Card Y$．また等号成立条件は$f$が可逆であること．
        \item $f$を全射とする．$X$が可算ならば$Y$も可算．$X$が有限ならば$Y$も有限で$\Card X\ge\Card Y$．また等号成立条件は$f$が可逆であること．
    \end{enumerate}
\end{corollary}

\subsection{自然数の２進表示と可算集合}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=自然数の２進表示]
    非常に基礎論的な議論で気味が良い．
\end{tcolorbox}

\begin{notation}
    集合$X$に対し，その有限部分集合全体からなる集合を
    \[ F(X):=\{A\in P(X)\mid|A|<\infty\} \]
    と置く．
\end{notation}

\begin{proposition}[binary presentation]
    有限部分集合$A\in F(\N)$に対し，自然数$b(A)=\sum_{m\in A}2^m$を対応させる写像$b:F(\N)\to\N$は可逆である．
\end{proposition}

\begin{corollary}\mbox{}
    \begin{enumerate}
        \item $n\ge 1$ならば，$\N^n$は可算無限集合．
        \item $\Q$は可算無限集合．
        \item $X,Y$が可算集合ならば，$X\times Y$も可算集合である．
    \end{enumerate}
\end{corollary}

\section{濃度}


\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=濃度]
    可逆射とepic射の言葉で濃度の順序関係を定めると，反射律と推移律はすぐに成り立つが，
    反対称律は自明ではない．これをBernsteinの定理という．こうして，濃度はSetのskeltonとなる．
\end{tcolorbox}

\begin{definition}[equipotent]
    $X,Y$を集合とする．
    \begin{enumerate}
        \item 全単射$X\to Y$が存在することを$\Card X=\Card Y$と書き，\textbf{対等}であるという．
        \item 単射$X\to Y$が存在することを$\Card X\le \Card Y$と書く．
        \item 全単射は存在しないが単射が存在することを$\Card X<\Card Y$と書く．
    \end{enumerate}
\end{definition}

\begin{proposition}[Bernstein：濃度は順序を定める（反対称律）]
    $f:X\to Y,g:Y\to X$を単射とする．このとき，全単射$h:X\to Y$が存在する．
\end{proposition}

\begin{proposition}[Cantor]
    \[\Card X<\Card P(X).\]
\end{proposition}

\begin{corollary}
    \[ \Card\N<\Card 2^\N=\Card\R. \]
\end{corollary}

\begin{definition}[cardinality of continuum]
    $\Card X=\Card\R=:\aleph$であるとき，$X$の濃度は\textbf{連続体濃度}であるという．
\end{definition}

\begin{proposition}
    \[\Card\R^n=\Card\R\;\;\;(n\ge 1)\]
\end{proposition}

\section{Zornの補題と無限集合}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=Zornの補題]
    集合論の非対称性がここに現れ，同じ濃度の現象を全射の言葉で双対的に表そうとすればACが必要になる．
    圏論的には双対で極めて自然だが，構成的数学では自明ではない．
\end{tcolorbox}

\subsection{Zornの補題}

\begin{proposition}[AC]
    $X\to Y$が全射ならば，$\Card Y\le\Card X$．
\end{proposition}

\begin{definition}[maximal, inductively ordered set]
    $X$を集合とする．$P(X)$上の包含関係定める順序を考える．
    \begin{enumerate}
        \item $A\in S\subset P(X)$について，$A$が$S$の極大元であるとは，次が成り立つことをいう：
        \[ \lnot(\exists B\in S,\;A\subsetneq B). \]
        \item $S\subset P(X)$の任意の空でない全順序な部分集合$T$について，$S$の元の中に$T$の上界が存在するとき，$S$は\textbf{帰納的順序集合}であるという．
    \end{enumerate}
\end{definition}

\begin{theorem}[Zorn, AC (1935)]
    $S\subset P(X)$を包含関係について帰納的な順序集合とする．任意の$A\in S$に対して，$S$の極大元であって$A$を部分集合として含むものが存在する．
\end{theorem}

\begin{lemma}
    $T\in\mathcal{R}_0$とする．$\mathcal{R}_T=\mathcal{R}_0$ならば$\mathcal{R}_{F(T)}=\mathcal{R}_0$である．
\end{lemma}

\begin{proposition}[Setの全順序性 AC]
    $X,Y$を集合とする．単射$f:X\to Y$が存在するか，または，単射$g:Y\to X$が存在する．
\end{proposition}

\subsection{始切片の議論}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    \cite{Analysis Now}では，いつか見た\cite{松坂和夫}での議論が精緻化されていた．
\end{tcolorbox}

\begin{definition}[chain]
    順序集合$(X,\le)$について，
    \begin{enumerate}
        \item $Y\subset X$について，$\maj(Y)$を真の上界全体からなる集合，$\min(Y)$を真の下界全体からなる集合とする．
        \item 部分集合$C\subset X$が\textbf{鎖}であるとは，$C$が整列集合であることをいう．
        すなわち，$C$の任意の空でない部分集合には最小元が存在し(well-founded)，
        最小元を選択する関数$c:P(C)\setminus\{\emptyset\}\to C$が存在して$\forall_{x\in C}\;c(\maj(C\cap\min\{x\}))=x$を満たす(linear order)ことをいう．
        これは$C$の中に「分岐点」にあたる$x$が存在しないことをいう．この条件は$C$に「分岐がない」ことを主張しており，$C$が全順序になることの特徴付けになっている．\footnote{well-ordered = well-founded linear orderである．}
    \end{enumerate}
\end{definition}

\begin{lemma}
    $X$の鎖$C_1,C_2$について，$C_1\nsubseteq$ならば，$x_1\in C_1$が存在して$C_2=C_1\cap\min\{x_1\}$である．
\end{lemma}

\subsection{無限集合の特徴付け}

以下の結果は，全てACを仮定して従う．

\begin{proposition}[無限集合の特徴付け１]
    集合$X$について，次は全て同値．
    \begin{enumerate}
        \item $X$は無限集合．
        \item 単射$\N\to X$が存在する．
        \item 単射$X\coprod\N\to X$が存在する．
        \item 全射ではない単射$X\to X$が存在する．
    \end{enumerate}
\end{proposition}

\begin{theorem}[無限集合の特徴付け２]
    $X$を集合とする．次の３条件は同値である．
    \begin{enumerate}
        \item $X$は無限集合．
        \item $X\ne\emptyset$かつ，単射$X\times\N\to X$が存在する．
        \item $\Card X\ne 0,1$であり，単射$X\times X\to X$が存在する．
    \end{enumerate}
\end{theorem}

\begin{corollary}\mbox{}
    \begin{enumerate}
        \item $X$を無限集合とする．$F(X)$を冪集合$P(X)$の部分集合$F(X)=\{A\in P(X)\mid |A|<\infty\}$とすると，単射$F(X)\to X$が存在する．
        \item $f:X\to Y$を全射とし，任意の$y\in Y$に対し$f^{-1}(y)$が可算であるとする．$Y$が無限集合ならば，単射$X\to Y$が存在する．
    \end{enumerate}
\end{corollary}

\section{選択公理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    ACは人類の選択である．
    これを認めると，Tychonoffの定理，Hahn-Banachの定理，Krein-Milman定理，Gelfand理論を得る．
    Rejecting it, one therefore loses a substantial part of mathematics, and, more important, there seems to be no compensasion for the abstinence.\cite{Analysis Now}
\end{tcolorbox}

\begin{definition}[axiom schema]
    論理式全体$Fml_L$を走る変数を伴った２階の論理式が存在して，その変数に論理式を代入した結果だと捉えられる，論理式の集合のことを\textbf{公理図式}という．
\end{definition}
\begin{example}
    推論規則は公理図式である．
\end{example}

\begin{shadebox}
    \begin{definition}[集合の公理系ZF]\label{def-ZF-theory}集合の公理は，集合論の言語$L=\{=,\in\}$による一階述語論理の言葉で，次のように表せる．ただし，自由変項から始まる公理は，全称量子化(universally quantified)されているものとする．
        \begin{enumerate}\setcounter{enumi}{-1}
            \item (Set Existence). $\exists x(x=x)$
            \item (Extentionality). $\forall z(z\in x\leftrightarrow z\in y)\rightarrow x=y$
            \item (Foundation). $\exists y(y\in x)\rightarrow\exists y(y\in x\land \lnot\exists z(z\in x\land z\in y))$
            \item (Comprehension Scheme). 自由変項$y$を持たないような全ての式$\varphi$について，
            \[\exists y\forall x\;(x\in y\leftrightarrow x\in z\land\varphi(x))\]
            \item (Pairing). $\exists z(x\in z\land y\in z)$
            \item (Union). $\exists A\forall Y\forall x(x\in Y\land Y\in\mathcal{F}\rightarrow x\in A)$
            \item (Replacement Scheme). 自由変項$B$を持たないような全ての式$\varphi$について，
            \[\forall x\in A\exists!y\varphi(x,y)\rightarrow\exists B\forall x\in A\exists y\in B\varphi(x,y)\]
        \end{enumerate}
        以降，一階述語論理の文字列に対して，次の略記となるような述語を採用する．
        \begin{screen}
            \begin{notation}\mbox{}
                \begin{enumerate}[(i)]
                    \item $x\subset y:\Leftrightarrow\forall z(z\in x\rightarrow z\in y)$
                    \item $x=\emptyset:\Leftrightarrow\forall z(z\notin x)$
                    \item (Ordinal successor function). $y=S(x):\Leftrightarrow\forall z(z\in y\leftrightarrow z\in x\lor z=x)$
                    \item $w=x\cap y:\Leftrightarrow\forall z(z\in w\leftrightarrow z\in x\land z\in y)$
                    \item (isSingleton). $\mathrm{SING}(x):\Leftrightarrow\exists y\in x\forall z\in x(z=y)$
                \end{enumerate}
            \end{notation}
        \end{screen}
        \begin{enumerate}\setcounter{enumi}{6}
            \item (Infinity). $\exists x(\emptyset\in x\land \forall y\in x(S(y)\in x))$
            \item (Power Set). $\exists y\forall z(z\subset x\rightarrow z\in y)$
            \item (Choice). $\emptyset\in F\land\forall x\in F\forall y\in F(x\ne y\rightarrow x\cap y=\emptyset)\rightarrow \exists C\forall x\in F(\mathrm{SING}(C\cap x))$
        \end{enumerate}
    \end{definition}
    \vspace{2mm}
\end{shadebox}
\begin{remark}\mbox{}
    \begin{enumerate}
        \item このZermelo-Fraenkel styleでは，宇宙は，全ての遺伝的集合のクラスとなる．
        特に7.無限公理の採用の仕方が，順序数を念頭においている．これが特徴的で最初は慣れなかった．
        2.整礎性公理は，全ての集合$x$について，順序数$\alpha$が存在して$x\in V_\alpha$であることに同値である．
        \item 1~9をZFC, 1~9をZF，これらから6.置換公理を除いたものをそれぞれZC, Zといい，
        これら４つからそれぞれ2.整礎性公理を除いたものを$\mathrm{Z^-,ZF^-,ZC^-,ZFC^-}$という．
    \end{enumerate} 
\end{remark}

\begin{axiom}[choice (Zermolo, 1904)]
    選択公理は，次のように表現することもできる：任意の空でない集合$X$に対して，関数$c:P(X)\setminus\{\emptyset\}\to X$であって，$\forall_{Y\in (X)\setminus\{\emptyset\}}\;c(Y)\in Y$を満たすものが存在する．
\end{axiom}

\section{整列可能定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    ZFCの世界では，全ての集合に整列順序が入り，これによって全ての集合はある順序数と同型になる．
    排中律を認めると，整列可能定理から選択公理が導かれ，同値となる．
    整列順序をさらに一般化して，帰納法が成立するような関係を，整礎的関係といい，整列順序とは整礎的な全順序である．
\end{tcolorbox}

\begin{definition}[well-ordered, first element]\mbox{}
    \begin{enumerate}
        \item 順序集合$(X,\le)$が\textbf{整列集合}であるとは，任意の空でない部分集合が最小元を持つ全順序集合であることをいう．
        \item この最小元を第一元という．
    \end{enumerate}
\end{definition}

\section{集合の射}

\begin{definition}[cardinal number, cardinality]
    順序数$\alpha$が\textbf{基数}であるとは，$\forall\beta<\alpha,\;\beta\not\simeq\alpha$となることをいう．
    即ち，集合の同型による同値類の元が持ち得る階数のうち最小の順序数を特に基数という．また\textbf{始数(initial ordinal)}ともいう．
    従って基数は$\Set$のskeltonを構成する．

    集合$A$の濃度とは，こうして集合の同型による同値類に対応づけられた基数のことをいう：
    \[card(A)=|A|:=\mid\{\alpha\in\ORD\mid A\simeq\alpha\}.\]
\end{definition}

\begin{lemma}[同型は同値関係である]
    集合のクラス$V$上に定義した次の関係$\simeq$は同値関係である．
    \begin{quote}
        (R) ２つの集合$x,y\in V$について，$x$と$y$の間に全単射$\varphi:x\to y$が存在することを$x\simeq y$とする．
    \end{quote}
\end{lemma}
\begin{proof}
    \begin{description}
        \item[反射律] $\id_A$より，$A\simeq A$．
        \item[反対称律] $A\simeq B$の時，$\varphi:A\to B$が存在するということだから，この逆射$\varphi^{-1}:B\to A$も全単射である．よって$B\simeq A$．
        \item[推移律] $A\simeq B,B\simeq C$のとき，同型射$\varphi:A\to B,\psi:B\to C$の合成$\psi\circ\varphi:A\to C$も同型だから，$A\simeq C$．
    \end{description}
\end{proof}
\begin{remark}
    このデータ構造$\N$上では，集合の和は

    積$X^n$は配置集合の記法と見ても整合的である．
\end{remark}

\begin{theorem}[Bernstein]
    単射$i:A\to B,j:B\to A$が存在するとき，２つの集合$A,B$は同型である．
\end{theorem}


\chapter{距離空間と可算性}

\begin{quotation}
    まず，写像の極限を，写像の連続性の言葉によって定義しようとすると，一点コンパクト化$\widetilde{A}$への延長点が，連続になるかと言う条件に他ならず，第６章の文脈に合流する．なお，今まではむしろ連続性の方を極限の言葉から定義していたのである．
    このうち点列の極限というクラスを用いて，距離空間はさらに詳細に研究される．
    \begin{enumerate}
        \item 一般の位相空間の写像について，極限の概念が定義できる．これは点列の収束の一般化であると同様に，超フィルターの極限を考えることで，Tychonoffの定理に応用がある．
        \item 点列の収束という道具を，距離空間を調べるために用意する．部分列の収束性の特徴付けで，積位相の言葉とグラフとして写像・点列をみる見方が本領を発揮する．これを意識した道具立てはたくさん用意してきた．
        \item 距離空間の点列の収束の完備性は，Cauchyの判定法の一般化となる．
    \end{enumerate}
    距離と位相の関係についてさらに調べる．
    \begin{enumerate}\setcounter{enumi}{3}
        \item 位相空間の位相を定義するような距離が存在するための条件を考える．
        \item 完備距離空間の縮小写像には不動点があることの帰結として，陰関数定理と常微分方程式の解の存在定理が理解できる．
    \end{enumerate}
    極限の議論において，コンパクト化の概念が通底している．Tychonoffの定理もそうである．
    
    点列から対象を構成する方法は代表的な極限構成である．
    これは$\io$として定義される，上極限事象の特別な場合である．
    位相空間の性質のほとんどは点列の言葉で特徴付けられる．
    これがBourbakiの「位相」で花が咲いた．
    例えば，相対コンパクト性は，「極限を考えたらはみ出してしまうかもしれない」という正規族の状況設定に極めて親和的な概念である．
    しかしこの手法が通用するためには，適切な可算性公理が必要になる．
    しかしネットの概念を用いれば，可算性を仮定しなくても，点列の収束と並行した理論展開が可能になる．
\end{quotation}

\section{極限}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=極限とTychonoffの定理]
    収束性は，位相の言葉（というより「連続」の言葉）で定めることができる（命題\ref{prop-characterization-of-convergence-in-terms-of-continuousness}）．
    余有限の点が，近傍に収まることであるから，開集合の言葉で表せるのは然るべきことである．
    ここでは余有限位相が重要な意味を持つ．
    「無限遠点への自然な延長」である．
    系\ref{cor-characterization-of-continuousness-in-terms-of-limits}の形の，極限の言葉で連続性を定義するという形に我々は慣れきっている．
    圏論的には極限の方が先なのかもしれない．

    $S_A$の極大元は$A$の超フィルターを定める．超フィルターの極限が存在する空間としてコンパクト空間が特徴付けられる．
    この特徴付けを用いると，Tychonoffの定理が証明できる．
\end{tcolorbox}

\subsection{集積点について}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=集積点について]
    集積点とは，分離不可能な境界点のイメージである．だから「拡大しても孤立点でない」という言葉で定義できる．
    Alexandroffの拡大の文脈で捉えると，触点であることが分かる．
\end{tcolorbox}

\begin{definition}[accumulation point]\label{def-accumulation-point}
    $X$を位相空間とし，$A$を部分集合とする．
    \begin{enumerate}
        \item $x\in X$が部分空間$A\cup\{x\}$の孤立点ではない時，$x$は$A$の\textbf{集積点}であるという．
        \item $Y$も位相空間とし，$a\in X\setminus A$を$A$の集積点とする．$f:A\to Y$を写像とし，$b\in Y$とする．$\widetilde{A}:=A\coprod\{a\}$を$X$の部分空間とし，写像$\tilde{f}:\widetilde{A}\to Y$を$\tilde{f}(a)=b,\tilde{f}|_A=f$で定めると，$\tilde{f}$は$a$で連続であるとする．
        この時を，\textbf{$x\in A$が$a$に限りなく近づく時，$f(x)$は$b$に収束する}という．$b$を$f(x)$の\textbf{極限}という．
    \end{enumerate}
\end{definition}
\begin{remark}[まさかこんな捉え方があるとは]\mbox{}
    \begin{enumerate}
        \item 集積点は「その点の任意の近傍が$A$と共通部分を持ってしまう」という意味で，
        「$A$上の点で任意精度で近似可能」な点である．\textbf{$A$とは近傍によっては分離不可能な点}である．
        これは開閉の概念以前に定義可能な概念であり，また極限の概念の一般化でもあり，
        $x\in X\setminus A$の時は，$x$が$A$の集積点であることと$x\in\overline{A}\setminus A$であることとは同値である．
        これによって，閉集合を集積点の言葉によって特徴付けることができる．
        $A$の内点が集積点であるかどうかはまた別の議論である．境界点の方が収束の議論がしやすいのは不思議である．
        \item 極限とは，\textbf{連続性を保った延長}と定義できる．Topでの順極限ということか？
    \end{enumerate}
\end{remark}

\begin{lemma}[集積点の特徴付け]\mbox{}
    \begin{enumerate}
        \item $x$は$A$の集積点である（$x\in X$が部分空間$A\cup\{x\}$の孤立点ではない）．
        \item $x$の任意の開近傍$U(x)$について，$U(x)\cap A\ne\emptyset$．
        \item $x\in\overline{A\setminus\{x\}}$．
    \end{enumerate}
\end{lemma}

\subsection{Hausdorff空間での極限の一意性}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=極限]
    極限は連続性の言葉で捉えられる．が，場面設定が少し人工的になる．
    写像$f:A\to X$を，$a\in \partial A\setminus A$に（無縁）和の言葉によって延長し，$\widetilde{f}(a)=b$と写像$f$を延長させても連続のままであるという条件を満たすもののみ，極限と称するに値する．
    位相的に考えれば，まるでAlexandroffの１点コンパクト化のように，集積点の満たす位相的性質を利用して，\textbf{値域に欠けた１点を取り戻すコンパクト化の営み}である．
    無縁和$\widetilde{A}=A\coprod\{\infty\}$について，$\infty$が$A$の集積点であるとは，$A$が$\widetilde{A}$で稠密であるということである．
    $\widetilde{A}=\N\cup\{\infty\}$の場合が点列の極限である．
    Hausdorff空間上の点列が収束するならば，その収束先は一意である．
    これは稠密性の言葉を使えば，系\ref{cor-Hausdorff空間への連続写像は，稠密な部分集合への制限で一意的に定まる}の時から判っていた話である．
\end{tcolorbox}

\begin{proposition}[Hausdorff空間では極限は一意的]\label{prop-uniqueness-of-limit-in-Hausdorff-space}
    $X,Y$を位相空間とし，$A$を$X$の部分集合，$a\in X\setminus A$を$A$の集積点とする．
    \begin{enumerate}
        \item (収束の特徴付け) 写像$f:A\to Y$と$b\in Y$に対し，次の２条件は同値．
        \begin{enumerate}[(1)]
            \item $x\in A$が$a$に近づく時，$f(x)$は$b$に収束する．
            \item $b$の任意の開近傍$V$に対し，$a\in X$の開近傍$U$で，$f(U\cap A)\subset V$を満たすものが存在する．
        \end{enumerate}
        \item $Y$をハウスドルフ空間とし，$f:A\to Y$を写像とする．$x\in A$が$a$に限りなく近づく時$f(x)$が$b,c\in Y$の両方に収束するならば，$b=c$．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $f$の延長$\widetilde{f}:\widetilde{A}:=A\coprod\{a\}\to Y$を$\widetilde{f}(a)=b$で定めると，(1)は，$\widetilde{f}$が$a\in\widetilde{A}$にて連続であることと同値だから，任意の$b$の開近傍$V$に対して，$a\in\widetilde{A}$の開近傍$U$であって
        \[U\subset\widetilde{f}^{-1}(V)\Leftrightarrow \widetilde{f}(U)\subset V\]
        を満たすものが存在するということと同値である．
        これは，写像$f$が$f(U\setminus\{a\})\subset V$であることに同値．
        \item 
        写像を$\widetilde{f}(a)=b$としても，$\widetilde{f}(a)=c$としても$x=a\in\widetilde{A}$にて連続であるということである．
        この下で$b\ne c$と仮定して矛盾を導く．
        $Y$はHausdorffだから，$V\cap W=\emptyset$を満たす$b,c$の開近傍$V,W$が存在する．
        すると，1より，$f(U\cap A)\subset V$かつ$f(U\cap A)\subset W$を満たす$a$の開近傍$U$が存在する．
        このとき，$f(U\cap A)\subset V\cap W=\emptyset$より，$U\cap A=\emptyset$である．
        $U$は$a$の開近傍であったから，この条件を満たす$U$が存在することは，$a$が$A$の集積点であることに矛盾する．
    \end{enumerate}
\end{proof}
\begin{remarks}
    2で$a$が$A$の集積点であることに矛盾させるのは不思議に感じたが，でないと極限の定義が作動しないのである．$a\in X\setminus A$をなんでも良いとした場合，それこそexoticな点を持ってきてしまってもよくなる．
\end{remarks}

\begin{definition}[収束点]
    これより，ハウスドルフ空間$Y$では，極限を$b=\lim_{x\to a}f(x)$などと表す．
\end{definition}

\subsection{チノコフの定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=Tychonoffの定理]
    Alexandroffのコンパクト化のように，filterの言葉をハードに使う．
    20世紀の香りがする．
    こうして，選択公理とZornの補題と同値な命題を，Topの中にも翻訳できたことになる．
\end{tcolorbox}

\begin{notation}
    集合$A$に対して$\widetilde{A}:=A\coprod\{\infty\}$とし，
    \[ S_A:=\left\{\O\in P(P(\widetilde{A}))\;\middle|\; \begin{array}{l}
        \O は\widetilde{A}の位相であり，\\\infty はAの集積点である
    \end{array}\right\} \]
    と置く．$\infty$が$A$の集積点であるとは，$A$が$\widetilde{A}$で稠密であることと同値．

    $A$上の超フィルターとは，半順序集合$P(A)$の超フィルターをいう．$S_A$の極大元とは超フィルターである．
\end{notation}

\begin{lemma}
    $S_A$は包含関係に関して帰納的半順序集合である．
\end{lemma}

\begin{proposition}[$S_A$を使った位相空間のコンパクト性の判定]\label{prop-characterization-compact-space-in-terms-of-filters}
    位相空間$X$について，次の３条件は同値である．
    \begin{enumerate}
        \item $X$はコンパクト空間である．
        \item $A$を任意の集合とし，$\O$を$S_A$の任意の元とする．$\widetilde{A}$を$\O$によって位相空間と考え，$A$をその部分空間と考える．任意の写像$f:A\to X$に対し，$f$のグラフ$\Gamma_f=\{(a,f(a))\mid a\in A\}$の積位相に関する閉包$\overline{\Gamma_f}\subset\widetilde{A}\times X$と$\{\infty\}\times X$の共通部分は空ではない．
        \item $A$を任意の集合とし，$\O$を$S_A$の任意の極大元とする．$\widetilde{A}$を$\O$によって位相空間と考える．任意の写像$f:A\to X$に対し，$f$の延長である連続写像$g:\widetilde{A}\to X$が存在する．（即ち，$f(a)$の$a\to\infty$の極限が存在する）
    \end{enumerate}
\end{proposition}


\begin{remark}
    Tychonoffの定理（定理\ref{thm-Tychonoff}）の証明には選択公理とZornの補題を使うが，選択公理はTychonoffの定理から導ける．この３つは同値な命題である．
\end{remark}

\begin{theorem*}[Tychonoff]
    $(X_i)_{i\in I}$をコンパクト空間の族とする．この時，積空間$\prod_{i\in I}X_i$はコンパクトである．
\end{theorem*}

\section{点列の収束}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=点列の極限]
    点列の収束についても，写像の極限（＝連続延長）の特殊な場合として定義できる．
    すると，連続写像についての今までの議論の世界に引き込んで議論できる．
    収束列が定義する連続写像$\x:\w{\N}\to X$を中心に証明構成が回転する美しい世界に引き込める．
    
    後半は点列を応用した距離空間の研究である．
    例えば点列の収束で閉包を特徴付けることが出来るのは，一般的には距離空間上のみである．
    開球の言葉でfilter列が作れるためである（ここから点列に落とすには選択公理が必要）．
    この点列の部分列の収束性を用いて，距離空間を調べることができる．
\end{tcolorbox}

\subsection{点列の収束の定義と特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=点列の収束の議論は，延長された写像の連続性に落とす．]
    点列の収束とは，漏斗の形のfilterによって１点を指定するテクノロジーである．これはHausdorffでない限り，必ずしも一点まで絞れるとは限らない．余有限の言葉で定義する．
    点列は写像の特別な場合なので，その収束は極限の観点からも議論できる，これは$X=\N$の場合として特徴付けられる．
    が，そんなことよりも，\textbf{filterの漏斗の形という極限の議論のは写像の１点での連続性の議論に他ならない}．
    この射の言葉を使わないでどうする．点列$(x_n)$が収束するとは，これが定める延長された写像$\tilde{x}:\w{\N}\to X$が連続であることに他ならない（同値）．
    まとめ：\textbf{点列の収束とは，離散空間$\N$からの写像（必ず連続）が，１点コンパクト化$\w{\N}$からの連続写像に延長されること}である．いかにも圏論的でTopの匂いがする．
\end{tcolorbox}

\begin{definition}[convergence]\label{def-convergence}\mbox{}
    \begin{enumerate}
        \item $X$を位相空間とし，$(x_n)$を$X$の点列，$a\in X$とする．$a$の任意の開近傍$U$に対し，$\{n\in\N\mid x_n\notin U\}$が有限集合である時，点列$(x_n)$は$a$に\textbf{収束}するという．
        \item $X$を距離空間とし，$(x_n)$を$X$の点列，$a\in X$とする．$\lim_{n\to\infty}d(x_n,a)=0$である時，点列$(x_n)$は$a$に\textbf{収束}するという．
        \item $X$の部分集合$\{x_n\mid n\in\N\}$が有界である時，点列$(x_n)$を\textbf{有界}という．
    \end{enumerate}
\end{definition}

\begin{remark}\mbox{}
    \begin{enumerate}
        \item 次の命題から，1は2の一般化になっていることがわかる．
        \item また，1は写像の極限の特別な場合でもある．次の空間を考えれば良い：離散空間$\N$の一点コンパクト化$\widetilde{\N}:=\N\coprod\{\infty\}$の開集合系は，$\infty\notin U$を満たす$U$全てと，余コンパクトな集合即ち$\widetilde{\N}\setminus U$が有限な余有限集合$U$のことである．
    \end{enumerate}
\end{remark}

\begin{proposition}[収束の特徴付け]\label{prop-characterization-of-convergence-in-terms-of-continuousness}
    $X$を位相空間とし，$(x_n)$を$X$の点列，$a\in X$とする．
    \begin{enumerate}
        \item $\widetilde{\N}=\N\coprod\{\infty\}$を離散空間$\N$の一点コンパクト化とする．写像$\tilde{x}:\widetilde{\N}\to X$を\[\tilde{x}(n)=\begin{cases}
            x_n,&n\in\N,\\a,&n=\infty,
        \end{cases}\]と定める．次の２条件は同値．
        \begin{enumerate}[(1)]
            \item 点列$(x_n)$は$a$に収束する．
            \item 写像$\tilde{x}:\widetilde{\N}\to X$は連続．
        \end{enumerate}
        \item $X$が距離空間ならば，次の条件とも同値である．
        \begin{enumerate}[(1)]\setcounter{enumii}{2}
            \item $\lim_{n\to\infty}d(x_n,a)=0$である．
        \end{enumerate}
        \item $X$が距離空間であるとする．$(x_n)$が収束するならば，$(x_n)$は有界である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 各$n\in\N\widetilde{\N}$は孤立点だから，$\tilde{x}|_{\N}$は連続．従って，(2)は$\tilde{x}$が$\tilde{x}(\infty)=a$にて連続であることに同値．
        いま，一般に$X$の部分集合$a\in U$に対し，$\infty\in V\subset\tilde{x}^{-1}(U)$を満たす$\infty$の開近傍$V\subset\widetilde{\N}$即ち余有限集合$V$が存在するとは，$\tilde{x}^{-1}(U)\subset\widetilde{\N}$自体も余有限であることに同値．これは(1)の定義である．
        \item 命題\ref{prop-characterization-of-convergence-in-metric-spaces}と同様．
        \item $(x_n)$が収束するならば，これが定める写像$\tilde{x}:\widetilde{\N}\to X$は連続である．よって，像$\tilde{x}(\widetilde{\N})$はコンパクトである．距離空間のコンパクト集合は有界である（系\ref{cor-compact-sets-in-metric-space-is-bounded}）．従ってその部分集合$\{x_n\}_{n\in\N}\subset\tilde{x}(\widetilde{\N})$も有界である．
    \end{enumerate}
\end{proof}
\begin{remarks}
    収束性の議論にはコンパクト性が通底している．3はすごく良い例である．
\end{remarks}

\begin{corollary}[連続性の極限の言葉による特徴付け]\label{cor-characterization-of-continuousness-in-terms-of-limits}
    $X$を位相空間とし，$(x_n)$を$X$の点列で$a\in X$に収束するとする．
    \begin{enumerate}
        \item (連続性の特徴付け) $Y$を位相空間とし，$f:X\to Y$を写像とする．$f$が$a$で連続ならば，$Y$の点列$(f(x_n))$は$f(a)\in Y$に収束する．
        \item $(x_n)$は$b\in Y$に収束するとする．$X$がハウスドルフならば$a=b$である．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 点列$(x_n)$が収束するので，点列$(x_n)$の定める写像$\tilde{x}:\widetilde{N}\to X$は連続である．従って，合成$f\circ\tilde{x}:\w{\N}\to Y$も連続であるから，特に$\infty$でも連続．よって，点列$(f(x_n))$は$f(a)\in Y$に収束する．
        \item 点列$x:\N\to X$の，$\w{\N}$への延長は，$\N$は$\w{\N}$の稠密な部分集合だから，$X$がHausdorffであるとき一意的である（系\ref{cor-Hausdorff空間への連続写像は，稠密な部分集合への制限で一意的に定まる}）．
    \end{enumerate}
\end{proof}
\begin{remarks}
    この1のような，写像の議論に落としてなす証明がとても美しい．
    2も美しすぎる！！！
\end{remarks}

こうして，点列の極限についても，$X$がハウスドルフである時，極限を$\lim_{n\to\infty}x_n$と書く．

\subsection{点列の応用：閉包の特徴付け}

\begin{corollary}[点列による閉包の特徴付け]\label{cor-characterization-of-closure-in-terms-of-limits}
    $X$を位相空間とし，$A$を$X$の部分集合とする．
    \[ B=\{a\in X\mid aに収束するAの点列(x_n)が存在する\} \]
    と定める．
    \begin{enumerate}
        \item $\overline{A}\supset B$．
        \item (AC) $X$が距離空間ならば，$\overline{A}=B$．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $A$の点列$(x_n)$が存在して$a\in X$に収束するならば，$a\in\overline{A}$であることを示せば良い．
        収束列$(x_n)$が定める連続写像$\tilde{x}:\w{\N}\to X$は，命題\ref{prop-continuous-map-and-closure}(3)より，$\tilde{x}(\w{\N})\subset\o{A}$を満たすので，$\x(\infty)=a\in\o{A}$を満たす．
        \item 
        $\o{A}\subset B$を示す．$a\in\o{A}$を任意にとり，これに収束する$X$の点列を構成すれば良い．
        いま，$a\in\o{A}$より，$a$の任意の近傍は$A$と共通部分を持つ（定義\ref{def-closure}）．
        特に，任意の$n\ge 1$に対して，$U_{\frac{1}{n}}(a)\cap A\ne\emptyset$である．
        従って，選択公理を認めれば，点列$(x_n)\in\prod_{n\ge 1}(U_{\frac{1}{n}}(a)\cap A)$が取れる．
        これについて，$\lim_{n\to\infty}d(x,a)=0$より，$a=\lim_{n\to\infty}x_n\in B$である（定義\ref{def-convergence}）．
    \end{enumerate}
\end{proof}
\begin{remarks}
    1という綺麗な算譜が成り立つので，これは普遍的に成り立つが，完全に閉包を特徴付けるならば，距離空間であることが必要である．
\end{remarks}

\subsection{部分列の収束}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=部分列という武器：積位相で議論する美しさ]
    点列の収束よりも弱い条件を考えることで，距離空間を調べていく．
    部分列とは面白い対象である．
    写像の空間と積位相の言葉に戻って，写像の極限を議論することになる．
    すると，点列のグラフ$A\subset X\times\w{\N}$が，$(-,\infty)$の形の点を１つでも触点に持てば良い（位相的に近傍によって分離できなければ良い）．
    連続な部分写像$\w{\N}\nrightarrow X$が存在するということなのだから．
    グラフによる議論．片方の空間（$x$軸）をコンパクトにしてあることが肝であり，これが距離空間の研究に向いている遠因である．

    距離空間においては，コンパクト性は点列コンパクト性で特徴付けられる．
    一般の位相空間では，後者の方が条件が強く，コンパクトだからと言って点列コンパクトとは限らない．
\end{tcolorbox}

\begin{definition}[subsequence, sequentially compact]\mbox{}
    \begin{enumerate}
        \item $X$を集合とし，$(x_n)$を$X$の点列とする．$(m_n)$が$m_{n+1}>m_n$を満たす自然数列である時，点列$(x_{m_n})$は$(x_n)$の\textbf{部分列}であるという．
        \item $X$を位相空間とする．$X$の任意の点列$(x_n)$に対し，$(x_n)$の収束する部分列が存在する時，$X$は\textbf{点列コンパクト}であるという．
    \end{enumerate}
\end{definition}

\begin{lemma}[部分列が収束することの特徴付け]\label{lemma-部分列が収束することの特徴付け}
    $X$を距離空間とする．$X$の点列$(x_n)$と$X$の点$a$について，次の３条件は同値である．
    \begin{enumerate}
        \item $(x_n)$の部分列$(x_{n_m})$で，$a$に収束するものが存在する．
        \item $A=\{(x_n,n)\mid n\in\N\}\subset X\times\widetilde{\N}$とし，$\overline{A}$を積位相に関する閉包とすると，$(a,\infty)\in\overline{A}$である．
        \item 任意の自然数$m$に対し，$\inf_{n\ge m}d(x_n,a)=0$である．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] 
        部分列$(x_{m_n})$が$a$に収束するならば，$\w{\N}$の点列である$(m_n)_{n\in\N}$は$\infty$に収束するから，
        $A$の点列$(x_{m_n},m_n)$は$(a,\infty)\in X\times\w{\N}$に収束する．
        連続写像$\w{\N}\to X$と$\w{\N}\to\w{\N}$との積も連続であるためである．
        よって，系\ref{cor-characterization-of-closure-in-terms-of-limits}より，$(a,\infty)\in\o{A}$である．
        \item[(2)$\Rightarrow$(3)]
        $(a,\infty)\in\o{A}$とする．任意の自然数$m$に対して，$\inf_{n\ge m}d(x_n,a)=0$を示す．
        任意の実数$r>0$に対して，$(0\le)\inf_{n\ge m}d(x_n,a)<r$を導く．
        いま，任意の実数$r>0$に対して，それぞれは$a\in X,\infty\in\w{\N}$の開近傍なので，$U_r(a)\times\w{\N}_{\ge m}$は$(a,\infty)\in X\times\w{\N}$の開近傍である（積位相の基底\ref{prop-characterization-product-topology}）．
        よって，$(a,\infty)\in\o{A}$は閉包の点なので，$A\cap(U_r(a)\times\w{\N}_{\ge m})=\{(x_n,n)\mid d(x_n,a)<r,n\ge m\}$は空でない．
        従って，$d(x_n,a)<r$を満たす自然数$n\ge m$が存在して，$\inf_{n\ge m}d(x_n,a)<r$を満たす．
        \item[(3)$\Rightarrow$(1)]
        次のように帰納的に構成した部分列$(x_{m_n})$は，$\lim_{n\to\infty}d(x_{m_n},a)=0$より，$a$に収束する．
        \begin{enumerate}
            \item $m_0:=0$．
            \item $n\ge 1$について，$\inf_{m\ge m_{n-1}+1}d(x_m,a)=0$が成り立つから，特に$d(x_m,a)<\frac{1}{n}$を満たす自然数$m>m_{n-1}$が存在する．そのような$m$のうち最小のものを$m_n:=m$とする．
        \end{enumerate}
    \end{description}
\end{proof}
\begin{remarks}
    2の条件に凄みを感じる．要は，部分写像が存在すれば良いから，積位相の言葉が一番効くはずである．
    $\infty$と一緒に閉包に入る点$(-,\infty)\in\o{A}$を満たすものは全て部分列の収束先の候補として洗い出すことができる．
    (3)$\Rightarrow$(1)では系\ref{cor-characterization-of-closure-in-terms-of-limits}とは違って選択公理が要らないのは，
    設定が十分具体的で有限的で，データ構造の上に実際のデータの構成算譜が存在するからである．
\end{remarks}

\begin{proposition}[コンパクト距離空間は点列コンパクトである]\mbox{}\label{prop-Bolzano-Weierstrass}
    \begin{enumerate}
        \item $X$がコンパクト距離空間ならば，$X$は点列コンパクトである．
        \item (Bolzano-Weierstrass) $(x_n)$を$\R^m$の有界な点列とすると，収束する部分列$(x_{m_n})$が存在数する．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 任意に$X$の点列$(x_n)$をとり，この収束する部分列が存在することを示せば良い．
        $A:=\{(x_n,n)\mid n\in\N\}\subset X\times\w{\N}$の閉包を$\o{A}$とし，$\exists a\in X,\;(a,\infty)\in\o{A}$を示せれば，補題\ref{lemma-部分列が収束することの特徴付け}より収束する部分列が存在する．
        いま，$X$はcompactだから，特徴付け\ref{prop-characterization-of-compactness-in-terms-of-projection}より，射影$\pr_2;X\times\w{\N}\to\w{\N}$は閉写像である．
        よって，$\pr_2(\o{A})\subset\w{\N}=\o{\pr_2(A)}$（命題\ref{prop-continuous-map-and-closure}）は，$\N\subset\pr_2(A)\subset\pr_2(\o{A})$を満たす閉集合だから，$\pr_2(\o{A})=\w{\N}$である．即ち，$\exists a\in X,\;(a,\infty)\in\o{A}$．
        \item 
        $(x_n)$が$\R^m$の有界な点列ならば，実数$M>0$であって，$\{x_n\}\subset[-M,M]^m$を満たすものが存在する．命題\ref{prop-compact-sets-in-R^n}より，有界閉集合$[-M,M]^m$はコンパクトだから，1.より，$(x_n)$には収束する部分列が存在する．
    \end{enumerate}
\end{proof}
\begin{remarks}[$\R^n$というコンパクト集合を好きに切り出せる空間：局所コンパクト空間]
    1．積位相の言葉でこんなに綺麗に翻訳できるとは．収束する部分列が存在するということは，積空間$X\times\w{\N}$上で，列$(x_n)$を定めるごとにこの閉包が$(-,\infty)$に届けば良いのである．
    でもその後の射影による議論はなんて整理されているんだ．驚嘆する．
    そして2.のBolzano-Weierstrassの定理は，毎度コンパクトな部分集合を$\R^n$の中で取り出していることに他ならない．これが出来るのは局所コンパクトだからである．
    これが$\R^n$の真の姿である．
\end{remarks}

\section{完備性}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=点列という新たな武器を使って完備性というメルクマールを建てる]
    実数列の収束については，Cauchyの判定法と呼ばれる必要十分条件がある．
    これが成り立つかどうかが，一般の距離空間に対しても肝要となる．
    これを完備性と呼ぶこととする．
    これは距離空間におけるLebesgue数の概念（定義\ref{def-Lebesgue-number}）に取って代わることができる．
\end{tcolorbox}

\subsection{基本列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=完備性というメルクマール]
    点列のどこに注目するか，振幅の上限が減少する列の収束性に注目する．
    これは完全なる距離函数の上に建設された概念で，位相的情報からは遊離していて届かない．
\end{tcolorbox}

\begin{definition}[Cauchy sequence, complete]
    $X$を距離空間とする．
    \begin{enumerate}
        \item $X$の点列$(x_n)$が\textbf{コーシー列}または\textbf{基本列}であるとは，次が成り立つことをいう：
        \[ \lim_{m\to\infty}\left(\sup_{n,n'\ge m}d(x_n,x_{n'})\right)=0. \]
        \item $X$の任意のコーシー列が収束する時，$X$は\textbf{完備}であるという．
    \end{enumerate}
\end{definition}

\begin{example}[完備性は位相情報からは定まらない]
    \[X=\left\{\frac{1}{n}\in\R\;\middle|\;n\in\N,n>0\right\}\]
    を，$d_1$をEuclid距離の$X$への制限，$d_2$を$X\times X\setminus\Delta_X$の特性関数とする．
    いずれも$X$上に離散位相を定めるが，$X$上の点列$(1/n)_{n\in\N}$は$d_1$についてはCauchy列だが，$d_2$についてはCauchy列ではない．従って，$X$は$d_2$については完備ではない．
    実際，$d_2$のCauchy列とは，途中から定数列になるものしかあり得ない．
\end{example}

\begin{lemma}\label{lemma-Cauchy-sequence}
    $X$を距離空間とし，$(x_n)$を$X$の点列とする．
    \begin{enumerate}
        \item $(x_n)$が$X$の点に収束するならば，$(x_n)$はCauchy列である．
        \item $(x_n)$がCauchy列であり，部分列$(x_{m_n})$が$a\in X$に収束するならば，数列全体も$a$に収束する．
        \item $(x_n)$がCauchy列ならば，$(x_n)$は有界である．
        \item $(x_n)$がCauchy列ならば，$a\in X$に対し，実数列$d(x_n,a)$もCauchy列である．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $\lim_{n\to\infty}x_n=:a$とする（距離空間はHausdorffだから\ref{prop-metric-space-is-Hausdorff}，極限は一意で\ref{prop-uniqueness-of-limit-in-Hausdorff-space}，well-defined）．
        任意の$m$を取る．任意の$n,n'\ge m$について，三角不等式より，$d(x_n,x_{n'})\le d(x_n,a)+d(x_{n'},a)$が成り立つから，その上限を比べても$\sup_{n,n'\ge m}d(x_n,x_{n'})\le 2\sup_{n\ge m}d(x_n,a)$が成り立つ（左辺がいくら大きくなろうと，それを抑えるときの右辺が存在するため）．
        これによる．$(x_n)$が収束するとは$\lim_{m\to\infty}\paren{\sup_{n\ge m}d(x_n,a)}=0$だから，$\lim_{m\to\infty}\paren{\sup_{n,n'\ge m}d(x_n,x_{n'})}=0$である．
        \item 
        一般に$d(x_n,a)\le d(x_n,x_{n'})+d(x_{n'},a)$である．右辺第１項の上限$\sup_{n,n'\ge m}d(x_n,x_{n'})$を先に取ると，$a$はこの振幅の間に存在するから，
        \[\sup_{n\ge m}d(x_n,a)\le \sup_{n,n'\ge m}d(x_n,x_{n'})+\inf_{n'\ge m}d(x_{n'},a)\]
        が一般に成り立つ．いま，部分列$(x_{m_n})$が$a\in X$に収束するとは，特徴付け\ref{lemma-部分列が収束することの特徴付け}(3)より，右辺第２項は$0$である．
        よって，Cauchy列ならば，$a$に収束する．
        \item 
        $\exists m\in\N,\;\sup_{n,n'\ge m}d(x_n,x_{n'})\le 1$である．$M:=\max(d(x_0,x_m),\cdots,d(x_{m-1},x_m),1)$とすれば，$\forall n\in\N,\;d(x_n,x_m)\le M$を満たす．
        \item
        $\abs{d(x_n,a)-d(x_m,a)}\le d(x_n,x_m)$より．
    \end{enumerate}
\end{proof}
\begin{remarks}
    1は三角不等式による．見える，目的に無限に近づくならば，その間の歩幅はさらに強いオーダーで0に近づくはずである．
    2は$a\in X$を基点に考えるといい，ここに無限に近づく点が任意に取れるのだから，Cauchy列では他の全ての点もそこに束縛される．
    これらを$\sup,\inf$で議論すると極めて後味が良い．
    標語としては$\sup_{n\ge m}d(x_n,a)\le \sup_{n,n'\ge m}d(x_n,x_{n'})+\inf_{n'\ge m}d(x_{n'},a)$と表せる，$a$の線を中心にしか振幅しないことから，部分列の特徴付けの表現に寄せて得る式である．
    3は適当な点を選べば（証明では１にした）それ以上逃げない．
    4は実数が距離函数から始まる概念のモデル対象であることをよく表している．
\end{remarks}

\subsection{実数の完備性}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=実数の特徴付け]
    実数では収束列とCauchy列は同値であり，これによって収束列を特徴付けることを，Cauchyの判定法という．
\end{tcolorbox}

\begin{proposition}[実数の完備性 / Cauchy's criterion]\label{prop-completeness-of-Euclid-space}
    距離空間$\R^n$は完備である．
\end{proposition}
\begin{proof}
    任意にCauchy列$(x_k):\N\to\R^n$を取る．これが収束することを示せば良い．
    \begin{enumerate}
        \item 補題\ref{lemma-Cauchy-sequence}.3より，列$(x_k)$は有界である．
        \item Bolzano-Weierstrassの定理\ref{prop-Bolzano-Weierstrass}より，列$(x_k)$は収束する部分列を持つ．
        \item 補題\ref{lemma-Cauchy-sequence}.2より，列$(x_k)$自体も同じ収束先へと収束する．
    \end{enumerate}
\end{proof}

\begin{screen}
    次の順で証明をしてきた．
    \begin{enumerate}
        \item 実数の連続性（Weierstrassの上限公理\ref{thm-Weierstrass's-supremum-axiom}）
        \item 閉区間の連結性（命題\ref{prop-closed-interval-is-connected}）
        \item 閉区間のコンパクト性（Heine-Borelの定理\ref{thm-Heine-Borel}）
        \item 閉区間の点列コンパクト性（Bolzano-Weierstrassの定理\ref{prop-Bolzano-Weierstrass}）
        \item 実数の完備性（命題\ref{prop-completeness-of-Euclid-space}）
    \end{enumerate}
    アルキメデス性の下で，5$\Rightarrow$1を導ける．
\end{screen}

\begin{definition}[Archimedean property]
    $\N$の消息を使った性質で，極限的な元が現れないこと．
    \begin{enumerate}
        \item $\forall a\in\R,\;\exists n\in\N,\;a\le n$．
    \end{enumerate}
\end{definition}

\subsection{コンパクト距離空間の特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=完備性によるコンパクト距離空間の特徴付け]
    命題\ref{prop-距離空間がコンパクトであることの特徴付け}の試みから，Lebesgue数を，代わりに完備という概念で置換できる．
    コンパクトな距離空間は，点列コンパクトである．仕組みで言えば鳩の巣原理である，有限被覆のうちどれかを無限回踏むことになる．
    点列コンパクトならば，完備かつ全有界である．部分列が収束する数列とCauchy列の共通部分は収束列であるためであり，まあコンパクトならば全有界である．
    また，完備ならば，全ての点が何かしらのCauchy列の収束先として表現でき，その表現は連続写像のデータ構造を持つ．
    全有界の時，これらCauchy列の集合はコンパクトに（＝効率よく）取れる．
\end{tcolorbox}

\begin{theorem}[AC]\label{thm-characterization-of-compact-metric-space}
    距離空間$X$について，次の３条件は同値である．
    \begin{enumerate}
        \item $X$はコンパクト．
        \item $X$は点列コンパクト．
        \item $X$は完備かつ全有界．
    \end{enumerate}
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] 
        命題\ref{prop-Bolzano-Weierstrass}.1．
        \item[(2)$\Rightarrow$(3),AC] \mbox{}\\
        \begin{description}
            \item[完備性について] 
            Cauchy列$(x_n)$を任意に取る．$X$は点列コンパクトなので，収束する部分列$(x_{m_n})$が存在する．補題\ref{lemma-Cauchy-sequence}より，Cauchy列$(x_n)$は部分列の収束先$\lim_{n\to\infty}x_{m_n}$に収束する．
            \item[全有界性について] 
            対偶命題：$X$が全有界でないならば，点列コンパクトでないことを示す．即ち，実数$r>0$であって，任意の有限部分集合$A\subset X$に対して，$X\supsetneq\cup_{a\in A}U_r(a)$が成り立つものが存在すると仮定する．
            これに対して次のように$X$の点列$(x_n)$を帰納的に定める：
            \begin{enumerate}
                \item $x_0\in X\ne\emptyset$を任意に取る．
                \item $x_0,\cdots,x_n\in X$に対して，$x_{n+1}\in X\setminus(U_r(x_0)\cup\cdots\cup U_r(x_n))\ne\emptyset$と取る．
            \end{enumerate}
        すると，この点列は$d(x_m,x_n)\ge r\;(0\le m<n)$を満たすので，収束する部分列を持たない．
        \end{description}
        \item[(3)$\Rightarrow$(1),AC] $X$を全有界かつ完備とし，ここからコンパクト性を示す．
        \begin{description}
            \item[コンパクト空間$A$の構成] 
            $X$は全有界で$\frac{1}{2^n}>0\;(n\in\N)$だから，任意の$n\in\N$に対して，$\forall x\in X\;\exists a\in A_n,\; d(x,a)<\frac{1}{2^n}$を満たす離散有限集合$A_n$が存在する（$X=\cup_{a\in A_n}U_{\frac{1}{2^n}}(a)$を満たす$A_n$が存在するため）．
            選択公理より，これらからなる，$X$の離散有限集合の列$(A_n)$が取れる．
            これらの無限積空間$A:=\prod_{n\in\N}A_n$はTychonoffの定理\ref{thm-Tychonoff}より，compactである．
            \item[コンパクト部分空間$C$の構成]
            $A$の部分空間$C$を
            \[C:=\left\{(a_n)\in A\;\middle|\;\forall n\in\N,\;d(a_n,a_{n+1})\le\frac{3}{2^{n+1}}\right\}\]
            で定める．するとこの$C$は
            \[C=\bigcap_{n\in\N}\left\{(a_m)\in A\;\middle|\;\forall n\in\N,\;d(a_n,a_{n+1})\le\frac{3}{2^{n+1}}\right\}=\bigcap_{n\in\N}(\pr_n\times\pr_{n+1})^{-1}\paren{\left[0,\frac{3}{2^{n+1}}\right]}\]
            をみたし，任意の$n\in\N$について射影の積$\pr_n\times\pr_{n+1}:A\to A_n\times A_{n+1}$は連続だから，$C$はコンパクト空間$A$の閉部分空間である．
            従って$C$もコンパクトである（系\ref{cor-union-intersection-of-compact-sets-is-compact}）．
            \item[全射$l:C\to X$の構成]
            $(a_n)\in C$は
            \begin{align*}
                \forall n\le m\qquad d(a_n,a_m)&\le d(a_n,a_{n+1})+\cdots+d(a_{m-1},a_m)\\
                &\le \frac{3}{2^{n+1}}+\cdots+\frac{3}{2^m}\le\frac{3}{2^n}
            \end{align*}
            より，$X$のCauchy列である．$X$は完備だから，極限$\lim_{n\to\infty}a_n\in X$が存在し，写像
            \[\xymatrix@R-2pc{
                l:C\ar[r]&X\\
                \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
                (a_n)\ar@{|->}[r]&\lim_{n\to\infty}a_n
            }\]
            が定まる．この$l$が全射であることを示す．

            任意の$x\in X$に対して，$l^{-1}(x)$の元を構成する．
            点列$a=(a_n)\in A$であって，$d(a_n,x)<\frac{1}{2^n}\;(n\in\N)$を満たすものが存在するように，空間$A$を定義したのであった．選択公理より，このような$a\in A$が取れる．
            ここでこの点列は，
            \[\forall n\in\N,\quad d(a_n,a_{n+1})\le d(a_n,x)+d(a_{n+1},x)<\frac{1}{2^n}+\frac{1}{2^{n+1}}=\frac{3}{2^{n+1}}\]
            を満たすから，$a\in C$でもある．この点列は$\lim_{n\to\infty}a_n=x$より，$l(a)=x$を満たす．
            \item[$l$は連続である]
            任意に点$a=(a_n)\in C$を取り，任意の$r>0$について，逆像$l^{-1}(U_r(l(a)))$に含まれる$a\in C$の開近傍の基本系の元（即ち基底）を構成すれば良い（命題\ref{prop-continuousness-in-terms-of-basis}）．\footnote{$l$の終域の基底は開球で，始域の基底は}

            任意の$n\in\N$について$d(a_n,l(a))\le\frac{3}{2^n}$である．
            よって任意の実数$r>0$に対して，$m$を$\frac{6}{2^n}<r$を満たす最小の自然数$n$とすれば，
            $a=(a_n),b=(b_n)\in C$が$a_m=b_m$をみたすならば，$d(l(a),l(b))\le d(a_m,l(a))+d(b_m,l(b))\le\frac{6}{2^m}<r$である．
            従って，$\pr^{-1}_m(\pr_m(a))\subset l^{-1}(U_r(l(a)))$である．
            よって，全射$l:C\to X$は連続である．\footnote{???}
            $C$はコンパクトだから，\ref{cor-image-of-compact-set-is-compact}より，$X$もコンパクトである．
        \end{description}
    \end{description}
\end{proof}
\begin{remarks}[データ構造の祈り]
    (2)$\Rightarrow$(3)：全有界ってこうやって使えるのか！
    ある$r>0$に対して，有限開球被覆が出来ないならば，そこを無限に飛び石しながら進む点列は，どの点の間も$r$以上離れている．
    (3)$\Rightarrow$(1)：積位相の利用の極みである，数列全体を考えて一斉に収束させる写像$l:C\to X$が非常にスケールがでかい．列という写像の束の空間として，数列の空間$A$を作っている．
    \textbf{「空間が完備かつ全有界ならば，全ての点が何かしらのCauchy列の極限である」「そしてこの対応$l$が連続なので，値域はコンパクト」ということの表現がこんなに完全になるとは}．
    データ構造の祈りを感じる．写像や集合や位相と言ったデータ構造がこの上なく好きだ．

    最後のステップについてだが，$\frac{6}{2^m}<r$をギリギリ満たす$m$について，$a_m=b_m$を満たせば，それぞれの極限の間の距離は$r$を下回るという算譜がある．
    従って，$\pr_m^{-1}(\pr_m(a))$の像はまるまる$U_r(l(a))$に入る．
    だがこれでは基底が構成できていないではないか．全く意味がわからないが，$m$の時点では$a_m=b_m$の必要があるにしても，もう少し緩めても良いのかなと考えられる．ここを開球の言葉に置換した算譜を作れば良いのだろう．
\end{remarks}
\begin{remark}
    (3)$\Rightarrow$(1)は区間縮小法による閉区間のコンパクト性の証明によく似ている．
\end{remark}

\subsection{完備空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=完備空間]
    Hausdorff空間では，コンパクト集合は閉であるが，逆も成り立つには全体空間がコンパクトである必要がある（命題\ref{prop-compact-set-in-Hausdorff-spaces}）．
    距離空間では，完備空間は閉であるが，逆も成り立つためには，全体空間が完備である必要がある．
    完備性とコンパクト性は似ていて，有界性だけ違う．
\end{tcolorbox}

\begin{proposition}[距離空間内の閉集合]\label{prop-complete-sets-in-metric-space}
    $X$を距離空間，$A$を部分空間とする．次の２条件を考える．
    \begin{enumerate}
        \item $A$は完備．
        \item $A$は$X$の閉集合．
    \end{enumerate}
    1$\Rightarrow$2である．$X$が完備ならば逆も成り立つ．
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2),AC] $A\supset\o{A}$を示せば良い．任意に$a\in\o{A}$を取る．系\ref{cor-characterization-of-closure-in-terms-of-limits}.2(AC)より，
        $a$に収束する$A$の点列$(x_n)$が存在する．収束する列$(x_n)$はCauchy列で（補題\ref{lemma-Cauchy-sequence}.1），$A$は完備だから，$(x_n)$は収束する．系\ref{cor-characterization-of-closure-in-terms-of-limits}.2より，それは$a$で，よって$a\in A$．
        \item[(2)$\Rightarrow$(1)]
        $(x_n)$を$A$のCauchy列とし，これが収束することを示せば良い．$X$が完備ならば，極限を持つ：$\lim_{n\to\infty}x_n=:a\in X$．系\ref{cor-characterization-of-closure-in-terms-of-limits}より，$a\in\o{A}=A$．従って，$A$は完備．
    \end{description}
\end{proof}
\begin{remarks}
    本質は系\ref{cor-characterization-of-closure-in-terms-of-limits}である．
    $A$の列は$\o{A}$の範囲に収束するというのはあらゆる空間について成り立ち，逆に$\o{A}$の点ならば$A$の内点のみの列でそれへ収束するようなものが作れるが，距離空間などの付加構造がある場合に限る(AC)．
\end{remarks}

\begin{proposition}
    $X$を集合とすると，ノルム空間$\widetilde{B}(X)$（例\ref{exp-uniform-norm}）は完備である．
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[証明方針] 任意に$\widetilde{B}(X)$のCauchy列$(f_n)$を取る．これが収束することを示せば良い．
        \item[収束先関数の構成] 
        上限ノルムの定義から，任意の$x\in X$に対して$\forall n,m\in\N,\;\abs{f_n(x)-f_m(x)}\le d(f_n,f_m)$が成り立つから，各$x\in X$について$\R$-列$(f_n(x))$はCauchy列である．よって，収束する．
        こうして次の関数が定義できる：
        \[\xymatrix@R-2pc{
            f:X\ar[r]&\R\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            x\ar@{|->}[r]&\lim_{n\to\infty}f_n(x)
        }\]
        いま，補題\ref{lemma-Cauchy-sequence}.4より，$\w{B}(X)$のCauchy列$(f_n)$に対して$\R$-列$(d(f_n,0))=(\|f_n\|_\infty)$もCauchy列である．$\R$は完備より収束する．
        $\forall x\in X,\;\abs{f(x)}\overset{def}{=}\lim_{n\to\infty}\abs{f_n(x)}\le\lim_{n\to\infty}\|f_n\|_\infty\in\R$より，$f$は有界であるから，$f\in\w{B}$である．
        \item[収束の証明]
        勝手に自然数$m\in\N$を取る．すると
        \[\forall x\in X,\; d(f,f_m)=\abs{f(x)-f_n(x)}=\lim_{n\to\infty}\abs{f_n(x)-f_m(x)}\le\sup_{n\ge m}d(f_n,f_m)\]
        が成り立つ．いま$(f_n)$はCauchy列だから，$\sup_{n\ge m}d(f_n,f_m)\xrightarrow{m\to\infty}0$であり，$(f_n)$は$f$に収束する．
    \end{description}
\end{proof}
\begin{remarks}
    各点ごとに収束させて収束先の関数を定義し，これが本当に（一様）収束先であることを示す．
    これは上限ノルムだからできることである．点列と関数の可換図式の問題である．
\end{remarks}

\begin{corollary}
    $X$を位相空間とする．$\widetilde{B}(X)$の部分空間$B(X)$は上限ノルムに関して完備である．
\end{corollary}
\begin{proof}
    命題\ref{prop-有界連続関数のなす部分空間は，一様収束位相に関して閉集合である}より，$B(X)$は完備空間$\w{B}(X)$の閉部分空間である．
    命題\ref{prop-complete-sets-in-metric-space}より，これも上限ノルムに関して完備である．
\end{proof}

\subsection{完備化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=完備化]
    完備性とコンパクト性は似ていて，有界性だけ違うということであった．
    コンパクト化の距離空間における一般化として，完備化を考える．
    例えば$\Q\to\R,(0,1)\to[0,1]$はいずれも完備化である．
    コンパクト化とは違うことには，任意の距離空間に関して完備化が存在し，本質的に一意的である．
    これは，距離函数が誘導する標準的な完備化$i:X\to B(X)$が存在するからに他ならない．
    有界連続関数の空間に埋め込むことで，完備化後に必要な点を用意することができ，任意の空間はこれに対して等長で同型となる．
\end{tcolorbox}

\begin{definition}[completion]
    $X$を距離空間，$Y$を完備距離空間とする．
    $f:X\to Y$が等長写像であり，像$f(X)$が$Y$で稠密である時，$Y$は$f$に関して$X$の\textbf{完備化}であるという．
\end{definition}
\begin{remarks}
    開埋め込みが等長写像になっている．Topの射とMetの射の交代である．
    命題\ref{prop-部分距離空間のwell-definedness}より，等長写像は埋め込みであることに注意．
\end{remarks}

\begin{proposition}
    $X$を距離空間とする．$x\in X$に対し，$d(x,-):X\to\R$を$y\mapsto d(x,y)$と定める．
    \[\xymatrix@R-2pc{
        D_X:X\ar[r]&\Map(X,\R)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        x\ar@{|->}[r]&d(x,-)
    }\]
    $a\in X$とする．
    \begin{enumerate}
        \item $x\in X$ならば，$D_X(x)-D_X(a)\in B(X)$である．$x\in X$を$D_X(x)-D_X(a)\in B(X)$に写す写像$i:X\to B(X)$は等長写像である．
        \item 等長写像$i:X\to B(X)$の像の閉包$\overline{i(X)}$が$X$の完備化である．
        \item (一意性) $Y$を距離空間，$f:X\to Y$を等長写像とし，$Y$は$f$に関して$X$の完備化であるとする．$y\in Y$に対し，
        \[\xymatrix@R-2pc{
            \widetilde{D}_X(y):X\ar[r]&\R&\tilde{i}:Y\ar[r]&B(X)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            x\ar@{|->}[r]&d(y,f(x))&y\ar@{|->}[r]&\widetilde{D}_X(y)-D_X(a)
        }\]
        と定めると，写像$\tilde{i}$は可逆な等長写像$Y\to\overline{i(X)}$を定め，$\tilde{i}\circ f=i$である．
        \[\xymatrix{
            X\ar[r]^-f\ar[d]_-i&Y\ar[dl]^-{\o{i}}\\
            B(X)
        }\]
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item \begin{enumerate}[(a)]
            \item 命題\ref{prop-characterization-of-closure-in-terms-of-metric-function}より，
            \[\abs{D_X(x)(y)-D_X(x)(z)}=\abs{d(x,y)-d(x,z)}\le d(y,z)\]
            より，$y\to x$の極限を考えると，$D_X(x)\in C(X)$である．
            \item 再び命題\ref{prop-characterization-of-closure-in-terms-of-metric-function}より，
            \[\forall z\in X,\;\abs{D_X(x)(z)-D_X(y)(z)}=\abs{d(x,z)-d(y,z)}\le d(x,y)\]
            より，さらに踏み込んで$D_X(x)-D_X(y)\in B(X)$である．
            \item 
            いま，
            \[\|D_X(x)-D_X(y)\|_\infty=\sup_{z\in X}\abs{d(x,z)-d(y,z)}\le d(x,y)\]
            であるが，$z=y$とすると，$\abs{d(x,y)-d(y,y)}=d(x,y)$なので，$d(i(x),i(y))=\|D_X(x)-D_X(y)\|_\infty=d(x,y)$より，$i$は等長写像である．
        \end{enumerate}
        \item 
        $\o{i(X)}\subset B(X)$は完備距離空間$B(X)$の部分閉集合だから，命題\ref{prop-complete-sets-in-metric-space}より完備である．
        $i$は等長写像で，$i(X)$は$\o{i(X)}$上で稠密に決まっているので，$\o{i(X)}$は$X$の完備化である．
        \item 

    \end{enumerate}
\end{proof}
\begin{remarks}
    $a\in X$を基点にしてなされる一般的な完備化
    \[\xymatrix@R-2pc{
        i:X\ar[r]&B(X)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        x\ar@{|->}[r]&d(x,-)-d(a,-)
    }\]
    が上限ノルムについて等長埋め込みであるということが飲み込めていない．
    おそらく距離函数という構造の値域$\R$を使って完備化をしている．
    $X$の任意の完備化$Y$は，この完備化$\o{i(X)}$と同型になる．
\end{remarks}

\subsection{完備距離空間の性質}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=完備距離空間：距離空間の聖域，一切距離空間悉有仏性]
    \begin{enumerate}
        \item 完備距離空間の縮小写像には不動点が存在する．任意の距離空間は縮小写像の不動点は一意的である，$r\in(0,1)$と定めたためである．
    \end{enumerate}
\end{tcolorbox}

\begin{definition}[contracting mapping]
    $X$を距離空間とし，$f:X\to X$を写像とする．次の条件を満たすとき，$f$は\textbf{縮小写像}であるという：
    \[ \exists r\in(0,1),\;\forall x,y\in X,\; d(f(x),f(y))\le r\cdot d(x,y). \]
    任意の$r>0$に対して$U_r(x)\subset f^{-1}(U_r(x))$が成り立つので，命題\ref{prop-continuousness-in-terms-of-basis}より，
    縮小写像ならば連続である．
\end{definition}

\begin{proposition}[完備距離空間の縮小写像には不動点が存在する]
    $X$を距離空間とし，$f:X\to X$を縮小写像とする．
    \begin{enumerate}
        \item $f(a)=a$を満たす$a\in X$は，存在すればただ一つである．
        \item $X$が完備であり空でなければ，$f(a)=a$を満たす$a\in X$が存在する．
    \end{enumerate}
\end{proposition}
\begin{proof}
    $f$は縮小写像だから，条件を満たす$r\in(0,1)$が存在する．
    \begin{enumerate}
        \item $a,b\in X$が$f(a)=a,f(b)=b$を満たすとする．$d(a,b)\le rd(a,b)$より，$r\in(0,1)$だから，$d(a,b)=0\Leftrightarrow a=b$．
        \item 任意に$x\in X\ne\emptyset$を取り，$X$の点列をこれから$(x_n:=f^n(x))$と定める．
        すると，
        \begin{align*}
            \forall m\in\N,\;\forall n\ge m,\quad d(x_n,x_m)&\le \sum^{n-1}_{i=m}d(x_{i+1},x_i)\\
            &\le \sum^{m-1}_{i=m}r^id(x_1,x_0)\\
            &=\frac{r^m-r^n}{1-r}d(x_1,x_0)\\
            &\le \frac{r^m}{1-r}d(x_1,x_0)\xrightarrow{m\to\infty}0.
        \end{align*}
        より，これはCauchy列である．$X$は完備だから，極限$\lim_{n\to\infty}x_n=:a\in X$が存在する．これについて，$f(a)=\lim_{n\to\infty}f(x_n)=\lim_{x\to\infty}x_{n+1}=a$である．
    \end{enumerate}
\end{proof}

\begin{proposition}[AC, 完備距離異空間の稠密開集合の可算共通部分は稠密]
    $X$を完備距離空間とする．$(U_n)_{n\in\N}$が$X$の稠密な開集合の列ならば，共通部分$\cap_{n=0}^\infty U_n$も稠密である．
\end{proposition}

\begin{corollary}[Baire, AC]
    $X$を空でない完備距離空間とし，$(A_n)_{n\in\N}$を$X$の閉集合の列とする．$X=\cup_{n=0}^\infty A_n$ならば，内部$A^\circ_n$が空でない$n$が存在する．
\end{corollary}

\section{可算性と距離付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=filterの聖域]
    第２可算な正規空間の位相は，距離で定義される．

    このように，位相空間論における種々の概念が点列の収束の言葉（可算極限）により特徴づけることは非常に便利である（位相空間論における正規族の議論など）．
    しかし，これが可能なのは第２可算性に因る．そして実はこれは非本質的な制約である．
    点列の一般化であるnetを用いれば，可算性を仮定しない一般の位相空間においても，収束によって位相空間の種々の概念を特徴づけることができる．函数解析における汎弱位相などは必ずしも可算性を持たない．
\end{tcolorbox}

\subsection{可算性}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=filterの聖域]
    やっと基底と開近傍の基本系の間の関係（基底$\U\subset\O$から，$x\in U$を満たす$U\in\U$を選び出せばそれが開近傍の基本系である）が定式化できる，第２可算ならば第１可算である．
    また第２可算ならば可分である．
    となると可分と第１可算の間の関係が気になるが，$X$が距離空間である時，可分であることと第２可算であることは同値である．
\end{tcolorbox}

\begin{definition}[first-countable, second-countable, separable, $\sigma$-compact]
    $X$を位相空間とする．
    \begin{enumerate}
        \item 任意の$x\in X$に対し，$x$の開近傍の基本系$\U_x$であって，可算集合であるものが存在する時，$X$は\textbf{第１可算}であるという．任意の近傍のフィルター$\O(x)$が可算な基を持つことをいう．
        \item $X$の開集合系の基底$\U$で，可算集合であるものが存在する時，$X$は\textbf{第２可算}であるという．したがって，可算な準基を持てば十分．
        \item $X$の稠密な可算部分集合が存在する時，$X$は\textbf{可分}であるという．
        \item $X$を局所コンパクト空間とする．$X$のコンパクト集合の列$(A_n)_{n\in\N}$で，$X=\cup_{n\in\N}A_n$を満たすものが存在する時，$X$は\textbf{$\sigma$-コンパクト}であるという．
    \end{enumerate}
\end{definition}
\begin{remarks}
    コンパクト集合で被覆できることを局所コンパクトというのであった（注\ref{remark-locally-compact}）．
    可算なコンパクト被覆が存在することを$\sigma$-コンパクトという．
    可分の定義は謎に感じたが，全有界の文脈であるのか！距離空間では２つの概念は同値になる(AC)．
\end{remarks}

\begin{proposition}\label{prop-sep-general-space}
    $X$を位相空間とする．
    \begin{enumerate}
        \item $\U$が$X$の開集合系の基底ならば，$X$の任意の点$x$に対し，$\U_x=\{U\in\U\mid x\in U\}$は$x$の開近傍の基本系である．
        \item $X$が第２可算ならば，$X$は第１可算である．
        \item (AC) $X$が第２可算ならば，$X$は可分である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $x$の開近傍$V$を任意に取る．$\U$は基底だから，$x\in U\subset V$を満たす$U\in\U$が存在する（定義\ref{def-basis-fundamental-sysmte}）．
        $U\in\U_x$である．よって，$\U_x$は開近傍の基本系である．
        \item $\U_x\subset\U$より，可算な$\U$が存在するならば，$\U_x$は可算である．
        \item $\U$を開集合の基底であって，可算なものとする．$\emptyset\notin\U$としても一般性を失わない．
        これに対して，選択公理より$(a_U)_{U\in\U}\in\prod_{U\in\U}U$が取れるから，$A:=\{a_U\}_{U\in\U}$と定めると，これは可算であるから，$X$上で稠密であることを示せば良い．
        任意の開集合$V\subset X$に対して，$A$と共通部分を持つことを示せば良い．$\U$は基底だから，$U\subset V$を満たす$U\in\U$が存在する．よって，$a_U\in A\cap U\subset A\cap V\ne\emptyset$．よって$A$は稠密．
    \end{enumerate}
\end{proof}

\begin{proposition}[距離空間では可分と全有界は同値]\label{prop-sep-metric-space}
    $X$を距離空間とする．
    \begin{enumerate}
        \item $X$は第１可算である．
        \item $A$が$X$の稠密な部分集合ならば，$\U_A=\{U_{1/n}(a)\mid a\in A,n\in\N,n>0\}$は$X$の開集合系の基底である．
        \item (AC) $X$が全有界ならば，$X$は可分である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 命題\ref{prop-open-balls-is-basis}と実数のArchimedes性より，任意の$x\in X$に対し，$\{U_{\frac{1}{n}}(a)\}_{n\in\N_{>0}}$は開近傍の基本系であり，可算である．
        \item $X$の開集合$U$とその点$x\in U$を任意に取り，この間に挟まる$\U_A$の元を構成すれば良い．
        開球は基底だから，$U_r(x)\subset U$を満たす実数$r>0$が存在し，実数のArchimedes性より，$n\ge\frac{2}{r}$を満たす$n\in\N$も存在する．$A$は稠密だから，この$n$に対しても$U_{1/n}(x)\cap A\ne\emptyset$で，$a\in U_{1/n}(x)\cap A$が取れる．
        $\frac{1}{n}+d(x,a)<\frac{2}{n}\le r$が成り立つから，$x\in U_{1/n}(a)\subset U_r(x)\subset U$が成り立つ．
        \item 
        任意の自然数$n\ge 1$に対して，$\forall x\in X,\;\exists a\in A_n,\;d(x,a)\le 1/n$を満たす有限集合$A_n\subset X$が存在するから，選択公理より列$(A_n)$を得る．$A=\cup_{n\in\N}A_n$とするとこれは可算集合であり，$X$上稠密である．
    \end{enumerate}
\end{proof}
\begin{remarks}
    2より，$X$が可分ならば全有界である．
    しかし3の全有界ならば可分はヤバすぎる，Archimedes性を舐めていた．
    $r=\frac{1}{n}$を再帰的に代入することによって，$A_n$を得る．これらを全て集めても高々可算であるが，全ての点に接触している．
\end{remarks}

\begin{corollary}\label{cor-separability-and-second-countability}
    $X$を距離空間とすると，次の２条件は同値．
    \begin{enumerate}
        \item $X$は可分である．
        \item $X$は第２可算である．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] $X$の稠密な可算部分集合を$A$とする．命題\ref{prop-sep-metric-space}の通りに$\U_A$を定めると，これは可算である．
        \item[(2)$\Rightarrow$(1),AC] 命題\ref{prop-sep-general-space}.3より．
    \end{description}
\end{proof}

\begin{itembox}[l]{全有界と可分と第２可算}
    全有界が一番強く，他２つが同値なのであろう．
    \[\xymatrix{
        &全有界\ar@{=>}[dl]\ar@{=>}[dr]\\
        可分\ar@{<=>}[rr]&&第２可算\ar@{=>}[d]\\
        &&第１可算
    }\]
    全有界ならば，稠密な可算部分集合$A$を構成できる．
    稠密な可算部分集合$A$が存在するならば，その各点に於ける可算な基本系（実数のArchimedes性より距離空間では常に構成可能）を$\cup_{a\in A}\cup_{n\in\N}U_{1/n}(a)$と集めると基底になるので第２可算．

    なお第１可算性については，局所コンパクト性みたいな感じで，距離空間普遍の性質なのであろう．
\end{itembox}

\subsection{距離付け可能性}\label{subsec-metrizable-spaces}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily
    ,title=filterの聖域]
    Urysohnの距離付け定理や，コンパクト距離空間の特徴付け（定理\ref{thm-characterization-of-compact-metric-space}）が，
    20世紀初めに於ける抽象的な位相空間論の頂点を飾るものであった．

    積空間$\R^\N\hookrightarrow l^\infty$に埋め込みがあり，距離付け可能である．
    $\R^\N$は可分であるため，第２可算でもある．
    これをモデル空間として採用して，埋め込み$X\hookrightarrow\R^\N$が存在することと，第２可算かつ正規であることと，可分かつ距離付け可能であることの３条件は同値であることを得る．

    距離付け可能性は，可算積について閉じている($\R$の非可算無限積は正規ではない)．
\end{tcolorbox}

\begin{definition}[metrizable]
    $(X,\O)$を位相空間とする．$\O$を定める$X$の距離が存在する時，$X$は\textbf{距離付け可能}であるという．
\end{definition}

\begin{proposition}[モデル空間での例]\mbox{}
    \begin{enumerate}
        \item 積空間$\R^\N$は距離付け可能である．
        \item 積空間$\R^\N$は可分であり，第２可算である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item \begin{description}
            \item[証明方針] $\R$は空でない開区間と同相だから，積空間$A:=\prod_{n\in\N}\paren{0,\frac{1}{n}}$が距離付け可能であることを示せば良い．
            また$l^\infty\subset\subset\R^\N$は距離空間だから（例\ref{exp-uniform-norm}），包含写像\[\xymatrix@R-2pc{
                i:A\ar[r]&l^\infty\\
                \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
                (a_n)\ar@{|->}[r]&a:\N\to\R
            }\]
            が埋め込みであること：$i^*(\O_{l^\infty})=\O_A$，即ち$l^\infty$空間の部分空間であることを示せば良い．
            \item[証明] \begin{align*}
                \forall r>0,\;\forall a\in A,\quad i^{-1}(U_r(a))&=U_r(a)\cap A\\
                &=\prod_{n\le 1/r}U_r(a_n)\times\prod_{n>1/r}\paren{0,\frac{1}{n}}
            \end{align*}
            は族の積位相の特徴付けより開集合系の基底である．基底と基底が通じ合っているため，$i^*$が任意の合併を保つことより（命題\ref{prop-functoriality-of-image-and-inverse-image-mappings}），
            $i^*(\O_{l^\infty})=\O_A$である．
        \end{description}
        \item 
        $\R^\N$の可算部分集合
        \[\Q^{(\N)}:=\left\{x=(x_n)\in\R^\N\;\middle|\;x_n\ne 0を満たすnは高々有限個\right\}\]
        が稠密であるため．系\ref{cor-separability-and-second-countability}より．
    \end{enumerate}
\end{proof}
\begin{remarks}
    1の初手が高次元すぎるのである．有界数列の空間$l^\infty=(\w{B}(\N),\|\;\;\|_\infty)$という数列の空間に上限ノルムを入れた空間（例\ref{exp-uniform-norm}）がある．
    これの部分空間であると示せれば，その位相は距離付け可能である．

    なんだか，2の可算部分集合$\Q^{(\N)}$はどう考えてもベクトル空間$\R^\N$の基底チックである．
\end{remarks}

\begin{theorem}[Urysohnの距離付け定理]
    位相空間$X$について，次の３条件は同値である．
    \begin{enumerate}
        \item $X$は可分かつ距離付け可能．
        \item $X$は第２可算かつ正規．
        \item 埋め込み$X\to\R^\N$が存在する．
    \end{enumerate}
\end{theorem}

\begin{lemma}[Urysohn's lemma]\label{lemma-Urysohn's-lemma}
    $X$を正規空間とする．$A$を$X$の閉集合，$U$を$X$の開集合で，$A\subset U$を満たすものとする．
    \begin{enumerate}
        \item $X$の閉集合$B$と，$X$の開集合$V$で，$A\subset V\subset B\subset U$を満たすものが存在する．
        \item (Urysohn's lemma) 連続関数$f:X\to[0,1]$で，$A\subset f^{-1}(0)\subset f^{-1}([0,1)\subset U$を満たすものが存在する．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 正規性の特徴付け\ref{prop-characterizatioin-of-normality}より．
        \item 
    \end{enumerate}
\end{proof}
\begin{remarks}[関数によって分離される]
    ２つの閉集合$A,B$が，関数によって分離されるとは，実数値関数$f:X\to[0,1]$であって，$f(A)=\{0\},f(B)=\{1\}$を満たすようなものが存在することをいう．
\end{remarks}

\begin{corollary}[AC, コンパクト距離空間は閉区間の可算積の閉部分空間と同相である]
    位相空間$X$について，次の３条件は同値である．
    \begin{enumerate}
        \item $X$はコンパクトかつ距離付け可能である．
        \item $X$は第２可算かつコンパクト・ハウスドルフである．
        \item 閉埋め込み$X\to[0,1]^\N$が存在する．
    \end{enumerate}
\end{corollary}

\begin{itembox}[l]{距離空間の研究}
    \begin{itemize}
        \item 距離空間は正規である（命題\ref{prop-metric-space-is-normal}）．
        距離空間は，稠密な可算部分集合を含めば，第２可算でもあるので，$\R^\N$に埋め込める．つまり距離付け可能である．
        \item コンパクト距離空間は，閉区間の可算積$[0,1]^\N$の閉部分空間と同相である．
    \end{itemize}
\end{itembox}

\section{陰関数定理と常微分方程式の解の存在定理}

\begin{screen}
    縮小写像の応用．
\end{screen}

\begin{notation}
    ベクトル$a\in\R^m$と行列$A\in M_m(\R)$のノルムを，それぞれ
    \begin{align*}
        |a|&:=\max(|a_1|,\cdots,|a_m|),&|A|&=\max_{1\le i,j\le m}|a_{ij}|,
    \end{align*}
    で定める．すると，$|Aa|\le m|A||a|$が成り立つ．

    開集合$U\subset\R^{n+m}$上の$C^1$級写像$f:U\to\R^m$に対して，
    行列値連続写像$f_y=\left(\frac{\partial f_i}{\partial y_j}\right):U\to M_m(\R)$が定義される：
    \[\xymatrix@R-2pc{
        U\ar[r]&M_m(\R)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (x_1,\cdots,x_n,y_1,\cdots,y_m)\ar@{|->}[r]&\left(\frac{\partial f_i}{\partial y_j}\right)_{1\le i,j\le m}
    }\]
\end{notation}

\begin{theorem}[陰関数定理]
    $n,m\ge 1$を自然数とし，$a\in\R^n,b\in\R^m$とし，$(a,b)\in U$とする．
    行列$A=f_y(a,b)=\left(\frac{\partial f_i}{\partial y_j}(a,b)\right)_{1\le i,j\le m}$が可逆であると仮定する．

    この時，実数$r>0$と連続関数$g:U_r(a)\to\R^m$であって，次の２条件を満たすものが存在する．
    \begin{enumerate}
        \item $b=g(a)$．
        \item $\forall x\in U_r(a),\;(x,g(x))\in U\land f(x,g(x))=f(a,b)$．
    \end{enumerate}
\end{theorem}

\begin{corollary}
    この$g$も$C^1$級であり，一意性も成り立つ．
\end{corollary}

\begin{theorem}[常微分方程式の解の存在定理]
    開集合$U\subset\R^{n+1}$上の連続関数$f:U\to\R^{n}$を考える．
    $a\in\R,b\in\R^n$とし，$(a,b)\in U$とする．$M>0$を実数とし，任意の$(t,x),(t,y)\in U$に対し，
    \[ |f(t,x)-f(t,y)|\le M|x-y| \]
    が成り立つとする．

    この時，実数$r>0$と微分可能な関数$v:(a-r,a+r)\to\R^n$であって，次の２条件を満たすものが存在する．
    \begin{enumerate}
        \item $v(a)=b$．
        \item $\forall t\in(a-r,a+r),\;(t,v(t))\in U\land v'(t)=f(t,v(t))$．
    \end{enumerate}
\end{theorem}

\chapter{位相空間続論}

\begin{quotation}
    位相の方法はもっと普遍的な効力を持つ．
    より多様な手法を整備して，関数空間の研究へと向かう．
\end{quotation}

\section{フィルター}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    \textbf{数列の収束はフィルターで議論するのが良い}，というのがBourbakiの発見(提出者はHenri Cartan)で位相空間論の頂点を飾った花であった．
    環のidealの概念の双対概念が束のフィルターである．
    束と位相との対応がStoneの仕事であったが，確かにフィルターの定義は完全に位相の「合併演算は無限に，共通部分演算は有限に」の通りの公理を持っている．
    フィルターの概念は収束という観点から見た場合にはネットの概念と実質的に同値である事が知られている\footnote{\url{https://ja.wikipedia.org/wiki/有向点族}}．
\end{tcolorbox}

\subsection{フィルターの定義と例}

\begin{definition}[filter]
    半順序集合$(L,\le)$の部分集合$F\subset L$が次の３条件を満たすとき，\textbf{フィルター}という．
    \begin{enumerate}
        \item (upward-closed) $\forall_{A\in F}\;A\le B\Rightarrow B\in F$．
        \item (downward directed / filtering downward) $A,B\in F\Rightarrow \exists_{C\in F}\;[C\le A,C\le B]$．\footnote{したがって向きを変えれば，自然に有向集合とみなせる\ref{exp-directed-sets}．}
        \item (not empty) $\exists_{A\in L}\; A\in F$．
    \end{enumerate}
\end{definition}

\begin{definition}[majorant, lattice]
    $(L,\le)$を半順序集合という．
    \begin{enumerate}
        \item ある元$x\in L$が部分集合$L'\subset L$に対して$\forall_{y\in L'}\;y\le x$を満たすとき，\textbf{$L'$の上界}と「最大元」に区別していう．
        \item filtering downwardかつfiltering upward（任意の二元集合$\{x,y\}$に上界$x\lor y\in L$が存在する）である半順序集合$(L,\le)$を\textbf{束}という．
    \end{enumerate}
\end{definition}
\begin{remark}[束がフィルターになる条件]
    束$(L,\land,\lor,\top,\bot)$の部分集合$F\subset L$が次の３条件を満たすとき，フィルターという：
    \begin{enumerate}
        \item $\forall_{A,B\in F}\;A\land B\in F$．
        \item $\forall_{A\in F,B\in L}\;A\lor B\in F$．
        \item $\top\in F$．
    \end{enumerate}
    この表現は$\land$を積，$\lor$を和とすると，イデアルの双対概念に間違いない．
    $P(X)$は特に束だから，こちらの定義の方がよく使う．
\end{remark}

\begin{example}[開集合のフィルター, neighbourhood filter]\mbox{}\label{exp-filter-of-neighbourhood}
    \begin{enumerate}
        \item $(P(X),\subset)$は束であると同時に，フィルターである（そして完備Boole代数である）．
        \item 位相空間$X$の開集合，コンパクト集合もフィルターをなす．例えば開集合については，上界としての$A\lor B$を，開集合$A$と一般の部分集合$B$に対して$A\cup B^\circ$と定めれば良い．
        \item 点$x\in X$の近傍全体の集合はフィルターになる．これを$\O(x)$と表す．この場合については，まさに$\forall_{U\in\Op_x(X),S\in P(X)}\;U\cup S\in\Op_x(X)$である．このフィルターより細かい真のフィルターを「$x$に収束する」と定義することがある．
    \end{enumerate}
\end{example}

\begin{example}
    $\Z\times\Z$や$\R\times\R$は積順序について束となり，辞書式順序について線型順序となる．
\end{example}

\begin{history}
    コングレ@Chevalleyの両親の屋敷でHenri Cartanがfilterを考えだす．

    1936年9月のコングレ@Chevalleyの両親の屋敷で，
    数学原論の「位相」の草稿作成時にHenri Cartanがfilterの概念を考えだす．
    その草稿でヴェイユは点列の収束を議論する上で空間に第二可算公理の成立を要求していたが，この制限を除くためにアンリ・カルタンが会合中に見つけた解決の糸口がフィルターである．
    休憩の間に思いついてみんなに話すと，Chevalleyは一般化の示唆すらして，ultrafilterが考え出された．
    一つの突破口が見つかるとブルバキではboum("bang"に当たるフランス語)と叫ぶ習慣があったが，filterの概念は特にboumologieと呼ばれた．
    数週間後に２つの論文を出すが，その時にfilterの名前がついた．
    \footnote{\url{https://ja.wikipedia.org/wiki/フィルター_(数学)}} 
\end{history}

\subsection{フィルターの性質}

\begin{definition}[filterbase, subbase]\label{def-filterbase-filtersubbase}
    束$L$の部分集合$F$について，
    \begin{enumerate}
        \item $F$が\textbf{フィルター基}とは，公理1の演算「supersetを取る」についてフィルターを生成することをいう．または同値な条件として，$\emptyset\notin F$を見たし，有限共通部分演算について閉じている空でない部分集合$F\subset L$をいう．
        \item $F$が\textbf{フィルター準基}とは，公理2の演算「有限共通部分」についてフィルター基を生成することをいう．
    \end{enumerate}
    単調写像$f:X\to Y$と$X$上のフィルター$F\subset P(X)$について，$f(F)$は$Y$のフィルター基となる．このフィルター基を包むような開集合系を$Y$が備えているかどうかで，$f$が連続かどうかが決まる．
\end{definition}

\begin{definition}[proper, prime, ultrafilter / maximal filter]
    $F\subset P(X)$を$X$の部分集合のフィルターとする．
    \begin{enumerate}
        \item $F\ne L$の時，即ち$\emptyset\notin F$の時，$F$を\textbf{真のフィルター}という．位相や解析の議論では単にフィルターというと真のフィルターを指す．netとの対応を取るからである．
        \item $L\setminus F$がイデアルである時，$F$を\textbf{素フィルター}という．この条件は$L\setminus F$が素イデアルであることに同値．
        素フィルターは真のフィルターである．
        真のフィルターが素であることの特徴付けには，環論的なもの$A\cup B\in F\Rightarrow A\in F\lor B\in F$や，$F:L\to\TV$が束準同型になることなどがある．
        \item 真のフィルターのうち極大なものを\textbf{超フィルター}という．
    \end{enumerate}
\end{definition}
\begin{remark}
    ブール代数の超フィルターを取る関手$\Ult:\Bool^\op\to\Set$は，超準解析やモデル理論で重要になる．
\end{remark}

\begin{definition}[principal ultrafilter / fixed ultrafilter, fixed, free]\mbox{}
    \begin{enumerate}
        \item $x\in S$について，$x$を含む$S$の部分集合全体からなるフィルターを，\textbf{単項ウルトラフィルター}という．
        \item 部分集合のフィルター$F$がfixedであるとは，$\cap F\ne\emptyset$であることをいう．
        \item フィルター$F$の結びが存在して，$\bot$であるとき，$F$は\textbf{自由}であるという．
    \end{enumerate}
\end{definition}

\subsection{ブール代数上のフィルターの研究}

\begin{screen}
    集合上のフィルターの代わりに，ブール代数上のフィルターを調べれば，実はパラレルな結果が成り立つ．
\end{screen}

\begin{lemma}[ブール代数上の超フィルターの特徴付け]
    $F\subset B$をブール代数$B$上の真のフィルターとする．次の４条件は同値．
    \begin{enumerate}
        \item $F$は超フィルターである．
        \item $\forall b\in B,\;b\in F\lor\lnot b\in F$．
        \item $x\notin F\Rightarrow \exists y\in F(x\land y=0)$．
        \item $F$は素フィルターである．即ち，$x\lor y\in F\Rightarrow x\in F\lor y\in F$．
    \end{enumerate}
\end{lemma}
\begin{remark}
    すごいわかってきた．ブール代数上の超フィルターは$B$をちょうど２分割するようで，ひっくり返すと同じ形になっている素フィルターになっている．
    こんな綺麗に割り切れているのに「素」とは面白いな．
\end{remark}

\begin{notation}
    ブール代数$B$上の超フィルター全体からなる集合を$UB$と表す．\footnote{フィルター全体からなる集合$\mathcal{F}X$と同様である．$U$も$\mathcal{F}$も関手だからであろうか？}
\end{notation}

\begin{proposition}[ブール代数上のフィルターはTVによって表現される]
    ブール代数$B$上の超フィルターは，束準同型$f:B\to\TV$と一対一対応する：
    \[\Hom_\Bool(B,2)\simeq UB\]
\end{proposition}
\begin{remark}
    TVの$\top,\bot$の役割を入れ替えると素フィルター故の双対フィルターを得る．
    つまり，全ての極大イデアルは，ブール代数の射$\varphi:B\to 2$について，$\varphi^{-1}(1)$と表現される．
    これを用いると，任意のブール代数の射$\psi:B\to A$について，超フィルターの逆像は超フィルターとなる．
    これは後少しでframe morphismではないか？
\end{remark}

\begin{definition}[principle filter / principle ultrafilter, fixed, free]
    $S$を空でない集合とする．
    \begin{enumerate}
        \item 部分集合$T\subset S$について，$T$を含む最小のイデアルを\textbf{$T$が生成する単項フィルター}という．
        \item $p\in S$について，$\{p\}$が生成する単項イデアルを$p$が生成する単行為であるといい，$\uparrow p:=\{T\in P(S)\mid p\in T\}$と書く．
        \item フィルター$F$が有限共通部分について$\emptyset$を得ない時(inhabited)，\textbf{固定されている}という．一方で，$\cap_{T\in F}T=\emptyset$である時，\textbf{自由}であるという．
    \end{enumerate}
\end{definition}

\begin{proposition}\label{prop-ultrafilters-on-sets}
    $S$を空でない集合とする．\footnote{\url{https://ja.wikipedia.org/wiki/フィルター_(数学)}}
    \begin{enumerate}
        \item 単項フィルターは超フィルターである．
        \item $S$が有限集合の時，超フィルターは全て単項フィルターの形で表せる．
        \item $S$が無限集合の時，単項フィルターの形で表せない超フィルターが，Zornの補題により構成出来る．
    \end{enumerate}
\end{proposition}

\section{ネットとフィルターの極限}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $\Lambda=\N$の場合で，第１可算な位相空間の議論（特に距離空間の議論）は全て議論できるが，一般の位相空間では点列コンパクトであることは，コンパクト性よりも緩く，コンパクト性の特徴付けとするにはもっと強い条件を用意しなければならない．
    うまく点列の概念を拡張することで，「任意のネットが収束するサブネットを持つ」ことがコンパクト性の特徴付けとなるように定義する．
    このように，コンパクト性の議論は，部分ネットの議論に精緻化される．
\end{tcolorbox}

\subsection{定義と例}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    \begin{itemize}
        \item  列とは$\N$からの写像であるが，
        netとは一般の有向集合からの写像である．
        \item 「向き」「近さ」の代数的構造を考えよう．２点は「近さ」が同じで（反射的），そして推移的であるはずである．また，収束の議論がしたいので，せめて任意の有限集合に対して，「それらのどれよりも近い点」が取れると都合が良い．\footnote{コンパクト性という有限性と関係ある？}
        \item 「方向」は代数的には結び半束の一般化である．上界が存在するからといって上限が存在するとは限らないので，結び半束より一般的である．
        \item 有向集合は「向き」を備えた集合で，これは順序の概念とは直接は関係がないと考えた方が良い．
        空間的な「近さ」を捉えるには，半対称性は要らないから，前順序の概念が適任であり，自然に圏とみなせる．
        したがってネットは自然に関手とみなせる．
        なぜこれを「向き」と呼ぶかは，圏論の直極限の概念による．
        \item netの概念は1922年にEliakim Hastings MooreとH. L. Smithによって導入された．
        \item Everything below can be done for nets as well as for (proper) filters, but filters often lead to a cleaner theory.
    \end{itemize}
\end{tcolorbox}

\begin{definition}[direction, directed set / filtered set, net / generalized sequences, eventuality filter]\mbox{}
    \begin{enumerate}
        \item 空でない集合$D$上の，任意の２元について上界を持つ(upward-filtering / upward-directed)ような前順序$\le$を\textbf{方向}といい，組$(D,\le)$を\textbf{有向集合}または\textbf{フィルター付き集合}という．
        \item 有向集合$D$からの写像$i:D\to X$を\textbf{$X$上のネット}という．ネットも$(x_n)_{n\in D}$と表し，$x_n=i(n)$とする．
    \end{enumerate}
\end{definition}
\begin{remarks}
    任意の全順序集合は有向集合だが，有向集合でない半順序集合は構成出来る．これは全順序の一般化で，ここからの写像で点列を一般化でき，解析学の極限が統一的に記述される．この発想は直極限の概念に集約される．\footnote{Awodeyでは，代わりに順序数をposet categoryと見做して使用していた．近傍系は有向集合になる．}
    有向集合は半順序の方がわかりやすい（任意の部分集合が上界を持つ順序：この場合を\textbf{directed poset}と呼び分ける）が，$i:D\to X$が単射である必要がないため，$D$の反対称性の公理は余剰である．
\end{remarks}
\begin{example}[有向集合の例]\mbox{}\label{exp-directed-sets}
    \begin{enumerate}
        \item 全順序集合は有向集合である．任意の２元は必ず比較可能であるから，大きい方が上界となる．一方で，半順序集合は必ずしも有向ではない．
        \item ２つの有向集合$A_\ge,B_\ge$について，積集合$A\times B$上に積関係を入れると，再び有向集合となる．
        \item 任意の$x_0\in\R$について，$\R\setminus\{x_0\}$上の関係$a\le b:\Leftrightarrow\abs{a-x_0}\ge\abs{b-x_0}$は前順序であるが半順序ではない（$x_0$からの距離が等しい点は２つある）が，有向集合であり，$x_0$に近いほど大きい．これを「$x_0$へ向かう向きを持つ」という．
        \item 上記の関係$\le$を，$\R_+\times\R_+\cup\R_-\times\R_-$上に制限すると，半順序を得るが，方向を失う．任意の$x_1\ne x_0$について，$\{\pm x_1\}$は上界を持たない（そもそも同時に比較可能となる１点が取れない）．
        \item 一般にフィルター$(F,\subset)$に対して，$U\le V:\Leftrightarrow V\subset U$と定義することで有向集合とみなせる．$\subset$は$F$に半順序を定めており，またフィルターはupward-directedとしたので，方向を逆にすれば，任意の上界が存在する．
        特に，$x\in X$近傍のなるフィルター$\O(x)$は，$U\le V:\Leftrightarrow V\subset U$と定義することで有向集合とみなせる．
    \end{enumerate}
\end{example}
\begin{example}[ネットの例]
    $D=\N$の時，これは列である．
\end{example}

\subsection{部分ネット}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    部分ネットは，終局フィルターで考えると一意に定まるが，明示的に定義すると２通りの定義があり，これでwell-definednessは深いところで約束されている．
\end{tcolorbox}

\begin{definition}[Willard 1970]\label{def-subnet-Willard}
    $(y_\beta)_{\beta\in B}$が$(x_\al)_{\al\in A}$の部分ネットであるとは，次の３条件を満たす写像$f:B\to A$が存在することをいう：
    \begin{enumerate}
        \item $\forall_{\beta\in B}\;x_{f(\beta)}=y_\beta$．
        \item 単調：$\forall_{\beta_1\ge\beta_2\in B}\;f(\beta_1)\ge f(\beta_2)$．
        \item cofinal：$\forall_{\alpha\in A}\;\exists_{\beta\in B}\;f(\beta)\ge\al$．
    \end{enumerate}
\end{definition}

\begin{definition}[Kelley 1955]\label{def-subnet-Kelley}
    $(y_\beta)_{\beta\in B}$が$(x_\al)_{\al\in A}$の部分ネットであるとは，次の２条件を満たす写像$f:B\to A$が存在することをいう：
    \begin{enumerate}
        \item $\forall_{\beta\in B}\;x_{f(\beta)}=y_\beta$．
        \item strongly cofinal：$\forall_{\alpha\in A}\;\exists_{\beta\in B}\;\forall_{\beta_1\ge\beta}\;f(\beta_1)\ge\alpha$．
    \end{enumerate}
\end{definition}

\begin{remark}
    Willard \ref{def-subnet-Willard}もKelley \ref{def-subnet-Kelley}も，（ネット$n:D\to X$同様）$f$に単射性を要求していない点に注意．したがって，$A=\N$としても，通常の部分列の定義よりは一般的である．
\end{remark}

\begin{definition}[Smiley, 1957; \AA rnes and Andenes, 1972]\label{def-subnet-Smiley}
    $(y_\beta)_{\beta\in B}$が$(x_\al)_{\al\in A}$の部分ネットであるとは，
    $y$の定める終局フィルターが，$x$の定める終局フィルターよりも細かいことをいう：$\forall_{\al\in A}\;\exists_{\beta\in B}\;\forall_{\beta_1\ge\beta}\;\exists_{\al_1\ge\al}\; y_{\beta_1}=x_{\al_1}$．
\end{definition}

\begin{theorem}[Schechter, 1996]\mbox{}
    \begin{enumerate}
        \item $y$が$x$のWillard \ref{def-subnet-Willard}の意味での部分ネットであるとき，同一の$f$を用いてKelley \ref{def-subnet-Kelley}の意味でも部分ネットである．
        \item $y$が$x$のKelley \ref{def-subnet-Kelley}の意味での部分ネットであるとき，Smiley \ref{def-subnet-Smiley}の意味でも部分ネットである．
        \item $y$が$x$のSmiley \ref{def-subnet-Smiley}の意味での部分ネットであるとき，$z$であって，$z$と$y$が互いにSmiley \ref{def-subnet-Smiley}の意味で部分ネットで（すなわち，同じ終局フィルターを定め），Willard \ref{def-subnet-Willard}の意味での$x$の部分ネットであるようなものが存在する．
    \end{enumerate}
\end{theorem}

\begin{definition}[equivalence of nets]
    ２つのネットが同じ終局フィルターを定めるとき，\textbf{同値}であるという．
\end{definition}

\subsection{終局フィルター}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=ネットの定めるフィルター]
    位相空間$X$上の真のフィルターとネットとは，収束先については１対１対応する．
    フィルターの言葉で言えば，「超フィルターの極限が存在する空間」としてコンパクト集合が特徴付けられる．
    A proper filter is equivalently the eventuality filter of a net.\footnote{\url{https://ncatlab.org/nlab/show/filter}}

    位相空間論の諸結果は次のように全てフィルターを用いた議論に言い換えられる．\footnote{\url{https://ja.wikipedia.org/wiki/フィルター_(数学)}}
    \begin{enumerate}
        \item $X$上の任意のフィルターの極限が高々一つ（つまり、多くても一つの点にしか収束していない）のとき、およびそのときに限って$ X $はハウスドルフ空間になる。
        \item 位相空間のあいだの写像$ f $が点$ x $で連続になるのは、$F \to x $ならば$ f(F) \to f(x) $となっているとき、およびそのときに限る。
        \item $X $がコンパクトになるのは任意の超フィルターが収束しているとき、およびそのときに限る。（命題\ref{prop-characterization-compact-space-in-terms-of-filters}）
    \end{enumerate}
\end{tcolorbox}

\begin{definition}[eventuality filter / cofinitely often]\mbox{}
    \begin{enumerate}
        \item $\nu:D\to X$を集合$X$上のネットとする．\textbf{ネット$\nu$が定めるフィルター}$F_\nu$とは，
        \[F_\nu:=\Brace{A\in P(X)\mid \exists_{i\in D}\;\forall_{j\ge i}\;\nu_j\in A}\]
        のことである．\footnote{この条件を「$\nu$は結局(eventually) $A$に収まる」と表現する．$D=\N$のとき，$\fe$の条件と同値．}
    \end{enumerate}
\end{definition}

\begin{lemma}\mbox{}
    \begin{enumerate}
        \item $F_\nu$は真のフィルターである．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $\emptyset\in F_n$より．
    \end{enumerate}
\end{proof}

\begin{definition}[convergence of net, limit point, cluster / accumulation point, Cauchy]
    $S$を位相空間，$F$を$S$上のフィルターとする．
    \begin{enumerate}
        \item ネット$n:D\to X$が$x\in X$に\textbf{収束}するとは，任意の$x$の開近傍（従って近傍）$A\in\O(x)$に，$n$が終局する$A\in F_n$ことをいう．このとき，$x$を極限点という．$X$がHausdorffのとき，一意に定まる．
        \item ネット$n:D\to X$が$x\in X$に\textbf{集積}するとは，任意の$x$の開近傍（従って近傍）$A\in\O(x)$に，$n$が無限回入ることをいう：$\forall_{i\in D}\;\exists_{j\ge i}\;n_j\in A$．このとき，$x$を集積点という．実は，任意の集積点は必ず部分ネットの極限点になる．
        \footnote{これは英語でclusterと\url{https://ncatlab.org/nlab/show/filter}に乗っているが，filterについてはclusterとaccumulateは同じ定義になるのだろうか？}
        \item $S$を距離空間とする．ネット$n:D\to X$が\textbf{コーシー}であるとは，フィルター$F_n$が任意の正実数$r>0$に対して，$\diam(A)<r$を満たす集合$A$が$F$に存在することをいう．数列がCauchy列であるとは，数列が定めるeventuality filterがCauchyであることをいう．
    \end{enumerate}
\end{definition}

\begin{example}
    自明なフィルター(the improper filter)$P(X)$は全ての一点集合を含むので，全ての点に収束し，どの点にも密集しない．
\end{example}

\subsection{フィルターの定めるネット}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    全ての真のフィルターは，あるネットの終局フィルターである．
    したがって，ネットの収束先の同値類が真のフィルターだと思える．
\end{tcolorbox}

\begin{definition}
    フィルター$F\subset P(X)$について，これが定めるネット$n:D\to X$とは，次の通り：
    \begin{enumerate}
        \item 集合$D\subset X\times F$を二項関係$\in$とし，その上の前順序$\le$を$(y,A)\le(z,B):\Leftrightarrow B\subset A$と定める．
        \item 写像$n:D\to X$を$n:=\pr_1$とする．
    \end{enumerate}
\end{definition}

\begin{lemma}\mbox{}
    \begin{enumerate}
        \item $F$は真のフィルターであることと，$D$が有向集合であることは同値．
        \item 真のフィルター$F$が定めるネット$n:D\to X$の定める終局フィルター$F_n$は等しい：$F_n=F$．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $F$が一般の場合でも，$\le$の定め方より，対称かつ反射的であるから，前順序である．任意の２元$(y,A),(z,B)$について，
        $A\cap B\ne\emptyset$ならば，$x\in A\cap B$を用いて，$(x,A\cap B)$はこの２元の上界である．$F$が真のフィルターであるときに限り，この前提$A\cap B\ne\emptyset$が満たされる．
        \item \begin{description}
            \item[$F_n\subset F$] 任意に$A\in F_n$を取ると，$(y,B)\in D$が存在して，任意の$(y,B)\le (z,C)$について$n(z,C)\in A$だから，特に$C=B$の場合を考えると，$B\subset A$．$B\in F$より，$A\in F$．
            \item[$F\subset F_n$] 任意の$A\in F$について，$i:=(x,A)\in D\;(x\in A)$と定めれば，任意の$(x,A)\le (y,B)$について，$n(y,B)=y\in B\subset A$だから$y\in A$．よって，$A\in F_n$．
        \end{description}
    \end{enumerate}
\end{proof}
\begin{remark}
    命題\ref{prop-ultrafilters-on-sets}の一般化である．
    真のフィルターはZornの補題の下では全てが単項生成ではないが，
    netの言葉を使えば，全てそれが定めるものになる．
\end{remark}

\section{ネットによる位相空間論}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    適切な$X$-値点の手法で，人間が開発した位相的概念は特徴付けられる．
\end{tcolorbox}

\subsection{位相の定義}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    純方向が簡単で，
    逆は対偶を示す＝狙い通りのネットが近傍のなすフィルター（の定める有向集合）から構成できる．
\end{tcolorbox}

\begin{proposition}[閉集合の特徴付け (AC)]\label{prop-characterization-of-open-sets-in-terms-of-net}
    $(X,\tau)$を位相空間とする．部分集合$F\subset X$について，次の２条件は同値．
    \begin{enumerate}
        \item $F$は閉である．
        \item 任意のネット$\nu:A\to F\mono X$が$F$外($S:=X\setminus F\in\tau$)に収束点を持たない．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] $F\subset X$を閉集合とし，$\nu:A\to F$を任意のネットとする．任意の点$x\in S:=X\setminus F$について，これが$\nu$の極限点でないこと$x\notin F_\nu$を示せば良いが，いま$S$は$x$の開近傍である$S\in\O(x)$にも拘らず，$\Im\nu\cap S=\emptyset$であった．よって当然$\forall_{t\in A}\;\exists_{s\ge t}\;\nu_s\notin S\Leftrightarrow S\notin F_\nu$．これは極限点の定義に沿わない．
        \item[(2)$\Rightarrow$(1)] 対偶を示す．
        \begin{enumerate}[(a)]
            \item すなわち，$F$は閉でないとし，ネット$\nu:A\to F$であって，$S:=X\setminus F$に極限点$s\in S$を持つようなものを構成すれば良い．
            \item $S$は開でないから，ある点$s\in S$が存在して，その任意の近傍が$F$と交わる（開集合の公理の特徴付け\ref{prop-characterization-of-open-sets}）．
            したがって，任意の近傍$U\in\O(s)$について，$x_U\in U\cap F$が取れる（選択公理）から，この選択関数としてネット$\nu:\O(s)\to F;U\mapsto x_U$を定めれば良い．
            \item このネット$\nu$が$s\in S$に収束すること$\O(s)\subset F_\nu$を示せば良い．任意の近傍$V\in\O(s)$には，開近傍$U\in\O(s)$が存在して$U\subset V$である．これについて，$U'\subset U\Rightarrow x_{U'}\in U'\subset U\subset V$より，$V\in F_\nu$．
        \end{enumerate}
    \end{description}
\end{proof}

\begin{proposition}[連続写像の特徴付け (excluded middle)]
    $(X,\tau_X),(Y,\tau_Y)$を位相空間とする．
    写像$f:X\to Y$について，次の２条件は同値．
    \begin{enumerate}
        \item $f:X\to Y$は連続である．
        \item $x\in X$に収束する任意のネット$\nu:A\to X$について，$f\circ\nu:A\to Y$は$f(x)\in Y$に収束する．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] $f:X\to Y$を連続とする．任意に$x\in X$に収束するネット$\nu:A\to X$を取る．任意の近傍$U\in\O(f(x))$について，$U\in F_{f\circ\nu}$を示せば良いが，$f^{-1}(U)$は$x$の開近傍だから，仮定より$f^{-1}(U)\in F_\nu$すなわち$\exists_{i\in A}\;\forall_{j\ge i}\;\nu_j\in f^{-1}(U)$．これは$U\in F_{f\circ\nu}$に同値．
        \item[(2)$\Rightarrow$(1)] 対偶を示す．
        \begin{enumerate}[(a)]
            \item $f:X\to Y$を連続でないとすると，$x\in X$に収束するが$f\circ\nu$は$f(x)\in Y$には収束しないネット$\nu:A\to X$を構成できることを示せば良い．
            \item 仮定より，$U\in\Op(Y)$かつ$f^{-1}(U)\notin\Op(X)$を満たすものが存在する．
            $f^{-1}(U)$は開集合でないから，
            命題\ref{prop-characterization-of-open-sets-in-terms-of-net}より，$X\setminus f^{-1}(U)$上のネットであって，ある$x\in f^{-1}(U)$に収束するもの$\nu:A\to X\setminus f^{-1}(U)$が存在する．このとき，$f\circ\nu:A\to Y$は$Y\setminus U$上のネットであるから，$U$上に収束先を持たない．したがって特に，$f(x)\in U$にも収束しない．
        \end{enumerate}
    \end{description}
\end{proof}

\subsection{分離公理の特徴付け}

\begin{proposition}[(AC, EM)]
    位相空間$(X,\tau)$について，次の２条件は同値．
    \begin{enumerate}
        \item $X$はHausdorffである．
        \item 任意のネットは，２個以上の極限点を持たない．
    \end{enumerate}
\end{proposition}

\subsection{コンパクト性の特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    「有向集合」と呼びたいような，「近さ」という一元的な指標がある対象をうまく定めた．
    ここからの写像が必ず収束する部分列を持つことがコンパクト性という有限性の特徴付けとなっている．\footnote{Inspection of these counter-examples reveals that the problem is that sequences indexed by the natural numbers may be “too short” in that they cannot go deep enough into uncountable territory, and they are “too slim” in that they proceed to their potential limiting point only from one direction, instead of from many at once. The use of general directed sets for nets in place of just the natural numbers for sequences fixes these two issues.\url{https://ncatlab.org/nlab/show/net}}
\end{tcolorbox}

\begin{proposition}[AC, EM]
    位相空間$(X,\tau)$について，次の２条件は同値．
    \begin{enumerate}
        \item $X$はコンパクトである．
        \item 任意のネットは収束する部分ネットを持つ．
    \end{enumerate}
\end{proposition}

\section{収束空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    By keeping only the simple conditions, one gets the definition of a convergence space; this is a more general concept than a topological space and includes many non-topological situations where we want to say that a sequence converges to some value (such as convergence in measure).\footnote{\url{https://ncatlab.org/nlab/show/net}}
    包含$\Top\mono\Conv$は充満忠実になる．

    The concept of completion of a metric space may be defined quite nicely in terms of the Cauchy filters, although not every property (not even every uniform property) of metric spaces can be defined in this way. As for convergence, there is a general notion of Cauchy space, but the forgetful functors from metric and uniform spaces are now not full.
    \footnote{\url{https://ncatlab.org/nlab/show/filter}}
\end{tcolorbox}

\subsection{定義と例}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    フィルターの収束をその代数的構造から公理化するが，その基本はフィルター（イデアルの双対）のままで，
    「上に単調＝より細かいフィルターは全て同じ点に収束する」ことと「下に方向を持つ＝２つの収束するフィルターには同じ点に収束する下限\footnote{ここだけ有向集合より条件が強い．}を持つ」とである．
\end{tcolorbox}

\begin{definition}[convergence space]
    $S$を集合とする．
    \begin{enumerate}
        \item 集合$\mathcal{F}S\subset P(P(S))$を，$S$上のフィルター全体からなる集合とする．
        \item $F\in\mathcal{F}S$について，$F\to x$とは，フィルター$F$が$x$に収束することをいう：$\O(x)\subset F$．
        \item 集合$S$と関係$\to\subset\mathcal{F}S\times S$の組$(S,\to)$であって，次の３公理を満たすものを，\textbf{収束空間}という．
        \begin{enumerate}[(1)]
            \item (Centred) $x$の定める単項超フィルター$F_x=\{A\in P(S)\mid x\in A\}$は$x$に収束する．
            \item (Isotone) $F\to x,F\subset G$ならば，$G\to x$．
            \item (Directed) $F\to x$かつ$G\to x$ならば，フィルター$H\subset  F\cap G$が存在して$H\to x$．(2)の下では，$F\cap G\to x$が必要かつ十分．
        \end{enumerate}
    \end{enumerate}
\end{definition}
\begin{remarks}
    したがって，単項フィルターは全て超フィルター＝極大になるが，「ここからどれくらい細かくしても収束するままか」を指定することによって，空間の構造が決まる，というアイデアが収束空間で，これが位相空間よりも一般的な概念になるという不思議がある．$\pr_1(\to)\subset P(S)$を考えると応に位相みたいであるが，今回は収束先の情報も必要なので$\to\subset\F S\times S$．
\end{remarks}

\begin{definition}[cluster, generated filter]
    $(S,\to)$を収束空間とする．
    \begin{enumerate}
        \item フィルター$F$が$x$に集積する$F\rightsquigarrow x$とは，$\exists_{(G,x)\in\to}\;F\subset G$が成り立つことをいう．
        \item 集合$T\subset S$に対して，$T$が生成するフィルターを$\brac{T}$で表す．
    \end{enumerate}
\end{definition}

\begin{example}
    測度空間$X$と可測空間$Y$の間の，殆ど至る所定義された可測関数のなす空間$\Meas\textrm{-}\ae(X,Y)$は，「殆ど至る所収束する」という関係$\xrightarrow{\ae}$について収束空間となる．
\end{example}

\subsection{収束空間の射}

\begin{definition}[continous function]
    $(S,\to),(T,\to)$を収束空間とする．
    \begin{enumerate}
        \item $f:S\to T$が連続であるとは，任意の$(F,x)\in\to$について，$(\brac(F),f(x))\in\to$であることをいう．
    \end{enumerate}
\end{definition}

\section{一様空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=全体のポイント]
    ブルバキの『位相』の成功はCartanのフィルターの概念もあるが，Weilの一様構造の概念も重要である．
    収束空間がネット／フィルターを用いた位相空間の一般化ならば，一様空間は一様収束の概念を用いた
    距離空間の一般化である．
    位相空間との違いは、位相空間が収束性、すなわち点に「近づく」事を定義可能な概念であるのに対し、一様空間ではある点が別の点に「近い」事が定義できる。しかしこの「近さ」は擬距離構造のように実数値で全順序づけされておらず、近縁と呼ばれる部分集合に属するかどうかで判断する半順序的なものである。\footnote{\url{https://ja.wikipedia.org/wiki/一様空間}}

    「古典解析学では（一様連続性を問題にするような時），２つの点が近いという概念がしばしば出てくる．
    それで，これに一般的にはっきりした意味を与えねばならない．このためには，位相構造よりもっと細かい構造，一様構造を定義することになる．」\cite{Bourbaki}
    （擬）距離空間や位相群はある種の一様構造を持つ．
\end{tcolorbox}

\subsection{定義と例}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    entourageによる定義はBourbaki流であり，いまだに一番一般的に見られる．FinSetsから開集合系の圏Opへの反変関手を記述しているとみなせる．
    一様空間の概念はAndré Weilが提案したもので，一様連続写像に自然に言及できる空間である．これは距離空間と位相群の概念の拡張とみなせる．\footnote{\url{https://ncatlab.org/nlab/show/uniform+space}}
\end{tcolorbox}

\begin{definition}[entourage / vicinities, uniform structure / uniformity, uniform space (Bourbaki)]
    $X$を集合とする．次の６公理を満たすような$X$上の\textbf{近縁}と呼ばれる二項関係$U\subset X\times X$のフィルター$\U\subset P(X\times X)$を\textbf{一様構造}と呼び，この組$(X,\U)$を\textbf{一様空間}という．
    \begin{enumerate}
        \item (reflexive) $\forall_{U\in\U}\;\Delta_X\subset U$．
        \item (transitive) $\forall_{U\in\U}\;\exists_{V\in\U}\;V\circ V\subset U$．即ち，$\forall_{U\in\U}\;\exists_{V\in\U}\;\forall_{x,y,z\in X}\;x\approx_V y\approx_V z\Rightarrow x\approx_U z$．
        \item (symmetric) $\forall_{U\in\U}\;\exists_{V\in\U}\;V^\op\subset U$．即ち，$\forall_{U\in\U}\;\exists_{V\in\U}\;\forall_{x,y\in X}\;y\approx_V x\Rightarrow x\approx_Uy$（6と合わせると，$V\subset U^\op\in\U$が必要）．
        \item (inhabited) $\U\ne\emptyset$．6と合わせると，$X\times X\in\U$が必要．
        \item (downward-directed) $\forall_{U,V\in\U}\;\exists_{W\in\U}\;W\subset U\cap V$．6の下では$W=U\cap V\in\U$が必要．
        \item (upward-closed) $\forall_{U\in\U}\;U\subset V\subset X\times X\rightarrow V\in\U$．
    \end{enumerate}
    関係$(x,x')\in U$を，\textbf{$x\in X$と$x'\in X$とは$U$の程度に近い}という．
    (1)から(5)を満たす関係の族を，近縁の基と呼ぶ．
\end{definition}
\begin{remarks}
    (4)から(6)は$\U$がフィルターになる条件である．
\end{remarks}

\begin{example}[加法構造]\mbox{}
    \begin{enumerate}
        \item $\R$上の族$V_\al:=\Brace{(x,y)\in\R\times\R\mid\abs{x-y}<\al}_{\al>0}$は一様構造となる．これを\textbf{加法一様構造}という．
        \item 集合$X$上の同値関係$R$は一様構造の近縁の基本系となる．$R$が自明であるとき$R=\Delta_X$，これは一様構造を定め，\textbf{離散一様構造}という．
    \end{enumerate}
\end{example}

\begin{definition}[被覆]\mbox{}
    \begin{enumerate}
        \item 位相空間$X$の被覆$C\subset P(X)$とは，$\cup C=X$を満たす$P(X)$の族をいう．
        \item $C_1$は$C_2$の細分である$C_1<C_2$とは，次が成り立つことをいう：$\forall_{A\in C_1}\;\exists_{B\in C_2}\;A\subset B$．
        \item $C_1,C_2$の結びとは，$C_1\land C_2:=\Brace{A\cap B\in P(X)\mid A\in C_1,B\in C_2}$のことを指す．これは再び被覆となる．
        \item $A\in P(X)$について，$C[A]:=\bigcup\Brace{B\in C\mid A\cap B\ne\emptyset}$と定める．
        \item $C^*:=\Brace{C[A]\subset P(X)\mid A\in C}$と定める．
        \item 近縁$U$について，$U[x]:=\Brace{y\in X\mid x\approx_U y}$と定める．
    \end{enumerate}
\end{definition}

\begin{definition}[Covering uniformities]
    位相空間$X$の一様被覆$\cC$とは，次を満たす被覆の族$\cC$のことをいう：
    \begin{enumerate}
        \item $\forall_{C\in\cC}\;\exists_{C'\in\cC}\;(C')^*<C$．
        \item (inhabited) $\U\ne\emptyset$．(4)の下では，$\{X\}\in\cC$．
        \item (downward-directed) $\forall_{C_1,C_2\in\cC}\;\exists_{C_3\in\cC}\;C_3<C_1\land C_2$．
        \item (upward-closed) $\forall_{C\in\cC}\;C<C'\Rightarrow C'\in\cC$．
    \end{enumerate}
\end{definition}
\begin{remarks}
    公理(2)から(4)が$\cC$がフィルターであるための条件である．
    (1)だけが本質的で，これを満たすものを準基，(4)以外を満たすものを基という．
\end{remarks}

\begin{lemma}[２つの定義の同値性]\mbox{}
    \begin{enumerate}
        \item 近縁系$\U$に対して，族$C\subset P(X)$が，ある近縁$U\in\U$について$\{U[x]\in P(X)\mid x\in X\}<C$を満たすとき$C\in\cC$とすると，$\cC$は一様構造を定める．
        \item 一様被覆系$\cC$に対して，$C\in\cC$を一様被覆として$\bigcup\Brace{A\times A\mid A\in C}$が生成する近縁系$\U$は一様構造を定める．
        \item (1),(2)の対応は全単射を定める．
    \end{enumerate}
\end{lemma}

\subsection{一様構造の定める位相}

\begin{definition}[uniform topology]
    近縁系$\U$について，$U[x]=\Brace{y\in X\mid x\approx_Uy}$を$x\in X$の近傍のフィルターとする位相はただ一つ存在し，これを\textbf{一様構造$\U$が定める位相}という．
\end{definition}

\begin{proposition}
    一様空間$(X,\U)$を一様位相によって位相空間とみなす．$X$は正規かつ完備正規(completely regular)である．
\end{proposition}

\subsection{一様空間の射}

\begin{definition}[uniformly continous function]
    $(X,\U_X),(Y,\U_Y)$を一様空間とする．
    \begin{enumerate}
        \item 関数$f:X\to Y$が一様連続であるとは，$\forall_{U\in\U_Y}\;(f\times f)^{-1}(V)\in\U_X$すなわち$(f\times f)^*\U_Y\subset\U_X$が成り立つことをいう．
        \item 一様空間と一様連続写像は具体圏をなし，これをUnifと書く．
    \end{enumerate}
\end{definition}

\begin{lemma}
    $(X,\U_X),(Y,\U_Y)$を一様空間とする．
    \begin{enumerate}
        \item 一様連続関数$f:X\to Y$は，対応する一様位相について連続である．
        \item 一様位相について連続だが，一様連続ではない関数$f:X\to Y$が存在する．
    \end{enumerate}
\end{lemma}

\section{分離公理}

\section{パラコンパクト}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    距離付け可能な空間はパラコンパクトである．
\end{tcolorbox}

\section{前層}

\begin{screen}
    \ref{subsec-Top}節の通り，
    $\Op\simeq\Hom_\Top(-,\S)\in[\Top^\op,\Set]$は前層である．
    $\Top$の部分圏$\Op(X)$（対象は$X$の開集合，射であるその間の包含写像は相対位相について連続である）上への制限$\mathcal{F}:\Op(X)^\op\to\Set$として空間$X$上の前層を定義する．
    前層とは圏の上に定まるもので，$X$上の前層といった時は，$X$上のフィルターという時のように，圏$\Op(X)$に暗に言及している．

    この，初源的な対象の圏$C$から，より精巧な対象（関手と呼ばれる）の圏$[C^\op,\Set]$を取り出す前層の手法$y:C\hookrightarrow\PSh(C)$の例として，双対写像$\Hom(-,W)$や位相という概念$\Hom(-,2)$が理解できるのではないか？要は，Free cocompletionの例である．\footnote{\url{https://ncatlab.org/nlab/show/free+cocompletion}}
    「\textbf{対象から関手へ}」がモットーであり，前層とは反変関手に対してこのものの見方をする時の特別な別名にすぎない．\footnote{\url{https://ncatlab.org/nlab/show/concept+with+an+attitude}}
    $F(X)$は$X$の$F$の内部への現前をいう，\textbf{切断}という名前で運用されている．$f:X\to Y$に対する$F(f):F(Y)\to F(X)$は，$Y$の各現前$y$をsuboccurance $x$に写す対応として理解できる．\footnote{\url{https://ncatlab.org/nlab/show/presheaf}}
    この枠組みのために，前層は反変を主に採用するのである．
    これはイメージの人類学の手法と似ている．
\end{screen}

\begin{definition}[presheaf, section, restriction mapping]
    $X$を位相空間，$X$の開部分空間のなす圏を$\Op(X)$とする．
    \begin{enumerate}
        \item 圏$C$について，\textbf{$X$上の$C$値の前層}とは，反変関手$\Op(X)^\op\to C$を言う．
        \begin{enumerate}[(1)]
            \item 前層の射を関手の射として，$C$-値前層の圏$[\Op(X)^\op,C]$が定まる．
            \item 集合の前層を単に前層と呼ぶ．他に$C$は環の圏であることが多く，これを環の前層という．$X$上の前層の圏を$(\PSh(X)=)\PSh(\Op(X)):=[\Op(X)^\op,\Set]$または$\Op(X)^\wedge$とも表す．前層の圏は実はトポスである．
        \end{enumerate}
        \item $\mathcal{F}:\Op(X)^\op\to\Set$を$X$上の前層とする．$U\in\Op(X)$の時，$\mathcal{F}(U)$の元を\textbf{前層$\mathcal{F}$の$U$上の切断}と呼ぶ．切断の集合は$\mathcal{F}(U)=\Gamma(U,\mathcal{F})$とも書く．$U=X$の時を\textbf{大域切断}，そうでない時を\textbf{局所切断}と呼び分ける．
        \item $\Op(X)\ni V\subset U$も開集合である時，写像$\mathcal{F}(i)=i^*:\mathcal{F}(U)\to\mathcal{F}(V)$を\textbf{制限写像}と呼び，$s\in\mathcal{F}(U)$の制限写像による像を$s|_V\in\mathcal{F}(V)$で表す．
        \item $\mathcal{F}$の部分関手$\mathcal{G}$を\textbf{部分前層}という．これを$\mathcal{G}\subset\mathcal{F}$で表す．
        \begin{enumerate}[(1)]
            \item $\mathcal{G}$が$\mathcal{F}$の部分前層であるとは，\textbf{包含射}と呼ばれる関手の射$\varphi:\mathcal{G}\to\mathcal{F}$が存在し，任意の成分$\varphi(U):\mathcal{G}(U)\to\mathcal{F}(U)$がSet上の包含写像であることをいう．
            \item この時，$i:V\to U\in\Op(X)$に対して，制限写像$i^*:\mathcal{F}(U)\to \mathcal{F}(V)$が写像$\mathcal{G}(U)\to\mathcal{G}(V)$を引き起こす：\[\xymatrix{
                \mathcal{G}(U)\ar@{.>}[d]\ar@{^{(}->}[r]^-{\varphi(U)}&\mathcal{F}(U)\ar[d]^-{i^*}\\
                \mathcal{G}(V)\ar@{^{(}->}[r]^-{\varphi(V)}&\mathcal{F}(V)
            }\]
        \end{enumerate}
        \item $U\in\Op(X)$とし，$\Op(U)$を$\Op(X)$の充満部分圏とする．$X$上の前層$\mathcal{F}$に対し，包含関手$i:\Op(U)\hookrightarrow \Op(X)$と$\mathcal{F}$との合成を$U$上の前層$\mathcal{F}|_U$と表し，これを$U$への\textbf{制限}と呼ぶ．
        \item 前層の積を普遍性$\mathcal{F}\times\mathcal{G}(U)=\mathcal{F}(U)\times\mathcal{G}(U)$で定める．
    \end{enumerate}
\end{definition}

\begin{example}[別の位相空間への連続写像全体の空間は（前）層をなす：前層の語はこの例に由来する]
    これは反変Hom関手としての，（「通常の意味」での）前層の例である．その射は共変Hom関手となる．
    その$\Top$の部分圏$\Op(X)$への制限が，空間$X$上の前層として引き起こされる．
    \begin{description}
        \item[前層$\mathcal{F}$] \mbox{}\\
    位相空間$Y\in\Top$が定める前層$h_Y:\Top^\op\to\Set$を次のように定める（ただし，$f^*$は反変Hom関手$\Hom(-,Y):\Map(Z,Y)\to\Map(X,Y)$が引き起こす写像とした）．
    \[\xymatrix@R-2pc{
        h_Y:\Top^\op\ar[r]&\Set\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        X\ar@{|->}[r]&C(X,Y)\\
        f:X\to Z\ar@{|->}[r]&f^*:C(Z,Y)\to C(X,Y)
    }\]
    これが単射$\Op(X)^\op\hookrightarrow\Top^\op$に沿って引き起こす関手が，$X$上の前層$\mathcal{F}=C(-,Y)$となる．
    \[\xymatrix{
        \Op(X)^\op\ar@{^{(}->}[r]_-{\mathcal{F}}\ar@{.>}[dr]&\Top^\op\ar[d]^-{h_Y}\\
        &\Set
    }\]
        \item[前層の射$g_*$] \mbox{}\\
    $Z$も位相空間とし，同様にして$X$上の前層$\mathcal{G}=C(-,Z)$を定める．すると，連続写像$g:Y\to Z$に対して，関手の射$g_*:\mathcal{F}\to\mathcal{G}$が，$U\in\Op(X)^\op$に対しての各成分が共変Hom関手$\Hom(U,-)$によって引き起こされる写像$g_*(U)$：
    \[\xymatrix@R-2pc{
        g_*(U):\mathcal{F}(U)=C(U,Y)\ar[r]&C(U,Z)=\mathcal{G}(U)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        f:U\to Y\ar@{|->}[r]&g\circ f:U\to Z
    }\]
    先述の通り，前層の射$g_*:\mathcal{F}\to\mathcal{G}$は，もっと圏Top全体で$g_*:h_Y\to h_Z$として定まっている．
    \end{description}
\end{example}

\begin{example}[$X$上の実数値連続写像の（前）層：制限写像の語はこの例に由来する]\mbox{}\\
    前例の特に$Y=\R$の場合は，$h_Y=h_\R=:C_X$と書く．$C_X(-)=C(-,\R):\Op(X)^\op\to\Set$は$X$上の（前）層である．
    各$U\in\Op(X)$について，この層$C_X$の値$C_X(U)\subset\R$上には，$\R$上の和と積$+,\times:\R\times\R\to\R$が入るから，
    $C_X(U)$は特に環である．$i:V\to U\in\Op(X)$を射とすると，制限写像$i^*:C_X(U)\to C_X(V)$は環の射であるから，$C_X:\Op(X)^\op\to\CRing$は特に$X$上の\textbf{環の前層}である．
\end{example}

\begin{example}[定数（前）層：切断の語はこの例に由来する]\mbox{}\\
    
\end{example}

\section{層}\label{sec-sheaf}


\begin{thebibliography}{99}
    \bibitem{斎藤毅}
        斎藤毅『集合と位相』（東京大学出版会．2016）
    \bibitem{松坂和夫}
        松坂和夫『集合・位相入門』（岩波書店．2015）
    \bibitem{新井敏康}
        新井敏康『数学基礎論』（岩波オンデマンドブックス）
    \bibitem{Johnstone}
        Peter Johnstone - The point of pointless topology (83)
    \bibitem{Johnstone2}
        Peter Johnstone, Stone Spaces, Cambridge Studies in Advanced Mathematics 3, Cambridge University Press 1982. xxi+370 pp. MR85f:54002, reprinted 1986.
    \bibitem{nLab}
        \url{https://ncatlab.org/nlab/show/Introduction+to+Topology}
    \bibitem{Vickers}
        Steven Vickers, Topology via Logic, Cambridge University Press (1989)
    \bibitem{Hausdorff}
    F. Hausdorff, Grundzüge der Mengenlehre, Veit \& Co., Leipzig, 1914.
    \bibitem{Bourbaki}
    Nicolas Bourbaki 位相I
    \bibitem{Analysis Now}
    Analysis Now
\end{thebibliography}
\end{document}