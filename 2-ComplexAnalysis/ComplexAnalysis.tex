\documentclass[uplatex, dvipdfmx]{jsreport}
\title{複素解析学（担当：平地健吾先生）}
\author{司馬博文}
\date{\today}
\pagestyle{headings} \setcounter{secnumdepth}{4}
%\input{/home/hirofumi/StatisticalNature/preamble_no_fonts.tex}
\input{/Users/hirofumi.shiba48/StatisticalNature/preamble_no_fonts.tex}
\usepackage[math]{anttor}
\newcommand{\frakP}{\mathfrak{P}}
\renewcommand{\G}{\mathbf{G}}
\newcommand{\Cr}{\C\setminus[\Delta(0,1/r)]}
\newcommand{\Pone}{\P^1(\C)}
\setcounter{chapter}{-1}
\begin{document}
\tableofcontents

\part{複素解析学Ⅰ}

\chapter{Introduction}

\begin{quotation}
    「二次方程式を一般的に解く為には所謂虚数が必要であることが早く認められたのである。実数と虚数とを総括して、ガウス以来それを複素数と称する。
    数の範囲を複素数まで拡張することは、方程式論のみでなく、現今の数学の各部門に於て緊要であって、実数のみに関する問題に於ても、それを複素数の立場から考察するとき、明瞭に解決される場合が多い。
    これは次元の拡張であって、恰も上空から瞰下するとき、地上の光景が明快に観取せられるようなものである。」
        高木貞治「代数学講義」
    \begin{itemize}
        \item 複素数の言葉を得ることによって，あまりに大き過ぎて捕らえられなかった模様が見えてくる．
        \item 数の体系を位相的に拡張することで，その射＝正則関数はさらに振る舞いがよくなる．こうして得る圏は層をなすので，見通しが良くなる．これが複素解析の実態だろう．
        \item やはり層の理論を産んだだけあって，データ構造として，祈りが極めて高い．複素数はその$2$次元ベクトル量としての構造を共軛変換（$\id$を除いて唯一の$\R$を保存する$\C$自己同型）によって外在化したように，Yacobianとしての構造も導関数の間に外在化させた（Cauchy-Riemann作用素）．この２つの道具を元に戻せば$\R^2$としてのデータ構造に戻るが，非常に野暮ったい．
        \item Cauchy-Riemann方程式より，正則関数はなぜか閉形式$f\;dz$を定めるので，特異点の検出に向く．
    \end{itemize}
\end{quotation}

\begin{description}
    \item[複素解析学とは]\mbox{}\\
        複素数上の関数についての解析学．古くは関数と言えば複素関数を指したため，歴史的には「関数論」ともいう．また，「等角写像論」という切り口で教授されることも多い．
    \item[解析を代数的に出来るのが素晴らしい]\mbox{}\\
        留数計算やGoursatの定理，あるいはそもそも複素数体が代数的閉体であることなどの結果を用いることで，
        部分積分などの煩雑な微積分テクニックが，
        より代数的に簡明な操作に置き換わる．
    \item[講義の目標：$\log z\;(z\in\C\setminus\{0\})$を定義する]\mbox{}\\
        対数関数が解ったならば，一変数複素関数が解ったと言って良い．
    \item[謎]\mbox{}\\
        一体なぜ複素数という対象はこんなにも代数的に有用なのか．複素数のうちどの型が汎用性が高いのか．
\end{description}

\section{実関数の複素関数への自然な拡張を目指す}

\begin{example*}[定義域の位相的性質が変わる]
    実関数$f(x)=\frac{1}{x}\;(x\in\R\setminus\{0\})$を複素数上に拡張したもの$f(z)=\frac{1}{z}\;(z\in\C\setminus\{0\})$は，定義域の位相的性質が違う（弧状連結である）．
\end{example*}
\begin{example*}[解析接続（複素指数関数）]
    $e^x:=\sum^{\infty}_{n=0}\frac{x^n}{n!},\;(x\in\R)$を複素数上に自然に拡張できる．
\end{example*}
\begin{example*}[新しく考慮可能になる値が出現する]
    対数関数$\log x\;(x>0)$は，$\log z\;(x\in\C\setminus\{0\})$に拡張でき，新たに$x<0$にて値が定まる．
    これは，対数関数は指数関数の逆関数であるから，
    $z\in\C\setminus\{0\}$に対して$e^w=z$を満たす$w\in\C$を
    $\log z$と書く訳であるが，これは複素指数関数が単射でなくなるために（周期$2\pi$を持つ）関数としては定まらない．
    そこで今回は次のように定義する．

    \begin{definition*}[complex logarithm]
        $z\in\C\setminus\{0\}$に対して，$\gamma(0)=1,\;\gamma(1)=z$を満たす曲線$\gamma:[0,1]\to\C\setminus\{0\}$を
        任意に取り，
        \begin{align*}
            \log z&=\int^z_1\frac{dw}{w}\\
            &:= \int_\gamma\frac{dw}{w}\\
            &=\int^1_0\frac{1}{\gamma(t)}\frac{d\gamma}{dt}dt
        \end{align*}
        によって定まる次のような多価関数を，\textbf{複素対数関数}という．
        \[ \log z=\log|z| + i(\theta+2\pi i),\;n\in\Z \]
    \end{definition*}
    \begin{remark*}
        この性質がtopology (homotopy)的なものの考え方の原点となった．
        確かにベクトル解析のレポートを書き上げる際に自然に触れた．
        また，凡ゆる多価関数性は本質的に対数関数に起因するという．
        この多価性の解消は，複素指数関数の定義域を$[0,2\pi)$に絞れば解決されるが（これを「枝」を取り出す方法，と言う），
        より自然な方法に，穴あき (つまり原点を除く) ガウス平面を無限個貼り合わせた被覆空間としてのリーマン面上で定義された関数と見做す，リーマン面の方法がある．\footnote{ja.wikipedia.org/wiki/複素対数函数}
    \end{remark*}
\end{example*}

\section{Roots}

\begin{itemize}
    \item $\C^\times=\R_{>0}\times S^1$という群をなす（極形式）ため，任意の零でない複素数は任意の冪根をもつ（代数学の基本定理の特殊な例）．
\end{itemize}

\chapter{複素数}

\begin{quotation}
    もしかしたら何事も慣れるとそうなのかもしれないが，複素数の中心となる２つの構成に何度も立ち戻って
    基本的な性質を証明するのは構成論上仕方ないが，一度遊離してしまえば，
    複素数の性質を証明するのに実数の議論にまで戻る必要が必ずしもない．
    CR作用素の性質も然り，また複素化という言葉（体としてというよりも，どちらかといえば線型代数）も然り（注\ref{remark-complexification}）．

    その観点からも，最後に証明する，複素線形性の特徴付けの２条件（定理\ref{thm-conformal-Clinear-communicative}）が，今後この上なく重要な意味を持つ．
    \begin{quote}
　      過去２世紀における数学の広範な発展は，その大部分が複素数を導入したことに因っている．つまり，逆説的に言えば，それは２乗して負になる数の存在という，一見不条理な概念を基礎においた発展なのである．\cite{Elias Stein}
    \end{quote}
    \begin{flushright}
        --- E. Borel, 1952
    \end{flushright}
\end{quotation}

\section{複素数の構成}

\begin{screen}
    高校教育課程では，imaginary unit $i^2=-1$を形式的に導入して，$a+bi\;(a,b\in\R)$と表される数を複素数とし，
    和と積に関する次の法則を発見する．
    \begin{align}
        (a+bi) + (c+di) &= (a+b) + (b+d)i\\
        (a+bi)(c+di) &= (ac-bd) + (bc+ad)i
    \end{align}
    ここでは，性質$i^2=-1$を満たす，より筋が良い２つのモデルを実際に構成することで，更なる詳細の性質についての結果を導くための基盤とする．
\end{screen}

\begin{definition}[complex numbers 1 | 代数系$(\R^2,\cdot)$として (Hamilton)]\label{def-complex-numbers-1}
    積$\cdot:\R^2\times\R^2\to\R^2$を備えた二次元実線型空間$\R^2$を\textbf{複素数体}と呼び，$\C:=(\R^2,\cdot)$と書く．
    \[\begin{pmatrix}a\\b\end{pmatrix}\cdot\begin{pmatrix}c\\d\end{pmatrix}=\begin{pmatrix}ac-bd\\bc+ad\end{pmatrix}\]
    \begin{itemize}
        \item 標準基底$\mathbf{e}:=\begin{pmatrix}1\\0\end{pmatrix},\mathbf{i}:=\begin{pmatrix}0\\1\end{pmatrix}$を用いて，$\begin{pmatrix}a\\b\end{pmatrix}=a\mathbf{e}+b\mathbf{i}$と成分表示できる．これを$a+bi$と略記する．
        $\Re z:=a, \Im z:=b$と定める．
        \item 写像$i:\R\to\C$を$\R\ni a\mapsto a\mathbf{e}\in\C$とすると，これは包含射（埋め込み）であり，$i(\R)=\{z\in\C\mid\Im z=0\}$．
        この包含射によって$\R$の元は$\C$の元と同一視する．
    \end{itemize}
\end{definition}
\begin{lemma}
    次が成り立つ．
    \begin{enumerate}
        \item $\mathbf{e\cdot e=e, e\cdot i=i, i\cdot e=i, i\cdot i=-e}$．
        \item(可換性) $v,w\in\R^2$に対して，$vw=wv$が成り立つ．
        \item(分配性) $v_1,v_2,w\in\R^2,a,b\in\R$に対し，$(av_1+bv_2)w=av_1w+bv_2w$．
    \end{enumerate}
\end{lemma}

\begin{definition}[complex numbers 2 | 部分代数$M$として]
    ２次元正方行列のなす線型空間$M_2(\R)$の，次のようにして定まる部分空間$M$を複素数体$\C:=M$と言う．
    \[ M=\left\{ \begin{pmatrix}a&-b\\b&a\end{pmatrix}\in M_2(\R)\;\middle|\; a,b\in \R \right\} \]
\end{definition}
\begin{proposition}
    次が成り立つ．
    \begin{enumerate}
        \item $M$は（行列）積について閉じて居る．
        \item $\varphi:\C\ni a+bi\mapsto\begin{pmatrix}a&-b\\b&a\end{pmatrix}\in M$は体としての同型である．
    \end{enumerate}
    特に$\varphi(1)=E,\varphi(i)=J:=\begin{pmatrix}0&-1\\1&0\end{pmatrix}$となる．この$J$を\textbf{複素構造}と言う．
\end{proposition}
\begin{remark}
    \[ \begin{pmatrix}a&-b\\b&a\end{pmatrix} = \left( \begin{pmatrix}a\\b\end{pmatrix} \;\; J\begin{pmatrix}a\\b\end{pmatrix} \right) \]
    であり，$J^2\begin{pmatrix}a\\b\end{pmatrix}=-\begin{pmatrix}a\\b\end{pmatrix}$であると言う構造を持つ．
\end{remark}
\begin{lemma}
    $\alpha,\beta,\gamma\in M$について，次が成り立つ．
    \begin{enumerate}
        \item $\alpha+\beta=\beta+\alpha, (\alpha\beta)\gamma=\alpha(\beta\gamma), \alpha(\beta+\gamma)=\alpha\beta+\alpha\gamma$．
        \item $\alpha\beta=\beta\alpha$．
        \item $\det(aE+bJ)=a^2+b^2$．（よって，零元$0$を除いて逆元を持つ）．
    \end{enumerate}
\end{lemma}

\section{その他の構成とそれらの等価性}

\begin{screen}
    まず，今回の授業で用いた２つの構成が等価であることが確認できる．
    次に，
    \begin{enumerate}
        \item 純粋な体論から：任意の各大体$\R\subset\F$が共通して持つ部分$\cap\F$として(Ahlfors)，
        \item 多項式の部分体$\R[x]/(x^2+1)$として，
        \item 複素構造$J$の中心化群として（問題\ref{problem-complex-linear-mappings}），
    \end{enumerate}
    も構成できる．複素化，代数的閉包．

    最後に$\R$-線型空間$V$から同じ次元の$\C$-線型空間$V\oplus V$を構成する手法として算譜抽出をして複素化を定義できる（$V=\R$の時，これは複素数の構成に等価）．
\end{screen}

\begin{proposition}[２つの構成の等価性]
    写像
    \[\xymatrix@R-2pc{
        M\ar[r]^-{\varphi}&{\R^2}\\
        {\rotatebox{90}{$\in$}}&{\rotatebox{90}{$\in$}}\\
        {aE+bJ}\ar@{|->}[r]&{\begin{pmatrix}a\\b\end{pmatrix}}
    }\]
    は（体の）同型である．
\end{proposition}

書籍\cite{Ahlfors}では$\C$の存在を体の公理系についての論から示していた．
それは，方程式$x^2+1=0$の解が存在する$\R$の任意の拡大体$\F$が共通して持つ部分体$\C$としての構成で，
まず$\R$の公理とその存在と一意性を確認し，そしてHamiltonの構成をして存在と一意性を確認した．


また，次の構成法もある．なんというか，体の拡大に代数方程式論を用いたことと深い繋がりがあるように思う．
\begin{problem}[多項式の部分体として]
    次の部分体は，$\C$と同型である．
    \[ P:=\R[x]/(x^2+1) \]
\end{problem}

\begin{example}[複素構造$J$の中心化群としての構成]
    ２次元実線型空間$V$の自己射のモノイド$\End(V)$に対して，
    可逆射$J:V\to V$を$J^2=-E$によって定め，
    これに対して可換になる射全体の集合を$M=\{A\in M_2(\R)\mid AJ=JA\}$を満たす部分空間／部分(Abel)群として複素数を作り出せる．
    勝手な元を$x\in V$とし，もう一つを$Jx$と取れば（直行座標になる），$J$は$\begin{pmatrix}0&1\\-1&0\end{pmatrix}$と表示される．

    命題\ref{problem-complex-linear-mappings}により，$L\in\Aut(V)$は$\exists\alpha,\beta\in\C\;L(z)=\alpha z+\beta\overline{z}$と表せるのであった．
\end{example}

\subsection{複素共軛と複素化}

\begin{proposition}[複素共軛は唯一の非自明な自己同型である，従って対合である]
    $\R$上の結合的代数の圏上での自己同型群$\Aut(\C)$は，複素共軛の作用のみで，$\Z/2$である．

    The automorphism group of the complex numbers, as an associative algebra over the real numbers, is $\Z/2$, acting by complex conjugation.\footnote{ncatlab.org/nlab/show/complex+number}
\end{proposition}
\begin{remark}
    実数の場合は$\Aut(\R)=\{\id\}$ということであろうか．
\end{remark}

線型代数の言葉で，体の拡張$\R\xrightarrow{i}\C$は，一般化されており，
複素化と呼ばれる．

\begin{definition}[complexification]
    実線型空間$V$の\textbf{複素化}とは，$\R$上の$\C$とのテンソル積$V^\C:=V\otimes_\R\C$のことである．
    なお，係数体を埋め込み$i:\R\to\C$により拡大する．\footnote{https://ncatlab.org/nlab/show/complexification}
    この複素化によって，$V$の基底は$V^\C$の基底と同一視される．
\end{definition}

\section{複素数特有の性質「共軛」}

\begin{screen}
    複素数は一般に抽象的に，公理論的に存在し，それ自体の自律性を持つはずである．
    ということで，前節の二通りの構成法を抽象化し，
    複素共軛という複素構造$J$に本質的な概念に注目して，
    複素数の特徴を，実数（成分）の言葉から遊離して複素共軛という複素数特有の言葉で捉え直し，\textbf{これを足場とする}ことを目指す．

    複素数体を$(\R^2,\cdot)$と同一視した際には虚数単位$i$が，$M$と同一視した際には$(x\;\;Jx)$と表せることが本質的な意味を持つ．
    前者の見方では複素共軛は唯一の非自明な体同型であり，後者の見方では複素共軛は行列の転置である．
\end{screen}

\begin{definition}[absolute value / modulus, conjugate]
    $z=x+yi\in\C$について，
    \begin{enumerate}
        \item $|z|:=\sqrt{x^2+y^2}$を，$z$の\textbf{絶対値}と言う．$(\R^2,\cdot)$のベクトルとしての長さを表す．
        \item $\overline{z}=x-yi$を，$z$の\textbf{複素共軛}と言う．$M$の元としての転置を表す，転置がinvolutionであるという点において共軛的である．
    \end{enumerate}
    つまり，複素構造としては$\pm\sqrt{-1}$のいずれも採用し得るが，\textbf{複素共軛を考えれば，右手系のみの言葉から複素数の世界を対称的に扱える}．
\end{definition}
\begin{proposition}[conjugate involution is a field automorphism]
    複素共軛の概念により定まる$\R$-線型写像(conjugate involution) $\C\to\C, i\mapsto\overline{i}=-i$は，$\R\subset\C$を変えない$\C$の自己同型である．
\end{proposition}
\begin{remark}
    これは体の拡大についての言葉を用いて，Galois群$\Gal(\C/\R)$が位数2の巡回群で，複素共軛により生成されると言える．\footnote{nLab}
\end{remark}
\begin{proposition}[複素共軛による特徴付け]
    実部は，複素共軛との平均として得られる．
    \[ \Re z=\frac{z+\overline{z}}{2},\; \Im z=\frac{z-\overline{z}}{2i} \]
    複素数の構成１（定義\ref{def-complex-numbers-1}）の際に用いた内部構造を抽象化する点において強力な指針となる．
\end{proposition}
\begin{lemma}[絶対値，複素共軛と演算の整合性]\label{lemma-abs-conj}
    $z=x+yi, w=u+vi\in\C$を$(\R^2,\cdot)$の元とみなす．
    \begin{enumerate}
        \item $\begin{pmatrix}x\\y\end{pmatrix}\cdot\begin{pmatrix}u\\v\end{pmatrix} = \Re z\overline{w}=\Re \overline{z}w$．（$\R^2$の内積の表示．$\R^2$内の内積は，$M$では転置して掛け合わせた行列の11または22要素に現れるから，$\Re$で取り出せる．これらは転置に対して値を保存する）．
        \item $\overline{z+w}=\overline{z}+\overline{w}, \overline{zw}=\overline{z}\overline{w}$．複素共軛はそのどちらを採用しても同じ複素数体を生成するので，和と積を保存する（同型）．
        \item $|z|^2=z\overline{z}=|\overline{z}|^2$．（回転変換の部分の打ち消し，直行行列が自身の転置と積を取って居るので２つの基底の長さを掛け合わせた値になる，これは行列式に等しい）．
        \item $|zw|=|z||w|, \left|\frac{z}{w}\right|=\frac{|z|}{|w|}$（3.の帰結）．
    \end{enumerate}
    また，次が成り立つ．不等式条件は順序が$\R$上にしかないために，これの大部分を引き継ぐ形になる．
    \begin{enumerate}\setcounter{enumi}{4}
        \item $|z\pm w|^2=|z|^2\pm 2\Re z\overline{w}+|w|^2$（これより恒等式$|z+w|^2+|z-w|^2=2(|z|^2+|w|^2)$を得る）．
        \item $-|z|\le\Re z\le|z|,-|z|\le\Im z\le |z|$．
        \item (Cauchy) $\Re z\overline{w}\le|z||w|$（等号成立条件は$z/w>0:\Leftrightarrow z/w\in\R\land z/w>0$）．
        \item (三角不等式) $|z+w|\le|z|+|w|$．
        \item (三角不等式の変形) $\abs{\abs{z}-\abs{w}}\le\abs{z-w}$．
    \end{enumerate}
\end{lemma}
\begin{proof}
    1., 2., 3.は$(\R^2,\cdot)$の元としての成分計算からわかる．4.は2.,3.を用いて$|ab|^2=ab\cdot\overline{ab}=ab\overline{a}\overline{b}=|a|^2|b|^2$から得る．
    $b=\frac{1}{b}$と定め直せばもう一方を得る．

    5.は3.と1.から分かる．$|z\pm w|^2=(z\pm w)(\overline{z}\pm\overline{w})=|z|^2\pm(z\overline{w}+\overline{w}z)+|w|^2$．
    
    6.は定義（実数からの構成）から成分計算により従う．
    
    7.は，5.より$\forall\lambda\in\C,\;\sum^n_{i=1}|a_i-\lambda\overline{b}_i|^2=\sum^n_{i=1}|a_i|^2+|\lambda|^2\sum^n_{i=1}|b_i|^2-2\Re\overline{\lambda}\sum^n_{i=1}a_ib_i\ge 0$が成り立つ．特に$\lambda=\frac{\sum^n_{i=1}a_ib_i}{\sum^n_{i=1}|b_i|^2}$とすることで，
    \begin{align*}
        &\sum^n_{i=1}|a_i|^2+\frac{\left|\sum^n_{i=1}a_ib_i\right|^2}{\sum^n_{i=1}|b_i|^2}-2\Re\frac{\sum^n_{i=1}\overline{a}_i\overline{b}_i}{\sum^n_{i=1}|b_i|^2}\sum^n_{i=1}a_ib_i\\
        =&\sum^n_{i=1}|a_i|^2+\frac{\left|\sum^n_{i=1}a_ib_i\right|^2}{\sum^n_{i=1}|b_i|^2}-2\frac{\left|\sum^n_{i=1}a_ib_i\right|^2}{\sum^n_{i=1}|b_i|^2}\\
        =&\sum^n_{i=1}|a_i|^2-\frac{\left|\sum^n_{i=1}a_ib_i\right|^2}{\sum^n_{i=1}|b_i|^2}\ge 0
    \end{align*}
    を得る．

    8.は，5.と6.より$|a+b|^2=|a|^2+|b|^2+2\Re a\overline{b}\le |a|^2+|b|^2+2|a||b|=(|a|+|b|)^2$より従う．

    9.は
    \begin{align}
        \abs{z}&\le\abs{z-w}+\abs{w},& \abs{w}&\le\abs{z-w}+\abs{z}
    \end{align}
    より．
\end{proof}

\begin{proposition}
    複素数$\alpha$がある実係数代数方程式の解ならば，$\overline{\alpha}$も解である．
\end{proposition}
\begin{proof}
    補題\ref{lemma-abs-conj}.2より，全ての四則演算からなる方程式関係について，その構造を体同型（＝四則演算を保存する）であるinvolution$\overline{ }$は保存する．
    そしてこのinvolutionによる双対命題は，係数が全て実数であるために，同じ方程式についてもう一つの解の存在を保障することになる．
\end{proof}

\begin{example}[代数方程式]\mbox{}
    \begin{description}
        \item[円の方程式] $|z-\alpha|=r$またはパラメータ表示で$z=r\xi+\alpha\;(|\xi|=1)$．または代数方程式で$(z-a)(overline{z}-\overline{a})=r^2$．また，この方程式は複素共軛の下で不変だから，その不動核に入っていることがわかる，即ち実数の関係式１本の等価な表現がある． 
        \item[楕円の方程式] 長軸が実軸に含まれ，短軸が虚軸に含まれる場合，$|z|^2+a(z^2+\overline{z}^2)-r=0\;(0\le a<\frac{1}{2})$と表せる．成分で表すと$(1+2a)x^2+(1-2a)y^2-r=0$となる． 
    \end{description}
\end{example}

\begin{remark}[２つの構成の緊密な協調]次のような観察は，複素数という構造の筋の良さを伺わせる．
    この２つを往来することで強力な時短になる．特に幾何的な側面は次の節で考察する．
    \begin{enumerate}
        \item 代数的な計算$\frac{1}{\alpha+i\beta}=\frac{\alpha-i\beta}{\alpha^2+\beta^2}$は，
        行列としての逆写像を考えることで$z^{-1}=Z^{-1}=\frac{1}{|\det Z|}\overline{z}$に一致する．逆行列が転置の定数倍に一致するのはたまたまである．
    \end{enumerate}
\end{remark}

\section{複素数の積の幾何的性質}

\begin{screen}
    複素数は公理論的にも存在するが，必要に応じてEuclid平面$\R^2$や行列$M$と同型を取って考えられるのが強みである．
    例えば，複素数は$(\R^2,\cdot)$の点でもあり，その上での（回転・拡大）変換でもあるのであった．
    これらを組み合わせ，適宜内部構造を参照することで，幾何的にも代数的にも強力な道具になる．
    「あと半年もすると，なんでも複素数で書いて計算してしまうようになります．」とのことであった．
    おかげで公式$\sqrt{\alpha+i\beta}=\pm\left(\sqrt{\frac{\alpha+\sqrt{\alpha^2+\beta^2}}{2}}+i\frac{\beta}{|\beta|}\sqrt{\frac{-\alpha+\sqrt{\alpha^2+\beta^2}}{2}}\right)\;\;(\beta\ne 0)$を考えずに済むのである．
\end{screen}

複素数を幾何的に捉えるには，回転・拡大変換に強い極座標系の表示を用いると手触りが良い．

\begin{definition}[polar form / trigonometric form]
    複素数$z$はある実数$\theta$を用いて，
    \[ z=|z|(\cos\theta+i\sin\theta) \]
    と表せる．この時$\theta$を$z$の\textbf{偏角}といい，$\theta=\arg z$と書く．
    $\arg:\C\to\R$は多価な選択写像で，特に$(-\pi,\pi]$に取る値を\textbf{主値}というが，暗黙のうちに$2\pi$の倍数分の違いは無視して$=$などの記号で結ぶことが多い．
\end{definition}
\begin{lemma}[偏角の性質：$\C$の積を$\R$の和に写す]
    $w=|w|(\cos\varphi+i\sin\varphi)$とする．
    \begin{enumerate}
        \item $zw=|z||w|(\cos(\theta+\varphi)+i\sin(\theta+\varphi))$．
        \item $\arg w-\arg z=\arg(w/z)\; \mod 2\pi$．
    \end{enumerate}
\end{lemma}
\begin{definition}[Gauss平面の向きと複素数のなす角]
    数ベクトル空間$\R^2$においてベクトル$v,w\in\R^2\setminus\{0\}$のなす角は
    \[ \cos\theta=\frac{(v,w)}{||v||\cdot ||w||} \]
    とし，この時符号が不定であった．一般にEuclid空間$\R^2$と言った時は，$(e_1,e_2)$を標準的な向きとする．

    しかしここに積の構造を加えた$\C$の場合，$\sqrt{-1}(=i=J)$という標準的な向き（右手系）が定まって居る．
    従って，２つの複素数$v,w\in\C\setminus\{0\}$のなす角は次のように定義する．
    \[ \frac{w}{||w||}=\begin{pmatrix}\cos\theta&\sin\theta\\-\sin\theta&\cos\theta\end{pmatrix}\frac{v}{||v||} \]
\end{definition}

\begin{proposition}[円分方程式の解]
    方程式$z^n=\alpha\in\C$の解は，$\alpha=r(\cos\theta+\sin\theta)$を満たす$r,\theta$を用いて，
    \[ z=\sqrt[n]{r}\left(\cos\frac{\theta}{n}+i\sin\frac{\theta}{n}\right)\left(\cos\frac{2\pi}{n}+i\sin\frac{2\pi}{n}\right)^m\;\;\;m=0,1,2,\cdots,n-1 \]
    と表せる．表示は少し技巧的で，前半の$z_0$が解を構成する因子で，その偏角変化のstepが$\xi^m$分大きくなっても，$n$乗した後に$\alpha$の方向を向いて居る事は変わらない．
    そして方程式の解はこの$n$個に尽きる．
\end{proposition}

\begin{proposition}[Dirichlet kernel]
    \[ \sum^n_{k=0}\cos(k\theta)=\frac{1}{2}+\frac{\sin\left(\left(n+\frac{1}{2}\right)\theta\right)}{2\sin\left(\frac{\theta}{2}\right)}\;(\theta\ne 2\pi n\;n\in\Z) \]
    右辺は\textbf{ディリクレ核}と呼ばれ，Fourier解析にて収束性の議論の際などに登場するのが有名．
    三角関数の加法に対する法則のみで説明可能な事象であることは間違いないが，その論理の筋が辿れたからと言って我々に利する事は少なそうである．
\end{proposition}
\begin{proof}
    $\zeta=\cos\theta+i\sin\theta\;(\theta\ne 2\pi n\;n\in\Z)$とおく，即ち$\zeta\ne 1$．
    次が成り立つ．
    \[ 1+\zeta+\zeta^2+\cdots+\zeta^n=\frac{1-\zeta^{n+1}}{1-\zeta} \]
    この左辺の実部は$\sum^n_{k=0}\cos(k\theta)$であるから，右辺の実部を計算することを考える．
    $z=\cos\frac{\theta}{2}+i\sin\frac{\theta}{2}$と置き直すと，$z^2=\zeta, z^{-1}=\overline{z}, 1-\zeta=1-z^2=z(\overline{z}-z)$だから，
    \begin{align*}
        \frac{1-\zeta^{n+1}}{1-\zeta}&=\frac{1-z^{2n+2}}{z(\overline{z}-z)}\\
        &= \frac{\overline{z}-z^{2n+1}}{\overline{z}-z}\\
        &= \frac{\overline{z}-z^{2n+1}}{-2i\sin\frac{\theta}{2}}\\
        &= \frac{i(\overline{z}-z^{2n+1})}{2\sin\frac{\theta}{2}}
    \end{align*}
    この実部は$\Re(i\overline{z}-iz^{2n+1})=\sin\frac{\theta}{2}+\sin\left(\frac{2n+1}{2}\theta\right)$より，得る．
\end{proof}

\begin{remark}[公理論としての厳密性についての注意]
    以上の議論は，三角関数は定義せずに（あるいはすごく解析的に定義し）naiveに用いており，また幾何的な言明は$\R$の解析的性質から従うものとしたことに注意．\cite{Ahlfors}
    複素解析学では三角関数を別の角度から定義しなおす．
\end{remark}

\section{等角性と複素線形性は同値}

\begin{screen}
    （厳密にはCR方程式が複素関数のYacobi行列に課す制約を見ることによって判明するが，）
    平面上の線型写像が等角である時，それは平面をGauss平面$(\R^2,\cdot)$とみなしたときに
    この上の$\C$-線型写像を定めていることに同値であることを，初等的に平面上のベクトルの「なす角」を複素数の偏角の言葉で捉えることで，見る．
\end{screen}

まず，複素数とは，部分空間$M\subset M_2(\R)$であった．
即ちモノイド$\Mor_{\FinVect_\R}(\R^2\simeq\C)$の部分群であることを洗い出す．

\subsection{実線型写像が複素線型でもあるための条件と複素化}

\begin{proposition}[$\R^2$の実自己線型写像の複素数表示]\label{prop-linearity-between-real-complex}
    実線型写像$L:\R^2\to\R^2$は，ある複素数$\alpha,\beta,z\in\C$と用いて，
    $L(z)=\alpha z+\beta\overline{z}$と表せる．（即ち，実線型写像$L:\R^2\simeq\C\to\C\simeq\R^2$は$\iota$を用いて$\C\oplus\C$の実部分空間（２次元）に埋め込める）
\end{proposition}
\begin{proof}
    $\R^2$の標準基底について，$L$は行列$A=(a\;b)\in M_2(\R)$で表示されるとする．
    すると，
    \begin{align*}
        L=(a\;b) &=\frac{1}{2}(a+Jb\;\;-Ja+b)+\frac{1}{2}(a-Jb\;\;Ja+b)\\
        &=\frac{1}{2}(a+Jb\;\;Ja-b)\begin{pmatrix}1&0\\0&-1\end{pmatrix}+\frac{1}{2}(a-Jb\;\;Ja+b)
    \end{align*}
    と分解できる．２つの行列は，それぞれ$Ja-b=J(a+Jb), Ja+b=(a-Jb)$の関係を満たすから，これを複素数
    \begin{align*}
        \beta&:=\frac{1}{2}(a+Jb\;Ja-b)\\
        \alpha&:=\frac{1}{2}(a-Jb\;Ja+b)
    \end{align*}
    と取れば，
    \begin{align*}
        Lz &= \beta\begin{pmatrix}1&0\\0&-1\end{pmatrix}z + \alpha z\\
        &= \alpha z+\beta\overline{z}
    \end{align*}
    と表せる．
\end{proof}

\begin{proposition}[$\R^2$の実自己線型写像の可逆性条件]
    実線型写像$L:\R^2\to\R^2$が$L(z)=\alpha z+\beta\overline{z}$と表されているとする．
    これが可逆であることは$|\alpha|^2-|\beta|^2\ne 0$に同値である．
\end{proposition}
\begin{proof}
    \[\xymatrix@R-1pc{
        {\begin{pmatrix}x\\y\end{pmatrix}}\ar@{|->}[ddd]\ar[rrr]&&&{\frac{1}{2}\begin{pmatrix}\alpha+\beta+\overline{(\alpha+\beta)}&-(\alpha-\beta-\overline{(\alpha-\beta)})\\\alpha+\beta-\overline{(\alpha+\beta)}&\alpha-\beta+\overline{(\alpha-\beta)}\end{pmatrix}\begin{pmatrix}x\\y\end{pmatrix}}\ar@{|->}[ddd]\\
        &\R^2\ar[r]^-{f_L}\ar[d]_-{\varphi_{1,i}}\ar@{}[ul]|-{\rotatebox{315}{$\in$}}&\R^2\ar@{}[ur]|-{\rotatebox{225}{$\in$}}\ar[d]^-{\varphi_{1,i}}\\
        &\C\ar[r]^-{L}\ar@{}[dl]|-{\rotatebox{45}{$\in$}}&\C\ar@{}[dr]|-{\rotatebox{135}{$\in$}}\\
        z\ar@{|->}[rrr]&&&\alpha z+\beta\overline{z}
    }\]
    $\alpha z+\beta\overline{z}$に$z=x+yi$を代入し，基底$1,i$について成分表示をすると，$L:\R^2\to\R^2$の表現行列を特定できる．
    この行列式は，
    \begin{align*}
        \det f_L&=\frac{1}{4}\left\{ ((\alpha+\beta)+\overline{(\alpha+\beta)})((\alpha-\beta)+\overline{\alpha-\beta})\right.\\
        &\hphantom{=}\;\left.-((\alpha+\beta)-\overline{(\alpha+\beta)})((\alpha-\beta)-\overline{(\alpha-\beta)}) \right\}\\
        &=\frac{1}{4}(4\alpha\overline{\alpha}-4\beta\overline{\beta})=|\alpha|^2-|\beta|^2.
    \end{align*}
\end{proof}
\begin{remark}[complexificationを用いた証明：実数上まで引き戻す必要がない]\label{remark-complexification}
    証明中の同型射$\varphi_{1,i}:\R\oplus\R\to\C$は，$1,i\in\C$が定める同型である．
    複素線型空間としての$\C$は，実線型空間$\R$の複素化である：$\R\oplus\R=:\R_\C\simeq\C$．
    今回の証明はこれの梯子を降るために用いたが，逆に登る方向へと用いると，実数上の議論まで引き戻さずとも済む．

    実２次線型空間としての$\C$の複素化$\C_\C=\C\oplus\C(=\C^2)$を考える．そこへの埋め込みである実線型写像$\iota:\C\to\C\oplus\C$を$z\mapsto\begin{pmatrix}z\\\overline{z}\end{pmatrix}$で与えると，これは単射だから，$V=\iota(\C)$と実２次部分空間を置けば$\iota:\C\to V$の範囲で可逆である．
    なお，ここで\textbf{$V$は複素線型（部分）空間ではない}ことに注意，複素数倍について閉じていないからである．
    \[\xymatrix{
        \C\oplus\C\ar@{-->}[r]^-{L_\C}&\C\oplus\C\\
        V\ar@{.>}[u]_-i\ar[r]^-{\hat{L}:=L\oplus L}&V\ar@{.>}[u]_-i\\
        \C\ar[u]_-\iota\ar[r]^-L\ar@{}[d]|-{\rotatebox{90}{$\in$}}&\C\ar[u]_-\iota\ar@{}[d]|-{\rotatebox{90}{$\in$}}\\
        z\ar@{|->}[r]&\alpha z+\beta\overline{z}
    }\]
    すると，上図を可換にする\textbf{実}線型写像$\hat{L}:=\iota\circ L\circ\iota^{-1}$の行列表示は，
    \[\hat{L}\begin{pmatrix}z\\\overline{z}\end{pmatrix}=\begin{pmatrix}\alpha z+\beta\overline{z}\\\overline{\beta}z+\overline{\alpha}\overline{z}\end{pmatrix}=\begin{pmatrix}\alpha&\beta\\\overline{\beta}&\overline{\alpha}\end{pmatrix}\begin{pmatrix}z\\\overline{z}\end{pmatrix}\]
    となる．（行列表示に複素数が現れているが，これは$L$が実線型写像であることと矛盾しない）．
    即ち，上の可換図式は，最上部の射$L_\C$は$\Vect_\C$上のものであるが，下部の四角形は$\Vect_\R$上のもので，$i$はただの包含写像である．
    この時，\textbf{複素線型写像$L_\C$は実線型写像$L$の複素化}と言う（ただし，実線型写像$\hat{L}$は$L$が$\C\oplus \C\to \C\oplus \C$上に定める実線型写像の$V$への制限で，$L_\C$とは，複素行列$\hat{L}$が$\C^2$上に定める複素線型写像）．

    まず，可換図式の下部を$\Vect_\R$上で考え，$\det\iota=1$を導く，すると$\det\hat{L}=\det\iota^{-1}\cdot\det L\cdot\det\iota=\det L$を得る．
    $\iota$は$\C$の基底を$1$，$V$の基底を$e_1,e_2$と複素上の線型空間として見ていると見えてこない，$L$は必ずしも複素線型とは限らないからである．
    一方双方を実線型空間と見ると，
    \[ \begin{pmatrix}x\\y\end{pmatrix} = \begin{pmatrix}x+yi\\x-yi\end{pmatrix} = \begin{pmatrix}1&1\\1&-1\end{pmatrix} \begin{pmatrix}x\\y\end{pmatrix} \]
    より，確かに$\det\iota=1$．

    可換図式の上部の$\hat{L}$の$L_\C$への拡張考える．$\hat{L}$と$L_\C$は表現行列が同一であるから，$\det\hat{L}=\det L_\C$．
    $V,\C\oplus\C$の集合としての共通部分から取れる２元$\begin{pmatrix}1\\1\end{pmatrix},\begin{pmatrix}i\\-i\end{pmatrix}$は，$V$の$\R$上の基底でもあり，$\C\oplus\C$の$\C$上の基底でもある．
    これが複素化である．
\end{remark}

\begin{itembox}[l]{複素化：体の拡大に伴う，体上の加群の射の拡張}
    実線型写像$f:V\to W$について，一度積写像$f\oplus f:V\oplus V\to W\oplus W$を考え，空間$V\oplus V,W\oplus W$
    に複素数の構造を入れて得る$V_\C,W_\C$上に，それに伴って拡張される$\C$倍$\cdot:\C\times V_\C\to V_\C$の構造を保つと言う意味での複素線型写像$f_\C:V_\C\to W_\C$を$f$の複素化という．
    $V\oplus V$から$V_\C$の定義は，集合としては変わらず，純粋に複素数積の代数的構造を入れたのみである．
\end{itembox}

\subsection{複素線型写像と等角写像}

写像$z\mapsto\overline{z}$は，$\overline{z}=\alpha z$と表した場合の$\alpha\in\C$が$z\in\C$の値に依ってしまい：$\alpha=\frac{x^2-y^2-2xyi}{x^2+y^2}$，
一定の複素数$\alpha z=\overline{z}$と表すことの出来ない変換である．
即ち，複素線型ではなく，複素数をかける行為と複素共軛を取る行為は可換ではない．
従って，この実線型写像$L:\R^2\to\R^2$が，複素線型写像$L':\C\to\C$と見做せるためには，この成分が消えなければならない．

\begin{shadebox}\begin{theorem}\label{thm-conformal-Clinear-communicative}
    $L:\R^2\to\R^2$を実線型同型とする．次の３条件は同値である．
    \begin{enumerate}
        \item $L$は等角写像である（任意の$v,w\in\C\setminus\{0\}$に対して，$v,w$のなす角と$Lv,Lw$のなす角が等しい）．
        \item $L$は$L:\C\to\C$と見た時，$\C$-線型写像である（即ち，$L$は複素数で表される，あるいは$L\in M$）．
        \item $L$は複素構造$J$と可換である．即ち，$JL=LJ$が成り立つ．
    \end{enumerate}
\end{theorem}\end{shadebox}
\begin{proof}
    まず1.$\Leftrightarrow$2.を示す．$\Leftarrow$は，$\exists\alpha\in\C,\; L(z)=\alpha z$である時，$\alpha$は回転・拡大変換を施すので，なす角を保存する．
    $\Rightarrow$を考える．
    $L:\C\to\C$を等角写像と仮定すると，特に$1,z$のなす角と$L(1),L(z)$のなす角は等しい．
    従って，
    \[ \arg z-\arg 1=\arg L(z)-\arg L(1) \]
    を得る．これより，$\arg\left(\frac{L(z)}{z}\right)=\arg L(1)=(Lに依って定まる値)$より，
    命題\ref{prop-linearity-between-real-complex}より，複素数$\frac{L(z)}{z}=\frac{\alpha z+\beta\overline{z}}{z}=\alpha+\beta\left(\frac{\overline{z}}{z}\right)$の偏角はある一定値をとる．
    ここで$z\in\C\setminus\{0\}$に応じて，$\frac{\overline{z}}{z}$は単位円周$|\xi|=1$上を動くから，複素数$\frac{L(z)}{z}$は$\frac{L(z)}{z}=\alpha+\beta\zeta\;(|\zeta|=1)$とパラメータ表示できるが，この偏角は一定であるはずなので，$\beta=0$．
    よって，$L(z)=\alpha z\;(z\in\C\setminus\{0\})$．

    次に2.$\Leftrightarrow$3.を示す（問題\ref{problem-complex-linear-mappings}の解が証明となって居る）．
    $\Rightarrow$は，2.が成り立つ時，$iL(z)=L(iz)\;(z\in\C)$が成り立つから，即ち3.も成り立つ．
    一方この時，命題\ref{prop-linearity-between-real-complex}より，$L(z)=\alpha z+\beta\overline{z}$と置いて，
    \begin{align*}
        L(iz)-iL(z) &= \alpha (iz)+\beta(\overline{iz}) - i(\alpha z+\beta\overline{z})\\
        &= -2i\beta\overline{z}=0
    \end{align*}
    より，$\beta=0$を得る．
\end{proof}

\section{演習}

\begin{problem}[複素構造の特徴付け, 複素数の特徴付け]\label{problem-complex-linear-mappings}
    $V$を二次元実線型空間，$J:V\to V$を$J^2=-E$を満たす線型写像とする．
    \begin{enumerate}
        \item $V$のある基底が存在して，$J$は$\begin{pmatrix}0&1\\-1&0\end{pmatrix}$と表示される．
        \item $J=\begin{pmatrix}0&1\\-1&0\end{pmatrix}$とする．$AJ=JA$を満たす二次正方行列$A$を全て求めよ．
    \end{enumerate}
\end{problem}
\begin{solution*}
    1. $x\in V$を任意に取る．すると，$x,Jx$が線型独立である．なぜならば，$x,Jx$が線型従属ならば，$\exists k\in\R(Jx=kx)$であるが，$J^2x=-x=k^2x$であり，$k^2=-1$が導かれるが，これは$k\in\R$に矛盾．
    従って$x,Jx$は線型独立．
    すると，これを基底として，$J=(Jx\;J^2x)=(Jx\;-x)=\begin{pmatrix}0&1\\-1&0\end{pmatrix}$と表される．

    2. $A=\begin{pmatrix}a&b\\c&d\end{pmatrix}$と置くと，$J^4=E$より，
    条件は$A=JAJ^3$となるから，$\begin{pmatrix}a&b\\c&d\end{pmatrix}=\begin{pmatrix}d&-c\\-b&a\end{pmatrix}$より，
    これを満たす$A$は確かに集合$M\subset M_2(\R)$をなす．
\end{solution*}

\begin{problem}
    $f(z)=\frac{z-a}{1-z\overline{a}}\;(|a|<1)$について，次を示せ．
    \begin{enumerate}
        \item $|z|=1$の時$|f(z)|=1$．
        \item $|z|<1$の時$f(z)|<1$．
    \end{enumerate}
\end{problem}

\chapter{複素関数}

\begin{quotation}
    実２変数ベクトル値関数と複素関数の間に次のような同型がある．
    \[\xymatrix@R-2pc{
        \varphi:\Hom(\R^2\supset D,\C)\ar[r]^-{\sim}&\Hom(\C\supset D',\C)\\
        \rotatebox{90}{$\in$}&\rotatebox{90}{$\in$}\\
        {f(x,y)}\ar@{|->}[r]&g(z(,\overline{z})):=f\left(\frac{z+\overline{z}}{2},\frac{z-\overline{z}}{2i}\right)
    }\]
    これにより，複素解析の殆どは，足元の空間を基底$1,i\in\C$が定める同型$\varphi:\C\to\R^2,a+bi\mapsto (a,b)$によって同一視することで，
    $\R^2$上の微分位相幾何（ベクトル解析）の特殊なモデルとして理解できるはずである．

    複素関数$f:\R^2\simeq\C\to\C\simeq\R^2$を一変数$z(=x+yi)$で定義したところまではこれで良いが，
    それについての微分作用素$\frac{d}{dz}$に対しての振る舞いは，$\R^2$上の$x,y$の２変数の観点からは
    素朴には全く予想がつかない．
    ここで，複素微分可能な平面上の関数$D\to\C$のクラスを特徴付ける偏微分方程式がCauchy-Riemann方程式である．
    \begin{enumerate}
        \item この一階の二次の偏微分方程式を満たすこと，
        \item その関数が等角写像であること（定理\ref{thm-charactorization-of-conformal-mappings}）と，
        \item その関数が複素微分可能であること（＝線型主要部が複素線型であること，定理\ref{thm-charactorization-of-complex-differentialability}）と，
        \item その関数が$J$の中心化子となる平面上の自己同型群を定めることと（問題\ref{problem-complex-linear-mappings}）
    \end{enumerate}
    は，同値になる．
\end{quotation}

\section{複素数列の収束}

\begin{screen}
    Hamiltonの構成$\C\simeq\R^2$の通り，複素数平面$\R^2$の位相の議論と並行になる．
    \textbf{$\C$の絶対値と$\R^2$のEuclid距離は構造が同じだからである}．
    $\C$の完備性も，$\R^2$の完備性と同値で，これはBolzano-Weierstraßの定理から従う．
    位相の言葉を定義しなければ，微分は概念さえ出てこない．
    そして$\R$の場合に比べて順序構造が除かれたのみで，微分概念は殆ど同様に定義される．
\end{screen}

\begin{definition}[convergence]
    複素数列$\{z_n\}_{n\in\N}$が$z\in\C$に収束するとは，絶対値について
    \[ \forall\varepsilon>0,\;\exists N,\;n\ge N\Rightarrow |z_n-z|<\varepsilon \]
    が成り立つことをいう．この論理式を$\lim_{n\to\infty}z_n=z$と略記する．
\end{definition}

\begin{proposition}[$\R^2$として]
    複素数列$\{z_n=x_n+iy_n\}_{n\in\N}$について，$\lim_{n\to\infty}z_n=z$と$\lim_{n\to\infty}x_n=x\land\lim_{n\to\infty}y_n=y$とは同値．
\end{proposition}
\begin{proof}
    三角不等式より，
    \[ \max(|x_n-x|,|y_n-y|)\le |z_n-z| \le |x_n-x|+|y_n-y| \]
    $\Leftarrow$はこの右辺から，$\Rightarrow$はこの左辺から分かる．
\end{proof}

\begin{proposition}[completeness]
    $\C$は完備である（Cauchy列と収束列が同値）．
\end{proposition}
\begin{proof}
    複素Cauchy列$\{z_n=x_n+iy_n\}_{n\in\N}$に対して，実Cauchy列$\{x_n\}_{n\in\N},\{y_n\}_{n\in\N}$は収束するから，
    $\{z_n\}_{n\in\N}$も収束する．
\end{proof}
\begin{remarks}
    $\C$-Cauchy列であることも，成分毎にCauchy列である
    ことに同値であるように，直積の概念はどこまでも「成分毎」であるな．
\end{remarks}

\section{複素関数}

\begin{screen}
    まず正則関数（整型関数）を定義する．
    そしてその必要条件として簡単にCauchy-Riemann方程式が導けることを観察し，
    その微分幾何的な意味（Jacobi行列$J_f$が複素数を定める$J_f\in M$ために，等角写像となる）
    を確認する．そして，複素数とは複素構造$J$の中心化子でもあるという事実（問題\ref{problem-complex-linear-mappings}）は，
    複素線形性$\frac{\partial}{\partial z}(\alpha f)=\alpha\cdot_\C\frac{\partial}{\partial z} f$に対応する．
    各接空間において，$\alpha$が定める変換$A$と，複素微分が定める変換$J$とは可換なのである．
\end{screen}

\subsection{複素微分と正則関数}

\begin{definition}[convergence, limit, continuous]\mbox{}
    \begin{enumerate}
        \item 開集合$D$の複素関数$f:D\to\C$の，$p\in D$における極限値とは，次を満たす$\alpha\in\C$のことをいう．
        \[ \forall\varepsilon>0,\;\exists\delta>0,\;0<|z-p|<\delta\Rightarrow|f(z)-\alpha|<\varepsilon \]
        この論理式を$\lim_{z\to p}f(z)=\alpha$と略して書く．
        \item これを用いて，関数が$p\in D$で連続であることを，$f(p)=\lim_{z\to p}f(z)$が成り立つことと定義する．
    \end{enumerate}
\end{definition}

\begin{proposition}[連続性の特徴付け]
    次の３条件は同値である．
    \begin{enumerate}
        \item $\lim_{z\to p}f(z)=\alpha$．
        \item $\lim_{z\to p}\overline{f(z)}=\overline{\alpha}$．
        \item $\lim_{z\to p}\Re f(z)=\Re\alpha\land\lim_{z\to p}\Im f(z)=\Im\alpha$．
    \end{enumerate}
\end{proposition}
\begin{proof}
    $\R^2$の位相構造から遺伝した性質である．直積の普遍性に沿った定義が出来て居ることを確認できる．
\end{proof}

\begin{remark}
    これより，$f$が連続である時，$\overline{f},\Re f,\abs{f}$も連続であることが従う．
\end{remark}

\begin{definition}[complex-differentiable, regular / holomorphic, entire]
    $f:D\to\C$を関数とする．
    \begin{enumerate}
        \item 複素関数$f$が$a\in D$で\textbf{（複素）微分可能}であるとは，極限値$\lim_{z\to a}\frac{f(z)-f(a)}{z-a}$が存在することをいう．
        \item 関数$f$が$D$上の全ての点で微分可能であるとき，関数$f$を\textbf{正則}または\textbf{整型}であるという．
        \item 正則な関数$f:\C\to\C$を\textbf{整関数}という．
    \end{enumerate}
    \begin{quotation}
        「形容詞‘解析’ (analytic) は、むしろ全局的の意味において用いられる。局所的には簡便に正則 (regular) という。フランス系では整型 (holomorphe) ともいう。」
        \begin{flushright}
            （高木貞治『解析概論』p.202）
        \end{flushright}
    \end{quotation}
\end{definition}

こうして関数の正則性の概念にまで到達した．$f:\R^2\simeq\C\to\R^2\simeq\C$が複素微分可能であるとは，
実微分可能であることよりも遥かに強い（CR方程式だけ強い）概念である．ひとまず，
関数についての微積分の議論を抽象するために，次の補題を立てる．

\begin{lemma}[関数の正則性の遺伝と微分法則]\label{lemma-propagation-of-regularity}
    $f,g:D\to\C$を正則関数とする．
    \begin{enumerate}
        \item $f+g,fg,f/g$は（$g$の零点を除いて）正則である．
        \item (Leibniz) 極限値について，$(f+g)'=f'+g', (fg)'=f'g+fg', \left(\frac{f}{g}\right)'=\frac{f'g-fg'}{g^2}\;(g(z)\ne 0)$．
        \item (Chain) $f\circ g$は正則で，$(f\circ g)'=(f'\circ g)\cdot g'$．
    \end{enumerate}
\end{lemma}

\subsection{Cauchy-Riemann方程式とその微分幾何的な意味}

\begin{screen}
    複素微分可能性の定義の本質は「近づけ方が何通りもある」ことである．
    これに耐えるための必要十分条件は，$\C$が2次元であることから，要は$\partial_{\o{z}}$であれば良い．

    また，複素微分は複素数$f'(z_0)\in\C$であるが，これにあたるものを$\R^2$と同型をとってみるとYacobian（微分とは線型主要部で，その表現行列のこと）である．
    従って，複素導値には，Yacobianっぽい関係式があるはずである．これがCR方程式である．
    \textbf{複素数がその構造を共軛によって外在化したように，Yacobianの構造も導関数の中に外在化させた．}
\end{screen}

\begin{example}[正則でない複素数値関数の例]
    関数$f(z)=\o{z}$を考えると，
    \[\frac{f(z_0+h)-f(z_0)}{h}=\frac{\o{h}}{h}\]
    より，$h\to 0$に対して，極限が定まらない．実軸上から近づけると$1$であるが，
    虚軸から近づけると$-1$である．
    しかし，これが定める実関数は$F:(x,y)\mapsto(x,-y)$で，微分可能である．
    この表現行列$\begin{pmatrix}1&0\\0&-1\end{pmatrix}$はYacobian $J_F$そのもので，従って$F\cdot dx=dF$（$F$はその微分と一致）．
    これは無限回微分可能であることを示している．
\end{example}

\begin{discussion}[複素微分可能であるために追加で必要な条件]
    さて，いま，$f$が正則である時，特にx,y軸への偏導関数$f_x,f_y$を考えると，
    \begin{align*}
        f'(z) &= \lim_{h\to 0}\frac{f(z+h)-f(z)}{h} =f_x(z) \\
        f'(z) &= \lim_{h\to 0}\frac{f(z+ih)-f(z)}{ih} =-if_y(z)
    \end{align*}
    となるから，関係式$f_x=-if_y$が成り立つことが必要である．
    これを成分ごとに書き下すことによって得る二本の偏微分方程式を\textbf{コーシー・リーマンの方程式}という．

    となると，逆にこの偏微分方程式を満たす２変数ベクトル値関数$f$は全て正則になるのかが気になる．
    本当にそうなることが期待される（定理\ref{thm-charactorization-of-complex-differentialability}），なんとなく$\R^2$に対して，
    複素構造$J$が生み出す本質的な構造であるような気がするからである．
\end{discussion}

\begin{definition}[Cauchy-Riemann方程式]
    $C^1$級２変数ベクトル値関数$f=\begin{pmatrix}u\\v\end{pmatrix}:\R^2\to\R^2$について，
    次の偏微分方程式を\textbf{コーシー・リーマンの方程式}という．
    \begin{align*}
        \begin{pmatrix}\frac{\partial u}{\partial x}\\\frac{\partial v}{\partial x}\end{pmatrix} &= -J\begin{pmatrix}\frac{\partial u}{\partial y}\\\frac{\partial v}{\partial y}\end{pmatrix}\\
        \Leftrightarrow\begin{pmatrix}\frac{\partial u}{\partial x}\\\frac{\partial v}{\partial x}\end{pmatrix} &= \begin{pmatrix}\frac{\partial v}{\partial y}\\-\frac{\partial u}{\partial y}\end{pmatrix}
    \end{align*}
\end{definition}
\begin{remark}[等角写像の言葉によるCauchy-Riemann方程式の特徴付け]
    これは，ベクトル値実関数$f$のYacobi行列が$\begin{pmatrix}\begin{pmatrix}u_x\\v_x\end{pmatrix}\;\;J\begin{pmatrix}u_x\\v_x\end{pmatrix}\end{pmatrix}$と表される，即ち，$M$に属することを要求して居ることに他ならない．
    従って，Cauchy-Riemann方程式が満たされることは，$f$の定める接空間上の変換$df$が，
    各接空間においては複素数で表されること＝等角変換であることに同値である．
    従って，Cauchy-Riemann方程式の解$f:\R^2\to\R^2$は，各点の接空間を各点ごとに等角に変換する，等角写像である．

    また，等角写像の合成はまた等角写像であることから，Cauchy-Riemann方程式の解は合成について閉じて居ることが予想される．
\end{remark}

\section{Cauchy-Riemann作用素：等角写像性を接空間上で再考}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=見直し予定5/24/2021]
    $\C$の体としての自己準同型は$\{\id,\o{-}\}$からなる．
    複素共役$\o{-}:\C\to\C$のJacobi行列は$J=\begin{pmatrix}1&0\\0&-1\end{pmatrix}$であり，これは反転変換を表す．向きが変わってしまう．
    一方で$\C\simeq M\subset O_2(\R)$であり，任意の正則行列のJacobi行列（微分）は$M$に入っている．
    逆に，これにより正則行列を特徴づけることができる，というのがCauchy-Riemann方程式の意味である．
    この知見より，複素共役$\o{-}:\C\to\C$は正則ではない．一般に$L(z)=\alpha z+\beta\o{z}$は$\R^2$の間の線型写像である．これを考えることで，
    線型写像$f:\R^2\to\R^2$が複素数倍写像であることと，$\partial_{\o{z}}f=0$であることが同値であることがわかる．
\end{tcolorbox}

\begin{screen}
    前節では初等的な考察からCR方程式を導き，それが複素関数$f$のYacobi行列に課される
    条件$J_f\in M$と同値であることとその意味を考察した．

    一方で，このことを微分作用素の代数的に，複素共軛の言葉からの微分作用素$\partial_z,\partial_{\overline{z}}$の満たすべき性質は何かという翻訳を考えたい．
    そもそも，複素数には通常の$\R^2$平面としての微分構造の特殊な場合としても考えられるが，
    複素構造特有の捉え方があるはずである．
    それを象徴するのがWirtingerの偏微分作用素／Cauchy-Riemann作用素（と対応する1-形式）である．
    これは（各接空間において，$\alpha$が定める変換$A$と，複素微分が定める変換$J$とは可換であることからも分かるとおり）複素線型で，
    Leibniz則と連鎖律が成り立つ．即ち，２変数関数$f(z,\overline{z})$と見て，全く実多変数ベクトル値関数$\R^2\to\R^2$の微積分とパラレルに計算が展開できる．
    強力な代数的道具となる．1-形式を用いてCauchyの積分定理を証明するときまで極めて強力な道具となる．

    また，この代数的観点からは，ある複素関数が微分可能であるかのCR方程式は，導関数$\frac{\partial f}{\partial\overline{z}}$が消えて居るかを確認すれば良いだけである．
    この複素関数のための微分(Wirtingerの作用素)からの見方は「複素関数とは，複素数による一変数関数である」という調和した感覚を，方程式の言葉で述べたものである．
    これは\textbf{線型空間の複素化}として一般化されている．
\end{screen}

\subsection{Cauchy-Riemann作用素：複素関数のための偏微分作用素＝接空間の基底}

\begin{discussion}[Cauchy-Riemann方程式を，線型空間の複素化の視点から見直すことを目指す]\label{discussion-CR-equation}
    いま，$f:D\to\C$が$a\in D$で全微分可能とは，或る$\R$-線型写像$L:x+yi\mapsto\alpha x+\beta y$が存在し，$f(a+z)=f(a)+L(z)+o(z)\;(z\in\C)$と表せることと同値で
    あったが，$f$が全微分可能である時$L(x+yi)=f_x(a)x+f_y(a)y=\frac{f_x(a)-if_y(a)}{2}(x+yi)+\frac{f_x(a)+if_y(a)}{2}(x-yi)=f_zz+f_{\overline{z}}\overline{z}$と表せるから，
    或る$\R$-線型写像$L$が存在し，$f(a+z)=f(a)+f_z(a)z+f_{\overline{z}}(a)\overline{z}+o(z)\;(z\in\C)$と表せることと同値
    でもある．この時，Cauchy-Riemann方程式（複素微分可能であるための必要十分条件）はもちろん$f_{\overline{z}}=0$と表される．
\end{discussion}

\begin{definition}[Wirtinger derivative / Cauchy-Riemann operatorとその1-形式]\label{def-CR-operator}
    これは恰も，形式的には基底変換に見える．
    そこで，新たに取った基底$z,\overline{z}$についての偏微分作用素
    \begin{align*}
        \partial_zf&=\frac{\partial}{\partial z}=\frac{1}{2}\left(\frac{\partial}{\partial x}\textcolor{red}{-}i\frac{\partial}{\partial y}\right)\\
        \overline{\partial}=\partial_{\overline{z}}f&=\frac{\partial}{\partial\overline{z}}=\frac{1}{2}\left(\frac{\partial}{\partial x}\textcolor{red}{+}i\frac{\partial}{\partial y}\right)
    \end{align*}
    を\textbf{コーシー・リーマン作用素}という．
    また，対応する1-形式を$dz=dx+idy,d\overline{z}=dx-idy\in\Omega(\C)$と定める：
    \begin{align*}
        dz\left(\frac{\partial}{\partial z}\right)&=1, &d\overline{z}\left(\frac{\partial}{\partial\overline{z}}\right)&=1.
    \end{align*}
\end{definition}

次の美しい代数的法則が成り立つために，どの微分作用素を採用しようと，即ち$x,y$を基底として考えても，$z,\overline{z}$を形式的に独立変数と考えてウルティンガーの微分を考えても，
議論はほぼ並行に展開される．次の補題のように，ウルティンガーの微分は通常の意味の微分が満たすべき性質（補題\ref{lemma-propagation-of-regularity}など）をすべて満たして居る．
\begin{lemma}[微分法則]\label{lemma-Wirtinger-operator}
    ウルティンガーの微分作用素$\frac{\partial}{\partial z},\frac{\partial}{\partial\overline{z}}$について，次が成り立つ．
    \begin{enumerate}
        \item 複素線型である．
        \item Liebniz則が成り立つ．
        \item Chain Ruleが成り立つ．
        \item 複素共軛の構造と整合的である．
        \begin{align*}
            \overline{\frac{\partial f}{\partial z}}&=\frac{\partial \overline{f}}{\partial\overline{z}},&\overline{\frac{\partial f}{\partial \overline{z}}}&=\frac{\partial \overline{f}}{\partial z}
        \end{align*}
    \end{enumerate}
\end{lemma}
\begin{proof}
    全て$f:\C\to\C$を$\R^2\to\R^2$と同一視をして，実数上の既知の議論まで還元すれば確認できる．
\end{proof}

ここで，新たに得たコーシー・リーマン作用素の言葉で，複素微分可能性（コーシー・リーマン方程式）が特徴付けられることをみる．
つまり，全微分可能な$f:\R^2\to\R^2$が正則な$f:\C\to\C$に自然に拡張できるためには，
$f=\begin{pmatrix}u\\v\end{pmatrix}$のそれぞれが微分可能であるだけでなく，
ちょうどCauchy-Riemann方程式という条件を加えたものに等しい．
この条件のチェックには，$\overline{z}$での偏微分を見れば良い，という．

\begin{theorem}[複素微分可能性の特徴付け]\label{thm-charactorization-of-complex-differentialability}
    次の二条件は同値．
    \begin{enumerate}
        \item $f$は$a$で複素微分可能である．
        \item $f$は$a$で全微分可能，かつ，$\partial_{\overline{z}}f(a)=0$である．
    \end{enumerate}
\end{theorem}
\begin{proof}
    1.$\Rightarrow$2.は既に述べたように，実軸と虚軸について近づければ全微分可能だとわかり，その導関数はCauchy-Riemann方程式を，即ち$f_{\overline{z}}(a)=0$を満たす．
    
    $\Leftarrow$は，全微分可能性より$f(a+z)=f(a)+f_z(a)z+f_{\overline{z}}(a)\overline{z}+o(z)\;\;(z\in\C)$と表せるが，$f_{\overline{z}}(a)=0$だから，
    $f(a+z)=f(a)+f_z(a)z+o(z)\;\;(z\in\C)$．これは1.の定義に他ならない．
\end{proof}

\begin{proposition}\label{prop-correspondence-between-complex-derivative-and-Yacobian}
    $f$が$z_0$で正則ならば，
    \begin{enumerate}
        \item $f'(z_0)=\pp{f}{z}(z_0)=2\pp{u}{z}(z_0)$．
        \item $F(x,y)=f(z)$とすると，$F$も実関数として微分可能であり，$\det J_F(x_0,y_0)=\abs{f'(z_0)}^2$．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item \begin{align*}
            \pp{f}{z}&=\frac{1}{2}\paren{\pp{u}{x}+i\pp{v}{x}+\frac{1}{i}\paren{\pp{u}{y}+i\pp{v}{y}}}\\
            &=\frac{1}{2}\paren{\paren{\pp{u}{x}+\pp{v}{y}}+i\paren{\pp{v}{x}-\pp{u}{y}}}\\
            &=2\cdot\frac{1}{2}\paren{\pp{u}{x}+\frac{1}{i}\paren{\pp{u}{y}}}&(\because\mathrm{Cauchy-Riemann}方程式)\\
            &=2\pp{u}{z}
        \end{align*}
        \item
        $H=\begin{pmatrix}h_1\\h_2\end{pmatrix},h=h_1+ih_2$とすると，Cauchy-Riemannの方程式と，$1,i$の定める同型による同一視で，次のように対応がつく：
        \begin{align*}
            J_F(x_0,y_0)(H)&=\begin{pmatrix}\pp{u}{x}&\pp{u}{y}\\\pp{v}{x}&\pp{v}{y}\end{pmatrix}=\begin{pmatrix}h_1\pp{u}{x}+h_2\pp{u}{y}\\h_1\pp{v}{x}+h_2\pp{v}{y}\end{pmatrix}=\begin{pmatrix}h_1\pp{u}{x}+h_2\pp{u}{y}\\-h_1\pp{u}{y}+h_2\pp{u}{x}\end{pmatrix}\\
            &=\paren{\pp{u}{x}-i\pp{u}{y}}(h_1+ih_2)=f'(z_0)\cdot h.
        \end{align*}
        よって，$f'$が存在する時，$F$もYacobianが存在する．

        この時，その行列式は，
        \begin{align*}
            \det J_F(x_0,y_0)&=\pp{u}{x}\pp{v}{y}-\pp{v}{x}\pp{u}{y}=\paren{\pp{u}{x}}^2+\paren{\pp{u}{y}}^2&(\because\mathrm{Cauchy-Riemann}方程式)\\
            &=\Abs{2\pp{u}{z}}^2=\abs{f'(z_0)}^2
        \end{align*}
        と表せる．
    \end{enumerate}
\end{proof}

\subsection{等角写像性を微分幾何の言葉で再考}

\begin{screen}
    等角性とは，各接空間上で接ベクトルが直交することに他ならない．
    Cauchy-Riemann方程式とは，複素関数$f$が各接空間上に定める線型主要部$df$が
    複素線型写像であることを要請する条件であるから，各点でベクトルの角度を保つに決まっている（定理\ref{thm-conformal-Clinear-communicative}）．
\end{screen}

\begin{definition}[conformal]
    $C^1$級複素関数$f:D\to\C$が$p\in D$において等角であるとは，任意の$p$を通る正則な２曲線$\gamma_i:(-1,1)\to D, \gamma_i(0)=p\;(i=1,2)$について，
    これらが$p$でなす角と$\tilde{\gamma_i}:=f\circ\gamma_i$が$p$でなす角が等しいことをいう．
    
    なお，２曲線$\gamma_i$が点$p$でなす角とは，順序も考えて$\arg\left(\frac{\gamma'_1(p)}{\gamma'_2(p)}\right)$と定める．
\end{definition}

\begin{theorem}[等角写像の特徴付け]\label{thm-charactorization-of-conformal-mappings}
    $f$を$C^1$級複素関数とする．次の二条件は同値．
    \begin{enumerate}
        \item $f$は$p$で等角である．
        \item （$f$は$p$で全微分可能，かつ，）$\partial_{\overline{z}}f(p)=0$である．
    \end{enumerate}
\end{theorem}
\begin{proof}
    $f$を$C^1$級とする時，点$p$の接空間$T_p(\C)$上に$f$が定める線型写像（関数のdifferential）は，$(dz)_p,(d\overline{z})_p$を空間$\Hom(T_p(\C),T_p(\C))$の基底として，
    \[ (df)_p=\frac{\partial f}{\partial z}(p)(dz)_p + \frac{\partial f}{\partial\overline{z}}(p)(d\overline{z})_p \]
    と表せる（議論\ref{discussion-CR-equation}）．
    従って，$f$が点$p$にて等角であることは，$(df)_p$が$\C$-線型写像であることと同値で（定理\ref{thm-conformal-Clinear-communicative}），
    それは$\frac{\partial f}{\partial\overline{z}}(p)=0$であることに同値．
\end{proof}
\begin{remark}
    まるで平面$\R^2$の接空間$T_p(\R^2)$上の変換に，見えない自由度$(d\overline{z})_p\in\Hom(T_p(\R^2),T_p(\R^2))$があって，
    その係数が潰れていれば等角写像になる，と言って居るように思える．
    このようなものの見方が複素構造の本質である，と．
\end{remark}

\section{Cauchy-Riemann作用素による微分幾何概観}

\begin{screen}
    今までの章で確認したことを改めて述べ直し，Cauchyの積分定理をベクトル解析の知識から確認する．
\end{screen}

\begin{definition}[複素関数と二変数ベクトル値関数，複素線積分]
    \begin{itemize}
        \item 次の同型射が存在する．
    \[\xymatrix@R-2pc{
        \varphi:\Hom(\R^2\supset D,\C)\ar[r]^-{\sim}&\Hom(\C\supset D',\C)\\
        \rotatebox{90}{$\in$}&\rotatebox{90}{$\in$}\\
        {f(x,y)}\ar@{|->}[r]&g(z(,\overline{z}))=f\left(\frac{z+\overline{z}}{2},\frac{z-\overline{z}}{2i}\right)
    }\]
    逆射はもちろん$g(z,\overline{z})=f(x+yi,x-yi)$とすれば良い．
    この時$z,\overline{z}$は形式的に独立変数として扱って作った同型であるが，$z,\overline{z}$の間の関係をぴったり捉えたのがCauchy-Riemann方程式である．
    これを満たすものを$g(z,\overline{z})$を略記して$g(z)$と書き，複素関数と呼ぶ．

    \item この同型を用いて，$\R^2$上の線積分として成分ごとに計算し，再び複素数に引き戻して値を定義したものを，\textbf{複素線積分}という．
    \end{itemize}
\end{definition}

\begin{itembox}[l]{Cauchy-Riemann equationと同値なもの}
    $f:D\to\C$を全微分可能とする．
    \begin{enumerate}
        \item $f$は正則．
        \item $\partial_{\overline{z}}f=0$．
        \item $f$は等角写像である．
        \item $f$は任意に複素数$\alpha$が定める変換$g_\alpha$と可換である．
    \end{enumerate}
\end{itembox}

\begin{remark}[正則とは？]\mbox{}
    \begin{enumerate}
        \item まるで平面$\R^2$の接空間$T_p(\R^2)$上の変換に，見えない自由度$(d\overline{z})_p\in\Hom(T_p(\R^2),T_p(\R^2))$があって，
        その係数が潰れていれば等角写像になる．
        \item $f$は$\overline{z}$に関数として依存しない（複素解析的であるという意味で）．
    \end{enumerate}
\end{remark}

\begin{definition}[compact convergence / uniform convergence on compact sets]
    位相空間$(X,\mathcal{T})$と距離空間$(Y,d_Y)$間の関数の列$(f_n:X\to Y)_{n\in\N}$
    が，関数$f:X\to Y$に\textbf{コンパクト一様収束}するとは，任意のコンパクト集合$K\subset X$について次が成り立つことをいう：
    \[ \forall\epsilon>0,\;\exists N>0,\;\forall x\in K,\;n>N\;\Rightarrow |f_n|_K(x)-f|_K(x)|<\epsilon.  \]
    即ち，全てのコンパクト集合$K\subset X$について
    \[\lim_{n\to\infty}\sup_{x\in K}d_Y(f_n(x),f(x))=0 \]
    が成り立つことをいう．
\end{definition}

\begin{definition}[analytic]
    $f:D\to\C$が\textbf{複素解析的}であるとは，任意の$p\in D$について，
    $r>0$が存在して，$B_r(p)\subset D$の範囲内で$f$がTaylor展開可能であることをいう．
    つまり，剰余項がコンパクト一様収束をする．
    \[ f(z) = f(p) + \sum^{\infty}_{n=0}\frac{1}{n!}\frac{\partial^nf}{\partial z^n}(p)(z-p)^n\;\;\;(\forall p\in\C,\;\exists r>0,\;\forall z\in B_r(p)) \]
\end{definition}

\begin{theorem}[正則関数は解析的である]
    $f:D\to\C$が正則ならば，複素解析的である．（複素解析的ならばもちろんオーバーキルで正則である．この２つの関数のクラスが一致することが複素解析学の肝の一つである）．
\end{theorem}
\begin{definition}[entire function]
    これより，正則関数$f$の収束半径とは，$f$の最も近い特異点までの距離となる．
    特異点がないならば，$f$が正則ならば即$\C$上全ての点で無限解微分可能ということになる．
    これを\textbf{整関数}という．
\end{definition}
\begin{corollary}[identity theorem]
    連結な領域$D\subset\C$で正則な関数$f$について，その零点集合が$D$上に集積点を持つならば，$f$は$D$上零関数であるとわかる．
    （従って，正則関数に関しては，可算点列上で局所的に一致することを確認すれば，大域的に一致すると分かって決まってしまう）．
\end{corollary}

\begin{theorem}[Cauchy's integral theorem]
    $f:D\to\C$を正則関数とする．閉領域$D'\subset D$は，その境界が区分的$C^1$級の曲線$\gamma_i\;(i=1,\cdots,r)$からなるものとする．
    この時，次が成り立つ．
    \[ \int_{\gamma_1+\gamma_2+\cdots+\gamma_r}f(z)dz=0 \]
\end{theorem}
\begin{proof}
    $f=\begin{pmatrix}u\\v\end{pmatrix}$と表せるとする．すると，$\R^2$上の積分として，Stokesの定理より，
    \begin{align*}
        \int_{\gamma_1+\gamma_2+\cdots+\gamma_r}f(z)dz &= \int_{\gamma_1+\gamma_2+\cdots+\gamma_r}(udx+vdy)\\
        &= \int_{D'}d(udx+vdy)\\
        &= \int_{D'}du\wedge dx+dv\wedge dy\\
        &= \int_{D'}\left(\frac{\partial u}{\partial x}dx+\frac{\partial u}{\partial y}dy\right)\wedge dx+\left(\frac{\partial v}{\partial x}dx+\frac{\partial v}{\partial y}dy\right)\wedge dy\\
        &= \int_{D'}\left(\frac{\partial v}{\partial x}-\frac{\partial u}{\partial y}\right)dx\wedge dy
    \end{align*}
    となるが，今$f$は正則関数であるから，Cauchy-Riemann方程式の実部より，$\frac{\partial v}{\partial x}-\frac{\partial u}{\partial y}=0$．よって，$\int_{\gamma_1+\gamma_2+\cdots+\gamma_r}f(z)dz=0$．
\end{proof}
\begin{remark}[一般の境界付き多様体上のStokesの定理からは例として一瞬で示せる]
    Wirtinger微分の言葉により，Cauchy-Riemann方程式は余接空間上の1-形式の消息に移してあるので，次の議論では一瞬である．
    \begin{align*}
        \int_{\gamma_1+\gamma_2+\cdots+\gamma_r}fdz&=\int_{D'}df\wedge dz&\mathrm{(Stokes' theorem)}\\
        &= \int_{D'}\frac{\partial f}{\partial\overline{z}}d\overline{z}\wedge dz =0
    \end{align*}
    Cauchyの積分定理は，複素平面上の正則関数の周回積分は，homotopyに対して不変であることを主張して居る．
\end{remark}

\begin{corollary}
    $\gamma_1,\gamma_2$は端点が一致する曲線であって，可縮な領域を内部に囲むものとする．
    $f$がその領域を含むある開集合上で正則ならば，次が成り立つ．
    \[\int_{\gamma_1}f(z)dz=\int_{\gamma_2}f(z)dz\]
\end{corollary}

Cauchyの定理の逆については，次の事実が成り立つ．
\begin{theorem}[Morera's theorem]
    連結な領域$D\subset\C$について，連続な複素関数$f:D\to\C$を考える．
    次の２条件は同値である．
    \begin{enumerate}
        \item 任意の区分的$C^1$級の閉曲線について線積分が$0$である
        \item $f$は正則である．
    \end{enumerate}
    2.$\Rightarrow$1.はCauchyの定理と言ったが，1.$\Rightarrow$2.をモレラの定理という．
\end{theorem}

Cauchyの定理は閉領域について成り立つ定理であった，Poincaréの補題により，空間$D'$が可縮であるためpotentialが存在するのである．
では，穴が空いた領域においては，積分値でその穴についての情報を捉えることができる．
これがCauchyの積分公式である．
\begin{theorem}[Cauchy's integral formula]
    開集合$U\subset\C$内の単純閉曲線$C$について，$C$が囲む領域内の点$\xi$で正則関数$f$が取る値に対して，次が成り立つ．
    \[ f(\xi) = \frac{1}{2\pi i}\oint_C\frac{f(z)}{z-a}dz. \]
\end{theorem}

\begin{itembox}[l]{関数のクラスを生み出す関手が微分方程式である}
    正則関数の全体は層をなす．
    微分方程式の正則解は，その部分層を指定していると考えられ，
    Cauchy-Riemann方程式はこの観点から特に重要である．

    また，Laplace方程式は調和関数をうみ，二つは酷似している．
\end{itembox}

\subsection{（概）複素多様体}

複素微分幾何学では，複素多様体が研究される．mirror対称性からは，symplectic幾何学と複素幾何学に何らかの対応性を定式化しようとしている．
それはCalabi yau多様体という，１次元の楕円曲線や２次元のK3曲面の高次元への拡張である複素多様体上で展開されつつある現象である．
\begin{quotation}
    一般にミラー対称性は，２つの物理理論の同値性であり，複素幾何学の問題をシンプレクティック幾何学の問題へ翻訳することでもある．

    今日では，ミラー対称性は純粋数学の主要な研究テーマであり，数学者は物理学者の直観に基づくミラー対称性を数学的に深く理解しつつある．ミラー対称性は弦理論の計算を実行する際の基本的なツールでもある．
\end{quotation}

\begin{definition}[almost complex structure]
    滑らかな多様体$M$上に定義された接束上の自己同型射$J:TM\to TM$で，$J^2=-\id_{TM}$を満たすものを\textbf{概複素構造}という．
    これは$M$上の滑らかな$(1,1)$-テンソル場とも見れる．
\end{definition}
\begin{remark}
    \begin{enumerate}
        \item この概念は1940sのCharles EhresmannとHeinz Hopfによる．
        \item Riemann計量とSymplectic形式と整合性を持つ三つ組(compatible triple)を形成することがある．
        \item 任意の複素多様体は，概複素構造を定める．
        \item $M$が概複素構造を持つならば，$M$の次元は偶数である．
        \item 任意の偶数次元の線型空間には線型複素構造が入る．従って偶数次元の多様体はいつも$(1,1)$-テンソル場を持っており，各点で$J_p^2=-1$を満たす．そして，この局所テンソルを互いに貼り合わせても大域的に定義できる時だけ，各点ごとに定義された線型複素構造は\textbf{複素構造}を与える．
        \item 複素構造のことを概複素構造と区別して\textbf{可積分な}複素構造という．即ち，我々は複素線型写像$f$から接空間上の自己同型$J_f$を得たが，これを逆に局所から大域に辿ることが出来る場合のことを複素多様体という．
        \item 球面で概複素構造を持つものは$S^2,S^6$だけで，$S^2$の場合はRiemann球面から定まるものであるが，$S^6$の場合は，可積分かどうかも分かっていない．(Eresmann and Hopf)．
    \end{enumerate}
\end{remark}

\section{指数関数}

\begin{screen}
    代表的な整関数の源は複素指数関数である．ここから，三角関数や双曲線関数などの代表的な関数が出てくる．
    まずは初等的に，指数関数を実関数の場合と同様，微分方程式によって指定する．
\end{screen}

\begin{discussion}[関数は，微分方程式によって指定する．]
    実解析の場合からの自然な拡張として，次の偏微分方程式\ref{equation-exponential}
    の解$f$として複素指数関数を定義するのが良いと思われる．
    \begin{align}\label{equation-exponential}
        \frac{\partial f}{\partial z}&=f, &\frac{\partial f}{\partial\overline{z}}&=0,&f(0)=1.
    \end{align}
    $f$の存在を認めてその必要条件を探ると，Cauchy-Riemann operatorの関係\ref{def-CR-operator}
    を用いて，
    \begin{align*}
        \frac{\partial f}{\partial x} &= \frac{\partial f}{\partial z} + \frac{\partial f}{\partial\overline{z}}=f\\
        \frac{\partial f}{\partial y} &= i\left(\frac{\partial f}{\partial z}-\frac{\partial f}{\partial \overline{z}}\right)=if
    \end{align*}
    である．これを用いて，まず偏角成分を確定させるために，実関数$|f|$を求めるにあたって，
    \begin{align*}
        \frac{\partial |f|^2}{\partial x} &= \frac{\partial f}{\partial x}\overline{f}+f\frac{\partial\overline{f}}{\partial z}=2|f|^2\\
        \frac{\partial |f|^2}{\partial y} &= \frac{\partial f}{\partial y}\overline{f}+f\overline{\frac{\partial f}{\partial y}} = i|f|^2-i|f|^2=0
    \end{align*}
    と計算でき，従って$|f|^2=:h(x)$とおけば，これは実常微分方程式$h_x=2h,h(0)=1$を満たす．
    従って，$h(x)=Ae^{2x}(A\in\R)$が一般解であるが，正規化して，$|f(z)|=e^x$とわかる．

    ここで，定数変化法より，残る部分を$g(z):=e^{-x}f(z)$と定めると，$x,y$で記述したいのでこれについての偏微分を調査すれば，
    \begin{align*}
        \frac{\partial g}{\partial x} &= -e^{-x}f + e^{-x}f = 0\\
        \frac{\partial g}{\partial y} &= e^{-x}if = ig
    \end{align*}
    を得るから，この常微分方程式を$g(0)=1$と共に解くと，$g(y)=\cos y+i\sin y$．
\end{discussion}

\begin{definition}[complex exponential function]\label{def-微分方程式による指数関数の定義}
    複素指数関数$e^z:\C\to\C$を，実関数$e^x,\cos y,\sin y$を用いて，$e^z:=e^x(\cos y+i\sin y)$によって定義する．
    特に，純虚数$x=0$について，逆に実関数の複素指数関数による表現を得る．
    \begin{align*}
        \cos y&=\frac{e^z+e^{-z}}{2} &\sin y&= \frac{e^z-e^{-z}}{2i}
    \end{align*}
\end{definition}

\begin{remark}[別定義]
    実数の優級数判定法より，$\sum^\infty_{n=0}\frac{z^n}{n!}\le\sum^\infty_{n=0}\frac{|z|^n}{n!}$は絶対収束する．
    よって，定理\ref{thm-冪級数は項別微分できる}から，複素微分可能な関数を$\C$上に定める．これを指数関数と定義しても良い．
\end{remark}

\section{連結性から，正則関数の姿を探る}

\begin{screen}
    連結な定義域上の正則関数が，定数関数となるための条件を考える（定理\ref{thm-inquiries-for-regular-functions-to-be-constant}）．
    そのために，連結性についての位相的な言葉を準備する．
    総合して，これらの議論をするためのものの考え方は極めて微分位相幾何学（ベクトル解析）的であるが，
    欲しい結果のためには，折れ線だけを考えれば非常にすっきり議論できる．

    この節での結果は，正則関数の微分がどこかで消える時，それは多項式関数であるということである．
\end{screen}

\begin{definition}[domain / region]
    連結な開集合を\textbf{領域}という．
\end{definition}
\begin{remark}
    Hahn (1921, p. 85 foonote 1) によれば、連結開集合としての領域の概念を導入したのはコンスタンチン・カラテオドリの有名な著作 (Carathéodory 1918) においてである。ハーンはまた、"Gebiet" ("領域") の語はそれ以前より時折開集合の同義語として用いられていたことも注意している．
    \begin{quote}
        Hahn (1921, p. 61 foonote 3) は開集合 ("offene Menge") の定義を与えたところで、以下のように述べている: "Vorher war, für diese Punktmengen die Bezeichnung "Gebiet" in Gebrauch, die wir (§ 5, S. 85) anders verwenden werden." (訳文: "以前は "Gebiet" の語をこのような点集合を表すのにしばしば用いられていた、そして我々はその語を (§ 5, p. 85) において別な意味で用いている。"
    \end{quote}
\end{remark}

\begin{proposition}
    領域$D$が弧状連結であれば，$D$内の任意の２点は折れ線で繋ぐことができる．
\end{proposition}
\begin{proof}
    $p,q\in D$とし，$\gamma:[0,1]\to D$を$\gamma(0)=p,\gamma(1)=q$を満たす連続関数とし，これらから$p,q$を結ぶ折れ線を構成する．
    ここで，$l:[0,1]\xrightarrow{\gamma}\gamma([0,1])\xrightarrow{d(-,\C\setminus D)}\R$より定めると，これも連続関数となる（平面上の２点についての距離関数$d:\R^2\to\R$も連続であるから）．
    この関数は定義域がコンパクトなので，最小値$m:=\min_{t\in[0,1]}l(t)$が存在する．また，$m>0$である．（$\gamma[0,1]\subset D$はコンパクト，即ち有界閉集合で，$\C\setminus D$も閉集合であるから，その間にある$r>0$の開球が取れる）．
    Heine–Cantorの定理より，コンパクトな定義域上の連続関数は一様連続であることと同値だから，
    特に$m$について，$N$が存在して，$|s-t|<\frac{1}{N}\Rightarrow|\gamma(s)-\gamma(t)|<m$を満たす．
    この$N$について，曲線$\gamma$を$N$等分して得られる点を結んだ折れ線は，$\forall i\in N,\; [p_i,p_{i+1}]\subset D$であるから，折れ線全体も$D$に含まれる．
\end{proof}
\begin{remark}
    一様連続性の使い方が自由自在の夫である．それと，$\gamma$が外部$\C\setminus D$と最接近する距離$m$について，この大きさで等分すれば論理の流れ（最後の１文）が楽というのは良いテクニックである．
\end{remark}

\begin{theorem}[連結な定義域上の正則関数が定数であるための条件]\label{thm-inquiries-for-regular-functions-to-be-constant}
    $f$を領域$D$上の正則な関数とする．
    \begin{enumerate}
        \item $D$上で$f'=0$ならば$f$は定数．
        \item $D$上で$\Re f$が定数であれば$f$も定数．
    \end{enumerate}
\end{theorem}
\begin{proof}
    1. $D$は連結だから，特に任意にとった線分$[p,q]\subset D$上について，$f'=0$ならば$f$は定数であることが示せば良い．
    線分を$\gamma:[0,1]\to D$を用いて$\gamma(t)=tq+(1-t)p$とパラメータ付し，実数上の関数$f\circ\gamma:[0,1]\to\C$を考える．
    $\frac{\partial}{\partial t}f(\gamma(t))=f'(\gamma(t))\gamma'(t)=0$より，両辺を$t$で積分して，$f\circ\gamma$は$[0,1]$上定数関数，よって$f$は$[p,q]$上定数関数．

    2. $\Re f$が定数関数である時，$0=2\partial_z(\Re f)=\partial_zf+\partial_z\overline{f}=\partial_zf+\overline{\partial_{\overline{z}}f}=\partial_zf$より，$f$が正則であるという条件に下で，1.の条件と同値である．
\end{proof}

この定理は，微分の階数$n$についての帰納法により，次のように一般化される．

\begin{proposition}[一般化：多項式関数の特徴付け]
    領域$D$上の正則関数$f$が，$f^{(n)}=0$を満たす時，$f$は$n-1$次以下の$z$についての多項式である．
\end{proposition}

\section{Riemann球面}

\begin{screen}
    複素多様体$\C P^1\simeq S^2$を構成し，その上での関数を考える．
    すると，煩瑣な特異点(zeros and poles)は全て対称的に扱え，真性特異点のみが残り，見通しが良い．

\end{screen}

前節の多項式関数の特徴付けに続いて，今回は有理関数$R(z)=\frac{P(z)}{Q(z)}\;(P,Q\in\C[z])$を考える．これは，$Q$の零点$Z$を除いて$\C$上で正則である．
そこでまず，$Z$での挙動を調べる．

\subsection{多項式の考察}

\begin{theorem}[fundamental theorem of algebra]
    定数でない複素係数多項式$P\in\C[z]$について，$P(z)=0$を満たす$z\in\C$が存在する．
\end{theorem}
\begin{remark}
    代数学の基本定理は、複素数体が、代数方程式による数の拡大体で最大のものであることを示している。これは、体論の言葉で言えば「複素数体は代数的閉体である」 ということになる。
\end{remark}

\begin{corollary}
    $P(z)=a_0+a_1z+a_2z^2+\cdots a_nz^n\;(a_n\ne 0)$とする．相異なる$\alpha_1,\cdots,\alpha_k\in\C$と$m_1,\cdots,m_k\in\N, \sum_{i=1}^km_i=n$が存在して，
    \[ P(z)=a_n(z-\alpha_1)^{m_1}\cdots(z-\alpha_k)^{m_k}, \]
    と表せる．
\end{corollary}
\begin{proof}
    因数定理を再帰的に用いる証明手法について，$n$についての数学的帰納法より．
\end{proof}

\begin{proposition}[multiplicity, degree]\label{prop-multiplicity}
    次の３条件は同値である（ように条件1を定義する）．
    \begin{enumerate}
        \item $\alpha$は$P(z)$の\textbf{$m$位の零点}である．
        \item $P_1(\alpha)\ne 0$の多項式を用いて，$P(z)=(z-\alpha)^mP_1(z)$と表せる．
        \item $P(\alpha)=P'(\alpha)=P''(\alpha)=\cdots=P^{(m-1)}(\alpha)=0$かつ$P^{(m)}(\alpha)\ne 0$．
    \end{enumerate}
\end{proposition}

\subsection{有理式への拡張}

命題\ref{prop-multiplicity}の特徴付は，そのまま有理関数にも適用できる．

\begin{proposition}[pole]
    ひとまず，$P,Q$は共通の零点を持たないとし，
    \[ R(z)=c\frac{(z-\alpha_1)^{m_1}\cdots(z-\alpha_k)^{m_k}}{(z-\beta_1)^{n_1}\cdots(z-\beta_l)^{n_l}} \]
    と表示できたとする．
    この時の$\beta_i$を\textbf{$n_i$位の極}と呼ぶ．
    ひとまずは形式的に，$R(\beta_i)=\infty$と表す．
\end{proposition}

\begin{proposition}
    次の３条件は同値である．
    \begin{enumerate}
        \item $\alpha$は$R$の$m$位の極である．
        \item $\alpha$は$1/R$の$m$位の零点である．
        \item $R_1(\alpha)\ne 0,\infty$を満たす有利関数について，$R(z)=(z-a)^{-m}R_1(z)$と表せる．
        \item $\forall j<m,\; (\lim_{z\to\alpha}|(z-a)^jR(z)|=\infty)\land(\lim_{z\to\alpha}(z-a)^mR(z)\in\C)$．
    \end{enumerate}
\end{proposition}

\subsection{Riemann球面とその上の関数}

$\R^3$内の原点を中心とした単位球面を$S^2$とし，$N:=\begin{pmatrix}0\\0\\1\end{pmatrix}, S:=\begin{pmatrix}0\\0\\-1\end{pmatrix}\in S^2$とする．
\begin{proposition}[stereographic projections]
    $\R^3$からの相対位相について，次の写像$Z',W'$は同相写像である．
    \[\xymatrix@R-2pc{
        {S^2\setminus\{N\}}\ar[r]_-{\sim}^-{Z'}&\R^2&{S^2\setminus\{S\}}\ar[r]_-{\sim}^-{W'}&\R^2\\
        \rotatebox{90}{$\in$}&\rotatebox{90}{$\in$}&\rotatebox{90}{$\in$}&\rotatebox{90}{$\in$}\\
        {p=\begin{pmatrix}\xi_1\\\xi_2\\\xi_3\end{pmatrix}}\ar@{|->}[r]&{Z'(p):=\frac{\xi_1+i\xi_2}{1-\xi_3}}&{p=\begin{pmatrix}\xi_1\\\xi_2\\\xi_3\end{pmatrix}}\ar@{|->}[r]&{W'(p):=\frac{\xi_1-i\xi_2}{1+\xi_3}}
    }\]
    また，この２つの同相写像は，$S^2\setminus\{N,S\}\subset\R^3$上に向きを整合的に定める（いずれも，$S^2$の「外側」が$z$軸上から見た$\R^2$の向きに対応する／貼り合わさる）．
\end{proposition}
\begin{remark}\mbox{}
    \begin{enumerate}
        \item $Z'$は，$\xi_3=0$の時，点を動かさない．$\xi_3>0$の時，$p=\begin{pmatrix}\xi_1\\\xi_2\\\xi_3\end{pmatrix}\mapsto\frac{\xi_1}{1-\xi_3}+i\frac{\xi_2}{1-\xi_3}$へ写す．これは直線$Np$と，$S^2$の赤道(equator)を通る平面との交点となる．一方で$W'$は，それに加えて複素共役（実軸対称）変換を施している，$S^2$を$S$で開いて伸ばした後に，ひっくり返してから$\R^2$に貼り付ける動きである．あるいは，$S^2$を実軸について180度回転してから，$Z'$を施している．
        \item 向きを逆転させている操作が，$\R^2\simeq\C$に複素共軛を作用させている操作に対応している．
    \end{enumerate}
\end{remark}

この同相写像を，２つの極$N,S$について行えば，$S^2$のatlas$\{Z',W'\}$を得る．
実際，このような局所座標系$Z',W'$について，$S^n$は（滑らかな）多様体をなす．
これを$n=2$とし，同型$\R^2\simeq\C$によって得る複素多様体としての$S^2$を，\textbf{リーマン球面}という．
ただし，極には取り扱いを有する．

\begin{definition}[Riemann sphere]
    立体射影$Z'$に，$N\mapsto\infty$を付け加えて得られる同相写像$Z:S^2\to\hat{\C}$，または，
    立体射影$W'$に，$S\mapsto\infty$を付け加えて得られる同相写像$Z:S^2\to\hat{\C}$
    によって定まる複素多様体（複素射影平面）を，\textbf{リーマン球面}という．
\end{definition}
\begin{remark}\mbox{}
    \begin{enumerate}
        \item 従って，$\hat{\C}$上での点列の収束は，同相写像$Z^{-1}$で写した先の$S^2\subset\R^3$上で考える．
        特に，$\hat{\C}$上の点列$\{z_n\}$が$\infty$に収束するとは，$\lim_{n\to\infty}|z_n|=\infty$と同値である（定義？）．
        \item 複素射影平面$\C P^1$でもある．
    \end{enumerate}
\end{remark}

\subsection{有理型関数：Riemann球面上の有理関数}

\begin{screen}
    Riemann球面の局所座標系$Z':S^2\setminus\{N\}\to\C,W':S^2\setminus\{S\}\to\C$を用いて，
    Riemann球面上の関数の扱いを定義していく．
    即ち，Riemann球面上の点がどの局所座標で表されるかで場合分けをして，適時座標変換を使いながら，定義していく．
\end{screen}

\begin{proposition}[有理関数の拡張]
    有理関数$R:\C\setminus Z\to\C$について，極では$R(z)=\infty\;(z\in Z)$とし，$R(\infty):=\lim_{|z|\to\infty}R(z)$として$R:\hat{\C}\to\hat{\C}$と見做す．
    この関数は連続である．
\end{proposition}
\begin{proof}
    有理関数$R:\C\setminus Z\to\C$は$\C$上連続であるから，極の周りでの連続性を新たに確認すれば良い．
\end{proof}

\begin{definition}[$\hat{\C}$-値正則関数 meromorphic functions:  holomorphic function with values in the Riemann sphere]
    $f:\C\supset U\to\hat{\C}$が正則であるとは，局所座標系$\{Z',W'\}$について正則であることをいう．即ち，
    \begin{enumerate}
        \item $f(p)\in S^2\setminus\{N\}$の時，$\C$-値関数$Z'\circ f:U\to S^2\setminus\{N\}\to\C$が$p$の近傍で正則．
        \item $f(p)\in S^2\setminus\{S\}$の時，$\C$-値関数$W'\circ f:U\to S^2\setminus\{S\}\to\C$が$p$の近傍で正則．
    \end{enumerate}
    が成り立つことをいう．$\hat{\C}$-値正則関数を\textbf{有理型関数}ともいう．
\end{definition}
\begin{remark}\mbox{}
    \begin{enumerate}
        \item 有理型関数は，有理関数が多項式関数の商であるのと同様，正則関数の商として表せるからである．
        \item これはつまり，解析接続を使って除きうる特異点を解消してやれば，有理型関数同士で四則演算をとったものはやはり有理型であることから従う．従って，（同じ領域で定義される）有理型関数の全体の成す集合は体を成す．\textbf{この体は複素数体の拡大体である}．
        \item だんだんものすごく層っぽくなってきた？
        \item 「複素多様体上で，極以外の特異点を持たない正則関数のこと」とも説明される．これは即ち，リーマン球面上で上の定義の意味で「正則」である，つまり「リーマン球面への正則関数であって、常に$\infty$の値をとる定数関数ではないもの」のことを意味する．この時極とは$f^{-1}(\infty)$の元である．
        \item 極のことを\textbf{仮性特異点}といい，極でも可除でもない特異点を\textbf{真性特異点(essential singularity)}という．
    \end{enumerate}
\end{remark}

\begin{proposition}
    有理関数$R:\C\to\C$は，有理型関数である．
\end{proposition}

\begin{definition}[$\hat{\C}$-上正則関数]
    関数$f:S^2\supset U\to\C$が正則であるとは，任意の$p\in U$について，
    \begin{enumerate}
        \item $p\ne\infty$ならば，$f(z)$が$p$近傍で$\hat{\C}$-値正則，
        \item $p=\infty$ならば，$f(1/z)$が$z=0$近傍で$\hat{\C}$-値正則
    \end{enumerate}
    であることをいう．ただし，$f(1/0)=\infty$とする．
\end{definition}

\begin{definition}[degree of zeros and poles]\label{def-degree-of-zeros-and-poles}
    有理関数$R:\hat{\C}\to\hat{\C}$が，$R(p)=0$を満たす時$p\in\hat{\C}$をその\textbf{零点}，$R(p)=\infty$を満たす時$p\in\hat{\C}$をその\textbf{極}という．

    $p=\infty$が零点または極である時の\textbf{位数}を，$\tilde{R}(w):=R(\frac{1}{w})$と置く時の関数$\tilde{R}$の$w=0$における位数として定義する．
\end{definition}
\begin{discussion}
    有理関数を
    \begin{align*}
        R(z)&=\frac{a_0+a_1z+a_2z^2+\cdots+a_nz^n}{b_0+b_1z+b_2z^2+\cdots+b_mz^m}\\
        &=w^{m-n}\frac{a_0w^n+a_1w^{n-1}+\cdots+a_{n-1}w+a_n}{b_0w^m+b_1w^{m-1}+\cdots+b_{m-1}w+b_m}=\tilde{R}(w)
    \end{align*}
    と置くと，分子の次数が大きい$m>n$時，$\tilde{R}$は$w=0$で$m-n$位の零点を持つ．
    分母の字数が大きい$n>m$時，$\tilde{R}$は$w=0$で$n-m$位の極を持つ．

    すると，$\hat{\C}$上の有理関数$R$の零点の位数の和は
    \begin{align*}
        &n+\begin{cases}
            m-n,&(m>n),\\
            0,&(m<n)
        \end{cases}\\
        =&\max\{m,n\}.
    \end{align*}
    同様に極の位数の和も$\max\{m,n\}$．
\end{discussion}

\begin{definition}[degree of rational functions]
    $\max\{m,n\}$を，有理関数$R$の\textbf{位数}とする．
\end{definition}

\begin{theorem}[有理関数の根の個数と全単射になる条件]\label{thm-1-degree-meromorphism-is-bijective}
    有理関数$R(z)$の位数を$m$とする．任意の$a\in\hat{\C}$に対して$R(z)=a$は$\hat{\C}$上に重複も含めて$m$個の解を持つ．
    
    従って，この意味で$R:\hat{\C}\to\hat{\C}$は$m$対１写像である：$|R^{-1}(a)|=m\;(\forall a\in\hat{\C})$．
    特に，$m=1$の時，有理関数$R$は$\hat{\C}$上の全単射を定める，これを\textbf{メビウス変換}という．
\end{theorem}
\begin{proof}
    $a=\infty$の時，$|R^{-1}(\infty)|$は（定義\ref{def-degree-of-zeros-and-poles}上）極の位数の和だから$=m$．
    $a\in\C$の時，$R(z)$の位数と$R(z)-a$の位数と$R-a$の零点の個数と$R(z)=a$の根の重複度を含めた個数は等しい．
\end{proof}

\subsection{貼り合わせによる特徴付けとMöbius変換}

リーマン球面の２つの局所座標系$Z,W$の間の座標変換を考える．
\begin{proposition}[gluing function of the Riemann sphere]
    まず，$\C^*:=\C\setminus\{0\}$として，次の同相写像$\varphi$が座標変換となっている．
    \[\xymatrix@R-2pc{
        &{S^2\setminus\{S,N\}}\ar[ddl]_-{Z'}\ar[ddr]^-{W'}&\\
        { }&{ }&{ }\\
        \C^*\ar[rr]^-{\varphi}_-{\sim}&&\C^*\\
        \rotatebox{90}{$\in$}&&\rotatebox{90}{$\in$}\\
        z\ar@{|->}[rr]&&{w:=\frac{1}{z}}
    }\]
    即ち，Riemann球面$S^2$は，２つの複素平面を同相写像$\varphi$によって貼り合わせて得る多様体である．
\end{proposition}
\begin{proof}
    \[Z(p)W(p)=\frac{\xi_1+i\xi_2}{1-\xi_3}\frac{\xi_1-i\xi_2}{1+\xi_3}=\frac{\xi_1^2+\xi_2^2}{1-\xi_3^2}=1\;(\forall p\in S^2\setminus\{N,S\})\]
\end{proof}

\begin{definition}[Möbius transformation / homography / a linear fractional transformation / a fractional linear transformation]
    複素線型写像（＝等角写像）のなす圏$\FinVect_\C$上の自己同型群$\Aut{\hat{\C}}$の元(biholomorphisms, i.e. bijective conformal transformations)を\textbf{メビウス変換}または\textbf{一次（分数）変換}という．
    定理\ref{thm-1-degree-meromorphism-is-bijective}より，位数が１の有理関数がこれに当てはまり，またこれに尽きるから，一般には$f(z)=\frac{az+b}{cz+d}, \det\begin{pmatrix}a&b\\c&d\end{pmatrix}\ne 0$と表示できる．
\end{definition}

「一次変換」と言われると線型変換と紛らわしいが，実際，線型変換の作用によって理解できる．
\begin{proposition}
    メビウス変換のなす群$\Aut{\hat{\C}}$は射影線型群（一般線型群の中心による剰余群）$\PGL_2(K):=\GL_2(K)/\{\lambda I\mid \lambda\in K^\times\}$の$K=\C$である場合と同型である．
\end{proposition}
\begin{remark}\mbox{}
    \begin{enumerate}
        \item （一般，特殊）射影線型群は，射影空間に忠実に作用する群のことである．群作用において忠実とは，$\forall g,h\in G,\;\exists x\in X,\; gx\ne hx$が成り立つことをいう．
        \item $K=\R,\C$の時，特殊射影線型群とも同型である：$\PSL_2(K)=\SL_2(K)/\pm I$．これは射影直線に作用する．
    \end{enumerate}
\end{remark}

\section{Schwartzian derivativeによる一次変換の特徴付け}

\begin{definition}[Schwartzian derivative]
    正則関数$f$に対する次の微分作用素$S$を，\textbf{シュワルツ微分}という．
    \[(Sf)(z):=\left(\frac{f''}{f'}\right)'-\frac{1}{2}\left(\frac{f''}{f'}\right)^2=\frac{f'''}{f'}-\frac{3}{2}\left(\frac{f''}{f'}\right)^2\]
\end{definition}

\begin{proposition}[シュワルツ微分作用素は，Möbius変換の下で不変である]
    シュワルツ微分作用素は，Möbius変換の下で不変である．
\end{proposition}

\begin{proposition}
    正則関数$f$について，次の２条件は同値である．
    \begin{enumerate}
        \item 正則関数$f$は，位数$1$の有理関数$R$，即ちMöbius変換である．
        \item シュワルツ微分が$0$になる：$Sf=0$．
    \end{enumerate}
\end{proposition}

\section{演習}

\chapter{冪級数}

\begin{quotation}
    一度に無限個の項の和を考えることは出来ないから，有限和を用いた近似列の極限として無限和を捉える．（近似列について何かしらの言及をし，これを帰納法を用いて極限への言及について引き上げる）．
    極限の概念が定義できるのは，射の上に於てのみである．
    （物理学が近似の学問であるとしたら，その有限範囲の極限としての無限を考える射の学問が数学と言えるのではないだろうか）．

    そしてこの級数の方法において，複素関数を無限和（＝有限範囲での近似の極限）として表すことができる．
    この媒介をするのが線型代数の言葉であり，関数の空間と列の空間との間に，基底を定めることによって同型が定まり，この対応を媒介してくれる．

    そして整関数を定義し，微分やその他の諸属性を証明するのは，無限列の空間上に於てである．
    従って，「積分と微分の交換」や「微分と極限の交換」と言った射の可換性の証明が最後まで問題となる．

    極限というものの本質として，議論が必然的に圏論的になる．

    最後に，複素微分というものは，冪級数の方法即ち極限の言葉によって定義できる関数のクラスに極めて親和性の高い作用素で，
    この極限とこの微分とは無条件に可換になる（定理\ref{thm-冪級数は項別微分できる}）．
\end{quotation}

\begin{remark*}
    なんとなく冪級数が苦手な理由が，可換性が見えにくいからだと思っている．不等式とは射ではないのか．
    となると，複素指数関数の定義などでの収束の評価では，
    \[\Abs{\frac{z^n}{n!}}=\frac{\abs{z}^n}{n!}\]
    を利用して，$\abs{e^z}$を$e^{\abs{z}}$で評価できる．三角不等式は$+$という関数に対する同じような関係である．
    $f$を連続写像として，$\mathrm{abs}\circ f\le f\circ\mathrm{abs}$の関係が遍在する．
\end{remark*}

\section{級数とは無限和}

\begin{screen}
    級数とは無限和である．無限和を定義するには，有限部分和の列の極限として定義する．
    級数について絶対収束という条件さえ満たせば，複素数上の和についての法則は複素数列の上にも遺伝し，
    和の結合性，可換性，積の分配性が同様に成り立つことが保証される．
\end{screen}

\begin{definition}[級数の収束]
    複素数列$\{a_n\}_{n\in\N}$が定める級数$\sum_{n=0}^\infty a_n$が収束するとは，
    部分和の列$\left\{S_N:=\sum^N_{n=0}a_n\right\}$が収束することをいう．

    このとき特に，級数$\sum^\infty_{n=0}|a_n|$も収束するとき，特に\textbf{絶対収束}という．
\end{definition}

\begin{proposition}[和の可換性]
    絶対収束する級数は，和を取る順序を変えても収束する．
    即ち，級数$\sum^\infty_{n=1}a_n$が絶対収束するとき，任意の全単射$\sigma:\N\xrightarrow{\sim}\N$に対して$\sum^\infty_{n=0}a_{f(n)}$も収束し，極限値は一致する．
\end{proposition}
\begin{proof}
    部分和の列$\left(S_N:=\sum^N_{n=0}|a_n|\right)_{n\in\N}$は収束するから，この極限を$S\in\R$と置く．

    まず，新たな列$\left(T_n\right)_{n\in\N}$を$T_n=S_{\max_{1\le i\le n}f(i)}$で定めると，この列は収束し，$\lim_{n\to\infty}T_n=S$であることを示す．
    作り方から，値域について$\{T_n\}\subset\{S_n\}$であるから，列$(T_n)$は上に有界．
    また$(T_n)$は単調増加列であることより，確かに実数列$(T_n)$は収束する：$\lim_{n\to\infty}T_n\le S$．
    これから，$\lim_{n\to\infty}T_n\ge S$でもあることをみる．任意の$\epsilon>0$に対して，十分大きな$N>0$が存在して
    \[ S-\epsilon<S_n(<S)\;\;\;(n\ge N) \]
    が成り立つから，$N':=\{f^{-1}(N),N\}$と取れば，$n\le \max_{1\le i\le n}f(i)$より$T_n=S_{\max_{1\le i\le n}f(i)}\ge S_n$（等号成立は，$f|_{n+1}:\{0,1,\cdots,n\}\to\{0,1,\cdots,n\}$が全単射である時）より，
    \[S-\epsilon<S_n\le T_n(<S)\;\;\;(n>N')\]
    が成り立つ．よって，$\lim_{n\to\infty}T_n=S$．

    最後に，この$(T_n)$を用いて，$\left(S'_N:=\sum^N_{n=0}|a_{f(n)}|\right)_{n\in\N}$が$S$に収束することを示す．この列$(S'_N)$も単調増加列で，$S'_N\le T_N\;(N\in\N)$であるから極限値をもち，これを$S'$とすれば$S'\le S$である．
    $S\le S'$を示す．いま$(T_n)$は$S$に収束するから，任意の$\epsilon>0$に対して，十分大きな$N$を取れば，
    \[S-\epsilon<T_n(<S)\;\;\;(n\ge N)\]
    を満たす．
    このとき，$N$に対して$M:=\max_{1\le i\le N}f(i)$と置けば$T_N=a_0+a_1+\cdots+a_M$であるが，さらに$N'=\max_{1\le i\le M}f^{-1}(i)$と置けば，$N'\ge N$で，
    \[S-\epsilon<T_N\le S'_n(<S)\;\;\;(n>N')\]
    が成り立つ．
    よって，$S=S'$．
\end{proof}

\begin{proposition}[無限和についての分配法則]\label{prop-distributive-law-for-infinite}
    級数$\sum^\infty_{n=1}a_n,\sum^\infty_{n=0}b_n$が絶対収束するとする．
    このとき，$c_m:=\sum^m_{n=1}a_nb_{m-n}$と置けば，級数$\sum^\infty_{n=0}c_n$も絶対収束し，
    \[ \left(\sum^\infty_{n=1}a_n\right)\left(\sum^\infty_{n=1}b_n\right)=\sum^\infty_{n=0}c_n \]
    が成り立つ．
\end{proposition}
\begin{proof}
    $d_m:=\sum^m_{n=0}|a_nb_{m-n}|$と置くと，三角不等式より$|c_m|\le d_m\;(\forall m\in\N)$．
    ここで，
    \begin{align*}
        \sum^N_{k=0}d_k&=\sum_{n+m\le N}|a_n||b_n|&（有限和の可換性）\\
        &\le\sum^N_{n=0}|a_n|\cdot\sum^N_{n=0}|b_n|
    \end{align*}
    であるが，右辺は収束するから，$\sum^\infty_{n=0}d_n$も収束する．よって$\sum^\infty_{n=0}|c_n|$も収束する．

    続いて，$\left(\sum^N_{n=0}a_n\right)\left(\sum^N_{n=0}b_n\right)=\sum^N_{n=0}c_n$が$N\to\infty$の極限では成り立つことを示す．
    \begin{align*}
        \left(\sum^N_{n=0}a_n\right)\left(\sum^N_{n=0}b_n\right)-\sum^N_{n=0}c_n&=\sum^{2N}_{n=N+1}c_n
    \end{align*}
    であるが，$\left\{\sum^N_{n=1}c_n\right\}$，特に$\left\{\left|\sum^N_{n=1}c_n\right|\right\}$はCauchy列であるから，右辺は任意の$\varepsilon>0$に対して，$N$を十分大きくとれば
    \[\left|\sum^{2N}_{n=0}c_n-\sum^{N}_{n=0}c_n\right|=\left|\sum^{2N}_{n=N+1}c_n\right|<\varepsilon\]
    と出来る．よって，
    \[\left|\left(\sum^N_{n=0}a_n\right)\left(\sum^N_{n=0}b_n\right)-\sum^N_{n=0}c_n\right|\xrightarrow{N\to\infty} 0.\]
    よって，
    \[\left(\sum^\infty_{n=1}a_n\right)\left(\sum^\infty_{n=1}b_n\right)=\sum^\infty_{n=0}c_n\]
\end{proof}

\section{冪級数と収束半径}

\begin{definition}[power series / série entiére, formal power series]\mbox{}
    \begin{enumerate}
        \item $c\in\C$中心の\textbf{冪級数}または\textbf{整級数}とは，収束列と中心点の組$(\{a_n\}_{n=0}^\infty,c)$に対して定義される級数
        \[ \sum^\infty_{n=0}a_n(z-c)^n \]
        のことをいう．
        \item 特に収束性の議論をする以前の，$z$を一般の可換環$R$上を走る不定元と見る時，多項式の無限への拡張となっており\textbf{形式的冪級数}という．
        形式的に定義された和と積について再び可換環となり，これを$R[[z]]$と書く．
    \end{enumerate}
\end{definition}

しばらくは簡単のために，冪級数の中心は原点$c=0$とする．
あとで平行移動を考えれば良い．

\begin{definition}[radius of convergence]
    原点中心の冪級数$\sum^\infty_{n=0}a_nz^n$に対して，これが絶対収束する$z$の範囲を
    \[D:=\left\{z\in\C\;\middle|\;\sum^\infty_{n=0}|a_nz^n|<\infty\right\}\]
    と定めると，$D$は$\C$上の開または閉の円板となる（実数列についての優級数判定法より）．
    この$D$の内部は$D^\circ=\Delta(0,R)$と表せ，この半径$R$を\textbf{収束半径}と呼ぶ．
    ただし，$D=\{0\}$の時は$R=0$，$D=\C$の時は$R=\infty$とした．
\end{definition}

即ち，絶対収束の事象は，同心円上の同値類$[r]$で起こり，収束半径の内部なら任意の$[\rho]$で絶対収束する．
一方$[R]$上での事象は$\theta$にも依る場合が多く，一概には言えない．

\begin{theorem}
    冪級数$S(z)=\sum^\infty_{n=0}a_nz_n$の収束半径を$R>0$とする．
    \begin{enumerate}
        \item 任意の$0<\rho<R$に対して，冪級数$S(z)$は閉円板$[\Delta(0,\rho)]$上で一様に絶対収束する．
        \item $|z|>R$ならば，$S(z)$は発散する．
    \end{enumerate}
\end{theorem}
\begin{proof}
    2. 対偶命題：$S(z)$が収束するならば$|z|\le R$であることを示す．
    今点$z_0$（$|z_0|=:r$とする）で$S(z_0)=\sum^\infty_{n=0}a_nz_0^n$は収束するとする．すると，Cauchy列でもあることより特に$\lim_{n\to\infty}a_nz_0^n=0$であるから，従って列$(a_nz_0^n)$は有界列であり，$\exists M\ge 0,\;\forall n\in\N,\; |a_nz_0^n|\le M$．
    すると，任意の$|z|\le s<r(=|z_0|)$を満たす$z\in\C$と$s\in\R$について，$\frac{s}{r}\le\frac{|z|}{|z_0|}$より，
    \[ |a_nz^n|\le |a_nz_0^n|\left(\frac{s}{r}\right)^n\le M\left(\frac{s}{r}\right)^n\;\;\;(\forall n\in\N). \]
    この時右辺は$\frac{s}{r}<1$より収束するから，$S(z)$は閉円板$[\Delta(0,s)]$にて一様に（＝$z$に依らず）絶対収束する．$s$は$s<r$を満たすように任意に取ったから，$S(z)$は開円板$[\Delta(0,s)]$にて一様に絶対収束する．
    従って，$\Delta(0,r)\subset \Delta(0,R)=D^\circ\subset D$より，$r\le R$．

    1. $\rho<|z_0|<R$を満たす点$z_0\in D^\circ$にて$S(z_0)$は絶対収束するから，2.での議論より，$(0<)\rho<|z_0|$を満たす$\rho$について$S(z)$は閉円盤$[\Delta(0,\rho)]$上で一様に絶対収束する．
\end{proof}

次の補題が抽出できる．

\begin{lemma}
    $t>0$とし，$\lim_{n\to\infty}a_nt^n$が収束するとする．$|z|<t$ならば，$\sum^\infty_{n=0}a_nz^n$は絶対収束し，$\lim_{n\to\infty}a_nz^n=0$である．
\end{lemma}

\subsection{上極限を用いた収束半径の表示とd'Alembertによる計算法}

\begin{screen}
    上極限の概念$\limsup$は，実数列の特徴量を，\textbf{上限による漸近列の極限}を用いて捉える．
    「無限列の値域の上限の極限」という形で２回射の極限を取ることになるので，
    随分巧妙なwell-defined性をhackした記法である．
\end{screen}

\begin{definition}[superior limit]
    実数列$(x_n)_{n\in\N}$の\textbf{上極限}とは，
    \begin{enumerate}
        \item $\lim_{n\to\infty}x_n=\infty$の時，$\limsup x_n=\infty$．
        \item そうでない時，数列$(\sup\{x_m\mid m\textcolor{red}{\ge}n\})_{n\in\N}$の極限$\limsup x_n=\lim_{n\to\infty}\sup_{m\ge n}x_m\in [-\infty,\infty)$．
    \end{enumerate}
    と定める．$\overline{\lim}$とも書く．
\end{definition}

\begin{proposition}[上極限の特徴付け]\label{prop-characterization-of-limsup}
    有界な実数列$(x_n)_{n\in\N}$について，$\limsup x_n=x\in\R$とは，次の２条件に同値．
    \begin{enumerate}
        \item $\forall\varepsilon>0,\;\exists N>0,\; n\ge N\Rightarrow x_n<x+\varepsilon$，
        \item $(x_n)$は$x$に収束する部分列を持つ．
    \end{enumerate}
\end{proposition}
\begin{proof}
    $\Rightarrow$について．$\limsup x_n=x\in\R$とすると，列を$(y_n:=\sup\{x_m\mid m\ge n\})_{n\in\N}$と定めればこれは単調減少列となる．
    $\epsilon>0$を任意の取ると，$\lim_{n\to\infty}y_n=x$よりある$N$が存在して$n>N\Rightarrow|y_n-x|<\epsilon$が成り立つ．$x_n\le\sup\{x_m\mid m\ge n\}=y_n\;(\forall n\in\N)$と併せて，$(y_n)$が単調減少列であることに注意して，
    $x_n\le y_n<\epsilon+x$を得る．
    また，$\{y_n\}\cap\{x_n\}$に対して，順番通りに$\N$から附番すれば，$x$に収束する$(x_n)$の部分列を得る．

    $\Leftarrow$について．$(y_n:=\sup\{x_m\mid m\ge n\})_{n\in\N}$と定めると，これは$(x_n)$の部分列であるから，1が成り立つ．
\end{proof}
\begin{remark}
    $(x_n)$の$x$に収束する部分列は順序構造を持つはずで，それについての言及がないのは本当に同値になるのだろうか？
    「存在が保証されているところの，$(x_n)$の$x$に収束する部分列のうち最大のものをとれば，$(y_n)$はその部分列だから，$(y_n)$も$x$に収束する」と論じたい．
\end{remark}

\begin{theorem}[冪級数の収束半径は係数列から定まる (Hadamard)]\label{thm-Hadamard}
    冪級数$\sum^\infty_{n=0}a_nz_n$の収束半径は
    \[ R^{-1}=\limsup_{n\to\infty}\sqrt[n]{|a_n|} \]
    と表せる．ただし，$R=0$の時は$R^{-1}=\infty$とする．
\end{theorem}
\begin{proof}
    $\sum^\infty_{n=0}a_nz^n$が$z\in\Delta(0,R)$で収束するとする．この時$(a_nz^n)$は$0$に収束するから特に有界であり，$\exists M\ge 0,\; \forall n\in\N,\; |a_nz^n|\le M$．
    これより，$\sqrt[n]{|a_n|}\le\frac{\sqrt[n]{M}}{|z|}$だから，
    \[ \limsup\sqrt[n]{|a_n|}\le\lim_{n\to\infty}\frac{\sqrt[n]{M}}{|z|}=\frac{1}{|z|}. \]
    $|z|$はいくらでも$R$に近く取れるから，特に
    \[ \limsup\sqrt[n]{|a_n|}\le\frac{1}{R}. \]
    （この全称量化子を除去する論理的言い換えについて，対偶を確認する：$\limsup\sqrt[n]{|a_n|}>\frac{1}{R}$ならば，あるより小さい実数$r<\frac{1}{R}$が存在して，$\limsup\sqrt[n]{|a_n|}>r$を満たす．これは論理的に必ず正しい）

    逆向きの不等式$R\ge(\limsup\sqrt[n]{|a_n|})^{-1}$を得るには，$|z|(<\rho)<(\limsup\sqrt[n]{|a_n|})^{-1}$を満たす全ての$z$において$S(z)$は絶対収束することを示せば良い．
    上極限の特徴付け（命題\ref{prop-characterization-of-limsup}）の1より，$\epsilon$を十分小さく取ることで，十分大きな$N$に対して
    \[ \sqrt[n]{|a_n|}<\limsup\sqrt[n]{|a_n|}+\epsilon<\frac{1}{\rho}\;\;\;(\forall n>N) \]
    が成り立つから，
    \[ (\sqrt[n]{|a_n|})^n|z|^n=|a_nz^n|<\left|\frac{|z|}{\rho}\right|\;\;\;(n>N) \]
    $\frac{|z|}{\rho}<1$より，$S(z)$は絶対収束することがわかる．
\end{proof}

\begin{proposition}[d'Alembertの公式]\label{prop-d'Alembert's-formula}
    冪級数$\sum^\infty_{n=0}a_nz_n$の係数列$(a_n)$について，極限$\lim_{n\to\infty}\frac{|a_n|}{|a_{n+1}|}$が収束するならば，
    この値は元の冪級数の収束半径である：
    \[ R=\lim_{n\to\infty}\frac{|a_n|}{|a_{n+1}|}. \]
    また，$\lim_{n\to\infty}\frac{|a_n|}{|a_{n+1}|}=\infty$の時，$R=\infty$．
\end{proposition}
\begin{remark}
    d'Alembertの収束判定法というと，値$\lim_{n\to\infty}\frac{|a_n|}{|a_{n+1}|}$と1との大小関係によって，
    級数$\sum^\infty_{n=0}a_n$の収束性が議論できる，という「十分遠くの等比数列による近似」の手法であった．
\end{remark}
\begin{proof}
    $\lim_{n\to\infty}\frac{|a_n|}{|a_{n+1}|}=:r$と置くと，
    $\Delta(0,r)$上で冪級数$\sum^\infty_{n=0}a_nz_n$は一様絶対収束，$|z|>r$ならば冪級数は発散することを示す．

    $z\ne 0$を複素数とし，$t:=\frac{|z|+r}{2|z|}$と置く．
    すると，$0<|z|<r$ならば，$t:=\frac{|z|+r}{2|z|}<\frac{r+r}{2|z|}$であるから，
    \[ 1<t<\frac{r}{|z|}=\lim_{n\to\infty}\frac{|a_n|}{|a_{n+1}|}\frac{1}{|z|}=\lim_{n\to\infty}\frac{|a_nz^n|}{|a_{n+1}z^{n+1}|}. \]
    従って，
    \begin{align*}
        &\exists N>0,\;n\ge N\Rightarrow\frac{|a_nz^n|}{|a_{n+1}z^{n+1}|}\ge t\\
        \Leftrightarrow\;\;\; &\exists N>0,\;n\ge N\Rightarrow|a_nz^n|\le t^{N-m}|a_Nx^N|
    \end{align*}
    よって，右辺について$\frac{1}{t}<1$より，級数$|a_Nz^N|t^N\sum^\infty_{n=N}\left(\frac{1}{t}\right)^n$は収束するから，級数$\sum^\infty_{n=0}a_nz^n$も絶対収束する．

    同様にして，$|z|>r$の時，$\lim_{n\to\infty}|a_nz^n|=\infty$であるから，級数$\sum^\infty_{n=0}a_nz^n$は発散する．
\end{proof}

\begin{lemma}
    次が成り立つ：
    \[ \liminf_{n\to\infty}\frac{|a_{n+1}|}{|a_n|}\le\liminf_{n\to\infty}\sqrt[n]{|a_n|}\le\limsup_{n\to\infty}\sqrt[n]{|a_n|}\le\limsup_{n\to\infty}\frac{|a_{n+1}|}{|a_n|}. \]
    従って，$\lim_{n\to\infty}\liminf_{n\to\infty}\frac{|a_{n+1}|}{|a_n|}$が収束する時，$\lim_{n\to\infty}\sqrt[n]{|a_n|}$も収束する．
\end{lemma}

\begin{example}[収束円の境界上での消息：Abelの変形法]
    $a\in\R$について定まる冪級数
    \[ f_a(z)=\sum^\infty_{n=1}n^az^n \]
    の収束円周$|z|=R=1$上での収束性について，次が成り立つ．
    \begin{enumerate}
        \item $a<-1$であれば，$|z|=1$上絶対収束する．
        \item $-1\le a<0$であれば，$z=-1$で発散，それ以外で収束．
        \item $0\le a$であれば，$|z|=1$上発散．
    \end{enumerate}
\end{example}
\begin{proof}
    級数$f_a(1)=\sum^\infty_{n=1}n^a$は，$a<-1$の時収束，$a\ge -1$の時発散するのであった．
    だから，$a<-1$の時は$|z|=1$上絶対収束，$a\ge 0$の時は各項が$|n^az^n|\ge 1$であるから発散．
    そこで，$a\in[-1,0)$の場合を考える．

    ここで，級数$\sum^\infty_{n=0}z^n$を考え，その部分和の列を$(S_n:=1+z+z^2+\cdots+z^n)_{n\in\N}$と置く（アーベルのトリック）．
    すると，級数$f_a(z)$の部分和は
    \begin{align*}
        \sum^N_{n=1}n^az^n&=\sum^N_{n=1}n^a(S_n-S_{n-1})\\
        &= -S_0+\sum^{N-1}_{n=1}(n^a-(n+1)^a)S_n+N^aS_N
    \end{align*}
    と分解できる．
    \begin{description}
        \item[$z\ne -1$の時] \[ |S_n|=\left|\frac{1-z^{n+1}}{1-z}\right|\le\frac{2}{|1-z|} \]
        と$a$に依らずに評価できる．また，関数$y(x)=x^a$に関する$[n,n+1]$上での平均値の定理より，$a\in[-1,0)$に注意して
        \[\exists\theta\in(0,1),\;\;n^a-(n+1)^a=-a(n+\theta)^{a-1}\le -an^{a-1}\]
        だから，第二項は$N\to\infty$とした時
        \begin{align*}
            \sum^\infty_{n=1}\left|(n^a-(n+1)^a)S_n\right|&\le\frac{2}{|1-z|}\sum^\infty_{n=1}(n^a-(n+1)^a)\\
            &\le\frac{-2a}{|1-z|}\sum^\infty_{n=1}n^{a-1}<\infty&(\because a-1<-1)
        \end{align*}
        と評価され，また第三項も
        \[ |N^aS_N|\le N^a\frac{a}{|1-z|}\xrightarrow{N\to\infty}0 \]
        と収束するから，$f_a(z)$は収束する．
        \item[$z=-1$の時] そもそも$a\in[-1,0)$の時，係数列$(n^a)$が発散するため，$z=-1$の時は発散する．
    \end{description}
\end{proof}

\subsection{冪級数は収束円内で項別微積分可能である}

\begin{screen}
    冪級数とは，（Taylor展開的な近似列の）極限の言葉を用いて定義される関数である．
    この時極限は，殆どの作用素と可換で，絶対収束なら和の法則も保存するのであった．
    また優級数の方法とはほぼ三角不等式である．
    ここで，収束円内では，冪級数は無条件で，冪級数上の形式的微分作用素$D$と，冪級数の定義の極限を取る行為とも可換であることを見る．
\end{screen}

\begin{definition}[termwise differentiation operator]
    形式的冪級数$S(z)=\sum^\infty_{n=0}a_nz^n$に対し，その項別微分$DS$を
    \[ DS(z):=\sum^\infty_{n=1}na_nz^{n-1} \]
    と定める．
\end{definition}

\begin{theorem}[冪級数は項別微分できる]\label{thm-冪級数は項別微分できる}\label{命題-6.1.2}
    形式的冪級数$S(z)=\sum^\infty_{n=0}a_nz^n$に対して，次が成り立つ．
    \begin{enumerate}
        \item $S(z)$の収束半径と$DS(z)$の収束半径は等しい．
        \item $S(z)$は収束円$\Delta(0,R)$の内部で正則関数であり，$S'(z)=DS(z)$である．即ち，次が成り立つ：
        \[  \]
    \end{enumerate}
\end{theorem}
\begin{proof}
    1. $\lim_{n\to\infty}n^{\frac{1}{n}}=\lim_{t\to 0}\frac{1}{t^t}=1$より，
    \[ \limsup\sqrt[n]{n|a_n|}=\lim_{n\to\infty}\sqrt[n]{n}(\limsup\sqrt[n]{|a_n|})=\limsup\sqrt[n]{|a_n|} \]
    より．

    2. \[S(z)=\sum^N_{n=0}a_nz^n+\sum^\infty_{n=N+1}a_nz^n=:S_N(z)+R_N(z)\]
    と置き，$S$の収束半径を$R\in[0,\infty]$とし，（$R=0$の時は微分は定義されないから）任意に取った点$w\in\Delta(0,R)$での微分を考える．
    $\rho\in(|w|,R)$に対して，$z\in\Delta(0,R)$の範囲で
    \begin{align*}
        &\frac{S(z)-S(w)}{z-w}-DS(w)\\
        =\;\;&\left( \frac{S_N(z)-S_N(w)}{z_w}-S'_N(w) \right) + \left( S'_N(w)-DS(w) \right) + \frac{R_N(z)-R_N(w)}{z-w}\\
        =:\;\;&I_N(z) + II_N(z) + III_N(z)
    \end{align*}
    を評価すれば良い．
    即ち，「$\rho$を十分小さく取ればいくらでも$S'$は$DS$に近づけることができる」と示せば，冪級数の定める関数$S$は正則で，その導関数は$DS$とわかる．
    それに当たって$N$で分解したが，この$N$というつまみを十分に大きく調整すれば，第二項と第三項は無視でき，その範囲内にて第一項を評価することが出来る，という指針で証明する．
    \begin{description}
        \item[第二項] $\lim_{N\to\infty}S'_N(w)=\lim_{N\to\infty}\sum^N_{n=1}na_nz^{n-1}=\sum^\infty_{n=1}na_nz^{n-1}\overset{def.}{=}DS(w)$は$DS$の定義であるから，$\lim_{N\to\infty}II_N(z)=0$．
        \item[第三項] \begin{align*}
            \left|\frac{R_N(z)-R_N(w)}{z-w}\right| &\le \sum^\infty_{n=N+1}\frac{|a_n(z^n-w^n)}{|z-w|}&（三角不等式）\\
            &= \sum^\infty_{n=N+1}|a_n||z^{n-1}+z^{n-2}w+\cdots+w^{n-1}|\\
            &\le \sum^\infty_{n=N+1}|a_n|\cdot n\rho^{n-1}&(|z|,|w|<\rho)
        \end{align*}
        右辺は$DS(\rho)$で，1.と$\rho<R$より絶対収束するから，$III_N(z)$も$N\to\infty$とした時$\Delta(0,\rho)$上$0$に一様に絶対収束する．
        \item[第一項] 以上より，
        \[ \forall\epsilon>0,\;\exists N>0,\;|II_N(z)|+|II_N(z)|<\epsilon\;\;\;(\forall z\in\Delta(0,\rho)) \]
        が成り立つ．任意に$\epsilon$を取り，このような$N$を固定すると，$\lim_{z\to w\\z\in\Delta(0,R)}I_N(z)=0$となる．即ち，
        \[ \forall\epsilon>0,\;\exists N>0,\;\exists \delta>0,\;0<|z-w|<\delta\Rightarrow |I_N(z)|<\epsilon\;\;\;(\forall z\in\Delta(0,\rho), n>N). \]
        この時，
        \[ \left|\frac{S(z)-S(w)}{z-w}-DS(w)\right|<2\epsilon\;\;\;(\forall z\in\Delta(0,\rho)) \]
        である．$\epsilon$を任意に取ったから，$S'(w)=DS(w)$．
    \end{description}
\end{proof}
\begin{remark}
    今回の証明で示している命題を形式化するとまずは一番頑健な明瞭性が得られる：
    \[ \forall\rho\in(0,R),\;\forall z\in\Delta(0,\rho),\;\forall\epsilon>0,\;\exists N>0,\;\exists\delta>0,\ (|z-w|<\delta\land n>N)\Rightarrow\left|\frac{S(z)-S(w)}{z-w}-DS_n(z)\right|<\epsilon. \]
    ただし$DS_n:=\sum^n_{k=0}ka_kz^{k-1}$とした．$S$が定義できているのと同様に，形式的には$DS$も同じ範囲で定義できることは1.で示せる，いずれも冪級数だからである．
    $DS$という冪級数が$N\to\infty$の極限によって定義されていることと，微分というものが$z\to w$の極限として定義されていることの２つが入り乱れている．
    さらに言えば，収束半径$R$というのも厄介者で，開円板$\Delta(0,R)$が「収束円の内部」だから，$R$を直接使うのではうまく評価できず，間にもう一つ$\rho$を取らねばならない（おそらく）．
    それで元の定理の代わりにそれと同値な先頭に１つ全称量化子が増えたものを示している．
\end{remark}

\begin{theorem}[解析的な関数は正則である]\label{thm-analytic-functions-are-regular}
    冪級数$f(z)=\sum^\infty_{n=0}a_nz^n$はその収束円の中で任意回微分可能であり，その導関数は
    \[f^{(k)}(z)=\sum^\infty_{n=k}n(n-1)\cdots(n-k+1)a_nz^{n-k}\]
    と表される．特に，$f^{(k)}(0)=k!a_k$が成り立ち，$f(z)$は次のようにTaylor展開できる：
    \[ f(z)=\sum^\infty_{n=0}\frac{f^{(n)}(0)}{n!}z^n. \]
\end{theorem}
\begin{proof}
    定理\ref{thm-冪級数は項別微分できる}を帰納的に用いて得る結果である．
\end{proof}

\begin{itembox}[l]{冪級数で表される関数は微分可能}
    係数の級数列$\sum^\infty_{n=0}a_n$が収束するならばそれが定める冪級数$\sum^\infty_{n=0}a_nz^n$も$U_r(0)$で収束し，
    収束半径は
    \[ \frac{1}{r}=\limsup_{n\to\infty}\sqrt[n]{|a_n|} \]
    と表される．この冪級数の定める関数
    $f(z):=\sum^\infty_{n=0}a_nz^n$は収束円板$U_r(0)$上で（無限回）微分可能であり，
    導関数は項別に微分したもの
    $f'(z)=\sum^\infty_{n=0}na_nz^{n-1}$と一致する．
\end{itembox}

\section{三角関数と指数関数}

\begin{screen}
    一般に指数写像は滑らかな多様体の接束上に，共変微分のことばで定義される．

    指数関数を冪級数から定義すると，その周期の半分として$\pi$が定義される．
\end{screen}

\begin{definition}[exponential mapping and its restriction]\mbox{}
    \begin{enumerate}
        \item 指数関数$\exp:\C\to\C^*:=\C\setminus\{0\}$を，冪級数
        \[ \exp z:=\sum^\infty_{n=0}\frac{z^n}{n!} \]
        として定義する．
        \item また，三角関数を，
        \begin{align*}
            \cos z&:=\frac{e^{iz}+e^{-iz}}{2}=\Re e^{ix},&\sin z&:=\frac{e^{iz}-e^{-iz}}{2i}=\Im e^{ix}
        \end{align*}
        と定める．
        \item これを余弦関数と正弦関数に関するEularの公式という．
        $z=x\in\R$の時，$\overline{e^{ix}}=e^{-ix}$に注意すれば，$\Re e^{ix}=\cos x,\Im e^{ix}=\sin x$が従うからである．
    \end{enumerate}
\end{definition}
\begin{lemma}[well-definedness]\mbox{}
    \begin{enumerate}
        \item 微分方程式$f'=f,\;f(0)=1$の解である．従って，この定義は\ref{def-微分方程式による指数関数の定義}と等しい（グラフが一致）．
        \item $\exp z$の収束半径は$\infty$である．
    \end{enumerate}
\end{lemma}
\begin{proof}
    1. 微分方程式の解の一意性より．

    2. 命題\ref{prop-d'Alembert's-formula}より，
    \[\frac{\frac{1}{n!}}{\frac{1}{(n+1)!}}=\frac{(n+1)!}{n!}=n+1\xrightarrow{n\to\infty}\infty=R.\]
\end{proof}

\begin{proposition}
    指数関数$\exp:\C\to\C\setminus\{0\}$とその制限について，次が成り立つ．
    \begin{enumerate}
        \item 指数法則（和と積のズレた保存）：$e^ze^w=e^{z+w}$．
        \item 三角関数の微分法則：$(\cos z)'=-\sin z,\;(\sin z)'=\cos z$．
        \item $\overline{e^z}=e^{\overline{z}}$．(because complex conjugation is a continuous field automorphism)．
        \item 三角関数の特徴付け：$\cos^2x+\sin^2x=1$．
        \item Eulerの公式：$e^{ix}=\cos x+i\sin x$．
    \end{enumerate}
\end{proposition}
\begin{proof}
    1. \begin{align*}
        &e^ze^w=e^{z+w}\\ \Leftrightarrow\;\;\;&\left(\sum^\infty_{n=0}\frac{z^n}{n!}\right)\left(\sum^\infty_{n=0}\frac{w^n}{n!}\right)=\sum^\infty_{n=0}\frac{(z+w)^n}{n!}
    \end{align*}
    であるが，左辺は命題\ref{prop-distributive-law-for-infinite}より，
    \[ \left(\sum^\infty_{n=0}\frac{z^n}{n!}\right)\left(\sum^\infty_{n=0}\frac{w^n}{n!}\right) = \sum^\infty_{n=0}\sum^n_{k=0}\frac{z^k}{k!}\frac{w^{n-k}}{(n-k)!} \]
    右辺は
    \begin{align*}
        \sum^\infty_{n=0}\frac{(z+w)^n}{n!} &= \sum^\infty_{n=0}\sum^n_{k=0}\frac{z^kw^{n-k}{}_nC_k}{n!}\\
        &= \sum^\infty_{n=0}\sum^n_{k=0}\frac{z^kw^{n-k}}{k!(n-k)!}
    \end{align*}
    より，指数法則の関係式を得る．

    2. 指数関数の微分法則（＝項別微分）から．

    3. 次の図式は可換であることと同値．
    \[\xymatrix{
        \C\ar[r]^-{\exp}\ar[d]_-{-}^-{\sim}&\C\setminus\{0\}\ar[d]^-{-}_-{\sim}\\
        \C\ar[r]_-{\exp}&\C\setminus\{0\}
    }\]
    これは，$\exp z=\lim_{N\to\infty}\sum^N_{n=0}\frac{z^n}{n!}$について，
    \[ \overline{\lim_{N\to\infty}\sum^N_{n=0}\frac{z^n}{n!}} = \lim_{N\to\infty}\sum^N_{n=0}\frac{\overline{z}^n}{n!} \]
    より．

    4. 
    \begin{align*}
        \cos^2 x+\sin^2 x  &= \left(\frac{e^{ix}+e^{-ix}}{2}\right)^2 + \left(\frac{e^{ix}-e^{-ix}}{2i}\right)^2= 1
    \end{align*}

    5.
    \begin{align*}
        \cos ix+i\sin ix  &= \left(\frac{e^{ix}+e^{-ix}}{2}\right) + i\left(\frac{e^{ix}-e^{-ix}}{2i}\right)= e^{ix}
    \end{align*}
\end{proof}

こうして指数関数を定義し，その基本性質を得た．
続いて$\pi$を定義する．
これは指数関数の周期として得られるが，指数関数が周期を持つという
事実自体が逆関数の多価性を表しており，Riemann面が志向される．

\begin{theorem}[period]\label{thm-period-of-exponential}
    ある正実数$\pi$が存在して，
    \[ e^w=1\Leftrightarrow w=2\pi in\;\;(n\in\Z) \]
    を満たす．
\end{theorem}
\begin{proof}\mbox{}
    $w=x+yi$と置くと，$e^{x+yi}=e^xe^{yi}=e^x(\cos y+i\sin y)=1$であるが，$|\cos y+i\sin y|=\cos^2y+\sin^2y=1$
    より，$|e^x|=1$．$\exp:\R\to\R_{>0}$は全単射なので，$x=0$と分かる．

    続いて，$y$の一番小さい解は$y=2\pi$であること，そしてその他の元は全てこれの整数倍で尽くされることを示す．
\end{proof}

これで挙動がわかってきた．$\exp$の実部が絶対値を指定しており，$\exp:\R\to\R_{>0}$は全単射．
虚部が周期$2\pi$を持って偏角を指定している．

\begin{theorem}
    $\exp:\C\to\C\setminus\{0\}$は全射である．
\end{theorem}
\begin{proof}
    $w\in\C\setminus\{0\}$を取る．実部は実関数$\log:\R_{>0}\to\R$を用いて$x=\log|w|$，
    虚部は$y=\arg w$を取ると，$e^{x+iy}\in f^{-1}(w)$である．
\end{proof}

こうして指数関数の多価性が本質的には$\arg$であること，周期とは本質的に
一周の角度$2\pi$のことであることが分かる．

\section{対数関数}

\begin{screen}
    A logarithm is a local section of an exponential map.\footnote{nLab exponential mapping}

    対数関数は指数関数のあり得る逆関数の全てとして定義するので，
    一意には定まらない．とは言っても，周期$2\pi$の倍数分の差しか現れないことが分かる．
    その多価性を畳み込むことが希望される．
\end{screen}

\begin{definition}[logarithm]
    $D$を$0$を含まない領域とする．連続関数$f:D\to\C$であって，
    \[ \forall z\in D,\; \exp(f(z))=z \]
    を満たすものを\textbf{対数関数}といい，$\log z$で表す．
\end{definition}

次が成り立つために，対数関数も正則である．

\begin{theorem}[正則性の遺伝]
    $g:U\to\C$は正則写像で$g'$が$U$上には零点を持たないとする．
    連続関数$f$が$g\circ f=\id$を満たせば，$f$も正則である．
\end{theorem}
\begin{proof}
    $w_j=f(z_j)\;(j=1,2)$と置く．
    \begin{align*}
        \frac{f(z_2)-f(z_1)}{z_2-z_1} &= \frac{w_2-w_1}{g(w_2)-g(w_1)}\\
        &= \frac{1}{g'(w_2)+o(w_2-w_1)}
    \end{align*}
    $f$は連続より，$z_2\to z_1$の時$w_2\to w_1$であるから，
    \[ f'(z_1)=\frac{1}{g'(w_1)} \]
    を得る．
\end{proof}

\begin{discussion}[対数関数の形についての必要条件]
    $f=\begin{pmatrix}u\\v\end{pmatrix}$と置くと，
    \[ e^u(\cos v+i\sin v)=z \]
    より，$e^u=|z|\Leftrightarrow u=\log|z|$，$v=\arg z$．
    よって，
    \[ f(z) = \log|z| + i\arg z. \]
\end{discussion}

\begin{definition}[principle value]\label{def-principle-value-of-log}
    以上の議論に基づいて，
    現状議論できる最大限の定義域としては$\C\setminus(-\infty,0]$上において，
    偏角の主値$\arg:\C\to(-\pi,\pi)$を用いて，関数$\Log:\C\setminus(-\infty,0]\to\C$を次のように定めることができる：
    \[ \Log(z):=\log|z|+i\arg z. \]
    これを\textbf{対数関数の主値}という．
    
    更なる実軸の非正領域への進出は積分によって行う．
\end{definition}

\begin{theorem}[対数関数は定値関数分の差を除いて一意]\label{thm-period-of-logarithm}
    $f,g$を領域$D$上の対数関数とする．次が成り立つ：
    \[ \exists n\in\Z,\;\forall z\in D,\; \;f(z)-g(z)=2n\pi i. \]
\end{theorem}
\begin{proof}
    $e^{f(z)}=e^{g(z)}$より，$e^{f(z)-g(z)}=1$．
    よって，$\exists n\in\Z,\; \;f(z)-g(z)=2\pi in.$である．
    関数$f-g$は特に連結な集合$D$上正則，特に連続であるから，全体としても$f-g\equiv 2\pi in$．
\end{proof}

\subsection{冪級数を用いた定義}

対数関数も指数関数と同様に冪級数を用いて定義をするためには，原点$0$を
避ける必要がある．

\begin{discussion}
    冪級数
    \[ f(z)=\sum^\infty_{n=1}(-1)^{n-1}\frac{z^n}{n} \]
    を考える．この収束半径は，
    \[ R=\frac{|a_n|}{|a_{n+1}|}=\frac{n+1}{n}\xrightarrow{n\to\infty}1 \]
    であり，導関数は，
    \[  f'(z)=\sum^\infty_{n=0}(-z)^n=\frac{1}{1+z}. \]

    これは実は対数関数である．実際，
    \begin{align*}
        (e^f)' &= \frac{e^f}{1+z}\\
        (e^f)'' &= \frac{(e^f)'(1+z)-e^f}{(1+z)^2} = \frac{e^f-e^f}{(1+z)^2}=0
    \end{align*}
    と$\exp\circ f(0)=\exp(0)=1,\;(\exp\circ f)'(0)=\frac{\exp\circ f(0)}{1}=1$と合わせて，
    $\exp\circ f(z)=z+1$．
    即ち，冪級数を用いて対数関数$f(z)=\log (z+1)$が定義できていた．
\end{discussion}

これを一般化すると次の通りとなる．
\begin{definition}
    原点からの変位$z_0\in\C\setminus\{0\}$に対して，半径$r:=|z_0|$の範囲で
    冪級数展開ができる．
\end{definition}

\chapter{複素積分とCauchyの定理}

\begin{quotation}
    最初の２節で，ベクトル解析の知識を用いて複素線積分について成り立つ性質を考察する．
    論調は必然的に，「線積分のうち，特別な場合」というようなものとなる．
    しかしこうして得る結果は一般性に欠ける．
    複素解析独自の結果を調査するために，第\ref{sec-redefinement-of-line-integral}節で
    Riemann和の方法から複素線積分を定義しなおし，
    これを基盤としてCauchyの積分定理を拡張した形で（複素関数については非本質的な制限（特に$C^1$級などの中間的性質）が取り払われた形で）証明する．
    \begin{enumerate}
        \item Greenの定理とは，Stokesの定理の1$\leftrightarrow$2次元版である．
        \item 正則関数の周回積分の値は0であることがそこから従う．Cauchyの積分表示もこの時点で得られる．また，線積分についての微積分学の基本定理もすぐに得られる．しかし，$C^1$級という，微分不可能と正則の間の中間的な性質を取り払えないもどかしさがある．実際，正則性と一致するのだから無駄な文言であるはずである．
        \item 曲線の長さとは，ベクトル解析の結果とは全く独立に集合論的に定まっている性質である（「長さ確定」の概念も同様）．こうして得る２つの複素線積分の定義は等価である：$L(\gamma)=\int_\gamma|dt|$．すなわち，長さという概念にアクセスする道具として（弧長による）線積分を見れる．
        \item $C^1$級である必要はなく，正則＝微分可能な時点でCauchyの定理は成り立つ．すると，その背後にある全貌が見えてくる．この証明の算譜を繰り返し使うと，任意階数の導関数が積分の形で表せるのである！この事実は多くの綺麗な結果を一気に導く．
        \item Cauchyの定理を回転数の言葉を用いて，一般の$z\in\C\setminus\Im\gamma$に拡張（定理\ref{thm-Cauchy-winding-number}）．
    \end{enumerate}
    Cauchyの積分定理は，Stokesの定理の正則関数論に於ける特殊化に他ならない．
    Cauchyの積分公式は，Poincaréの補題の仮定が満たされていないことを使って，定義域にあいた穴を捉える．
\end{quotation}

\section{Greenの公式}

\begin{screen}
    まずは，Euclid空間上の議論を復習する．
    ここで得るGreenの公式は，複素関数の消息よりも一般的なものゆえ，
    関係のない煩瑣な論理の糸が絡まっていて，異質性が際立つ．
    複素関数についてはもっと自然な結果が成り立つことを後の節で見るための準備とする．
\end{screen}

\begin{definition}[$C^1$曲線]
    曲線$\gamma:I\to\R^2$が，$I$を含む或る開区間上の$C^1$写像に拡張できる時，曲線$\gamma$を$C^1$級であるという．
\end{definition}

\begin{definition}[向きづけられた曲線]
    複素線積分の値は，可逆なパラメータの変換について不変である．
    ここで，曲線をパラメータの同型について同型類を取ったものを\textbf{向きづけられた曲線}という．
    \[\xymatrix@R-2pc{
        \Map([a,b],\R^2)\ar[r]&\Map([-b,-a],\R^2)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        \gamma\ar@{|->}[r]&-\gamma
    }\]
    がこの同型類の上に定める対応を，\textbf{逆向きの曲線}という．
    終点と始点を共有する曲線について，形式和$\gamma_1+\gamma_2$を定める．
    ホモロジーからの記法であるようだ．
\end{definition}

\begin{definition}
    $U$の\textbf{向きづけ}とは，2-形式$dx\wedge dy$を$dxdy$に読み替える時の，基底$dx\wedge dy\in\wedge^2(U)$の選び方をいう．
    $\int_Df\;dx\wedge dy$に対応づける所の，Euclid空間に引き戻した積分記法$\int_{[D]}f\;dxdy$の方は，$dx,dy$の順序に依らない(Fubini)ため，2-形式を定めると向きが定まる．
\end{definition}

\begin{definition}[境界の向き]
    部分集合$D$の境界$\partial D$の向きとは，
    外向き法線ベクトルの方向に第一基底を取り，
    残りを空間の所与の向きのとおりに定めたときに$\partial D$に定まる向きをいう．
\end{definition}

\begin{proposition}[Green]\label{prop-Green}
    $D$を有界領域，$\partial D$を区分的$C^1$級とする．
    この時，$[D]$の開近傍上で定義された$C^1$級1-形式$\omega$に対して，
    \[ \int_{\partial D}\omega=\int_Dd\omega \]
    が成り立つ．
\end{proposition}
\begin{remarks}
    証明は，座標を用いて，$D$が縦線集合（グラフ領域）である場合についてまず証明する．
    すると，帰納法により縦線集合に分割できるような$D$上でも成り立つ．
    この時，巧妙なアルゴリズムを与えれば，随分複雑な領域も縦線集合への分割が可能であるが，
    その一般的議論は果が少ない場合が多いので，今回は省略する．
\end{remarks}

\section{複素線積分とCauchyの定理}

\begin{screen}
    複素関数については複素関数に自然な微分作用素$\partial_z,\partial_{\overline{z}}$が存在するのであった(Cauchy-Riemann)．
    これを用いれば，Greenの公式の複素関数における場合は，随分綺麗な性質を主張となる（Cauchyの定理\ref{thm-Cauchy}）ことがわかる．
\end{screen}

\begin{proposition}[複素1-形式]
    \[\begin{cases}
        dz:=dx\textcolor{red}{+}idy\\
        d\overline{z}:=dx\textcolor{red}{-}idy
    \end{cases}
    \Leftrightarrow\begin{cases}
        dx=\frac{1}{2}(dz+d\overline{z})\\
        dy=\frac{1}{2}(dz-d\overline{z})
    \end{cases}\]と置くと，
    \[df=\frac{\partial f}{\partial z}dz + \frac{\partial f}{\partial\overline{z}}d\overline{z}\]
    が成り立つ．
\end{proposition}

\begin{definition}[複素線積分]
    複素線積分を，複素形式$dz$に関する線積分：
    \begin{align*}
        \int_\gamma fdz&:=\int_\gamma f(dx+idy)\\
        &=\int^b_af(\gamma(t))(\frac{dx}{dt}(t)+i\frac{dy}{dt}(t))dt
    \end{align*}
    と定める．
\end{definition}

\begin{example}[単位円周上での積分]
    単位円周$S^1$上で積分
    \[ \int_{S^1}z^n\;dz\;\;\;(n\in\Z) \]
    を考える．パラメータ付けを
    \[ \xymatrix@R-2pc{
        \gamma:[0,2\pi]\ar[r]&\C\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        t\ar@{|->}[r]&e^{it}
    } \]
    とすれば，$dz=ie^{it}dt$．よって，
    \begin{align*}
        \int_{S^1}z^n&=\int_{[0,2\pi]}(e^{it})^nie^{it}dt\\
        &=i\int^{2\pi}_0e^{i(n+1)t}dt\\
        &=\begin{cases}
            2\pi i,&n=-1のとき,\\
            \left[\frac{e^{i(n+1)t}}{n+1}\right]^{2\pi}_0=0,&n\ne -1のとき.
        \end{cases}
    \end{align*}
    これは一体どういうことだろう．$f(z)=\frac{1}{z}$の時のみ，一周で$2\pi i$の値が加算されていくが，それ以外の場合は何周しても$0$．
    また，Cauchyの積分表示に出現する$2\pi i$は，この分を打ち消しているのかも知れない．
\end{example}

\begin{theorem}[Cauchyの定理，積分表示]\label{thm-Cauchy}
    $D\subset\C$を有界領域，$\partial D$は$C^1$区分的とする．$C^1$級関数$f\in C^1([D])$が$D$上正則ならば，次が成り立つ．
    \begin{enumerate}
        \item \[ \int_{\partial D}f\;dz=0. \]
        \item \[ \forall z\in D,\;f(z)=\frac{1}{2\pi i}\int_{\partial D}\frac{f(\zeta)}{\zeta-z}\;d\zeta. \]
    \end{enumerate}
\end{theorem}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $f$は$D$上正則なので，$df=\frac{\partial f}{\partial z}dz$だから，Greenの公式より，
    \begin{align*}
        \int_{\partial D}f\;dz &= \int_D df\wedge dz
        =0.
    \end{align*}

    \item $z\in D$に対して，$[\Delta(z,\epsilon)]\subset D$を満たす$\epsilon>0$を取る．
    $D_\epsilon:=D\setminus[\Delta(z,\epsilon)]$と置くと，$\zeta$の関数$\frac{f(\zeta)}{\zeta-z}$は$D_\epsilon$上正則である．
    いま，$\partial D_\epsilon=\partial D-\partial\Delta(z,\epsilon)$であることに注意．

    すると，$D_\epsilon$は有界な領域だから，1.より，
    \[ 0=\int_{\partial D_\epsilon}\frac{f(\zeta)}{\zeta-z}d\zeta=\int_{\partial D}\frac{f(\zeta)}{\zeta-z}d\zeta-\int_{\partial\Delta(z,\epsilon)}\frac{f(\zeta)}{\zeta-z}d\zeta \]
    である．$\zeta$のパラメータづけ
    \[\xymatrix@R-2pc{
        [0,2\pi]\ar[r]&\partial\Delta(z,\epsilon)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        \theta\ar@{|->}[r]&z+\epsilon e^{i\theta}
    }\]
    を用いると，$d\zeta=i\epsilon e^{i\theta}d\theta$より，
    \begin{align*}
        \int_{\partial\Delta(z,\epsilon)}\frac{f(\zeta)}{\zeta-z}d\zeta &= 
        \int^{2\pi}_0\frac{f(z+\epsilon e^{i\theta})}{\epsilon e^{i\theta}}i\epsilon e^{i\theta}d\theta\\
        &= i\int^{2\pi}_0f(z+\epsilon e^{i\theta})d\theta\\
        &\xrightarrow{\epsilon\searrow 0}i\int^{2\pi}_0f(z)d\theta=2\pi if(z).
    \end{align*}
    ただし，収束$f(z+\epsilon e^{i\theta})\xrightarrow{\epsilon\searrow 0}f(z)$は$\theta$に依らず一様である．
    \end{enumerate}
\end{proof}
\begin{remarks}\label{remarks-Cauchy's-theorem}
    すでに電磁気学におけるGaussの法則のようなものを感じる（左辺の$f(z)$が湧き出しで，それが右辺の線積分で量れる）．場について適切な表現を持つので，複素数というのは物理界とも近いのだろう．
    あとは，関数の生成規則$f(z)\mapsto\frac{f(\zeta)}{\zeta-z}$というのがどうして出来たかである．
\end{remarks}

\begin{example}[中心がズレた単位円周上での積分]
    円周$\partial\Delta(1,1)$上での関数$\frac{1}{z^2-2}$の積分は$2\pi i$の$\frac{1}{2\sqrt{2}}$倍である．
    この場合の計算は，分母の次数を$1$まで落として，Cauchyの積分表示が使える．
    部分分数展開は
    \[ \frac{1}{z^2-2}=\frac{1}{2\sqrt{2}}\left(\frac{1}{z-\sqrt{2}}-\frac{1}{z+\sqrt{2}}\right) \]
    であるが，$\frac{1}{z+\sqrt{2}}$は$\Delta(1,1)$上正則なので積分は$0$．一方$\frac{1}{z-\sqrt{2}}$は$z=\sqrt{2}$に極を持つので正則ではないが，$f\equiv 1,z\equiv\sqrt{2}$と見ると，定値関数$f$は正則だからCauchyの積分表示より，
    \[ \int_{\partial\Delta(1,1)}\frac{dz}{z-\sqrt{2}}=f(\sqrt{2})2\pi i=2\pi i. \]
    よって，
    \[ \int_{\partial\Delta(1,1)}\frac{dz}{z^2-2} = \frac{1}{2\sqrt{2}}2\pi i = \frac{\pi i}{\sqrt{2}} \]
\end{example}

\begin{example}[Fresnel積分]\label{example-Fresnel-integral}
    \[ \int^\infty_0\cos^2x\;dx=\int^\infty_0\sin^2x\;dx=\frac{\sqrt{2\pi}}{4}. \]
    これは，領域$D_R:=\{re^{i\theta}\mid r\in(0,R),\theta\in(0,\pi/4)\}$でのGauss関数$e^{-z^2}$の積分計算とCauchyの積分定理から従う．
    \[ \frac{1+i}{\sqrt{2}}\int^\infty_0e^{-ix^2}\;dx=\frac{\sqrt{\pi}}{2}. \]
\end{example}

\begin{theorem}[fundamental theorem of calculus]
    $F:D\to\C$を正則，$F'=:f$を連続とする．\footnote{Greenの定理だけに注目していると，この$F$の$C^1$級という設定は外せない}
    $\gamma:[a,b]\to D$を長さ確定な$C^1$級曲線とすると，次が成り立つ：
    \[ \int_\gamma f\;dz=F(\gamma(b))-F(\gamma(a)). \]
\end{theorem}
\begin{proof}
    
\end{proof}

\section{Riemann和からの線積分の定義}\label{sec-redefinement-of-line-integral}

\begin{screen}
    線積分を，$C^1$級とは限らない曲線上にも拡張することを考える．
    そのためには，$C^1$級微分形式$dz$に頼らず，Riemann積分の方法で直接定義すれば，一般の連続曲線について積分が定まる．
    その際には，面積確定や長さ確定のように，長さという測度が集合的な性質のみからすでに定まっている．
    これを杖とすれば良い．
\end{screen}

\subsection{曲線の長さの測度論的な定義}

\begin{definition}[length of curve]\mbox{}
    \begin{enumerate}
        \item 曲線$\gamma:[a,b]\to D$の\textbf{長さ}$L(\gamma)$とは，Riemann和を
        \[ S(\Delta):=\sum^n_{j=1}|\gamma(t_j)-\gamma(t_{j-1})| \]
        と置いた時の極限値
        \[ L(\gamma):=\sup\{S(\Delta)\mid \Delta は[a,b]の分割\} \]
        である．この時$L$は全ての連続曲線$\Hom([a,b],D)$上で定まり，この時値域は$\R_{>0}\cup\{\infty\}$である．
        \item 曲線$\gamma$が\textbf{長さ確定}であるとは，$L(\gamma)\in\R_{>0}$であることをいう．
    \end{enumerate}
\end{definition}

\begin{example}[Koch snowflake]
    $L(\gamma)=\infty$の例としては，連続かつ至る所微分不可能な曲線がほとんどである．
\end{example}

\begin{theorem}[1-形式の方法とRiemann和の方法との等価性]\label{thm-C1-length-definedness}
    $C^1$級曲線$\gamma$は長さ確定であり，
    \[ L(\gamma)=\int_{\gamma}1\cdot|dz|=\int_{\gamma}|\gamma'(t)|\; dt \]
    が成り立つ．ただし，$\int_\gamma 1\cdot|dz|$をスカラー場の線積分（長さ積分ともいう）とした．$\gamma$の長さとは，曲線の重なりや$n$周なども含めるからである（？）．
\end{theorem}
\begin{proof}
    
\end{proof}

\begin{lemma}[形式的三角不等式：無限和に昇華された三角不等式]\label{lemma-triangular-inequality-in-infinite-cardinal}
    $\gamma$を$C^1$級曲線，$f$を連続とする．長さ積分についての不等式が成り立つ：
    \[  \left|\int_\gamma f\;dz\right|\le\int_\gamma|f|\;|dz|\le |f|_\gamma\;L(\gamma). \]
    ただし，$|f|_\gamma$とは$\sup_{z\in\Im\gamma}|f(z)|$とした．
\end{lemma}

\subsection{測度論に軸足を移した複素線積分の理論}

\begin{definition}[line integral]
    複素関数$f:D\to\C$と曲線$\gamma:[a,b]\to D$について，
    分割$\Delta=(t_i)$と$\xi_i\in[t_{i-1},t_i]$に関する有限和を
    \[S(\Delta,(\xi_i)):=\sum^n_{j=1}f(\gamma(\xi_j))(\gamma(t_j)-\gamma(t_{j-1}))\]
    と定める．$|\Delta|\to 0$の時，$S$がある実数値に収束する時，その値を$\int_\gamma f\;dz$と表し，$f$を複素線積分可能という．
\end{definition}

\begin{shadebox}\begin{theorem}[well-definedness]\mbox{}
    \begin{enumerate}
        \item $f:D\to\C$が連続で$\gamma:[a,b]\to D$が長さ確定ならば，$f$は$\gamma$上可積分：$\int_\gamma f\;dz:=\lim_{|\Delta|\to 0}S(\Delta;f,\xi)$．
        \item 特に$\gamma$が$C^1$級である時，その積分値は$\int_\gamma f\;dz=\int^b_af(\gamma(t))\gamma'(t)\;dt$と表せる．
    \end{enumerate}
\end{theorem}\end{shadebox}
\vspace{1mm}

\section{Cauchyの積分定理の本来の姿とCauchyの評価}

\begin{screen}
    \begin{enumerate}
        \item 冪級数展開と多項式の言葉から始め，
        三角形分割の言葉でCauchyの定理を示していく．星形領域は三角形分割ができる．
        直接的にはpotentialの構成が，複素関数の美しい性質を導いている．微分可能なだけで，積分も可能であると判るのである．
        これで，$C^1$級の制約がつかないCauchyの定理と，Cauchyの積分表示を得る．
        \item いま，$C^1$級の制約を外して証明できたことにより，任意の段階で証明できたことになる．微分の階数を上げるも下げるも自由である．こうしてCauchyの評価を得る．
        \item 三角形に対するCauchyの定理に潜ませていた爆弾を爆発させる．有限個の特異点は無視できる（系\ref{cor-erasing-unknown-differentialability}）．正則性の特徴付けも得る（Moreraの定理\ref{thm-Morera}）．
    \end{enumerate}
    冪級数展開と多項式の言葉から始め，
    三角形分割の言葉でCauchyの定理を示していく．
    まるでWeylである．
    すると，近傍でのコンパクト一様収束という概念装置が残る．
    複素関数は無限に続く微分系列の中の途中の姿でしかなく，また存在も局所的である．
    だんだん真の姿が見えてきた．
\end{screen}

\subsection{Cauchyの定理と積分表示の，拡張再証明}

\begin{screen}
    一点$p$での正則性を不明とした連続関数について，星形領域上での理論を立てる．
    これを用いて，$C^1$級を取り払った形でCauchyの積分表示を示すことができる．
    すると，その証明の算譜を繰り返し用いることで，有限個の特異点は潰せる（系\ref{cor-erasing-unknown-differentialability}）し，任意の階数の導関数について積分表示を得ることができる．これをCauchyの評価\ref{thm-Cauchy's-evaluation}という．
\end{screen}

\begin{lemma}[多項式の定める正則関数]\mbox{}
    \begin{enumerate}
        \item $P$を多項式とすると，これは正則関数を定め，原子関数を持つ．即ち，正則関数$Q$であって$Q'=P$を満たすものが存在する．実際，
        \begin{align*}
            P(z)&=\sum^m_{n=0}a_nz^n,&Q(z)&=\sum^m_{n=0}\frac{a_n}{n+1}z^{n+1}+C,
        \end{align*}
        とすればいい．
        \item $\gamma$を区分的$C^1$級閉曲線とすると，$\gamma$に沿った$P$の線積分は$0$である．その理由は，微積分学の基本定理から従い，特にベクトル解析の結果の直接の翻訳としてのCauchyの定理によらないでもわかる：
        \[\int_\gamma P(z)\;dz=Q(\gamma(b))-Q(\gamma(a))=0\qquad(\because\quad\gamma(a)=\gamma(b)).\]
    \end{enumerate}
\end{lemma}

\begin{theorem}[三角形に対するCauchyの定理]\label{thm-Cauchy's-theorem-for-triangle}
    $D\subset\C$を領域，$p\in D$とし．連続関数$f:D\to\C$は$D\setminus\{p\}$上で正則とする．この時，$D$内の閉三角形$T\subset D$に対して，
    \[ \int_{\partial T}f(z)\;dz=0. \]
\end{theorem}
\begin{remark}
    この定理の立て方には爆弾が仕掛けられている．当面の間は$p\in T$と$p\notin T$に場合分けして示すことになるが，これは領域$D$内で特異点が高々有限個ならばこれを潰せることの萌芽である．
    6点でしか交わり得ない，分割時のdiamに理想的な$2$倍の関係があるなど，最初に被覆のためのモデル図形として三角形を選ぶのは歴史的にはRiemannからなのであろうか．
    Riemann和の場合と全く並行に議論は進むことになる．
    有限個の特異点も，アルゴリズムの改変（その分粗く評価すること）で対応できる．
\end{remark}
\begin{proof}
    一般の三角形$T\subset D$について，$\eta(T):=\int_{\partial T}f(z)\;dz$と置く．
    \begin{description}
        \item[$p\notin T$の場合] $T$を４つの三角形$(T_1^j)_{j\in[4]}$に分割すると$\eta(T)=\sum^4_{j=1}\eta(T_1^j)$．この時，$T_1:=\max_{j\in[4]}T_1^j$と置くと，
        \[|\eta(T)|\le 4|\eta(T_1)|.\]
        同様にして分割を繰り返すと，三角形の包含列
        \[ T=:T_0\supset T_1\supset T_2\supset\cdots \]
        を得，
        \[ |\eta(T)|\le 4^{j}|\eta(T_j)|\;\;\;(j\in\N) \]
        が成り立つ．各三角形について$z_j\in T_j$を取る．すると，
        \[ k>j\Rightarrow z_k\in T_j \]
        が成り立つ．$diam(T_j):=\max\{|z-w|\mid z,w\in T_j\}$と置くと，$diam(T_j)=2^{-j}diam(T)$だから，$(z_j)$はCauchy列である．よって，$a:=\bigcap_{j=0}^\infty T_j$とおけばこれが極限点$a=\lim_{j\to\infty}z_j$に他ならない．

        $p\notin T$としたから$f$は$a$で微分可能で，
        \[ f(z)=f(a)+f'(a)(z-a)+(z-a)\varphi(z)\;\;\;(\lim_{z\to a}\varphi(z)=0) \]
        と置けるから，
        \begin{align*}
            \eta(T_j)&:=\int_{\partial T_j}(f(a)+f'(a)(z-a)+(z-a)\varphi(z))\;dz\\
            &=\int_{\partial T_j}(z-a)\varphi(z)\;dz\;\;\;(補題)\\
            |\eta(T_j)|&\le\int_{\partial T_j}|z-a||\varphi(z)|\;|dz|\\
            &\le diam(T_j)|\varphi|_{T_j}L(\partial T_j)\\
            &= 2^{-j}diam(T)|\varphi|_{T_j}2^{-j}L(\partial T)\\
            &= 4^{-j}diam(T)L(\partial T)|\varphi|_{T_j}.
        \end{align*}
        すると，
        \begin{align*}
            |\eta(T)|&\le 4^j|\eta(T_j)|\\
            &\le diam(T)L(\partial T)|\varphi|_{T_j}\xrightarrow{j\to\infty}0.
        \end{align*}
        \item[$p\in T$の場合] $T$を同様に$4^j$個の三角形に分割する．どの段階でも，$p$を含む$T^k$は高々$6$個である．
        上での議論より，$p$を含まない全ての$T^k_j$について，$\eta(T^k)=0$であることはわかっているから，$|\eta(T^{k_0})|:=\max_{k}|\eta(T^k)|$と置くと，
        \begin{align*}
            |\eta(T)|&\le\sum^{4^j}_{k=1}|\eta(T^k_j)|\le 6|\eta(T^{k_0}_j)|\\
            |\eta(T^k)|&=\int_{\partial T^k}|f(z)|\;|dz|\le|f|_TL(\partial T^k)=|f|_T2^{-j}L(\partial T)\\
            |\eta(T)|&\le 6|f|_T2^{-j}L(\partial T\xrightarrow{j\to\infty}0.
        \end{align*}
    \end{description}
\end{proof}

三角形領域では飽き足らず，potentialが定められる理想の領域として次のモデル図形を得る．
\begin{definition}[star-shaped domain]\mbox{}
    \begin{enumerate}
        \item $D\subset\C$が星形領域であるとは，\textbf{中心}$p$を持つことをいう：
        \[ \exists p\in D,\;\forall q\in D,\;[p,q]\subset D. \]
        \item 全ての点が中心であるような星形領域を\textbf{凸領域}という．
    \end{enumerate}
\end{definition}

\begin{theorem}[potentialの構成]
    $D$を星形領域，$a$をその内点とする．$f:D\to\C$が連続，$D\setminus\{a\}$で正則とすると，$f$は$D$上で原子関数を持つ．
\end{theorem}
\begin{proof}
    中心$p\in D$が取れるから，これについて
    \[ F(z):=\int_{[p,z]}f(\zeta)d\zeta\;\;\;(z\in D) \]
    とおけば，これが求める原始関数であることを，即ち$F'=f$を示す．

    任意に$z\in D$を取る．$\epsilon>0$が存在して$[\Delta(z,\epsilon)]\subset D$が取れる．
    $|h|<\epsilon$の時，$z+h\in D,[p,z+h]\subset D$だから，$p,z,z+h$を頂点とする三角形$T$は$D$に含まれる．
    よって，三角形についてのCauchyの定理より，
    \[ F(z+h)-F(z)-\int_{[z,z+h]}f(\zeta)\;d\zeta = \pm\int_{\partial T}f(\zeta)\;d\zeta=0. \]
    これを用いて，
    \begin{align*}
        \left| \frac{F(z+h)-F(z)}{h} - f(z) \right| &= \left| \frac{1}{h}\int_{[z,z+h]}f(\zeta)\;d\zeta-\frac{1}{h}\int_{[z,z+h]}f(z)\;d\zeta \right|\\
        &\le \frac{1}{|h|}\int_{[z,z+h]}|f(\zeta)-f(z)|\;|d\zeta|\\
        &\le \max_{\zeta\in[z,z+h]}|f(\zeta)-f(z)|\xrightarrow{h\to 0}0.
    \end{align*}
\end{proof}

\begin{corollary}[Cauchyの定理は，星形領域では$\gamma$に一切の制約がつかない]\label{cor-Cauchy's-theorem}
    $\gamma$を星形領域$D$内の区分的$C^1$級曲線とする．
    \[ \int_{\gamma}f\;dz=0. \]
\end{corollary}

\begin{theorem}[$C^1$級を仮定しないCauchyの積分表示]\label{thm-Cauchy's-integral-expression}
    $f:D\to\C$を正則とする．$[\Delta(a,r)]\subset D$ならば，
    \[ f(z)=\frac{1}{2\pi i}\int_{|\zeta-a|=r}\frac{f(\zeta)}{\zeta-z}d\zeta\;\;\;(z\in\Delta(a,r)). \]
\end{theorem}

\subsection{Cauchyの評価}

\begin{screen}
    Cauchyの積分表示を，各導関数についても拡張するため，
    特徴関数$\frac{f(\zeta)}{\zeta-z}$の高次元化についての性質を準備する．

    すると，
    \begin{enumerate}
        \item 正則関数は$C^1$級どころか無限回微分可能であり，
        \item 正則関数の導値は積分で表示することができ，
        \item 導値は，微分とは何も関係のない値，$a$の収束半径や関数$f$の境界点での最大値で抑えられる
    \end{enumerate}
    ことがわかる．
\end{screen}

\begin{discussion}
    \[x^n-y^n=(x-y)\sum_{j,k\in\N,j+k=n-1}x^jy^k\]
    より，
    \[ \frac{1}{(\zeta-z)^n}-\frac{1}{(\zeta-w)^n}=(z-w)\sum^n_{j=1}\frac{1}{(\zeta-z)^j(\zeta-w)^{n-j+1}}. \]
\end{discussion}

\begin{lemma}
    $\gamma:[a,b]\to\C$を（区分的）$C^1$曲線とし，$C:=\gamma([a,b])$とする．
    連続関数$F_n:C\to\C$を自然数$n\in\N$に対して
    \[ F_n(z):=\int_\gamma\frac{\varphi(\zeta)}{(\zeta-z)^n}d\zeta \]
    とすると，これは$\C\setminus C$上正則であり，$F_n'(z)=nF_{n+1}(z)$を満たす．
\end{lemma}
\begin{proof}
    上での議論より，
    \[ \frac{F_n(z)-F_n(w)}{z-w}=\sum^n_{j=1}\int_\gamma\frac{f(\zeta)}{(\zeta-z)^j(\zeta-w)^{n-j+1}}d\zeta \]
    であるから，関数$\frac{f(\zeta)}{(\zeta-z)^j(\zeta-w)^{n-j+1}}$が$\frac{f(\zeta)}{(\zeta-w)^{n+1}}$に$z\to w$の時一様収束することを示せば良い．

    $z\to w$は$\C\setminus C$上で近づけるから，$\delta:=dist(w,C)$と置くと$\delta>0$であり，$z\in\Delta(w,\delta/2)$と取ると$dist(z,c)>\frac{\delta}{2}$であることに注意して，
    \begin{align*}
        \left|\frac{f(\zeta)}{(\zeta-z)^j(\zeta-w)^{n-j+1}}-\frac{f(\zeta)}{(\zeta-w)^{n+1}}\right|&\le \frac{|f|_C}{\delta^{n-j+1}}\left|\frac{1}{(\zeta-z)^j}-\frac{1}{(\zeta-w)^j}\right|\\
        \left|\frac{1}{(\zeta-z)^j}-\frac{1}{(\zeta-w)^j}\right|&\le |z-w|\sum^j_{l-1}\left|\frac{1}{(\zeta-z)^l(\zeta-w)^{j-l+1}}\right|\\
        &\le |z-w|\sum^j_{l=1}\frac{1}{(\delta/2)^j\delta^{j-l+1}}
    \end{align*}
    より，まとめると
    \[ \left|\frac{f(\zeta)}{(\zeta-z)^j(\zeta-w)^{n-j+1}}-\frac{f(\zeta)}{(\zeta-w)^{n+1}}\right|\le|f|_C|z-w|(\delta の有理式) \]
    $\Delta(w,\delta/2)\ni z\to w$の時，右辺は$0$に収束する．
\end{proof}
\begin{remarks}
    関数の正則性とは局所的な事象である．
    そこで，特に説明せずに，$\Delta(w,\delta/2)$上に話をかぎった．
    しかし$w$は任意に取ったから，これで良いのである．
\end{remarks}

\begin{theorem}[Cauchyの評価]\label{thm-Cauchy's-evaluation}
    正則関数$f:D\to\C$は無限回微分可能であり，$[\Delta(a,r)]\subset D$の時，$n$階の導値は
    \[ f^{(n)}(z)=\frac{n!}{2\pi i}\int_{|\zeta-a|=r}\frac{f(\zeta)}{(\zeta-z)^{n+1}}d\zeta\;\;\;(z\in\Delta(a,r)) \]
    と表せる．また，$M:=|f|_{\partial\Delta(a,r)}$と置くと，
    \[ |f^{(n)}(a)|\le \frac{n!M}{r^n} \]
    で抑えられる．
\end{theorem}
\begin{proof}
    1. Cauchyの積分表示に補題を用いれば得る．

    2. その絶対値は
    \begin{align*}
        |f^{(n)}(a)|&\le\frac{n!}{2\pi}\int_{|\zeta-a|=r}\left|\frac{f(\zeta)}{(\zeta-a)^{n+1}}\right|\;|d\zeta|\\
        &\le\frac{n!}{2\pi}\frac{2\pi r}{r^{n+1}}M=\frac{n!M}{r^n}.
    \end{align*}
\end{proof}

\subsection{Cauchyの評価の波及}

\begin{theorem}[Liouville]\label{thm-Liouville}
    $\C$上で有界な正則関数は，定数関数である．
\end{theorem}
\begin{proof}
    $|f|_\C=\sup_{z\in\C}|f(z)|=:M$と置く．任意の$\Delta(a,r)\subset\C$に対するCauchyの評価より，
    \[f'(a)\le\frac{M}{r}\]
    である．$r$は任意より，$f'(a)=0$．$a$も任意より，$f'=0$．従って，$f$は定数関数である．
\end{proof}
\begin{remarks}
    いま言われたらそんな気がする．関数が始まるとハンドルは握らされている気がするが，そのハンドルの切り方は無限解微分可能である必要がある．
    この時，最終的には果てに行ってしまうことが約束されている．
\end{remarks}

「代数的な命題が解析の言葉で示せる」
複素数の解析的な性質と密接に繋がっているのか．

\begin{theorem}[fundamental theorem of algebra]
    定数でない多項式$P$は零点を持つ．
\end{theorem}
\begin{proof}
    対偶を示す．多項式$P$は零点を持たないとすると，
    \[ f(z):=\frac{1}{P(z)} \]
    と定めた$f:\C\to\C$も零点を持たない正則な関数である．また$\lim_{|z|\to\infty}f(z)=0$より有界でもある．
    よってLiouvilleの定理より$f$は定数，よって$P$も定数．
\end{proof}

\begin{theorem}[Morera]\label{thm-Morera}
    領域$D$上の連続関数$f$について，
    \[ \int_{\partial T}f(\zeta)\;d\zeta=0\qquad(\;\forall T：D内の三角形) \]
    が成り立つならば，$f$は正則である．
\end{theorem}
\begin{proof}
    任意の$\Delta(a,r)$上で示せば十分．いま
    \[ F(z):=\int_{[a,z]}f(\zeta)\;d\zeta\;\;\;(z\in\Delta(a,r)) \]
    と定めた関数$F:\Delta(a,r)\to\C$は$f$のpotentialだから$F'=f$をみたし，正則．
    よって$f$も正則．
\end{proof}

\begin{corollary}\label{cor-erasing-unknown-differentialability}
    連続関数$f:D\to\C$が$D\setminus\{p\}$で正則ならば，$D$上でも正則．
\end{corollary}
\begin{proof}
    定理\ref{thm-Cauchy's-theorem-for-triangle}より任意の三角形$T\subset D$上で$\int_{\partial T}f\;dz=0$である．
    Moreraの定理より，$f$は$p$でも正則．
\end{proof}

\begin{corollary}[除去可能特異点]
    $f:D\setminus\{p\}\to\C$が正則で，$p$の近くである$M>0$に対して
    \[ |f(z)|<-M\log|z-p| \]
    が成り立つとする．この時，$f$は$D$上の正則関数に拡張できる．（一意的？）
\end{corollary}
\begin{proof}
    
\end{proof}

\begin{itembox}[l]{特異点について}
    可除特異点を除けば，多項式の冪によって救済可能な極と，真性特異点との２つしかない．真性特異点については，孤立した真性特異点の近傍の像が高々唯一の点を除き複素平面全体を覆うことが示せる(Picard's great theorem)．
    
\end{itembox}

\section{コンパクト性と正則性の遺伝}

\begin{screen}
    複素関数は無限に続く微分系列の中の途中の姿でしかなく，また存在も局所的である．（$C^1$級などの中間的性質はそうではない）．
    だんだん真の姿が見えてきた．
    正則関数列の収束の議論に乗り出したいので，再び位相の言葉を確認する．
    $K\subset\C$が点列コンパクトであることとコンパクトであることと有界閉集合であることの３つは同値である．
    また，ある領域$D$内で，任意のコンパクト集合で収束することと，任意の開球で収束することとも，同値である．
    従って，今までの冪級数は\textbf{コンパクト一様収束}も同時に証明していたことがわかる，これで軸を乗り移るのである．

    また，正則性は連続性と同様に，極限によって持ち上がる性質であることがわかる．一方で$C^1$級であることについては同様の性質は成り立たず，$C^1$級に収束しない$C^1$級列が構成できる．

    証明については，もうすでに任意に点$a\in D$を取った後は任意の値$r$に対して「半径$r/2$の開球が与えられる度にどう抑えられるか」の算譜のみに話を限るようになった．
\end{screen}

\subsection{コンパクト性}

\begin{definition}[sequentially compact]
    $K\subset\C$が\textbf{点列コンパクト}であるとは，$K$内の任意の点列が，$K$内に収束する部分列を持つことをいう．
\end{definition}

\begin{theorem}[Weierstrass]\label{thm-Weierstrass}
    次は同値．
    \begin{enumerate}
        \item $K\subset\C$は点列コンパクト．
        \item $K\subset\C$は有界閉集合．
    \end{enumerate}
\end{theorem}

\begin{definition}[compact]
    $\C$の開集合の族$\{V_\lambda\}_{\lambda\in\Lambda}$が$K\subset\bigcup_{\lambda\in\Lambda}V_\lambda$を満たす時，$\{V_\lambda\}$を$K$の\textbf{開被覆}という．
    $K$の任意の開被覆$\{V_\lambda\}_{\lambda\in\Lambda}$について，有限個の要素$V_{\lambda_1},V_{\lambda_2},\cdots,V_{\lambda_n}$が存在して，$K\subset\bigcup_{i=1}^nV_{\lambda_i}$が成り立つとき，$K$は\textbf{コンパクト}という．
\end{definition}

\begin{theorem}\label{thm-sequantial-compactness-and-compactness}
    距離空間$(X,d)$に於て，$K\subset X$が点列コンパクトであることとコンパクトであることは同値．
\end{theorem}

\subsection{広義一様収束}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $\sigma$-有限性の概念の類似として，コンパクト集合は一般の集合に対して，ある種の有限条件として働く．
    これについての一様収束の一般化が，広義一様収束の概念である．
\end{tcolorbox}

\begin{definition}[compact convergence, uniform convergence on compact sets]
    領域$D\subset\C$上の関数列$\{f_n\}_{n\in\N}$が$D$内の任意のコンパクト集合上で一様収束する時，$\{f_n\}$は\textbf{広義一様収束}または\textbf{コンパクト一様収束}するという．
\end{definition}

\begin{lemma}
    $D$上の関数の列$\{f_n\}$について，次は同値．
    \begin{enumerate}
        \item $\{f_n\}$は広義一様収束する．
        \item $\forall z\in D,\;\exists r>0,\;\Delta(z,r)$上で$\{f_n\}$が一様収束する．
    \end{enumerate}
\end{lemma}
\begin{proof}
    開球の閉包$[\Delta(z,r_z)]$はコンパクトであるから，1$\Rightarrow$2が成り立つ．
    2$\Rightarrow$1を示す．コンパクト集合$K\subset D$を任意に取る．
    $\{\Delta(z,r_z)\}_{z\in K}$は$K$の開被覆であるから，
    有限個の点$z_1,\cdots,z_n\in K$が存在して，
    \[ K\subset\Delta(z_1,r_{z_1})\cup\cdots\cup\Delta(z_n,r_{z_n}) \]
    が成り立つ．$\{f_n\}$は各$\Delta(z_j,r_{z_j})$上で一様収束するから，これらの合併，特に$K$上でも一様収束する．
\end{proof}
\begin{remark}\mbox{}\label{remark-compact-convergence-and-power-series}
    \begin{enumerate}
        \item 最後の議論は，$\epsilon$-$N$論法にて，$N=\max\{r_{z_1},\cdots,r_{z_n}\}$とすることに相当する．この道が通れる有限性をコンパクトという．
        \item 今までの冪級数の議論は，収束半径内で任意に近傍をとって行ってきたが，これはcompact一様収束性までをも無自覚に証明してきたのである．
        収束冪級数$S(z)$が収束半径$R$を持つとき，この収束円内でコンパクト一様収束する．実際，任意のコンパクト集合$K\subset\Delta(a,R)$に対して，$0<r<R$が存在して$K\subset\Delta(a,r)$を満たす．
        \item なんだかこの局所性も含めて，複素解析は場の記述に極めて向いている．
    \end{enumerate}
\end{remark}

\begin{theorem}[正則性の遺伝(Weierstrass)]\label{thm-propagation-of-regularity-through-compact-convergence}
    $D$上の正則関数の列$\{f_n\}$が$f$に広義一様収束する時，$f=\lim_{n\to\infty}f_n$も正則であり，
    さらに言えば，任意の$k\in\N$に対し，$\lim_{n\to\infty}f^{(k)}_n=f^{(k)}$が成り立つ．
\end{theorem}
\begin{proof}
    \begin{description}
        \item[$f$の正則性] 
    任意に$a\in D$を取り，ここでの$f$の正則性を示す．Cauchyの積分表示\ref{thm-Cauchy's-integral-expression}より，$[\Delta(a,r)]\subset D$を満たす$r>0$に対し，
    \[ f_n(z)=\frac{1}{2\pi i}\int_{|\zeta-a|=r}\frac{f_n(\zeta)}{\zeta-z}d\zeta\;\;\;(z\in\Delta(a,r)) \]
    が成り立つ．いま，関数$\frac{f_n(\zeta)}{\zeta-z}$は積分区間である$\partial\Delta(a,r)$上で一様収束するから，$n\to\infty$の時，極限と積分とは交換可能で，
    \[ f(z)=\frac{1}{2\pi i}\int_{|\zeta-a|=r}\frac{f(\zeta)}{\zeta-z}d\zeta\;\;\;(z\in\Delta(a,r)) \]
    である．右辺が$z$で微分可能であるから，左辺も$\Delta(a,r)$上微分可能である．$a$を任意に取ったから，結局$D$上正則である．
        \item[$f^{(k)}$の正則性] 同様の議論を$k$階導関数
    \[f_n^{(k)}(z)=\frac{k!}{2\pi i}\int_{|\zeta-a|=r}\frac{f_n(\zeta)}{(\zeta-z)^{k+1}}d\zeta\] 
    についてすれば良い．即ち，$f^{(k)}(z)=\frac{k!}{2\pi i}\int_{|\zeta-a|=r}\frac{f(\zeta)}{(\zeta-z)^{k+1}}d\zeta$とするとこれが一様収束であることを示す．
    例えば，$z$を$\Delta(a,r/2)$上に限れば，次のように評価できる：
    \begin{align*}
        |f_n^{(k)}(z)-f^{(k)}(z)|&\le\frac{k!}{2\pi}\int_{|\zeta-a|=r}\frac{|f_n(\zeta)-f(\zeta)|}{|\zeta-z|^{k+1}}|d\zeta|\\
        &\le\frac{k!}{2\pi}\frac{|f_n-f|_{\partial\Delta(a,r/2)}}{(r/2)^{k+1}}2\pi r\xrightarrow[z\in\Delta(a,r/2)]{n\to\infty}0.
    \end{align*}
    \end{description}
\end{proof}

\begin{screen}
    任意の点にて，その近傍上で収束することと，広義一様収束することは同値である．
    なんだか双対命題のようである．
    だんだん一致の定理っぽくなってきた．
\end{screen}

\section{Taylor展開}

\begin{screen}
    収束する冪級数は正則関数である（定理\ref{thm-analytic-functions-are-regular}）ことは確認したが，
    \textbf{正則関数は全て収束する冪級数として（局所的に）表せる}（系\ref{cor-serial-expression-of-regular-functions}）ことを示す．
    表示が違うだけで，関数として一致するのである．こうして，正則関数と解析関数の２つの世界は結局同義だったのである．
    \textbf{正則関数が全て極限の言葉で現し尽くされる}，という到達点である．
\end{screen}

\begin{definition}[analytic]
    開集合上の関数$f:\Omega\to\C$が$z_0\in\Omega$で\textbf{解析的}であるとは，$z_0$を中心とした正の収束半径$r>0$を持つ冪級数$\sum_{n\in\N}a_n(z-z_0)^n$が存在して，$\Delta(a,r)$上で$f$に一致することをいう．
\end{definition}

\begin{theorem}[Taylorの定理と剰余項の積分表示]\label{thm-Taylor}
    領域$D$上の正則関数$f:D\to\C$の任意の点$z_0\in D$と自然数$n\in\N$に対して，
    \begin{enumerate}
        \item $D$上の正則関数$f_n$と$a_k\in\C$が存在して，$f$は次のように表される：
        \[ f(z)=\sum^{n-1}_{k=0}a_k(z-z_0)^k+f_n(z)(z-z_0)^n\qquad(z\in D). \]
        \item 任意の$r\in\R$に対して，$[\Delta(z_0,r)]\subset D$であれば，開円板$\Delta(z_0,r)$上で$f_n$は次のように表示される：
        \[ f_n(z)=\frac{1}{2\pi i}\int_{|\zeta-z_0|=r}\frac{f(\zeta)}{(\zeta-z_0)^n(\zeta-z)}d\zeta\;\;\;(z\in\Delta(z_0,r)). \]
    \end{enumerate}
\end{theorem}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 
    $z_0=0$の場合の主張
    \[f(z)=\sum^{n-1}_{k=0}a_kz^k+f_n(z)z^n\qquad(z\in D)\]
    を示せばよい．$n\in\N$についての帰納法で示す．$n=0$の時は自明．
    $n=1$の場合，関数$f_1$を
    \[f_1(z)=
        \begin{cases}
            \frac{f(z)-f(0)}{z}&z\ne 0\\
            f'(0)&z=0
        \end{cases}
    \]
    と定めると，$\lim_{z\to 0}\frac{f(z)-f(0)}{z}=f'(0)$より$f_1$は$D$上連続で，$D\setminus\{0\}$正則だから，系\ref{cor-erasing-unknown-differentialability}より，$D$上正則．
    この時，定め方から
    \[f(z)=f(0)+f_1(z)z\qquad(z\in D)\]
    より，$a_0=f(0)$とすれば$n=1$の時成立．
    全く同様に，これを繰り返すと示せる．
    $n>1$の時，$f_k(z)=f_k(0)+zf_{k+1}(z)\;(k=1,2,\cdots,n-1)$と定めると，
    \[f(z)=f(0)+f_1(0)z+f_2(0)z^2+\cdots+f_n(z)z^n\]
    より，$a_0=f(0),a_k=f_k(0)\;(k=1,2,\cdots,n-1)$と定めれば良い．
    \item
    $z_0=0$の場合の主張
    \[f_n(z)=\frac{1}{2\pi i}\int_{|\zeta|=r}\frac{f(\zeta)}{\zeta^n(\zeta-z)}d\zeta\;\;\;(z\in\Delta(0,r))\]
    を示せば良い．1.の結果より，
    \[f_n(z)=\frac{z}{z^n}-\sum^{n-1}_{k=0}\frac{a_k}{z^{n-k}}\]
    であるから，Cauchyの積分表示\ref{thm-Cauchy's-integral-expression}より，
    \[2\pi if_n(z)=\int_{|\zeta|=r}\frac{f(\zeta)}{(\zeta-z)\zeta^n}\;d\zeta-\sum^{n-1}_{k=0}a_k\int_{|\zeta|=r}\frac{d\zeta}{(\zeta-z)\zeta^{n-k}}\]
    が成り立つ．あとは，
    \[F_k(z;r):=\int_{|\zeta|=r}\frac{d\zeta}{(\zeta-z)\zeta^{n-k}}=0\]
    を示せば良い．$r,z\in\Delta(0,r)$を任意に取る．
    $\frac{1}{(\zeta-z)\zeta^{n-k}}$は$|\zeta|>|z|$で正則だから，勝手に$R>r$を取って円環$r<|\zeta|<R$上で考えても正則である．
    従ってCauchyの積分定理\ref{cor-Cauchy's-theorem}より\footnote{円環は星形領域ではないが}，$F_k(z;r)=F_k(z;R)$である．
    $|\zeta|=R$の時$|\zeta-z|>R-r$より，
    \begin{align*}
        |F_k(z;r)|&=|F_k(z;R)|\\
        &\le\int_{|\zeta|=R}\frac{|d\zeta|}{|\zeta|^{n-k}|\zeta-z|}\\
        &<\frac{2\pi R}{R^{n-k}(R-r)}.
    \end{align*}
    $R$は任意に取ったから，$F_k(z,r)=0$と解る．
    \end{enumerate}
\end{proof}
\begin{remarks}
    各$f_n$を構成するとき微分の言葉を使っていない（$f'(0)$だけ）のがほんま神秘的．
    円環は星形領域ではないが，結局$f$は$C^1$級なので定理\ref{thm-Cauchy}も使えるから，もはやどうでも良いだろう．典型的な議論であるらしい．
    「$D$内に境界も含めて含まれる円板」という制限はCauchyの積分表示\ref{thm-Cauchy's-integral-expression}からの遺伝である．
\end{remarks}

剰余項の積分表示は良いが，これが収束する半径を考えたい．

\begin{corollary}\label{cor-serial-expression-of-regular-functions}
    少なくとも領域$D$上で正則な関数$f:D\to\C$は，任意の点$z_0\in D$について，$\Delta(z_0,r)\subset D$を満たす開円板$\Delta(z_0,r)$上で冪級数展開
    \[ f(z)=\sum^\infty_{n=0}a_n(z-z_0)^n \]
    を持つ（即ち，級数が$\Delta(z_0,r)$上広義一様収束する）．従って実際の収束半径は$r$以上である．
\end{corollary}
\begin{proof}
    任意の$0<s<r$を取れば，$[\Delta(z_0,s)]\subset D$である．これについてTaylor展開を考え，$s\nearrow r$を考えれば良い．
    Taylor展開の剰余項$(z-z_0)^nf_n(z)$が，$t\in(0,1)$に対して，$z\in\Delta(z_0,ts)$を満たすならば，
    \begin{align*}
        |(z-z_0)^nf_n(z)|&\le\frac{(st)^n}{2\pi}\int_{|\zeta-z_0|=s}\frac{|f(\zeta)||d\zeta|}{|\zeta-z||\zeta-z_0|^n}\\
        &\le \frac{(st)^n}{2\pi}\frac{|f|_{\partial\Delta(z_0,s)}2\pi s}{(s-ts)s^n}\\
        &=\frac{t^n}{1-t}|f|_{\partial\Delta(z_0,s)}
    \end{align*}
    は$n\to\infty$の時，$0$に収束する．
\end{proof}

\section{Taylor展開の算譜}

\begin{screen}
    必要に応じて有限多項式部分で切って計算するのがテクニックである．
    また，数列の空間との対応を適宜取る．
\end{screen}

関数の商のTaylor展開を計算するテクニックは，次のように
理論的に説明される．

\begin{proposition}[Neumann級数展開]
    $A$をBanach空間$X$上の有界作用素$A\in B(X)$とする．
    この時，$\|A\|<1$ならば，作用素$I-A$は可逆で，$(I-A)^{-1}\in B(X)$であり，次のように表せる：
    \[(I-A)^{-1}=\sum^\infty_{n=0}A^n.\]
    この右辺の級数をNeumann級数という．
\end{proposition}
\begin{corollary}
    複素数$z\in\C$が存在して$\|A\|<|z|$ならば，resolvent作用素$(zI-A)^{-1}=:R(z,A)$が同様に存在し，次のように表せる：
    \[R(z,A)=\sum^\infty_{n=0}\frac{A^n}{z^{n+1}}.\]
    が，$r$を$A$のspectre半径として，$\{z\in\C\mid\abs{z}>r\}$上で成り立つ．
\end{corollary}

\begin{example}[Bernoulli number]
    次のTaylor展開を考える．
    \[\frac{e^z-1}{z}=1+\frac{z}{2!}+\frac{z^2}{3!}+\cdots.\]
    この逆関数$f$のNeumann級数の係数列を$(b_n)_{n\in\N}$と置くと，
    \[f(z)=\frac{z}{e^z-1}=\sum^\infty_{n=0}b_nz^n\]
    より，
    \begin{align*}
        1&=\frac{e^z-1}{z}f(z)\\
        &=\left(1+\frac{z}{2!}+\frac{z^2}{3!}\right)(b_0+b_1z+b_2z^2)+O(z^3)
    \end{align*}
    ここから，
    \begin{align*}
        b_0&=1,&b_1&=-\frac{1}{2},&b_2&=-\frac{1}{2}b_1-\frac{1}{3}=\frac{1}{12}.
    \end{align*}
    これは，漸化式
    \begin{align*}
        b_n+\sum^{n-1}_{k=0}\frac{b_k}{(n+1-k)!}&=0,&b_0&=1
    \end{align*}
    で続きを計算できる．この時の$(b_n)$を用いて，$B_n=n!b_n$はBernoulli数と呼ばれる．
    性質$b_{2n+1}=0\;(n\in\N\setminus\{0\})$はこの対応で簡単に示すことができる．
\end{example}

\section{回転数}

\begin{screen}
    数学なのに何か物理学のように感じるというのが何点かあった（所感\ref{remarks-Cauchy's-theorem}）．
    近傍による局所的な議論など．その極みなのではないか？

    今までCauchyの定理群の積分路は円周であったが，回転数を定義することにより，一般の$C^1$級曲線に対して，Cauchyの定理群を拡張することができる．
    Homotopy的な表示へ至る足場である．
\end{screen}

\subsection{回転数を用いたCauchyの積分表示}

\begin{definition}[winding number]
    区分的$C^1$級\textbf{閉}曲線\footnote{$C^1$の文言は外せる}$\gamma:[a,b]\to\C$について，像を$C=\gamma([a,b])$と置いた時，$z\in\C\setminus C$周りの\textbf{回転数}とは，積分値
    \[ \xymatrix@R-2pc{
        n:\Hom([a,b],\C)\times\C\setminus C\ar[r]&\Z\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (\gamma,z)\ar@{|->}[r]&\frac{1}{2\pi i}\int_\gamma\frac{d\zeta}{\zeta-z}
    } \]
    のことを指す．
\end{definition}

\begin{shadebox}\begin{theorem}\label{thm-Cauchy-winding-number}
    $D$を星形領域，$f$を$D$上の正則関数，$\gamma$を$D$内の区分的$C^1$\textbf{閉}曲線とする．
    この時，次が成り立つ：
    \[ \frac{1}{2\pi i}\int_\gamma \frac{f(\zeta)}{\zeta-z}d\zeta=n(\gamma,z)f(z)\qquad(z\in D\setminus\Im\gamma). \]
\end{theorem}\end{shadebox}
\begin{proof}
    $z\in D\setminus\Im\gamma$を任意に取る．
    $D$上の正則関数$f$を用いて得られる$\zeta$の関数$\frac{f(\zeta)-f(z)}{\zeta-z}$は$D\setminus\{z\}$上正則だから，$z$での値を$f'(z)$と定めることで$D$上正則に延長できる．
    よって，Cauchyの積分定理\ref{cor-Cauchy's-theorem}より，$D$内の閉曲線$\gamma$に沿った線積分は
    \[\int_\gamma\frac{f(\zeta)-f(z)}{\zeta-z}\;d\zeta=0.\]
    これより，
    \begin{align*}
        \int_\gamma\frac{f(\zeta)}{\zeta-z}\;d\zeta&=\frac{f(z)}{\zeta-z}\;d\zeta\\
        &=f(z)\frac{d\zeta}{\zeta-z}\\
        &=f(z)2\pi i\cdot n(\gamma,z).
    \end{align*}
\end{proof}
\begin{remarks}
    今までは，一回転しかしないモデル図形としても開球の言葉を使ってきたのである．
\end{remarks}

\subsection{回転数の性質}

\begin{lemma}\label{lemma-character-of-winding-number}
    $\C\setminus C=\bigcup_{\lambda\in\Lambda}V_\lambda$を，曲線$\gamma$による平面の分割$\C\setminus\Im\gamma$の，各連結成分への分解とする．
    \begin{enumerate}
        \item $\Im n(\gamma,z)\subset\Z$．
        \item $n(\gamma,z)$の各連結部分への制限は定値関数．
        \item 非有界な連結部分上では$n(\gamma,z)=0$．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 
    関数$h:[a,b]\to\C$を，
    \[h(t)=\int^t_a\frac{\gamma'(s)}{\gamma(s)-z}\;ds\qquad(t\in[a,b])\]
    と定める\footnote{$\gamma$は区分的$C^1$級なので，有限個の特異点は別で考える必要がある．}．特に，$h(b)=2\pi i\cdot n(\gamma,z)$である．この関数の値域が$\Z$に含まれること，stepするような関数であること，$\abs{z}\to\infty$では$0$であることを示せば良い．

    関数$\frac{e^{h(t)}}{\gamma(t)-z}$を考える．この微分は，\footnote{同様に，有限個の特異点は別で考える}
    \begin{align*}
        \frac{d}{dt}\frac{e^{h(t)}}{\gamma(t)-z}
        &=\frac{h'(t)e^{h(t)}(\gamma(t)-z)-e^{h(t)}\gamma'(t)}{(\gamma(t)-z)^2}\\
        &=\frac{\gamma'(t)e^{h(t)}-e^{h(t)}\gamma'(t)}{(\gamma(t)-z)^2}&\left(\because\quad h'(t)=\frac{\gamma'(t)}{\gamma(t)-z}\right)\\
        &=0
    \end{align*}
    だから，関数$\frac{e^{h(t)}}{\gamma(t)-z}$は定数関数であり，特に
    \begin{align*}
        \frac{1}{\gamma(a)-z}&=\frac{e^{2\pi i\cdot n(\gamma,z)}}{\gamma(b)-z}\\
        e^{2\pi i\cdot n(\gamma,z)}&=\frac{\gamma(b)-z}{\gamma(a)-z}=1
    \end{align*}
    が成り立つから，定理\ref{thm-period-of-exponential}より，$n(\gamma,z)\in\Z$である．
    \item $n(\gamma,z)$は$\C\setminus\Im\gamma$上の正則関数であるから，特に連続である．1.より$\Im n\subset\Z$であるから，各連結部分への制限は定数関数である．（中間値の定理より，矛盾が導ける背理法による証明）．
    \item $\abs{z}\to\infty$の時，$\left|\frac{1}{\zeta-z}\right|$は$\zeta\in\C$に依らず一様に$0$に収束するから，$\lim_{\abs{z}\to\infty}n(\gamma,z)=0$．
    \end{enumerate}
\end{proof}

\section{回転数の算譜}

\begin{screen}
    回転数は，非有界な部分では$0$で，
    $\gamma$を横切るごとに1ずつしか変化せず，
    その符号は横切る向きに依る．
    $\gamma$の接ベクトルを右手に見ながら横切る時に回転数は$1$増える．
\end{screen}

\begin{notation}
    有向線分$L=[\alpha,\beta]$と曲線$\gamma$がただ一つの交点$z_0=\gamma(t_0)\in(\alpha,\beta)$を持つとする．
    また，$\gamma'(t_0)$と$L$は並行でないとする：$\Im\frac{\gamma'(t_0)}{\beta-\alpha}\ne 0$．
    この符号を$\sigma=\sgn\paren{\Im\paren{\frac{\gamma'(t)}{\beta-\alpha}}}$と置く．
\end{notation}
\clearpage
\begin{proposition}
    次が成り立つ：
    \[n(\gamma,\alpha)=n(\gamma,\beta)+\sigma.\]
\end{proposition}
\begin{proof}
    $\sigma=1$，即ち$\Im\paren{\frac{\gamma'(t)}{\beta-\alpha}}>0$の場合を考える．$z\mapsto\frac{z-z_0}{\beta-\alpha}$という一次変換により，$z_0=0,L=[\alpha,\beta]\subset\R$として考えて良い．\footnote{補題参照}

    $\epsilon>0$を十分小さくとれば，$[\Delta(0,\epsilon)]\cap\gamma([a,b])$は$t_0$を含む閉区間$I\subset[a,b]$の像$\gamma(I)$となり，$\Delta(0,\epsilon)\setminus\gamma(I)$は２つの連結部分$D^+,D^-$に分割される．
    ただし，$D^+$は$(0,\beta)$と交わり，$D^-$は$(\alpha,0)$と交わる部分とした．（下図参照）．
    $\gamma$の$[\Delta(0,\epsilon)]$に含まれる部分を$\gamma_0:=\gamma|_I$と置く．
    円弧を$\gamma_0^{\pm}:=\partial D^{\pm}\cap\partial\Delta(0,\epsilon)$とし，
    それぞれに$\C\simeq\R^2$から定まる標準的な境界としての向きを定める．この時，$\partial D^\pm=\gamma_0^\pm\mp\gamma_0$である．
    \begin{center}\begin{tikzpicture}[>=stealth]
        \fill[lightgray] (0,0) circle (1);
        \fill[black] (0,0) circle (2pt) node[below left] {$O$};
        \draw[->, line width=1pt, darkgray] (-0.8,-3) .. controls (0.3,0) .. (-0.8,3) node[above right] {$\gamma$};
        \draw[->] (-3.5,0) -- (3.5,0) node[right] {$\Re$};
        \draw (-3,0.1) -- (-3,-0.1) node[below] {$\alpha$};
        \node[above] at (-3,0.1) {$L$};
        \draw (3,0.1) -- (3,-0.1) node[below] {$\beta$};
        \draw (0,0) circle (1);
        \node at (1,0) {\footnotesize$\blacktriangle$};
        \node at (-1,-0.03) {\footnotesize\rotatebox{180}{$\blacktriangle$}};
        \node[below right] at (1,0) {$\epsilon$};
        \node[above right] at (1,0) {$\gamma_0^+$};
        \node[below left] at (-1,0) {$\gamma_0^-$};
        \draw (-0.7,-0.5) .. controls (-1.5,-1.5) .. (-2,-2) node[below left] {$D^-$};
        \draw (0.4,-0.5) .. controls (1.5,-1.5) .. (2,-2) node[below right] {$D^+$};
        \draw (-0.1,0) ellipse (0.3 and 1);
        \draw (0,0.9) .. controls (0.5,1.3) .. (1.5,1.5) node[right] {$\gamma_0$};
    \end{tikzpicture}\end{center}
    ここで，$\gamma$の$\gamma_0$の部分を$\gamma_0^+,-\gamma_0^-$で置き換えて得られる曲線をそれぞれ$\gamma^+,\gamma^-$とすると，
    $\frac{1}{\zeta-\alpha}$は$D^+$上正則なので，$\int_\gamma\frac{d\zeta}{\zeta-\alpha}=\int_{\gamma^+}\frac{d\zeta}{\zeta-\alpha}$．
    即ち，$n(\gamma,\alpha)=n(\gamma^+,\alpha)$．すると，曲線$\gamma^+$に関して$0,\alpha$は同じ連結領域に分割されるから，$n(\gamma^+,\alpha)=n(\gamma^+,0)$．
    ２つ併せて$n(\gamma,\alpha)=n(\gamma^+,0)$．同様にして，$n(\gamma,\beta)=n(\gamma^-,0)$．
    いま，$\int_{\gamma^+}\frac{d\zeta}{\zeta}-\int_{\gamma^-}\frac{d\zeta}{\zeta}=\int_{\partial\Delta(0,\epsilon)}\frac{d\zeta}{\zeta}$より，
    $n(\gamma^+,0)=n(\gamma^-,0)+n(\partial\Delta(0,\epsilon),0)=n(\gamma^-,0)+1$．
\end{proof}
\begin{remarks}
    回転数とは，積分の境界作用素の部分の代数的性質を整数に落とし込んだ代物か．
    $n(\gamma^+-\gamma^-,0)=n(\partial\Delta(0,\epsilon),0)$なんてのも成り立つ．
\end{remarks}

\begin{lemma}
    $\C$の一次変換により，曲線の回転数は変わらない．
\end{lemma}
\begin{lemma}
    $\epsilon>0$が存在して，$[\Delta(0,\epsilon)]\cap\gamma([a,b])$は$t_0$を含む閉区間$I\subset[a,b]$の像$\gamma(I)$となり，$\Delta(0,\epsilon)\setminus\gamma(I)$は２つの連結部分$D^+,D^-$に分割される．
\end{lemma}

\section{曲線のホモトピー}

\begin{screen}
    homotopyは写像の間の連続変形であり，まるで2-射である．
    きっと高次圏論の重要な動機になっているとすでにわかる．
\end{screen}

\begin{definition}[homotopy]
    領域$D$上の曲線$\gamma_i:[0,1]\to D\;(j=0,1)$について，
    \begin{enumerate}
        \item $\gamma_0$と$\gamma_1$が\textbf{homotopic}であるとは，連続写像$\Phi:[0,1]\times[0,1]\to D$であって，
        \begin{align*}
            第二要素について\;\;\Phi(0,t)&=\gamma_0(t),&\Phi(1,t)&=\gamma_1(t),&(t\in[0,1]),\\
            第一要素について\;\;\Phi(s,0)&\equiv\gamma_0(0),&\Phi(s,1)&\equiv\gamma_1(0),&(s\in[0,1]),
        \end{align*}
        を満たすものが存在することをいう．この時，$\gamma_0\sim\gamma_1$と書く．
        \item 連続写像$\Phi$を曲線$\gamma_0,\gamma_1$の\textbf{homotopy}という．
    \end{enumerate}
\end{definition}

\begin{lemma}[homotopicは同値類を定める]
    領域$D$内の曲線$\gamma,\lambda,\mu$について，
    \begin{enumerate}
        \item $\gamma\sim\lambda,\lambda\sim\mu\Rightarrow\gamma\sim\mu$．
        \item $\gamma_1\sim\lambda_1,\gamma_2\sim\lambda_2\Rightarrow\gamma_1+\gamma_2\sim\lambda_1+\lambda_2$．
        \item $\gamma$とhomotopicな曲線全体からなる集合を$\{\gamma\}$と書き，\textbf{homotopy class}という．
    \end{enumerate}
\end{lemma}

\begin{definition}[null-homotopic, simply connected]\mbox{}
    \begin{enumerate}
        \item $p$を始点とする閉曲線が$1_p$とhomotopicである時，\textbf{1点にhomotopic}という．
        \item $D$の任意の点$p$について，任意の$p$から始まる閉曲線が1点にhomotopicである時，$D$を\textbf{単連結}という．
    \end{enumerate}
\end{definition}

\begin{lemma}
    $p$を始点とする任意の閉曲線が1点にhomotopicであるとする．この時，$D$内の任意の閉曲線が1点にhomotopicである．
\end{lemma}

\begin{proposition}
    $D$が単連結であることと，$\hat{C}\setminus D$が単連結であることは同値である．
    これは２次元に特有の性質となっている．
\end{proposition}

\section{ホモトピー型のCauchyの積分定理}

\begin{screen}
    足助先生が私に自分で発見させる形で最終課題を出してくれた，あれは本当に美しかった．
    Cauchyの定理はどう考えてもhomotopyの言葉で語った方が筋が良い．
    そしてこの言葉によって，potentialの存在が星形領域から解放され，単連結空間一般で定義できることになる．
    極めて自然な射の言葉による世界の拡張である．
    これをあのまま構成論的にやっていたならば，一般の領域に対して折れ線によって各地に届けねばならなかった．
    しかし，その構造を保存する射も，あるいはもしかしたら射の方が，重要な対象であることのappreciationが出来るようになってきた．
\end{screen}

\begin{theorem}[Cauchy's integral theorem in the terms of homotopy]\label{thm-Cauchy's-theorem-in-terms-of-homotopy}
    $f$を領域$D$上で定義された正則関数，$\gamma,\mu$を$D$内でhomotopicな曲線とする．
    \[ \int_\gamma f\;dz=\int_\mu f\;dz. \]
\end{theorem}

\begin{theorem}
    単連結領域上の正則関数は原始関数を持つ．
\end{theorem}

\chapter{正則関数の零点と極}

\begin{quotation}
    実関数における極値問題は，
    正則関数の零点とその位数という対象にまとまる．
    正則関数の零点は離散的である．極と零点は表裏一体であるから，離散的な極を持つ正則関数として有理型関数と言う自然な対象が定まる．
    するとこれは$\hatC$-正則写像のことを意味する．
    これを調べて，Laurent展開への足掛かりとする．舞台をRiemann球面へと遷すのである．
    主な証明の道具は位相空間論であり，孤立点と集積点，領域$D$の連結性などを使う．
    \begin{enumerate}
        \item 連結性は，数学的帰納法の無限濃度版であると言える．
        正則関数は大抵領域$D$上で考えるから，連結性が証明で使える場合がある．その代表的な結果が一致の定理となる．
        非常に非直感的な持ち上げの性質である．
        \item その連結性から足を伸ばすと，正則関数の零点は孤立することがわかる．従って，孤立していない零点を見つけると，その正則関数は零関数だとわかる（系\ref{cor-identity-theorem}）．
        \item Laurent展開以降の結果では，正則関数の特異点も孤立している必要があるから，孤立特異点を論ずる．
        \item Laurent展開へ至る重要な足掛かりとして，まずは反転を調べる．全ての正則関数は有理関数である．
    \end{enumerate}
    リーマン面はこの理論に書くことのできない実質的な構成部分であり，そのままこの理論の基礎である．それはまた，経験により多かれ少なかれ技巧的に解析関数から蒸留された何物かではなく，あくまでもそれ以前のもの，母なる大地，その上にこそ初めて諸関数が生育し繁茂し得る大地とみなされなければならない．
    \begin{flushright}
        Herman Weyl\cite{Weyl} 序文 (1913)
    \end{flushright}
\end{quotation}

\section{連結性と弧状連結性}

\begin{screen}
    連結性とは，連続的なデータ構造の，特に振る舞いの良い特性であると言えるだろう．
    まるで数学的帰納法である．
    正則関数は大抵領域$D$上で考えるから，連結性が証明で使える場合がある．その代表的な結果が一致の定理となる．
    この使用法が，正則関数の機運をよく表しているような気がする．
\end{screen}

\begin{proposition}[Riemann球面の部分集合の相対位相による開閉の特徴付け]\label{proposition-region-is-connected}
    $V\subset D\subset\hatC$とする．
    解析においては次の言い換えを多用する．
    \begin{description}
        \item[1] $V$が$D$-閉である．
        \item[1'] $V$の点列$(z_n)$が極限$z_\infty\in D$を持つならば，$z_\infty\in V$である．
        \item[2] $V$が$D$-開である．
        \item[2'] 任意の$z_0\in V$について，十分小さく近傍$U\subset\hatC$を取れば，$U\cap D\subset V$．
    \end{description}
\end{proposition}
\begin{proof}
    1は，Bolzano-Weierstrassの定理\ref{thm-Weierstrass}より，
    $\C$の有界閉集合は点列コンパクト性と同値で，定理\ref{thm-sequantial-compactness-and-compactness}より，点列コンパクト性はコンパクト性に同値である．
    $\hatC$では一般に閉集合であることがこれと同値な条件となる．

    2は，$V$が開集合であることと，$V$の任意の点に$V$の相対位相による近傍が取れることとは同値．
\end{proof}
\begin{remarks}
    $\hatC$の位相を正確に定めていないので，
    「$\hatC$の閉集合は全て有界である」とか言って良いのかわからない．
\end{remarks}

\begin{example}
    $\R$は$\C$-閉だが，$\hatC$-閉ではない．
    $(z_n=n)_{n\in\N}$は$\C$内では収束しないが，$\hatC$では収束する．
\end{example}

\begin{lemma}[domain, region]
    $D\subset\C$とする．次の２条件を考える．
    \begin{enumerate}[(1)]
        \item $D$は弧状連結．
        \item $D$は連結．
    \end{enumerate}
    (1)$\Rightarrow$(2)が成り立ち，$D$が開集合の時(2)$\Rightarrow$(1)も成り立つ．
    このような$D$を\textbf{領域}と言う．
\end{lemma}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] 
        $\emptyset\ne V\subset D$を開かつ閉とし，$V=D$を導く．
        任意の$p\in V,q\in D$について，これを結ぶ任意の道$\gamma:[0,1]\to D$に対し\footnote{道とは区間からの連続写像のこと}，実数$m$を$m=\sup\{t\in[0,1]\mid\gamma(t)\in V\}$と置いた時，$m=1$が導かれることを示せば良い．

        $V$は$D$-閉だから，$m=\max\{t\in[0,1]\mid\gamma(t)\in V\}$でもある．即ち$\gamma(m)\in V$．
        また$V$は$D$-開だから，$\gamma(m)\in V$の近傍$U$が存在して$U\cap D\subset V$を満たす．
        これより，$m<1$ならば，$\gamma$の連続性より，ある$\epsilon>0$が存在して$\gamma(m+\epsilon)\in U\cap D\subset V$を満たすので，$m$の定義（最大性）に矛盾．
        従って，$m=1$である．
        \item[(2)$\Rightarrow$(1)] 
        任意の$p\in D$について，$V=\{q\in D\mid pとqを結ぶ道\gamma_q:[0,1]\to Dが存在する\}$
        とすると，$V=D$が従うことを示す．

        $V$は$D$-開と示す．任意に$q\in V$を取ると，$q\in D$でもあるから，$\epsilon>0$が存在して$\Delta(q,\epsilon)\subset D$である．
        この時，任意の$r\in\Delta(q,\epsilon)$について，$\gamma_q$に線分$[q,r]$を繋げたものは再び道だから，
        $\Delta(q,\epsilon)\subset V$が従う．

        $V$は$D$-閉と示す．$D$内に収束する$V$の点列$(z_n)$を任意に取る．ある$\epsilon>0$が存在して，$\Delta(z_\infty,\epsilon)$は十分大きな$N$について，$z_n\;(n\ge N)$を含む．
        すると，$\gamma_{z_N}$と線分$[z_N,z_\infty]$を繋げたものは道である．よって，$z_\infty\in V$．
    \end{description}
\end{proof}
\begin{remarks}
    (1)$\Rightarrow$(2)について，「開かつ閉」と言うのは極めて特殊な集合にならざるを得ず，
    弧状連結の場合はそれが全体集合に限られてしまうのだな．
    (2)$\Rightarrow$(1)の証明はまさに連続版帰納法の構図となっている．
    初め，$p,q\in D$には道$\gamma:[0,1]\to D$が存在しないと仮定し矛盾を導く，
    すると$P=\{p'\in D\mid pからp'への道が存在する\},Q$とし，$D\setminus (P\cup Q)$で繰り返していけば，
    $D$が２つ以上の連結部分に分割できて，これらが開かつ閉となることに矛盾，としたが，上記の方針がより直接的である．

    なぜ数学的帰納法や連結性により，結果が持ち上げられるか．
    境界の条件だけが大事だからである．
    $n,n+1$の結果が接着しているなら，全体空間まで結果が持ち上がると言うドミノ倒しの本質は変わらない．
\end{remarks}

\begin{example}[連結であって弧状連結でない例]
    $I=[-i,i],V=\left\{x+i\sin\frac{\pi}{x}\;\middle|\;x\in(0,1]\right\}$とし，$D=I\cup V$と定めるとこれは連結であるが弧状連結ではない．
    原点$O$と$V$は共有点は持たないが，位相的に分離不可能であるから，$D$は２つの連結部分に分解することはできない．
    かと言って共有点は持たないので，道で結べない．
\end{example}

\section{正則関数の零点は孤立する}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=複素関数の解析性から流出する性質]
    \begin{enumerate}
        \item 領域$D$上の正則関数は，ある一点で任意階数の導値が$0$ならば，零関数である．Taylor展開より，局所的に零であるだけでなく，fiberの共通部分は閉になるからである．
        \item 零関数でない正則関数の零点は孤立する．Taylor展開により，その近傍では零点は一つだからだ．
    \end{enumerate}
    集合$S$が$S$-孤立点の合併ではないとは，ある点$x\in X$が存在して，その任意の開近傍が
    $S$の他の点を必ず含むことをいう（分離不可能）．
    これは開集合・閉集合の概念よりも先立って存在する観念で，このような点を集積点／極限点という．
    孤立点の対義語として捉えられるのである．

    正則関数の零点は必ず孤立する（定理\ref{thm-zeros-are-isolated}）．
    これは正則関数は局所的にTaylor展開を持つことと，零関数の局所的な言葉による特徴付け（定理\ref{thm-local-characterization-of-zero-function}）からわかる．
    だから，孤立点の合併ではないような集合になるなら，それは零関数しかあり得ないとわかる．
\end{tcolorbox}

\begin{theorem}[零関数の局所的な特徴付け]\label{thm-local-characterization-of-zero-function}
    $f:D\to\C$を領域$D$上の正則関数とする．ある点$a\in D$について，次が成り立てば，$f\equiv 0\quad\mathrm{on}\;D$である．
    \[\forall j\in\N,\;f^{(j)}(a)=0.\]
\end{theorem}
\begin{proof}
    $E=\{z\in D\mid \forall j\in\N,\; f^{(j)}(z)=0\}$とすると，$a\in E$より$E\ne\emptyset$．
    $E=D$を示す．命題\ref{proposition-region-is-connected}より，領域$D$とは連結だから，
    \begin{description}
        \item[$E$は$D$-閉]
        $f^{(j)}$は正則，特に連続であるから，零点集合$E_j=(f^{(j)})^{-1}(0)$は$D$-閉である．
        従って，共通部分$E=\cap_{j=0}^\infty E_j$も閉である．
        \item[$E$は$D$-開]
        $z\in E$を任意に取る．系\ref{cor-serial-expression-of-regular-functions}より，$r>0$が存在して，
        $f(w)=\sum^\infty_{n=0}(w-z)^n\;\;(w\in\Delta(a,r)\subset D)$と表せるが，$z\in E$より，$a_n=0\;(\forall n\in\N)$．
        従って，$\Delta(a,r)\subset E$．
    \end{description}
\end{proof}
\begin{remarks}[美しすぎる]
    $f$は$D$上正則だから，系\ref{cor-serial-expression-of-regular-functions}より，
    $a\in D$において$r>0$が存在して，$f(z)=\sum^\infty_{n=0}a_n(z-a)^n\;(z\in\Delta(a,r)\subset D)$
    と表せる．$f(z)=0$より$a_0=0$を得ていき，$f^{(j)}(z)=0$より順次$a_j=0$を得る．
    これに定理の条件を照らし合わせると，$a_i=0\;(i=0,1,\cdots,\infty)$が導かれる．
    が，これだけでは領域$D$全体には響かない．これは帰納法の一部であったのだ！
    この構造こそが重要．
\end{remarks}

\begin{theorem}[零点の孤立]\label{thm-zeros-are-isolated}
    正則関数$f:D\to\C$は零写像ではないとする．この時，$f$の零点は孤立している．
\end{theorem}
\begin{proof}
    $f$は零写像ではないから，定理\ref{thm-local-characterization-of-zero-function}の対偶より，
    任意の零点$a\in f^{-1}(0)$についてある自然数$m\in\N$が存在して$f^{(m)}(a)\ne 0$を満たす．即ち，$f$の全ての零点は有限の位数を持つ．
    この時，Taylor展開（系\ref{cor-serial-expression-of-regular-functions}）より，
    $a$のある開近傍$U$上において，$f(z)=\sum^{\infty}_{n=m}f^{(n)}(a)(z-a)^n$と表せるから，$U$において$a$以外に$f$は零点を持たない．
    従って，$a$は$f^{-1}(0)$-孤立点である．
\end{proof}

\begin{corollary}[一致の定理]\label{cor-identity-theorem}
    領域$D$上で定義された２つの正則関数$f,g$が，
    ある$D$内に集積点を持つような集合上で一致すれば，$f\equiv g\;\;(\mathrm{on}\;D)$である．
\end{corollary}
\begin{proof}
    正則関数$f-g$を考えると，この零点はある集積点において$D$上孤立していない．
    従って，定理\ref{thm-zeros-are-isolated}より，
    $f-g=0$である．従って，$f=g\in\Hom(D,\C)$．
\end{proof}

\section{孤立特異点}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    特異(singular)とは，正則(regular)の対義語であり，関数が正則性を失う点である．
    特異点が孤立している場合は，可除なものか，極か，真性特異点である．
    極は一見扱いやすく見えるかもしれないが，多変数関数論では真に複雑な構造をあらわにする．
\end{tcolorbox}

\begin{notation}[isolated singularity]
    特異点のうち，他の特異点を持たない近傍が取れるものを\textbf{孤立特異点}という．そこで，
    $\Delta^*(a,r):=\Delta(a,r)\setminus\{a\}$と表す．
\end{notation}

\begin{definition}[isolated singularity, removable singularity, pole, essential singularity]
    正則関数$f:\Delta^*(a,r)\to\C$に対して，点$a$を\textbf{孤立特異点}という．
    \begin{enumerate}
        \item $\lim_{z\to a}f(z)\in\C$が存在する時，これを\textbf{除去可能特異点}または\textbf{可除特異点}という．
        \item $\lim_{z\to a}f(z)=\infty$である時，これは\textbf{極}である．
        \item $\lim_{z\to a}f(z)\in\hatC$が存在しない時，これを\textbf{真性特異点}という．
    \end{enumerate}
\end{definition}

\subsection{可除特異点の場合}

\begin{screen}
    可除特異点の場合，$f(a):=\lim_{z\to a}f(z)\in\C$とすることで，$f:\Delta(a,r)\to\C$に連続に延長できる．従って，正則に延長できるから，特異点は消せる．
    この場合の同値条件を考える．近傍で有界なら良い．
\end{screen}

\begin{theorem}[可除特異点の特徴付け(Riemann)]\label{thm-Riemann's-removable-zeros}
    $f:D\setminus\{a\}\to\C$について，$a\in D$を孤立特異点とする．
    次の条件は同値である．
    \begin{enumerate}
        \item $a$は除去可能である（$f$は$D$上に一意的に延長できる）．
        \item $\lim_{z\to a}(z-a)f(z)=0$．
        \item $a$の近傍が存在して，その上で$f$は有界である．
    \end{enumerate}
\end{theorem}
\begin{proof}
    2$\Leftrightarrow$3である．
    \begin{description}
        \item[1$\Rightarrow$2] 
        $\lim_{z\to a}f(z)\in\C$が存在する時，$\lim_{z\to a}(z-a)f(z)=0$である．
        \item[2$\Rightarrow$1] 
        $g(z):=(z-a)f(z)$と置けば，$\lim_{z\to a}g(z)=0\in\C$であるため，$a$は$g$の可除特異点である．
        従って，$g(z)=0$に注意すれば，$r>0$が存在して，$\Delta(a,r)$上で正則関数$h:\Delta(a,r)\to\C$を用いて$g(z)=(z-a)h(z)$と表せる．
        $\Delta^*(a,r)$上で$f$と$h$は一致するから，一致の定理（系\ref{cor-identity-theorem}）より，$h$が$f$の$z=a$での延長を与えている．
    \end{description}
\end{proof}

\subsection{極の場合}

\begin{screen}
    極はRiemann球面の張り替え（＝反転）を考えれば，零点に変換される．
    この考え方はLaurent展開とその主要部に結晶される．
\end{screen}

\begin{definition}[極の主要部]
    $r>0$が存在して，正則関数$\varphi:\Delta(a,r)\to\C$が存在して，
    \[f(z)=\frac{a_0}{(z-a)^m}+\frac{a_1}{(z-a)^{m-1}}+\cdots+\frac{a_{m-1}}{z-a}+\varphi(z)\qquad\mathrm{on}\;\Delta(a,r)\]
    と表せる．$f-\varphi$を\textbf{主要部}と呼ぶ．$a$を$f$の\textbf{$m$位の極}と呼ぶ．
\end{definition}

\subsection{真性特異点の場合}

\begin{screen}
    真性特異点は，近づけ方に依って，好きな値に収束させることができる．
\end{screen}

\begin{theorem}
    $a$を$f$の真性特異点とする．
    任意の$\alpha\in\hatC$に対して，$r>0$が存在して，
    $\Delta^*(z,r)$の$a$に収束する点列$(z_n)_{n\in\N}$であって，
    $\lim_{n\to\infty}f(z_n)=\alpha$を満たすものが存在する．
\end{theorem}
\begin{proof}
    \begin{description}
        \item[$a=\infty$の時] 
        近傍として，$\Delta^*(a,1/n)$を考えると，任意の$n\in\N$について，この上で$f$は有界ではない．有界であるとすると，定理\ref{thm-Riemann's-removable-zeros}.3より，$a$は除去可能となり矛盾．
        よって，各$n$について，$\abs{f(z_n)}>n$を満たす点$z_n\in\Delta^*(a,1/n)$が取れる．
        これがなす列$(z_n)$は$a$に収束し，また各$f(\Delta^*(a,1/n))$は有界ではないから，$\lim_{n\to\infty}f(z_n)=\infty$．
        \item[$\alpha\in\C$の時]
        $g(z):=\frac{1}{f(z)-\alpha}$を考える．
        すると，$g$も$a$を真性特異点とする．実際，$\lim_{z\to a}g(z)=\beta\in\hatC$が存在する時，$\lim_{z\to a}g(z)=\beta=\frac{1}{\lim_{z\to a}f(z)-\alpha}$より，$\lim_{z\to a}f(z)=\frac{1}{\beta}+\alpha\in\hatC$となり，$a$が$f$の真性特異点であることに矛盾．
        この$g$について，$\lim_{z\to a}g(z)=\infty$となる場合の$\Delta^*(a,r)$の点列$(z_n)$は存在する．
        この$(z_n)$について，$\lim_{n\to\infty}g(z)=\frac{1}{\lim_{n\to \infty}f(z_n)-\alpha}=\infty$．従って，$\lim_{n\to\infty}f(z_n)=\alpha$．
    \end{description}
\end{proof}
\begin{remarks}
    $g(z):=\frac{1}{f(z)-\alpha}$は技巧的に見えるが，反転の技術はCauchyの定理からずっと続く伝統である．
\end{remarks}

\begin{example}[inversion]\label{exp-inversion}
    $f(z)=\exp\paren{\frac{1}{z}}$は$f:\C^*\to\hatC$を定める．これについて，$\forall r>0,\;f(\Delta^*(0,r))=\C^*$が成り立つ．
    \[\xymatrix@R-2pc{
        \inv:\C^*\ar[r]&\C^*&f:\C^*\ar[r]&\C^*\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        z\ar@{|->}[r]&\frac{1}{z}&z\ar@{|->}[r]&e^{\frac{1}{z}}
    }\]
    とすると，$f=\exp\circ\;\inv$と表せる．
    $r>0$を任意に取る．$\inv(\D)=\C\setminus[\Delta(0,1/r)]$である．
    $\exp$の周期性より，
    \[L_n=\{z\in\C\mid\Im z\in[2n\pi,2(n+1)\pi]\}\]
    とすると，$\exp(L_n)=\C^*$であるが，
    \[\Cr\supset L_n\;(n>1/2\pi r)\]
    より，$\exp(\Cr)=\C^*$である．
    以上より，
    \[f(\D)=\exp\circ\;\inv(\D)=\exp(\Cr)=\C^*.\]
\end{example}

\begin{theorem}[Picard's great theorem]
    $a$を$f$の真性特異点とする．任意の$\Delta^*(a,r)\subset\dom f$について，$\C\setminus f(\Delta^*(a,r))$は高々一点集合である．
\end{theorem}

\section{有理型関数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    有理型関数は，定値写像$\infty$の例を除いて，「$\hatC$値正則関数」の概念に一致する．
    有理型関数は合成について閉じるので，射を定める．$\End(\hatC)$は有理関数全体の集合に一致する．
\end{tcolorbox}

\subsection{定義}

\begin{definition}[meromorphic function]\label{def-meromorphic function}
    領域$D\subset\C$上の連続関数$f:D\to\hatC$が，
    \begin{enumerate}
        \item $E:=f^{-1}(\infty)$が$D$上の離散集合であり，\footnote{正則関数$g=\inv\circ f:D\to\hatC$の零点だから，わざわざこの条件を有理型関数の定義につけずとも$f^{-1}(\infty)$は離散的になる．}
        \item $f$が$D':=D\setminus E$上正則である時，
    \end{enumerate}
    $f$を\textbf{有理型関数}という．
    この時$E$は$f$の極の集合である．
\end{definition}

\begin{theorem}[$\hatC$-正則関数との概念のズレ]
    領域$D\subset\C$上の$\hatC$値正則関数$f:D\to\hatC$は，有理型関数であるか$\infty$値の定数関数であるかのいずれかである．
\end{theorem}
\begin{proof}
    即ち，$\hatC$値正則関数$f:D\to\hatC$について，集合$f^{-1}(\infty)\subset D$は
    離散集合であるか，そうでなければ$f^{-1}(\infty)=D$が成り立つことを示せば良い．

    $f:D\to\hatC$の極は$g:=\frac{1}{f}$と定めた時の正則関数$g:D\setminus f^{-1}(0)\to\C$の零点である．$V:=\{w\in f^{-1}(\infty)\mid\forall n\in\N,\; g^{(n)}(w)=0\}$と置くと，これは閉集合の共通部分だから$D$-閉．
    また，系\ref{cor-serial-expression-of-regular-functions}による$g$の任意の$w\in V$周りでのTaylor展開を考えることで，$w\in V$ならば$r>0$が存在して$\Delta(w,r)\subset V$が導ける．よって，$V$は$D$-開でもある．
    $D$の連結性より，$V=D$．即ち，$f=\infty\;\;\mathrm{on}\;D$．
\end{proof}
\begin{remarks}
    後半の証明は，一致の定理\ref{cor-identity-theorem}のstatementと，値域に$\infty$が追加されている点だけ違う．
    実際，主張している内容は，$f^{-1}(\infty)$が集積点を持つ，即ち$f^{-1}(\infty)$上で$f=\infty$が成り立っているのだから，$D$上でも$f=\infty$が成り立つ，を結論しているので，
    一致の定理の変形と呼べるものになっている．
    実際の証明の構造は，零関数の特徴付け定理\ref{thm-local-characterization-of-zero-function}と並行になる．

    $g:D\setminus f^{-1}(0)\to\C$の定義域が連結であるとは限らないので，
    $g$の零点が離散的でないからと言って一致の定理を用いて即座に零関数であるとは結論づけることができない．
\end{remarks}

\begin{example}[rational function]
    数の拡張は解析にてなされる．
    $P(z),Q(z)$を共通零点を持たない多項式とする時，$f(z):=\frac{P(z)}{Q(z)}$を\textbf{有理関数}という．
    有理関数の極は，$Q(z)$の零点だから離散的であるため，有理関数は有理型関数である．
\end{example}

\begin{example}
    有理型関数は合成について閉じる．$f^*,g^*:P(\hatC)\to P(\C)$が離散集合を保つ時，その合成も離散集合を保つからである．
    $\frac{1}{\sin}=\inv\circ\sin:\C\to\C^*$は$2\pi n$に１位の極を持つ有理型関数である．
    $\frac{1}{\sin\frac{1}{z}}=\inv\circ\sin\circ\inv:\C^*\to\C^*$も有理型関数であり，$z=0$は真性特異点である．
\end{example}

\begin{lemma}[有理型関数は合成について閉じている]
    $E\subset\C$を離散集合とする．
    連続関数$f:D\to\C$に関して，$F:=f^{-1}(E)$と定めると，$F$も離散である．
\end{lemma}
\begin{proof}
    任意に$p\in E$を取ると，$E$は離散集合であるから，$U\cap E=\{p\}$を満たす近傍$U\subset\C$が存在する．
    従って，$f^{-1}(p)$は開集合である．またこれは正則関数$f-p$の零点集合であるから離散的である．
    従って，$F=\cup_{p\in E}f^{-1}(p)$も一点からなる開集合に分割でき，全体として離散である．
\end{proof}

\begin{remark}
    \href{https://ja.wikipedia.org/wiki/有理型関数}{実は}有理型関数の集合$\Hom(D,\hatC)$は体をなし，$\C$の拡大体となっている．
\end{remark}

\subsection{Riemann球面上の有理型関数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $\C$上の正則関数（整関数）は多項式をはじめ，色々あるが，$\hatC$上の有理型関数は有理関数である．そして$\hatC$の双正則関数は一次分数変換である．
    この綺麗な性質は$\hatC$のコンパクト性による．
\end{tcolorbox}

\begin{screen}
    先ほどは，$\hatC$値正則関数のクラスとして有理型関数を導入した．次は定義域に$\infty$を追加する．

    inversionとは，Riemann球面の構成法の２つを入れ替えることに当たる．北極点と南極点の包み換えである．
    すると，$0$と$\infty$が対応する．
    こうして，$\hatC$上の有理型関数と有理関数とが完全に対応するという結果を得る．
    関数が生息する母なる大地として真にふさわしい，その最初の適性はコンパクト性である．

    定義域をコンパクトな$\hatC$からさらに狭まれば，有理関数ではない例を得るし，極も有限個とは限らない．
\end{screen}

\begin{definition}[北極点での正則性]
    例\ref{exp-inversion}の通り，$\C\setminus[\Delta(0,R)]$上の正則関数$f$に対して，$g(z):=f(1/z)$と定めると，これは$\Delta^*(1,1/R)$上の正則関数となる．
    この$g$について，
    \begin{enumerate}
        \item $0$が除去可能特異点である時，$f$は$\infty$において正則であるといい，$f$は$\infty$近傍で定義された$\hatC$上の連続関数に延長できる．
        \item $0$が$m$位の零点／極／真性特異点である時，$f$について，$\infty$は$m$位の零点／極／真性特異点であるという．
    \end{enumerate}
\end{definition}

\begin{definition}[$\hatC$上の有理型関数]
    $\hatC$上の有理型関数も，同様に極を除いて正則である$\hatC$値連続関数のこととして定める．
\end{definition}

\begin{theorem}\label{thm-meromorphic-function-is-rational}
    $\hatC$上の有理型関数は有理関数である．
\end{theorem}
\begin{proof}
    $\hatC$上の有理型関数$f:\hatC\to\hatC$を任意に取る．
    $f^{-1}(\infty)$は離散集合であり，$\hatC$はコンパクトであるから，$f^{-1}(\infty)$は有限集合である．
    これより，$f^{-1}(\infty)=\{p_1,\cdots,p_n\}$と置く．

    各$j\in[n]$について，
    \begin{itemize}
        \item $p_j\in\C$ならば，$f$の$p_j$での極の主要部を$P_j(z)=\frac{a_{j_1}}{(z-p_j)^{m_j}}+\cdots+\frac{a_{j_m}}{z-p_j}$とし，
        \item $p_j=\infty$ならば，$g:=f\circ\inv$の$w=0$での極の主要部を$Q(w)=\frac{a_{j_1}}{w^{m_j}}+\cdots+\frac{a_{j_m}}{w}$と置くことで，$P_j(z)=Q\circ\inv(z)=a_{j_1}z^{m_j}+\cdots+a_{j_m}z$
    \end{itemize}
    と定め，関数$F:=f-\sum^n_{j=1}P_j$を考える．
    
    まず，これが，全ての特異点が取り除かれた結果，$\hatC$上の正則関数であることを示す．
    特に$f^{-1}(\infty)$上で正則であることを示せば良い．
    $p_j\in\C$では，$F=(f-P_j)-\sum^n_{k=1,k\ne j}P_j$とみると，
    右辺のいずれの項も正則であることがわかる．
    残る$p_j=\infty$である時，第二項は$0$に収束し，第一項は$\lim_{z\to\infty}(f(z)-P_j(z))=\lim_{w\to 0}(g(w)-Q(w))\in\C$はと収束する．
    従って，確かに$F:\hatC\to\hatC$は正則に定まっている．

    $\hatC$はコンパクトなので，実数値関数$|F|:\hatC\to\R$は最大値を持つ．
    従って，$F$は有界である．よって，Liouvilleの定理\ref{thm-Liouville}より，$F|_\C$は定数である．
    従って，$F$も定数である．$F=c$とすると，$f=\sum^n_{j=1}P_j+c$より，これは有理関数である．
\end{proof}
\begin{remarks}
    真に関数の生育する地$\hatC$では，極は有限であるから，その主要部を取り除く算譜が存在する．
    その結果，有理型関数から，その極を取り除いたのだからもう他に特異点はなく，全域で正則な整関数を得る．
    $p_j=\infty$の時は特別な取り扱いが必要で，ここでの極とは$\sum^m_{i=1}a_iz^i$の形の発散点のことに他ならないので，
    Riemann球面を張り替えたものの上の関数と取り換えて（$g:=f\circ\inv$とし），
    $w=0$に極を移送する．
\end{remarks}

\section{一次変換}

\begin{screen}
    有理関数＝$\hatC$上の，極のみを特異点としてもつ正則関数の重要なクラス$\Aut(\hatC)\subset\End(\hat\C)$を調べる．
    一次分数変換とは，Riemann球面の同型＝双正則関数のことである．
    換言すれば，$\hatC$上の全単射な等角写像はMöbius変換に限る．

    この名前は，Riemann球面の同型は，$\hatC\simeq\Pone$によって，Riemann球面を
    atlas $\pi_1,\pi_2$を持つ複素多様体と見た時の
    座標表示について，一次多項式の有理関数の形で表せるからである．

    なお，$\Aut(\hatC)=\mathrm{PGL}_2(\C)=\GL_2(\C)/\{\lambda\id\mid\lambda\in\C^\times\}$が成り立つ．
    $k=\C$のように，二乗根についても閉じている代数的閉体であったら，$\mathrm{PGL}_2(\C)=\SL_2(\C)/\pm\id$が成り立つ．

    円円対応の幾何学的性質を導くのに，射影空間のことばを借りる．
\end{screen}

\begin{definition}[Möbius transformation / homography / linear fractional transformation]
    有理関数のうち，特に次の形をしたものを\textbf{一次（分数）変換}という．
    \[S(z)=\frac{az+b}{cz+d}\qquad\paren{a,b,c,d\in\C,\;\det\begin{pmatrix}a&b\\c&d\end{pmatrix}\in\C^\times}\]
    これは合成と逆について閉じている：$S^{-1}(w)=\frac{dw+b}{-cw+a}$．
    一次変換全体のなす群を$\Aut(\hatC)$と表す．
\end{definition}

\subsection{一次分数変換の行列表示}

\begin{definition}[projective space]
    一次元複素射影空間$\P^1(\C)$または$\C\P^1$を
    \[\P^1(\C):=\{l\subset\C^2\mid lは\C^2の複素一次元部分空間\}\]
    と定義する．
    \begin{enumerate}
        \item 各$l$は基底$\begin{pmatrix}\zeta_1\\\zeta_2\end{pmatrix}\in\C^2\setminus\{0\}$を用いて$l=\C\begin{pmatrix}\zeta_1\\\zeta_2\end{pmatrix}$と表せる．
        \item $\Pone=U_1\cup U_2$と表せる：\[U_j=\left\{\C\begin{pmatrix}\zeta_1\\\zeta_2\end{pmatrix}\in\Pone\;\middle|\;\zeta_j\ne 0\right\}\qquad j=1,2.\]
        \item 次の集合の同型$\pi_1,\pi_2$が存在する．
        \[\xymatrix@R-2pc{
            U_1\ar[r]&\C&U_2\ar[r]&\C\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            \C{\begin{pmatrix}\zeta_1\\\zeta_2\end{pmatrix}}\ar@{|->}[r]&\zeta_2/\zeta_1&\C{\begin{pmatrix}\zeta_1\\\zeta_2\end{pmatrix}}\ar@{|->}[r]&\zeta_1/\zeta_2
        }\]
        \item $\pi_{j}(U_1\cup U_2)=\C^*\;\;(j=1,2)$であり，次の図式は可換である．即ち，２つの近傍座標$\{(U_1,\pi_1),(U_2,\pi_2)\}$を持ち，$\inv:\C^*\to\C^*$を座標変換とする複素多様体の構造を$\Pone$の中に捉えたこととなる．
        \[\xymatrix{
            &U_1\cup U_2\ar[dl]_-{\pi_1}\ar[dr]^-{\pi_2}\\
            \C^*\ar[rr]^-{\inv}&&\C^*
        }\]
        \item 従って，$\Pone$は２つの複素平面$\C$を，$\C^*$上で$z$と$1/z$との同一視により貼り合わせて得る空間ともみなせる．
        \item 実際，一般の射影空間$\P^n(K)$の定義としては，「$n+1$個の$K$の元の比$[x_0,x_1,\cdots,x_n]$全体の集合」という条件を作用する．この元（標準全射$p$の値）を\textbf{斉次座標}(homogeneous coordinates)という．即ち，$K^{n+1}$を同値関係$x\sim y:\Leftrightarrow\exists k\in K,\;x=ky$で割ったもの$(K^{n+1}\setminus\{0\})/\sim=:\P^n(K)$として定める．$K=\R,\C$の時，商位相が自然に入る．
        \item 変数変換$\pi_2\circ\pi_1^{-1}$が有理関数で与えられることから，一般の体$K$について，$\P^n(K)$はZariski位相について代数多様体となる．
        \item 実はこの同一視は$\hatC$とも同一であり，２つは同相である：$\Pone\simeq\hatC\simeq S^2$．
    \end{enumerate}
\end{definition}

\begin{definition}[projective linear transformaton group]
    $\C^2$には，
    \[\SL_2(\C)=\left\{A=\begin{pmatrix}a&b\\c&d\end{pmatrix}\in M_2(\C)\;\middle|\;\det A=1\right\}\]
    が，左から行列積の計算規則で作用する：$\SL_2(\C)\times\Pone\to\Pone$．
    \begin{enumerate}
        \item 各線形作用$A\in\SL_2(\C)$は，部分空間の間に次の同型を定める．これは行列$A$が定める線型写像$f_A=A\times$の像写像$(f_A)_*$が定める線型写像である．
        \[\xymatrix@R-2pc{
            S_A:\Pone\ar[r]&\Pone\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            \C\zeta\ar@{|->}[r]&A(\C\zeta)=\C(A\zeta)
        }\]
        \item $S_A\in\Aut(\C\P^1)$の作用を$\pi_1(U_1)=\C^*$上の座標$z$を用いて表すと，$p_1:\C^*\to\C\P^1$を標準全射として，$\pi_1\circ S_A\circ p_1:\C^*\to\C^*$だから，
        \[z\mapsto\C\begin{pmatrix}z\\1\end{pmatrix}\mapsto\C\begin{pmatrix}az+b\\cz+d\end{pmatrix}\mapsto\frac{az+b}{cz+d}\]
        となる．
        \item 以上の議論より，$\P^1(\C)$上の同型$A\in\SL_2(\C)$に，一次分数変換の表示$\pi_1\circ S_A\circ p_1=\frac{az+b}{cz+d}$を対応させるような群の射が存在する．
        \[\xymatrix@R-2pc{
            S:\SL_2(\C)\ar[r]&\Aut(\hatC)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            A\ar@{|->}[r]&S_A
        }\]
        これは符号の違いの分だけ可逆でない（補題）．
    \end{enumerate}
\end{definition}

\begin{lemma}[$\Isom(\SL_2(\C),\C\P^1)$について]
    $A,B\in\SL_2(\C)$について，次が成り立つ．
    \begin{enumerate}
        \item $S_A\circ S_B=S_{AB}$．
        \item $\forall z\in\C,\; S_A(z)=z$と$A=\pm\id\in M_2(\C)$は同値．
    \end{enumerate}
\end{lemma}
\begin{proof}
    2.を示す．$S_A(z)=z$の分母を払うと$cz^2+(d-a)z-b=0$より，$b=c=0,d=a$．$\det A=1$より，$a=d=\pm 1$が従う．
\end{proof}
\begin{remarks}
    $f,g$を可逆射とした時の性質$(f\circ g)_*=f_*\circ g_*$，$(f^{-1})_*=(f_*)^{-1}$の系である．
    群同型$\Aut(\hatC)\simeq\SL_2(\C)/{\pm I}$を意味する．
    こっちも貼り合わせか．
\end{remarks}

\subsection{非調和比}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=一次変換の式の読み方]
    群作用$\SL_2(\C)\times\Pone\to\Pone$には，標準分解が存在する．
    これを用いて，3-鋭可移（相異なる３点の行き先を定めると，それを満たす群作用が一意に定まる）であることが示せる．
    これが，非調和比という不変量の定義の動機となる．
    つまり，一次変換$e\frac{a-bz}{c-dz}$は零点と極に注目し，あと係数が定まると一意に定まる．
    この一次変換による適当な$z_1\in C$の値を非調和比といい，この値は一次変換の取り方に依らない．
    全く意味論を拒絶する神秘的な消息である．
\end{tcolorbox}

\begin{example}[並行，回転・拡大，反転変換]\label{exp-basis-of-auto-hatC}
    群の射$S:\SL_2(\C)\to\Aut(\hatC)$は次のようになっている．
    \begin{enumerate}
        \item $A=\begin{pmatrix}1&\alpha\\0&1\end{pmatrix}\mapsto S_A(z)=z+\alpha$．実際，$z\mapsto\C\begin{pmatrix}z\\1\end{pmatrix}\mapsto\C\begin{pmatrix}z+\alpha\\1\end{pmatrix}\mapsto z+\alpha$．
        \item $A=\begin{pmatrix}\alpha&0\\0&\alpha^{-1}\end{pmatrix}\mapsto S_A(z)=\alpha^2z$．実際，$z\mapsto\C\begin{pmatrix}z\\1\end{pmatrix}\mapsto\C\begin{pmatrix}\alpha z\\\alpha^{-1}\end{pmatrix}\mapsto\alpha^2z$．
        \item $A=\begin{pmatrix}0&i\\i&0\end{pmatrix}\mapsto S_A(z)=z^{-1}$．実際，$z\mapsto\C\begin{pmatrix}z\\1\end{pmatrix}\mapsto\C\begin{pmatrix}i\\iz\end{pmatrix}\mapsto z^{-1}$．
    \end{enumerate}
\end{example}
\begin{remark}
    $\alpha^2$が何かと思ったが，命題\ref{prop-correspondence-between-complex-derivative-and-Yacobian}に
    ある通り，$f$の定める変換のYacobian（拡大率）だろう．
\end{remark}

\begin{proposition}[Möbius変換の標準分解]
    $S\in\Aut(\hatC)$は上の例\ref{exp-basis-of-auto-hatC}の３種の変換に分解できる．
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[$c\ne 0$の時] 
        \begin{align*}
            S(z)&=\frac{az+b}{cz+d}\\
            &=\frac{\frac{a}{c}(cz+d)+b-\frac{ad}{c}}{cz+d}\\
            &=\frac{a}{c}+\frac{bc-ad}{c^2\paren{z+\frac{d}{c}}}
        \end{align*}
        より，
        \[z\mapsto z+\frac{d}{c}\mapsto\frac{c}{cz+d}\mapsto\frac{bc-ad}{c^2z+cd}\mapsto\frac{a}{c}+\frac{bc-ad}{c^2\paren{z+\frac{d}{c}}}\]
        と見ると，平行移動，反転，回転・拡大，平行移動の合成である．
        \item[$c=0$の時]
        \[S(z)=\frac{a}{d}z+\frac{b}{d}.\]
    \end{description}
\end{proof}

\begin{theorem}[the action is sharply 3-transitive]\label{thm-SL2-action-is-3-transitive}
    $\hatC$の相異なる３点$z_2,z_3,z_4$について，
    \begin{align*}
        S(z_2)&=1,&S(z_3)&=0,&S(z_4)&=\infty
    \end{align*}
    を満たす群作用$S\in\Aut(\hatC)$が唯一つ存在する．
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[存在]
        \[S(z)=\begin{cases}
            \paren{\frac{z_2-z_4}{z_2-z_3}}\paren{\frac{z-z_3}{z-z_4}}&z_2,z_3,z_4\in\C のとき,\\\vspace{1mm}
            \frac{z-z_3}{z-z_4}&z_2=\infty のとき,\\\vspace{1mm}
            \frac{z_2-z_4}{z-z_4}&z_3=\infty のとき,\\\vspace{1mm}
            \frac{z-z_3}{z_2-z_3}&z_4=\infty のとき,
        \end{cases}\]
        と置けば良い．
        \item[一意性]
        $S_1,S_2\in\Aut(\hatC)$がこれを満たすとする．
        $S:=S_1\circ S_2^{-1}$とすると，これは
        \begin{align*}
            S(1)&=S_1\circ S_2^{-1}(1)=S_1(z_2)=1,&S(0)&=S_1\circ S_2^{-1}(0)=S_1(z_3)=0,&S(\infty)&=S_1\circ S_2^{-1}(\infty)=S_1(z_4)=\infty,
        \end{align*}
        を満たす．このとき，$S=\id_{\hatC}$であることを示せば，$S_1=S_2$を導ける．

        $S=\frac{az+b}{cz+d}$と置く．
        \begin{align*}
            \frac{a+b}{c+d}&=1.&\frac{b}{d}&=0,&\frac{a}{c}&=\infty,
        \end{align*}
        より，$b=c=0,a=d$．$ad-bc=1$より，$a=d=1$．よって，$S=\id_{\hatC}$．
    \end{description}
\end{proof}
\begin{remarks}[transitive]
    群作用$G\times X\to X$が\textbf{可移}であるとは，
    任意の$x\in X$について$Gx=X$が成り立つことをいう．
    これに加えて，$\forall y\in X,\;\exists ! x\in X,\;gx=y$が成り立つとき，
    \textbf{鋭推移的}であるという．これは鋭という他に正則(regular)ともいう．
    群作用が\textbf{$n$-重推移的}であるとは，どの相異なる元$x_1,\cdots,x_n\in X$と$y_1,\cdots,y_n\in X$に対しても，$y_i=gx_i\;(i=1,\cdots,n)$を満たす$g\in G$がただ一つ存在することをいう．
\end{remarks}

\begin{definition}[cross ratio / anharmonic ratio]
    相異なる４点$z_1,z_2,z_3,z_4\in\C$に対して，\textbf{非調和比}を$(z_1,z_2,z_3,z_4):=S(z_1)$で定義する．ただし，$S$は定理の条件を満たす$S\in\Aut(\hatC)$とする．
    $z_3,z_4\in\C$のとき，$(z_1,z_2,z_3,z_4)=S(z_1)=\paren{\frac{z_2-z_4}{z_2-z_3}}\paren{\frac{z_1-z_3}{z_1-z_4}}$である．これを比の値と見て，比(double ratio)で表す流儀もある．
\end{definition}

\begin{theorem}[非調和比は不変量である]
    任意の$T\in\Aut(\hatC)$と（相異なる）４点$z_1,z_2,z_3,z_4\in\hatC$に対して，
    \[(T(z_1),T(z_2),T(z_3),T(z_4))=(z_1,z_2,z_3,z_4)\]
    が成り立つ．
\end{theorem}
\begin{proof}
    $S\in\Aut(\hatC)$を，$z_2,z_3,z_4\in\Pone$が定理\ref{thm-SL2-action-is-3-transitive}の意味で定める群作用$S(z):=(z,z_2,z_3,z_4)$と置くと，
    $S(z_1)=(z_1,z_2,z_3,z_4)=(T(z_1),T(z_2),T(z_3),T(z_4))$を示せば良い．

    ここで，$ST^{-1}\in\Aut(\hatC)$に注目すると，これは
    \[\begin{cases}
        ST^{-1}(T(z_2))=S(z_2)=1\\
        ST^{-1}(T(z_3))=S(z_3)=0\\
        ST^{-1}(T(z_4))=S(z_4)=\infty
    \end{cases}\]
    を満たすから，$ST^{-1}(z)=(z,T(z_2),T(z_3),T(z_4))$である．
    よって，
    \begin{align*}
        S(z_1)&=S(T^{-1}T)(z_1)\\
        &=ST^{-1}(T(z_1))=(T(z_1),T(z_2),T(z_3),T(z_4))
    \end{align*}
    が成り立つ．
\end{proof}
\begin{remarks}
    非調和比は定理\ref{thm-SL2-action-is-3-transitive}を通じて群作用のことばで定義した．
    そこで，群作用$ST^{-1}$を考えるなんて，飛び道具か？
\end{remarks}

\subsection{円円対応}

\begin{notation}
    $\infty$を通る直線を$\hatC$では円と呼ぶ．
    また，$\hat{\R}:=\R\cup\{\infty\}$と表す．
\end{notation}

\begin{theorem}[非調和比による円の特徴付け]
    相異なる４点$z_1,z_2,z_3,z_4\in\C$に関して，次の２条件は同値．
    \begin{enumerate}
        \item $(z_1,z_2,z_3,z_4)\in\R$．
        \item ４点$z_1,z_2,z_3,z_4$は一つの円または直線（ただし$\infty$を含む）上に在る．
    \end{enumerate}
\end{theorem}
\begin{proof}
    非調和比は群作用で定義したから，群作用のことばで書き換える．
    $S(z):=(z,z_2,z_3,z_4)\in\hatC$と置くと，
    (1)は，$S(z_1)\in\R$も含め，$S(z_2)=1,S(z_3)=0,S(z_4)=\infty$と，
    $S(\{z_1,z_2,z_3,z_4\})\subset\hatR$を意味する．
    従って，逆像$S^{-1}(\hatR)$が円または直線であることを示せば十分である．

    $z\in\C$について，
    \begin{align*}
        z\in S^{-1}(\hatR)\;\Leftrightarrow\;&S(z)=\o{S(z)}\\
        \;\Leftrightarrow\;&\frac{az+b}{cz+d}=\o{\frac{az+b}{cz+d}}\\
        \;\Leftrightarrow\;&(az+b)\o{(cz+d)}=\o{(az+b)\o{(cz+d)}}\\
        \;\Leftrightarrow\;&\Im(az+b)\o{(cz+d)}=\Im(a\o{c}\abs{z}^2+b\o{c}\o{z}+a\o{d}z+b\o{d})=0
    \end{align*}
    が成り立てば良い．この条件式は，$A,B,C\in\R$が存在して，
    \[(\Im(a\o{c}))(x^2+y^2)+Ax+By+C=0\]
    の形に表せる．これは，$\Im(a\o{c})\ne 0$の時は$\C$上の円の方程式で，
    $\Im(a\o{c})=0$の時は$\C$上の直線を表す．従って，総じて$S^{-1}(\hatR)\subset\hatC$は円である．
\end{proof}

\begin{corollary}[Möbius変換は円に円を対応させる]
    $T\in\Aut(\hatC)$は$\hatC$の円を$\hatC$の円に写す．
\end{corollary}
\begin{proof}
    円$C\subset\hatC$を任意に取る．すると，相異なる３点$z_2,z_3,z_4\in C$を用いて，
    $C=\{z\in\hatC\mid(z,z_2,z_3,z_4)\in\hatR\}=S^{-1}(\hatR)$と表せる．\footnote{$z_4\in C$について，非調和比は$S(z_4)=\infty$となる．}
    ただし，$S\in\Aut(\hatC)$は$S(z_2)=1,S(z_3)=0,S(z_4)=\infty$で定まる作用とした．
    従って，この像は
    \begin{align*}
        T(C)&=\{T(z)\in\hatC\mid(z,z_2,z_3,z_4)\in\hatR\}\\
        &=\{w\in\hatC\mid(T^{-1}(w),z_2,z_3,z_4)\in\hatR\}\\
        &=\{w\in\hatC\mid(w,T(z_2),T(z_3),T(z_4))\in\hatR\}
    \end{align*}
    従って，$T(C)$は$T(z_2),T(z_3),T(z_4)$を通る$\hatC$の円である．
\end{proof}
\begin{remarks}
    任意の円$C$について，$C=S^{-1}(\hatR)$である．
    よって，$T(S^{-1}(\hatR))=(T^{-1}\circ S)^{-1}(\hatR)$
    であるが，$T^{-1}\circ S\in\Aut(\hatC)$より，$T(C)$も円であると分かる，という話である．
\end{remarks}

\section{最大値の原理}

\begin{screen}
    領域$D$上の正則関数を精査する．
    \begin{itemize}
        \item 領域上の正則関数は，定値でないならばその絶対値は最大値を持たない（定理\ref{thm-maximum-modulus-principle}）．これは定数でない正則関数は開写像であること（定理\ref{thm-open-mapping-theorem}）からも来る．最大値を持つと，$f(U)$が開とならない可能性が出てくる．
        \item では閉集合上ではと言うと，境界点で最大値を取る（定数関数の場合も含め）．
    \end{itemize}
\end{screen}

\subsection{最大値の原理}

\begin{theorem}[maximum modulus principle]\label{thm-maximum-modulus-principle}
    $f:D\to\C$を領域$D$上の正則関数とする．$\max_{z\in D}\abs{f(z)}$が存在すれば，$f$は定数関数である．
\end{theorem}
\begin{proof}
    $\abs{f(z)}$が最大値$M:=\abs{f(a)}$を$a\in D$で持つとする．
    $\Delta(a,r)\subset D$を満たす$r>0$について，
    \begin{align*}
        f(a)&=\frac{1}{2\pi i}\int_{\abs{z-a}=r}\frac{f(z)}{z-a}\;dz\\
        &=\frac{1}{2\pi i}\int^{2\pi}_0\frac{f(a+re^{i\theta})}{re^{i\theta}}ire^{i\theta}\;d\theta&(dz=ire^{i\theta}\;d\theta)\\
        &=\frac{1}{2\pi i}\int^{2\pi}_0if(a+re^{i\theta})\;d\theta
    \end{align*}
    であるから，
    \[M=\abs{f(a)}\le\frac{1}{2\pi}\int^{2\pi}_0\abs{f(a+re^{i\theta})}\;d\theta\]
    が成り立つ．ところが，$\abs{f(a+re^{i\theta})}\le M$でもあるから，右辺も$\le M$で抑えられる．
    即ち，$\abs{f(a+re^{i\theta})}\equiv M\;(\theta\in[0,2\pi])$．これは$r>0$に依らずに成り立つから，$\abs{f(z)}\equiv M\;(z\in\Delta(a,r))$が成り立つ．

    いま，$\Delta(a,r)$上で，$M=0$とすると，$f=0$より定数関数．$M>0$とする．$f\o{f}=M^2$（$\Delta(a,r)$上の実数値写像）に$\partial_z$を作用させると，
    \begin{align*}
        0&=\partial_z(f\o{f})=(\partial_zf)\o{f}+f(\partial_z\o{f})\\
        &=f'\o{f}.&(\partial_z\o{f}=\o{\partial_{\o{z}}f}=0,\;補題\ref{lemma-Wirtinger-operator})
    \end{align*}
    であるが，$M>0$としたから$\abs{f(z)}>0\;(z\in \Delta(a,r))$即ち$f\ne 0$より，$f'=0$．
    よって，$f$は$\Delta(a,r)$上定数関数．一致の定理\ref{cor-identity-theorem}より，$f$は$D$上定数関数である．
\end{proof}
\begin{remarks}
    $\abs{f}$が最大値を持つと仮定すると，Cauchyの積分表示\ref{thm-Cauchy's-integral-expression}
    より，$\abs{f}$は定数関数になることが従う．
    これに，微分作用素$\partial_z$の言葉を使うと，複素数の自由度を解剖してもやはり$f$は定数関数になることが従う．
    この２段構造もある道が通れてしまう，結果，$\abs{f}$が最大値を持つと即定数関数，というのが正則関数に成り立つ最大値の原理である．
\end{remarks}

\begin{corollary}\label{cor-maximum}
    $f:D\to\C$を領域$D$上の正則関数とする．
    コンパクト集合$K\subset D$に対して，
    \[\abs{f(z)}\le\max_{w\in\partial K}\abs{f(w)}\]
    が成り立つ．等号が成立する時の点が$K$の内点ならば，$f$は定数関数である．
\end{corollary}
\begin{proof}
    実数値関数$\abs{f(z)}:K\to\R$は連続なので，$K$上で最大値$\abs{f(a)}\;(a\in K)$を取る．
    \begin{description}
        \item[$a\in\partial K$のとき] $\abs{f(z)}\le\max_{w\in\partial K}\abs{f(w)}$が従う．
        \item[$a\in K^\circ$のとき] 最大値原理\ref{thm-maximum-modulus-principle}より，$f$は定数関数だから，$\abs{f(z)}\le\max_{w\in\partial K}\abs{f(w)}$のうち特に等号が成り立つ．
    \end{description}
\end{proof}

\subsection{Schwarzの補題：正規化された正則関数の振る舞い}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    正則関数$f:\Delta\to\Delta,f(0)=0$のクラスを考える．
    \begin{enumerate}
        \item 縮小写像となる：Lipschitz定数は$1$以下である．
        \item $0$でのJacobianも$1$以下である．
    \end{enumerate}
    中心である$0$に向かって縮小することはあれど，辺縁$\partial\Delta$へ皺寄せが行くことはない．これは無限回微分可能であることなど，いろんな事実が効いているのであろう．
\end{tcolorbox}

\begin{notation}
    $\Delta:=\Delta(0,1)$と略記する．
\end{notation}

\begin{theorem}[Schwarz's lemma]\label{thm-Schwarz's-lemma}
    $f:\Delta\to\Delta$を$f(0)=0$を満たす単位円板$\Delta$上の正則関数とする．この時，
    \begin{enumerate}
        \item $\abs{f(z)}\le\abs{z}\qquad(z\in\Delta)$．
        \item $\abs{f'(0)}\le 1$．
    \end{enumerate}
    が成り立つ．さらに，等号$\abs{f(z)}=\abs{z}$を成立させる$z\in\Delta^*$が存在する場合と$\abs{f'(0)}=1$が成り立つ場合は，$\exists c\in\C,\;f(z)=cz\;\;(\abs{c}=1)$の場合に限る．
\end{theorem}
\begin{proof}
    \[F(z):=\begin{cases}
        \frac{f(z)}{z}&z\in\Delta^*,\\
        f'(0)&z=0,
    \end{cases}\]
    と置くと，$F:\Delta\to\Delta$は正則．これについて，$\abs{F(z)}\le 1\;(z\in\Delta)$を示せば良い．
    なお，等号が成立するとき，最大値原理\ref{thm-maximum-modulus-principle}より，$F=1$即ち$\exists c\in\C,\;f=c\cdot\id$と表せる．

    任意の$z\in\Delta$に対して，$\abs{z}<r<1$を満たす$r>0$を取れば，$[\Delta(0,r)]\subset D$で，系\ref{cor-maximum}より，
    \begin{align*}
        \abs{F(z)}&\le\max_{\abs{z}=r}\abs{F(z)}=\frac{1}{r}\max_{\abs{z}=r}\abs{f(z)}\\
        &\le\frac{1}{r}&(\because f(z)\in\Delta より\abs{f(z)}\le 1)
    \end{align*}
    が成り立つ．$r<1$は任意だから，$\abs{F(z)}\le 1\;(z\in\Delta)$を得る．
\end{proof}
\begin{remarks}
    $\abs{f(z)}\le\abs{z}\qquad(z\in\Delta)$はあまりにも非自明だが，正則関数$F$についての言及に翻訳すれば至極真っ当である．
    証明の本質は，任意の閉円板が中に取れて，そこで系\ref{cor-maximum}が使えると言うことである．
    直接最大値の原理\ref{thm-maximum-modulus-principle}から自明であるわけではない．
\end{remarks}

\begin{remark}
    Hermann Schwarz 1843-21はドイツ人数学者．
    Laurent Schwartz 1915-02はフランス人で，超関数(distribution)に名前を残す．Fields賞受賞者．
\end{remark}

\begin{corollary}[一次変換は縮小関係を保つ]
    正則写像$f:\Delta(0,R)\to\Delta(0,M),f(z_0)=w_0$に対して，
    \[\Abs{\frac{M(f(z)-w_0)}{M^2-\overline{w}_0f(z)}}\le\Abs{\frac{R(z-z_0)}{R^2-\overline{z}_0z}}\]
\end{corollary}
\begin{proof}
    ２つの一次変換
    \begin{align*}
        S(z)&:=\frac{R(z-z_0)}{R^2-\o{z_0}z},&T(w)&:=\frac{M(w-w_0)}{M^2-\o{w_0}w}
    \end{align*}
    について，$\abs{T\circ f(z)}\le\abs{S(z)}\;(z\in\Delta(0,R))$を示せば良い．

    いま，$S:\Delta(0,R)\to\Delta,T:\Delta(0,M)\to\Delta$は全単射である．
    従って，$T\circ f\circ S^{-1}:\Delta\to\Delta$についてSchwarzの補題より，
    \[\abs{T\circ f\circ S^{-1}(\zeta)}\le\abs{\zeta}\qquad(\zeta\in\Delta)\]
    が成り立つ．$\zeta=S(z)$とすれば，
    \[\abs{T\circ f(z)}\le\abs{S(z)}\qquad(z\in\Delta(0,R)).\]
\end{proof}
\begin{remarks}
    より一般に，まだ正規化されていないような円板から円板への正則関数$f:\Delta(0,R)\to\Delta(0,M),f(z_0)=w_0$
    にSchwarzの補題の知見を適用したいならば，一次変換を使って$\End(\Delta)$に引き戻せば良い．
\end{remarks}

\subsection{単位円板とその極限としての上半平面の正則自己同型の決定}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Schwarzの補題の内容を，一次変換の言葉を用いて引き戻すと，普遍的な結果が得られる．
    全くもってどのようにして見つけた道なのかわからない．
    ここでは$\Aut(\Delta),\Aut(H)\subset\Aut(\hatC)$の表示を見る．この２つの例は極めて代数的に素性が良い．
    一次変換の制限も多様な対称群になる．
    \begin{enumerate}
        \item 単位円板$\Delta$上の双正則写像は，零点$a\in\Delta$を用いて
        \[\exists\theta\in\R,\qquad f(z)=e^{i\theta}\frac{z-a}{1-\overline{a}z}\]
        の形で表せる．すなわち，単位円板の正則自己同型の自由度は２つで，零点とが定まると鏡像点として極が定まる$a\in\Delta$と，その回転変換分の違い$e^{i\theta}$である．
        \item 上半平面$H$の双正則写像は，実行列$A=\begin{pmatrix}a&b\\c&d\end{pmatrix}\in M_2(\R),\det A\ne 0$を用いて，$f(z)=\frac{az+b}{cz+d}$の形で表せる．
    \end{enumerate}
    証明手法はただ一つで，「一次変換を用いて引き戻し，Schwarzの補題から強力な主張を得る」．
\end{tcolorbox}

\begin{definition}[biholomorphism]
    正則写像$f:U\to V$が可逆で，逆写像も正則である時，これを\textbf{双正則写像}という．
\end{definition}

\begin{notation}
    $\Aut(\Delta):=\{f:\Delta\to\Delta\mid fとf^{-1}は正則\}$
    を$\Delta$の\textbf{正則自己同型群}と言う．
\end{notation}

\begin{theorem}[単位円板上の双正則写像は一次変換である]\label{thm-biholomorphism-on-unit-disk}
    双正則写像$f:\Delta\to\Delta$が$f(a)=0\;(a\in\Delta)$を満たせば，
    \[\exists\theta\in\R,\qquad f(z)=e^{i\theta}\frac{z-a}{1-\overline{a}z}\]
    が成り立つ．
\end{theorem}
\begin{proof}
    \[S(z):=\frac{z+a}{1+\o{a}z}\]
    とおけば$S\in\Aut(\Delta)$であり，$F:=f\circ S:\Delta\to\Delta$は$F(0)=f(a)=0$より，Schwarzの補題\ref{thm-Schwarz's-lemma}の過程を満たす双正則写像である．
    よって，$\abs{F'(0)}\le 1$．また，$F^{-1}:\Delta\to\Delta$にもSchwarzの補題を適用すると$\abs{(F^{-1})'(0)}\le 1$を得る．
    ここで，
    \begin{align*}
        1=(\id)'&=(F^{-1}\circ F)'\\
        &=(F^{-1})'\circ F\cdot F'
    \end{align*}
    より，$1=(F^{-1})'(0)\cdot F'(0)$だから，$(F^{-1})'(0)=F'(0)=1$．
    よってSchwarzの補題から$\exists c\in\C,\;F(z)=cz\;(\abs{c}=1)$であるから，$\exists\theta\in\R,\;F(z)=e^{i\theta}z$と表せる．
    $f=F\circ S^{-1}$より，$f(z)=e^{i\theta}\circ S^{-1}(z)=e^{i\theta}\frac{z-a}{1-\o{a}z}$．
\end{proof}
\begin{remarks}
    発想は同じで，一次変換を用いて引き戻し，Schwarzの補題から強力な主張を得る．
    $\Aut(\Delta)=SU(1,1)/\{\pm I\}$．
\end{remarks}

\begin{theorem}[上半空間の自己同型]
    $f:H\to H$が双正則写像であれば，実行列$A=\begin{pmatrix}a&b\\c&d\end{pmatrix}\in M_2(\R),\det A\ne 0$が存在して，
    \[f(z)=\frac{az+b}{cz+d}\qquad\paren{\det\begin{pmatrix}a&b\\c&d\end{pmatrix}=1,\;a,b,c,d\in\R}\]
    が成り立つ．
\end{theorem}
\begin{proof}
    $H$上の一次変換$H\to H$は定理の形で表せる．従って逆に，双正則写像$f:H\to H$は一次変換であることを示せば良い．

    一次変換$S(z):=\frac{z-i}{z+i}$は$S(H)=\Delta$を満たし，この範囲で全単射である．
    よって，$T:=S\circ f\circ S^{-1}:\Delta\to\Delta$は双正則写像である．
    定理\ref{thm-biholomorphism-on-unit-disk}より，これは一次変換である．
    従って，$f=S^{-1}\circ T\circ S$も一次変換である．
\end{proof}
\begin{remarks}
    上半平面とは半径無限大の円であり，行列式が$1$であるような一次変換がこれの正則自己同型となる．
    Riemann球面の大円による分割で得る円板同士が写り合うのである．

    $S(z):=\frac{z-i}{z+i}$は$i\mapsto 0$と降りてきて，$-i\mapsto\infty$と飛んでいき，上から球体が降りてくるような変換である．
    行列式が$2i$とはどういうことか．
\end{remarks}

\chapter{留数解析}

\begin{quotation}
    前章で反転について十分に準備した．
    こうして，Taylor展開をRiemann球面$\hatC$上に移植した理論がLaurent展開である．
    Laurent展開の主な応用先は特異点の研究である．
    Taylor展開では不可能だったが，Laurent展開では
    一点の空いた開円板$\Delta^*(a,r)$で関数を展開できるのである．
    おそらくだが，真性特異点が負冪の無限級数で表され，Laurent展開の主要部が有限の時，極の主要部に一致する．

    それにしても，$\C$内の領域$D$上正則であることと，$D$上で原始関数を持つこととが同値でないのは不思議だ．
    こうして，関数の生育する真の大地の探求へと駆り立てられることになる．
    （閉形式と完全形式のズレはtopologyの問題）．

    \begin{enumerate}
        \item Laurent展開の言葉を用意する．
        \item 対数関数の原始関数である$-1$以外は全て完全形式であるため，原始関数をもち，閉曲線上での積分は$0$になる．従って，正則関数の積分は実質$-1$の冪のみを考えれば良い．これを留数定理という．
        \item 留数は$-1$の冪であるが，これをさらにもう一歩踏み込んで分解すると，結局完全形式ではなく，留数を生み出して居る元凶は偏角部分のみである：$\frac{f'}{f}\;dz=d\log\abs{f}+i\cdot d\arg f$．これを偏角の原理という：$\int_\gamma\frac{f'}{f}\;dz=i\int_\gamma d\arg f$．
        \item 開写像定理
        \item 原始関数が存在しない関数についても，元凶は今や怖くない留数に注目するという方針が定まったので，この方法で定積分を求めることが出来る．
    \end{enumerate}
\end{quotation}

\section{Laurent展開}

\begin{screen}
    反転（＝Riemann球面の座標変換）について知った今，Taylor展開を強化できる．
    開円環とは，$\hatC$上の開円板２つの重なる部分である．
    この，２つの葉の重なる部分が作れるので，その範囲でうまい協業の仕方がある，それは「積分路を分ける」ことである．
    こうして得た標準分解$f=F_1+F_2\;\;\mathrm{on}\;\Delta(a,r,R)$について，Taylor展開を考えれば，負冪も含めた有理型関数への拡張・\textbf{Laurent}展開を得る．
\end{screen}

\begin{notation}
    開球の一般化として円環
    \[\Delta(a,r,R):=\{z\in\C\mid r<\abs{z-a}<R\}\qquad(0\le r<R<\infty)\]
    を考える．なお，$\C^*=\Delta(0,0,\infty)$である．
\end{notation}

\begin{theorem}[正則関数の円環上での分解]\label{thm-decomposition-of-holomorphic-function}
    円環$\Delta(a,r,R)$上の正則関数$f$は，$\Delta(a,R)$上の正則関数$F_1$と，$\infty$を零点とする$\Delta(a,r,\infty)$上の正則関数$F_2$との
    和$f=F_1+F_2\quad\mathrm{on}\;\Delta(a,r,R)$として一意的に表示できる．
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[分解の存在] 
        $r<r'<R'<R$を満たす$r',R'$について，$[\Delta(a,r',R')]\subset\Delta(a,r,R)$より，Cauchyの積分表示\ref{thm-Cauchy's-integral-expression}から，
        \begin{align*}
            f(z)&=\frac{1}{2\pi i}\int_{\partial\Delta(a,r',R')}\frac{f(\zeta)}{\zeta-z}\;d\zeta\\
            &=\frac{1}{2\pi i}\int_{\abs{\zeta-a}=R'}\frac{f(\zeta)}{\zeta-z}\;d\zeta+\frac{-1}{2\pi i}\int_{\abs{\zeta-a}=r'}\frac{f(\zeta)}{\zeta-z}\;d\zeta\\
            &=:F_1(z)+F_2(z)&(\on\Delta(a,r',R'))
        \end{align*}
        と置くと，$F_1,F_2$自体の定義域はより広く，これらの被積分関数$\frac{f(\zeta)}{\zeta-z}$は$z$の関数として$\C\setminus\Im\zeta$上で正則だから，
        $F_1$は特に$\Delta(a,R')$上で正則，$F_2$は特に$\Delta(a,r',\infty)$上で正則になる．
        $z$の関数$\frac{f(\zeta)}{\zeta-z}$が，$\C\setminus\Im\zeta$の連結部分上では少なくとも正則だからである（正則性の遺伝\ref{lemma-propagation-of-regularity}）．
        $r<r'<R'<R$は任意より，$F_1$は$\Delta(a,R)$上で正則，$F_2$は$\Delta(a,r,\infty)$上で正則．
        また，$\lim_{z\to\infty}F_2(z)=0$は積分表示より明らか．
        （回転数を用いたCauchyの積分表示\ref{thm-Cauchy-winding-number}からも$z$が$\Im\gamma$が分割する非有界部分にあるとき，$0$と分かるのでは？）
        \item[分解の一意性]
        $f=G_1+G_2$を満たす正則関数$G_1:\Delta(a,R)\to\C,G_2:\Delta(a,r,\infty)\to\C$も
        同様の条件を満たすとする．すると，$F_1-G_1=G_2-F_2$が$\Delta(a,r,R)$上で成り立つ．
        よって一致の定理\ref{cor-identity-theorem}より，関数$G_2-F_2$は$\hatC$上に拡張され，$\infty$は零点である．
        よって，$\hatC$のコンパクト性より，$G_2-F_2$は$\C$上で有界だから，$\C$上定数関数であり，その値は$0$．よって，$G_2-F_2=0$より，$G_2=F_2$．
    \end{description}
\end{proof}

\begin{definition}[Laurent series]
    $F_1$は$\Delta(a,R)$上正則だから，$a$を中心としたTaylor展開
    \[F_1(z)=\sum^{\infty}_{n=0}A_n(z-a)^n\]
    は$\Delta(a,R)$上広義一様収束する（定理\ref{thm-Taylor}）．
    
    続いて，$g(w)=F_2\paren{\frac{1}{w}+a}$とし，$w=0$中心のTaylor展開を考えると，$\Delta\paren{0,\frac{1}{r}}$上で
    \[g(w)=\sum_{n=1}^\infty A_{-n}w^n\]
    と表せ，$\Delta(a,r,\infty)$上で広義一様収束する級数展開
    \[F_2(z)=\sum^\infty_{n=1}A_{-n}(z-a)^{-n}\]
    を得るから，$f=F_1+F_2:\Delta(a,r,R)\to\C$は次のように表せる：
    \[f(z)=\sum^\infty_{n=-\infty}A_n(z-a)^n.\]
    これを\textbf{ローラン展開}といい，$F_2$をその\textbf{主要部}という．
\end{definition}

\begin{lemma}[Laurent展開の係数の積分による表示]\label{lemma-Laurent-expansion-integral-expression}
    Lorent展開の係数$A_n$は次のように表せる：
    \[A_n=\frac{1}{2\pi i}\int_{\abs{z-a}=s}(z-a)^{-n-1}f(z)\;dz.\]
\end{lemma}
\begin{proof}
    $r<s<R$を満たす$s\in\R$について，$m\in\N$を取って積分すると，次のような結果を得る．
    \begin{align*}
        \int_{\abs{z-a}=s}(z-a)^mf(z)\;dz
        &=\int_{\abs{z-a}=s}\sum^\infty_{n=-\infty}A_n(z-a)^{n+m}\;dz\\
        &=\sum^\infty_{n=-\infty}\int_{\abs{z-a}=s}A_n(z-a)^{n+m}\;dz&\paren{\because 級数\sum^\infty_{n=-\infty}A_n(z-a)^{n+m}は\partial\Delta(a,s)上で一様収束する}\\
        &=2\pi iA_{-m-1}
    \end{align*}
    となる．$n\ne -m-1$のとき，$A_n(z-a)^{n+m}$は原始関数を持つため，閉曲線上の線積分は$0$．
    一方$\frac{1}{2\pi i}\int_{\abs{z-a}=s}\frac{1}{z-a}\;dz$は曲線$\partial\Delta(a,s)$周りの$a$での回転数を表す．

    これより，$n=-m-1$とすれば，
    \[A_n=\frac{1}{2\pi i}\int_{\abs{z-a}=s}(z-a)^{-n-1}f(z)\;dz.\]
\end{proof}
\begin{remarks}
    冪が$-1$のときだけ，回転数の定義のように，積分に対する振る舞いが特異的である．
    だから，$f$に対して，適当な冪$m$を付けて$(z-a)^mf(z)$を考えると，
    当たり判定内に押し出す形で，各係数$A_n$を得る，というカラクリである．
\end{remarks}

\section{留数定理}

\begin{screen}
    Laurent展開を円環上で定義したが，これが活躍するのは特異点周りの積分である．
    冪が$-1$である場合を除いて，円環$\Delta(a,r,R)$上で原始関数を持つために，
    特異点など関係ない．これを検出する精密な機器として使えるのは，係数$A_{-1}$である．
    こうして，領域$D$周りの一周の（＝回転数$1$の）積分は，留数の和に$2\pi i$を乗じたものとなる．
    他の成分は全て一周すると$0$になるからである．冪が$-1$のものだけが残る．この証明には，Laurent展開が必要であった．
    多項式とは，正則関数に欠かせない代数的な道具である．

    留数定理：特異点を囲んだ積分路に沿った正則関数の積分は，Laurent展開の主要部の積分の値に等しいが，
    それは留数に等しい．
\end{screen}

\begin{definition}[residue]
    $a$が$f$の孤立特異点であるとき，Laurent展開$f(z)=\sum^\infty_{n=-\infty}A_n(z-a)^n$の主要部$F_2(z)=\sum^{-1}_{n=-\infty}A_n(z-a)^n$は，
    任意の$r>0$について$\Delta(a,r,\infty)$で広義一様収束するから，結局$\C^*$上で広義一様収束する．
    $f$の孤立特異点$a$に於ける\textbf{留数}とは，係数$A_{-1}$のことをいい，$\Res_af=A_{-1}$と表す．
\end{definition}

\begin{lemma}[留数の特徴付け]\mbox{}\label{lemma-residue-integral-expression}
    \begin{enumerate}
        \item 十分小さな$s>0$に対して，\[\Res_af=\frac{1}{2\pi i}\int_{\abs{z-a}=s}f(z)\;dz.\]
        \item $f(z)-(\Res_af)(z-a)^{-1}$は$\Delta^*(a,s)$上での原始関数$\sum_{n\in\Z\setminus\{-1\}}\frac{1}{n+1}A_n(z-a)^{n+1}$を持つ．
    \end{enumerate}
\end{lemma}
\begin{proof}
    1.はLaurent展開の係数の積分表示\ref{lemma-Laurent-expansion-integral-expression}の$n=-1$の場合である．
    この補題の証明中にもある通り，
    2.は，Laurent展開に於ける項で冪が$-1$でないものは全て原始関数を持つ．
    $\Delta^*(a,s)$上で級数は広義一様収束するから，項別に積分を考えれば良い．
\end{proof}

\begin{theorem}[留数定理]\label{thm-residue}
    $D$を区分的$C^1$級境界を持つ有界領域，$p_1,\cdots,p_n\in D$を孤立特異点とする．
    $[D]\setminus\{p_1,\cdots,p_n\}$上の正則関数$f$に対し，次が成り立つ：
    \[\frac{1}{2\pi i}\int_{\partial D}f(z)\;dz=\sum^n_{j=1}\Res_{p_j}f.\]
\end{theorem}
\begin{proof}
    十分小さな$\epsilon>0$が存在して，$\Delta(p_j,\epsilon)\;(j\in[n])$は共有点を持たずに$D$に含まれる．
    領域$D_\epsilon:=D\setminus\cup_{j=1}^n[\Delta(p_j,\epsilon)]$とすると，$[D_\epsilon]$上で$f$は正則．
    Cauchyの積分定理\ref{thm-Cauchy}より，
    \[0=\int_{\partial D_\epsilon}f(z)\;dz=\int_{\partial D}f\;dz-\sum^n_{j=1}\int_{\partial\Delta(p_j,\epsilon)}f\;dz.\]
    いま，補題\ref{lemma-residue-integral-expression}より，
    \[\sum^n_{j=1}\int_{\partial\Delta(p_j,\epsilon)}f\;dz=\sum^n_{j=1}\Res_{p_j}f\]
    なのであった．
\end{proof}

\begin{theorem}[Homotopy型の留数定理]\label{thm-residue-in-terms-of-homotopy}
    $E$を領域$D$内の集積点を持たない部分集合\footnote{$x\in E$が集積点であるとは，$\{x\}$が$E$の孤立点でないことをいう．従って，$E$が離散空間だと言っても良い．}とし，$f$は$D\setminus E$上の正則関数とする．
    $\gamma$を$D\setminus E$上の閉曲線で，$D$上で１点とhomotopicであるとする．
    この時，
    \[\frac{1}{2\pi i}\int_\gamma f\;dz=\sum_{p\in E}n(\gamma,p)\cdot\Res_pf\]
    が成り立つ．\footnote{$n(\gamma,p)\ne 0$となる$p\in E$は有限個であるから，右辺はwell-defined．}
\end{theorem}
\begin{proof}
    $\gamma$を一点に縮めるhomotopyを$\Phi:[0,1]\times[0,1]\to D$とする．
    $K:=\Phi([0,1]\times[0,1])$はcompactなので，離散集合である$K\cap E$は有限集合である．
    仮に無限であるとすると，各$x\in E\cap K$に対して$(\{x\})_{x\in E}$が有限化できない開被覆となる．
    そこで，$K\cap E=\{p_1,\cdots,p_n\}$とすると，領域$D'$であって，$K\subset D'\subset D$かつ$D'\cap E=K\cap E$であるものが取れ，$\gamma$は$D'$上でも1点にhomotopicである．
    $E\setminus K$の元での回転数は$0$だから，以降，$|E|<\infty,D=D'$の場合についてのみ考えれば良い．

    各$p_j\in E$でのLaurent展開の主要部を$P_j(z):=\sum^\infty_{k=1}A_{j-k}(z-p_j)^{-k}$とし，$g(z):=f(z)-\sum^n_{j=1}P_j(z)$と置くと，
    $g$は$D$上で正則なので，これについてのhomotopy型のCauchyの定理\ref{thm-Cauchy's-theorem-in-terms-of-homotopy}より，
    \[\int_\gamma f(z)\;dz=\sum^n_{j=1}\int_\gamma P_j(z)\;dz.\]
    ここで，補題\ref{lemma-residue-integral-expression}より，$\widetilde{P}_j(z):=P(z)-A_{j,-1}(z-p_j)^{-1}$は$\C\setminus\{p_j\}$上で原始関数を持つので$\gamma$に沿った積分は$0$．
    $\int_\gamma\frac{A_{j,-1}}{z-a}\;dz$のみが残り，これは$2\pi i\cdot n(\gamma,p_j)\Res_{p_j}f$に等しい．
\end{proof}
\begin{remarks}
    Jordanの閉曲線定理は難しいなら，homotopyを使ってこうやって話をするのか．
    この定理のポイントは，Laurent展開の主要部を全て除いたら（特異点が有限個の場合しか除ききれない）
    正冪の級数しか残らない，即ち，正則部分しか残らない．
    従って，特異点を囲んだ積分路に沿った正則関数の積分は，Laurent展開の主要部の積分の値に等しいが，
    それは留数に等しい．
\end{remarks}

\subsection{留数の計算}

\begin{screen}
    極の場合はTaylor展開の算譜に還元する算譜がある．
    それはそうである．少し形式的な考え方で，
    実用的には直接Laurent展開の$-1$の冪の係数を求めるのが速いことも多い．
\end{screen}

\begin{discussion}[主要部が有限ならば（特異点が極ならば）押し出せる]\label{discussion-algorithm-for-residue}
    $p$が$f$の$m$位の極の時，$g(z)=(z-p)^mf(z)$は$p$の近くで正則になる．
    正冪からなる級数で表せているので．この時，
    $f$の$p$での留数は，$g$の$p$でのTaylor展開の$(z-p)^{m-1}$の係数となっている：
    \[\Res_pf=\frac{1}{(m-1)!}\lim_{z\to p}\frac{d^{m-1}}{dz^{m-1}}((z-p)^mf(z)).\]
\end{discussion}

\begin{example}
    $f(z)=\frac{1}{\sin^3z}$は$0$に３位の極を持つ．
    この留数は，直接Laurent展開して，
    \begin{align*}
        \sin^{-3}z&=z^{-3}\paren{1-\frac{1}{6}z^2+[z^4]}^{-3}\\
        &=z^{-3}+\frac{1}{2}z^{-1}+[z]
    \end{align*}
    より，留数は$\frac{1}{2}$．
\end{example}

\begin{example}
    $f(z)=\frac{e^{\frac{1}{z}}}{z^2+1}$は$z=0$に真性特異点を持つ．
    \begin{align*}
        f(z)&=\frac{e^{\frac{1}{z}}}{z^2+1}=\paren{\sum^\infty_{n=0}\frac{1}{n!}\frac{1}{z^n}}\paren{\sum^\infty_{m=0}(-1)^mz^{2m}}
    \end{align*}
    より，
    \begin{align*}
        \Res_0f&=\frac{1}{z}\cdot 1+\frac{1}{3!z^3}\cdot(-z^2)+\frac{1}{5!z^5}\cdot z^4+\cdots\\
        &=\sum^\infty_{n=0}\frac{(-1)^n}{(2n+1)!}=\sin 1.
    \end{align*}
    今回は，積分が求まるので，留数定理によりこの結果を確認できる．
    この関数は部分分数展開により$f(z)=\frac{1}{2!}\paren{\frac{e^{\frac{1}{z}}}{z-i}-\frac{e^{\frac{1}{z}}}{z+i}}$とも表せ，$\abs{z}=r>1$での積分は$0$である．
    なぜならば，homotopy型のCauchyの定理\ref{thm-Cauchy's-theorem-in-terms-of-homotopy}より
    $r>1$に依らずに積分$\int_{\abs{z}=r}f(z)\;dz$の値は一定．特に$r\to\infty$の場合を考えて，$=0$である．
    従って，$\Delta(0,r)$内の特異点は$z=0,i,-i$だから，
    \begin{align*}
        0=\Res_0f+\frac{1}{2!}\paren{e^{\frac{1}{i}}-e^{\frac{1}{-i}}}=\Res_0f+\sin (-1)=\Res_0f-\sin 1.
    \end{align*}
    なお，$z=i,-i$に於ける留数とは，補題\ref{lemma-residue-integral-expression}より，$\int_{\abs{z}=r}\frac{e^{\frac{1}{z}}}{z-i}\;dz=\left.e^{\frac{1}{z}}\right|_{z=i}$に等しい．
\end{example}

\section{偏角の原理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=偏角の原理：回転数は連続写像について保存する]
    $\Im\gamma\subset D$と$f\in\O(D)$と$w\notin f(\Im\gamma)$について，$f^{-1}(w)=\{z_1,\cdots,z_k\}$とすると，
    \[\sum_{i=1}^kn(\gamma,z_i)=n(f\circ\gamma,w)\]
\end{tcolorbox}

\subsection{偏角の原理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    偏角の原理は，回転数と重複度を結びつける．
    回転数とは，対数関数のRiemann面を用いて，何回転したかを数える技術で，重複度はTaylor展開をしたときの指数である．
    対数微分（$\frac{f'}{f}$という比の値を考えると多くの情報が詰まっている）を駆使することで，指数＝重複度を留数として得ることができる．
\end{tcolorbox}

\begin{discussion}[位数を含めた数え上げ]\label{discussion-counting-singularities-up-by-logarithmic-differentiation}
    $f$を有理型関数とする．$p$を零点または極とし，
    零点なら位数を，極なら位数の$-1$倍を$m_p\in\Z$とすると，これを数え上げることができる．この時，
    $h(p)\ne 0$を満たす正則関数$h$が存在して，
    $f(z)=(z-p)^{m_p}h(z)$と表せるが，
    $f'=m_p(z-p)^{m_p-1}h(z)+(z-p)^{m_p}h'(z)$より，
    \[\frac{f'}{f}=\frac{m_p}{z-p}+\frac{h'}{h}\]
    が成り立つので，$\Res_p\frac{f'}{f}=m_p$を得る．$\frac{h'}{h}$も再び正則関数であることに注意．
\end{discussion}

\begin{theorem}[argument principle]\label{thm-argument-principle}
    $D$を区分的$C^1$級境界を持つ有界領域，$f$を$[D]$上で定義された有理型関数で，$\partial D$には極も零点も持たないものとする．
    $D$内の$f$の零点と極全体からなる集合を$P$とすると，次が成り立つ：
    \[\frac{1}{2\pi i}\int_{\partial D}\frac{f'}{f}\;dz=\sum_{p\in P}m_p.\]
\end{theorem}
\begin{proof}
    零点と極のなす集合$P$は離散的であるであるから，右辺はwell-defined．
    議論\ref{discussion-counting-singularities-up-by-logarithmic-differentiation}より特異点を持つ非正則な関数$\frac{f'}{f}$の各特異点$p\in P$での留数が$m_p$なので，
    homotopy型の留数定理\ref{thm-residue-in-terms-of-homotopy}より上式を得る．
\end{proof}

\begin{theorem}[homotopy型の偏角の原理]\label{thm-argument-principle-in-terms-of-homotopy}
    $f$を領域$D$上の正則関数（有理型関数），$\gamma$を$f$の零点（と極）を通らない$D$内の閉曲線で，$D$上１点にhomotopicとする．\footnote{特異点を囲まない，というイメージ．自己交叉をしている可能性はある．}
    $\widetilde{\gamma}:=f\circ\gamma$と置くと，$n(\widetilde{\gamma},0)=\sum_{p\in f^{-1}(0)}n(\gamma,p)\cdot m_p$．
\end{theorem}
\begin{proof}
    \begin{align*}
        n(\tilde{\gamma},0)&=\frac{1}{2\pi i}\int_{\tilde{\gamma}}\frac{dw}{w}&(\because 回転数の定義)\\
        &=\frac{1}{2\pi i}\int_\gamma\frac{f'}{f}\;dz&(\because\ref{remarks-1-form})\\
        &=\sum_{p\in f^{-1}(0)}n(\gamma,p)\cdot\Res_p\frac{f'}{f}&(\because\mathrm{homotopy}型の留数定理\ref{thm-residue-in-terms-of-homotopy})\\
        &=\sum_{p\in f^{-1}(0)}n(\gamma,p)\cdot m_p.
    \end{align*}
\end{proof}
\begin{remarks}
    $0$の周りの$\wt{\gamma}$についての回転数は，$f^{-1}(0)$のそれぞれの孤立点周りの$\gamma$の回転数と重複度の重み付き平均になる．すなわち，対応$f(a)=b$を局所的に$\Delta(a,r)\mapsto f(\Delta(a,r))$と見れば，$f(\partial\Delta(a,r))$は$b$の周りに，$z=a$での重複度分だけトグロをまく．
\end{remarks}
\begin{remark}[偏角の原理とは]\label{remarks-1-form}
    変数変換$w=f(z)$において多様体$D$上に引き戻すと，$\dd{w}{z}=f'(z)$より，$\frac{dw}{w}=\frac{f'(z)}{f(z)}dz$である．
    この一形式について，
    \begin{align*}
        \frac{f'}{f}\;dz&=d(\log f)=d\log\abs{f}+id\arg f
    \end{align*}
    が成り立つ．$\log\abs{f}$は一価の実関数$\C^*\to\R$であるが，$\arg f$は多価関数であり，現在対数関数の定義に困っているのである．
    しかし，この1-形式を積分すると，
    \begin{align*}
        \int_\gamma\frac{f'}{f}\;dz&=\int_\gamma d\log\abs{f}+i\int_\gamma d\arg f\\
        &=i\int_\gamma d\arg f
    \end{align*}
    であるが，1点にhomotopicな$\gamma$に対して，$d\log\abs{f}$はそれが囲む領域内で完全だから，原始関数をもち，
    $\int_\gamma d\log\abs{f}=0$．また，$\int_\gamma d\arg f$についても，$\arg f$にあるのは高々定数分の不定性であるから（定理\ref{thm-period-of-logarithm}），積分すると多価性が消失する．
    
    いや，違う，積分路により値が変わるから，対数関数の原始関数である$-1$冪を用いて回転数を定義したのである．
    今回の対数微分とは，対数を微分してから元に戻すと，多価性を削ぎ落としてから還って来るために，一価関数を得るというトリックのことを言う．
    多価関数でも「増分」は変わらない．
\end{remark}

\subsection{Rouchéの定理}

\begin{screen}
    零点の個数の数え上げについて，関連する定理が示せる．
    境界における条件を満たせば，零点の個数は増えたり減ったりしない．
    ものすごくhomotopyっぽくなってきている．
\end{screen}

\begin{theorem}[Rouché]\label{thm-Rouché}
    $D$を区分的$C^1$級境界を持つ有界領域，$f,g$を$[D]$上の正則関数とする．この時，境界$\partial D$上で，条件
    \[\abs{f(z)-g(z)}<\abs{f(z)}+\abs{g(z)}\qquad\forall z\in\partial D\]
    が成り立つならば，$D$内の$f,g$の（重複度も込めた）零点の個数は等しい．
\end{theorem}
\begin{proof}
    三角不等式$\abs{a-b}\le\abs{a}+\abs{b}$で等号が成立するのは，$0\in[a,b]$の時に限る．
    従って，$\abs{a-b}<\abs{a}+\abs{b}$は，$0\notin[a,b]$に同値．
    よって，任意の$z\in\partial D$について$0\notin[f(z),g(z)]$であるから，
    \[f_t(z):=tf(z)+(1-t)g(z)\qquad(t\in[0,1])\]
    と$f_t:[D]\times[0,1]\to\C$を定めると，これは$\partial D$上で零点を持たない．
    そこで，この$f_t$の$D$内での零点の個数を考え，$t$に依らずに一定であることを示す．

    $f_t$の$D$内での零点の個数を$N_t$とすると，偏角の原理\ref{thm-argument-principle}より，
    \[N_t=\frac{1}{2\pi i}\int_{\partial D}\frac{f'_t}{f_t}\;dz\]
    となる．今，$f_t$は$t\in[0,1]$に関して連続であるから，右辺も連続．従って，$N_t$は$t$に依らず定数である．
    特に$t=0,1$の場合を考えて，$f$の零点の個数$N_1$と$g$の零点の個数$N_2$は等しい．
\end{proof}
\begin{remarks}
    こんな証明思いつくか．連続と離散の往来．
    $f_t\;(t\in[0,1])$は，つまみ$t$に依らずにこの縦線集合には零点がない，即ち，$f,g$は運命共同体である．

    $f,g$は平面上の各点に，平面上の点を対応させる写像である．これを，$f(z)$から$g(z)$へ連続変形することを考える．
    これは，閉領域$[D]$のある境界点から別の境界点への直線的移動の集合となる．この時絶対に原点を通らない，というのが$\abs{f(z)-g(z)}<\abs{f(z)}+\abs{g(z)}\quad\forall z\in\partial D$の同値命題である．
    この時に，$0$を通過しないことがわかる（$f,g$の零点の個数が一致することよりも強い）．
    従って，結果的に，零点の数は最初と最後でも変わらない．
\end{remarks}
\begin{remark}
    通常は$\abs{f(z)-g(z)}<\abs{g(z)}$というより強い仮定が採用されるが，$f,g$の扱いも対称ではなく，謎である．
    この定理は，素性のわかりやすい$f$と抱き合わせで，研究したい関数$g$に対して用いられる．
\end{remark}

\begin{example}
    $f(z)=z^9+5z^3+z+2$の$\Delta(0,1)$内の零点の個数を考えたい．
    ここで$g(z)=5z^3$を抜き出すと，境界$\abs{z}=1$においては，$\abs{f(z)-g(z)}=\abs{z^9+z+2}\le\abs{1+1+2}=4$．
    $\abs{g(z)}=5$より，$\abs{f(z)-g(z)}<\abs{g(z)}\le\abs{f(z)}+\abs{g(z)}$．
    よって，$g(z)=5z^3$の$\Delta(0,1)$での零点を考えればよく，これは$z=0$において重複度$3$．
\end{example}

\section{開写像定理と逆写像定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=偏角の原理が拓いた道]
    偏角の原理を用いると，零点の個数を数えることができるが，正則関数の普遍的な性質として，局所的には零点の重複度がそんなすぐには変わらない．
    これが開写像の定理の証明を簡潔にし，逆写像定理を導く．
\end{tcolorbox}

\subsection{開写像定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=開写像定理の重要な含意]
    \begin{enumerate}
        \item $\Im f$の次元が決して$1$にならないことである．
        定数関数の場合を除けば$0$にもならない．（まあ等角写像だもんね）．
        \item 位数$m$の零点の周り$\Delta^*(a,r)$（他の零点を含まない範囲）では，$\abs{f^{-1}(w)}=m$となっている．
        \item 可逆な正則関数$f$の逆写像$f^{-1}$は連続である．
        \item 正則関数が単射ならば，$f'$は零点を持たない．
    \end{enumerate}
\end{tcolorbox}

\begin{theorem}[open mapping theorem]\label{thm-open-mapping-theorem}
    定数でない正則関数$f:D\to\C$は開写像である．
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[方針] 
    任意の開集合$U\subset D$について，$f(U)\subset\C$が開と示せば良い．
    これを，任意の点$a\in U$の任意の開近傍$a\in\Delta(a,r)\subset U$について，像$f(\Delta(a,r))$が開集合$f(a)=:b\in V\subset f(\Delta(a,r))$を含むことを以てする．
    実際，これが示せれば，$f(U)=f\paren{\cup_{a\in U}\Delta(a,r)}=\cup_{a\in U}f(\Delta(a,r))$より，$f(U)$は開集合と判る．
        \item[$V$の構成]
        正則関数$f-b$を考える．
        零でない正則関数の零点は離散的\ref{thm-zeros-are-isolated}だから，$a$の周りに$\Delta(a,r)\subset U$で$0\notin f(\Delta^*(a,r))$を満たす$r>0$が取れる．

        次に$b$を動かして，$w$にも依る２変数正則関数$f(z)-w$の，$z$の零点の個数$N(w)$は，偏角の原理\ref{thm-argument-principle}より，
        \begin{align*}
            N(w)&=\frac{1}{2\pi i}\int_{\partial\Delta(a,r)}\frac{f'(\zeta)}{f(\zeta)-w}d\zeta=n(\gamma,w)\\
            &\qquad ただし，\gamma(t):=f(re^{it}+a):[0,2\pi]\to\C\;\text{とした}
        \end{align*}
        となる．（ただし，$w\notin f(\partial\Delta(a,r))$の範囲で）．

        $b$を含む$\C\setminus f(\partial\Delta(a,r))$の連結成分を$V$とすると，$N(w)$は$V$上連続\ref{lemma-character-of-winding-number}だから，$N(w)=N(b)(\ge 1)\;(w\in V)$．
        （なお，ここでは関係ないが，$N(b)$は$z=a$での重複度に一致する．Homotopy型の偏角の原理\ref{thm-argument-principle-in-terms-of-homotopy}より）．
        %（$m\ge 0$は$f(z)$の零点$z=a$の位数としたから，$f(z)-b$の零点$z=a$の位数は$m+1$）．
        よって，この$V$は$b\in V\subset f(\Delta(a,r))$を満たす（像の境界$f(\partial\Delta(a,r))$に対して回転数が$0$ではないので）．
    \end{description}
\end{proof}
\begin{remarks}
    $f(a)=b$の局所は，適切な言葉（今回は回転数）を用いれば，$(f(z)-w)^{-1}(0)$の濃度が$1$の範囲を開集合として抽出できるということである．
    回転数の言葉に仮託することで，「正則関数の値の重複度はそんなにすぐには変わらない」という結果を得た．
    また，零点の言葉に仮託して，$a$の十分近くでは再び$b$を取らないように近傍を取れることも使っている．
\end{remarks}
\begin{remarks}[偏角の原理の重要な応用]
    $f-w$なる関数を考えて偏角の原理を適用するとは，Rouchéの定理\ref{thm-Rouché}と同じ議論である．
    そして，偏角の原理は２つとも用いている．まず，定理\ref{thm-argument-principle}は，$f$の$D$での零点の数を数えたいなら，$\partial D$で$\frac{f'}{f}$を積分しろと言っている．ただし，$\partial D$に特異点があると失敗する．
    そして，$\tilde{\gamma}$の原点周りでの回転数を知りたい場合は，それを$f$で引き戻して，その範囲での$f$の零点での回転数と重複度の重み付きの和を数えれば良い，という．
    今回は，$\partial\Delta(a,r)$が$\gamma$に行くとして，その$w\in\C$の回転数を，$f-w$で検出した．
    この回転数の言葉で，$b$を含む開近傍を指定したのである．
    精密機器のようなテクノロジー．
\end{remarks}

\subsection{開写像定理の証明抽出}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    １位の零点は零点を持たないこととほぼ等価だが，高次の零点を持つと時空が歪む．
    \footnote{微分により，別の階層から来た単葉正則関数である，と見れないのか？}
    そもそも，Homotopy型の偏角の定理\ref{thm-argument-principle-in-terms-of-homotopy}より，$f(a)=b$の重複度$m$に対して，$a$の十分近くで一回転する閉曲線は，$b$の周りを$m$回転する．
    この消息を精緻化すると，$f-b$が$z=a$で$m$位の零点を持つならば，$a,b$それぞれの近傍$U,V$が存在して，$U\xrightarrow{f}V$は$w\in V\setminus\{b\}$について$f(z)=w$は異なる$m$解をもつ．
\end{tcolorbox}

\begin{corollary}[開写像定理の証明抽出]\label{cor-uninjectivity-around-zeros}
    $f$が$z=a$を$m\ge 1$位の零点として持つとする．このとき，$a$の近傍$U$と$b$の近傍$V$であって，
    \begin{enumerate}
        \item $f:U\to V$が，重複度を込めて$m$対$1$写像になるようなものが存在する．
        \item $f:U\setminus\{a\}\to V\setminus\{b\}$が，重複度を込めずに$m$対$1$写像になるようなものが存在する．即ち，$\abs{f(w)}=m\;(w\in V\setminus\{b\})$．
    \end{enumerate}
\end{corollary}
\begin{proof}
    $V,r$を定理\ref{thm-open-mapping-theorem}と同様に構成し，始域$U$を$f^{-1}(V)\cap\Delta(a,r)$に制限してこれを新たな$U$とすることで(2)を満たす$f:U\to V$を構成できる（すると(1)も満たす）．
\end{proof}
\begin{image}
    $z=a$にて，$f$は$m$重の光線を射出するなら，その近傍では$m$個の点から集中している．
\end{image}

\subsection{逆写像定理とその系}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    開写像定理の証明抽出\ref{cor-uninjectivity-around-zeros}より，$f'(z)\ne 0$ならば，$f$は局所的に可逆であるという通常の逆関数定理の主張を得る．
    $f'(z)\ne 0$のとき，$f$は$z$を１位以上の零点として持ち得ないため，全単射である．
    あとは，この逆写像も正則であることを示せば良い．
\end{tcolorbox}

\begin{theorem}[inverse mapping theorem]\label{thm-inverse-mapping-theorem}
    正則な全単射写像$f:U\to V$の逆写像$f^{-1}:V\to U$は正則である．
\end{theorem}
\begin{proof}
    $f^{-1}$が連続かつ$\forall z\in \U,\;f'(z)\ne 0$であれば，$f^{-1}$も正則である．
    Chain Ruleより，$(f^{-1})'=\frac{1}{f'\circ f^{-1}}$であるから，$f'$が零点を持たず，$f^{-1}$が連続ならば，$(f^{-1})'$が連続に定義できる．

    前者は開写像定理\ref{thm-open-mapping-theorem}より従うから，$\forall z\in U,\; f'(z)\ne 0$を示せば良い．
    $m>0$位の零点$a\in U$が存在して$f'(a)=0$を満たすとする．
    系\ref{cor-uninjectivity-around-zeros}より，$f$の単射性に矛盾する．
\end{proof}

\begin{remark}
    $C^\infty$級写像ではこれは成り立たない．
    $f(x+yi)=x^3+iy$は$C^\infty$級の可逆写像$\C\to\C$を定める．
    $f^{-1}(x+yi)=x^{\frac{1}{3}}+iy$は実軸$x=0$上で微分不可能である：
    \[J_{f^{-1}}=\begin{pmatrix}\frac{\partial x^{\frac{1}{3}}}{\partial x}&\frac{\partial x^{\frac{1}{3}}}{\partial y}\\\frac{\partial y}{\partial x}&\frac{\partial y}{\partial y}\end{pmatrix}=\begin{pmatrix}\frac{1}{3x^{\frac{2}{3}}}&0\\0&1\end{pmatrix}.\]
    従って$f^{-1}$は$C^\infty$級ではない．
\end{remark}

\begin{corollary}
    $f$を単射正則とする．$b:=f(a)$の近傍において逆写像をもち，その積分表示は
    \[f^{-1}(w)=\frac{1}{2\pi i}\int_{\abs{z-a}=r}\frac{zf'(z)}{f(z)-w}\;dz\]
    となる．
\end{corollary}

\section{留数計算}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=複素数の世界を縦横無尽に駆け回る積分計算]
    複素解析は応用についてもバッチリである．
    数の体系を複素数に拡張し，積分区間を二次元的図形の一部だと思うと，
    嘘のような論理で値が求まる．
    \textbf{関数の積分は，特異点をみよ}．
\end{tcolorbox}

\begin{definition}
    留数定理\ref{thm-residue},\ref{thm-residue-in-terms-of-homotopy}
    （完全形式でない$-1$の冪の成分しか定積分の値に寄与しないこと）を用いて定積分の値を計算することを，\textbf{留数計算}という．
    Fresnel積分（例\ref{example-Fresnel-integral}）
    のように明示的に留数が現れない場合も留数計算と呼ばれる．
\end{definition}

\begin{definition}
    複素数係数の有理関数全体の集合を
    \[\C(x):=\left\{f(x)=\frac{p(x)}{q(x)}\;\middle|\;p(x),q(x)\in\C[x],q\ne 0\right\}\]
    と表す．これはアルキメデス性の成り立たない体をなす．
\end{definition}

\subsection{三角関数の有理式の定積分}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=三角関数は単位円周上での積分]
    実三角関数の$\theta$についての積分は，単位円のパラメータ表示$z=e^{i\theta}$を用いて$z$の$S^1$上での積分に持ち込み，留数定理で決着する．
    三角関数の複素変数への拡張が，元々複素指数関数によってなされているからである．
\end{tcolorbox}

\begin{screen}
    $R(x,y)\in\C(x,y)$を二変数有理関数とする．
    \[I=\int^{2\pi}_0R(\cos\theta,\sin\theta)\;d\theta\]
    の値を求める方法を考える．
\end{screen}

\begin{discussion}[単位円上の積分]
    $z=e^{i\theta}$と変数変換をすると，$dz=izd\theta$で，
    \begin{align*}
        \cos\theta&=\frac{1}{2}\paren{z+\frac{1}{z}},&\sin\theta&=\frac{1}{2i}\paren{z-\frac{1}{z}},
    \end{align*}
    より，
    \begin{align*}
        I&=\int_{\partial\Delta}R\paren{\frac{z+z^{-1}}{2},\frac{z-z^{-1}}{2i}}\frac{dz}{iz}
    \end{align*}
    と書き換えられる．よって，正則関数
    \[F(z):=R\paren{\frac{z+z^{-1}}{2},\frac{z-z^{-1}}{2i}}\frac{}{iz}\]
    の留数を考えれば良い：
    \[I=2\pi i\sum_{\abs{z}<1}\Res_zF(z).\]
\end{discussion}

\begin{example}
    積分
    \[I=\int^\pi_0\frac{d\theta}{a+\cos\theta},\quad(a>1),\]
    を考える．関数$z^2+2az+1$の２解$z=-a\pm\sqrt{a^2-1}\in\R$は$\beta<-1<\alpha<0$なので，$\Delta$での極は$\alpha$の１つ．
    ここでの留数が積分の値となる．
    \begin{align*}
        2I&=\int^{2\pi}_0\frac{d\theta}{a+\cos\theta}=\int_{\partial\Delta}\frac{1}{a+\frac{z+z^{-1}}{2}}\frac{dz}{iz}\\
        &=\frac{2}{i}\int_{\partial\Delta}\frac{dz}{z^2+2az+1}\\
        &=4\pi\Res_\alpha\frac{1}{(z-\alpha)(z-\beta)}
    \end{align*}
    いま，$z=\alpha$は１位の極でLaurent展開は
    \begin{align*}
        \frac{1}{z-\alpha}\frac{1}{z-\beta}&=
        \frac{1}{z-\alpha}\frac{1}{z-\alpha-(\beta-\alpha)}\\
        &=\frac{1}{z-\alpha}\frac{\frac{1}{\beta-\alpha}}{\frac{z-\alpha}{\beta-\alpha}-1}\\
        &=\frac{1}{z-\alpha}\paren{\frac{1}{\alpha-\beta}+\frac{1}{\alpha-\beta}\frac{z-\alpha}{\beta-\alpha}+O(z^2)}
    \end{align*}
    より，\footnote{$\frac{1}{z-\beta}$に$z=\alpha$を代入しても得る．冪級数表示の一意性より．}留数は$\frac{1}{\alpha-\beta}$．
    \begin{align*}
        2I&=4\pi\Res_\alpha\frac{1}{(z-\alpha)(z-\beta)}=\frac{4\pi}{\alpha-\beta}=\frac{2\pi}{\sqrt{a^2-1}}\\
        \therefore\quad I&=\int^\pi_0\frac{d\theta}{a+\cos\theta}=\frac{\pi}{\sqrt{a^2-1}}.\qquad(a>1)
    \end{align*}
    これはひとまず$a>1$にて証明したが，\textbf{この仮定は外せる}．
    この左辺の積分は，$a$の関数としては，分母を$0$にしない$a\in\C\setminus[-1,1]$の範囲で正則である，$\int_{\partial\Delta}\frac{dz}{z^2+2az+1}$の形で見ると明白である．
    分母が$0$になると$1$次のオーダーで発散するので積分が定義されない．\footnote{「１次のオーダーになったらlogが出てきますから意味がない」}
    右辺も$\C\setminus[-1,1]$上では少なくとも定義されている正則関数である（$\hatC$上の有理型関数${}^{-1}$と，２つのGauss平面を$\R_{\le 0}$をbranch cutとして貼り合わせて出来るRiemann面上の関数$\sqrt{\quad}$の合成である，補題\ref{lemma-square-root-as-a-complex-function}）．
    よって，$a>1$の仮定の下で考察を始めたが，一致の定理より，$a\notin[-1,1]$で成り立つ．
\end{example}
\begin{screen}
    \begin{remarks}[正則関数というデータ構造]
        関係式とは関数と見れる．その関数が正則だと認められるのならば，一致の定理が使える．これは極めて非自明な推論装置となっている．
        すると，最初から一般に複素数と見る必要はなく，考察は退化した実数上の場合について議論すれば良い，という留数計算の方針が見つかる．
        今回はこの方針のおかげで，$0>\alpha>-1>\beta$を満たす場合のみを考えることで済んだ．
    \end{remarks}
\end{screen}

\begin{lemma}[根号という関数]\label{lemma-square-root-as-a-complex-function}
    $f(z)=\sqrt{z^2-1}:=\sqrt{z-1}\sqrt{z+1}$は$\C\setminus[-1,1]$上の正則関数を定める．
\end{lemma}
\begin{proof}\mbox{}
    \begin{description}
        \item[$f$の構成] 
    関数$f_0(z):=\sqrt{z}$を，極座標表示$z=re^{i\theta}\;(r\ge 0,-\pi<\theta\le\pi)$を用いて
    \[\xymatrix@R-2pc{
        f_0:\C\ar[r]&\C\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        r\theta^{i\theta}\ar@{|->}[r]&\sqrt{r}e^{\frac{i\theta}{2}}
    }\]
    と定めると，$\C\setminus(-\infty,0]$でのみ正則である．
    \footnote{
        $\R_{<0}$においては連続ではない．$z$を，上半平面$z\in H$から近づける場合と，下半平面から近づける場合で，$\sqrt{z}$の値の定義が変わってしまう．
        $z=0$においては正則ではない．$\lim_{z\to 0}\frac{\sqrt{z}-\sqrt{0}}{z-0}$は任意の近づけ方について発散する．
    }
    これに，平行移動写像（これは整関数である）
    \[\xymatrix@R-2pc{
        g_1:\C\ar[r]&\C&g_2:\C\ar[r]&\C\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        z\ar@{|->}[r]&z-1&z\ar@{|->}[r]&z+1
    }\]
    を合成して，$f_1:=f_0\circ g_1,f_2:=f_0\circ g_2$という形で，関数
    \[\xymatrix@R-2pc{
        f_1:\C\ar[r]&\C&f_2:\C\ar[r]&\C\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        z\ar@{|->}[r]&\sqrt{z-1}&z\ar@{|->}[r]&\sqrt{z+1}
    }\]
    を定義すると，$f_1$は$\C\setminus(-\infty,1]$上正則，$f_2$は$\C\setminus(-\infty,-1]$上正則である．
    従って，$f:=f_1\cdot f_2$と複素関数$f(z)=\sqrt{z^2-1}$を定義すると，これは少なくとも$\C\setminus(-\infty,1]$上では正則である．
    
    ここからさらに，$f$は$(-\infty,-1)$上でも正則であることを示す．
        \item[連続性の証明]
    まず，$(-\infty,-1]$上での連続性を示す．$a\in(-\infty,-1]$について，
    \begin{align*}
        \sqrt{z-1}&\xrightarrow{z\to a}\begin{cases}
            \sqrt{\abs{a-1}}e^{\frac{i\pi}{2}}=f_1(a)&z\in Hのとき,\\
            \sqrt{\abs{a-1}}e^{\frac{-i\pi}{2}}\ne f_1(a)&z\in H^-のとき.
        \end{cases}&
        \sqrt{z+1}&\xrightarrow{z\to a}\begin{cases}
            \sqrt{\abs{a+1}}e^{\frac{i\pi}{2}}=f_2(a)&z\in Hのとき,\\
            \sqrt{\abs{a+1}}e^{\frac{-i\pi}{2}}\ne f_2(a)&z\in H^-のとき.
        \end{cases}
    \end{align*}
    であり，それぞれは関数$f_1,f_2$としては$(-\infty,-1]$上で不連続だが，$f=f_1f_2$としてみると，$z\in H^-$の場合も，
    \[f(z)=\sqrt{z^2-1}\xrightarrow{z\to a}\sqrt{\abs{a-1}}e^{\frac{-i\pi}{2}}\sqrt{\abs{a+1}}e^{\frac{-i\pi}{2}}=\sqrt{\abs{a^2-1}}e^{i\pi}=f_1(a)f_2(a) \qquad(z\in H^-)\]
    より，総じて$(-\infty,-1]$上で$f$は連続である．
        \item[正則性の証明]
    すると，$a\in(-\infty,-1)$の下では，
    \begin{align*}
        \lim_{z\to a}\frac{f(z)-f(a)}{z-a}&=\lim_{z\to a}\frac{\sqrt{z^2-1}-\sqrt{a^2-1}}{z-a}\\
        &=\lim_{z\to a}\frac{z+a}{\sqrt{z^2-1}+\sqrt{a^2-1}}\\
        &\overset{a\ne -1}{=}\frac{2a}{2\sqrt{a^2-1}}&(\sqrt{z^2-1}は(-\infty,-1]上で連続であるため)\\
        &=\frac{a}{\sqrt{a^2-1}}&(これはa\ne\pm 1ならば\C の元)
    \end{align*}
    と，極限値を持つから，$f$は$(-\infty,-1)$上正則である．
    以上より，$f$は$C\setminus[-1,1]$上正則である．
    \end{description}
\end{proof}
\begin{remarks}
    個々の構成要素は正則でない部分が多く，２つのGauss平面を，$\R_{\le 0}$をbranch cutとして張り合わせてRiemann面上の関数とみる必要がある．
    しかし，積を取ると，正則となるような領域が広がるのである．「分枝をうまく定義すると，打ち消しあって，$\C\setminus[-1,1]$上で正則となる」，
    これを，Riemann面の変形として捉えて視覚化出来たらなあ．
\end{remarks}

\subsection{有理関数の広義定積分}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=有理関数は上半平面での留数をみる]
    $\R$上に極を持たない有理関数$R(z)=\frac{P(z)}{Q(z)}\in\C(z)$
    は，$R(z)=O(z^{-1})$の場合証明は別であるが（上半円板ではなく，長方形領域をとって議論する必要がある），結局全て，上半平面$H$上の留数の和となる：
    \[I=\int^\infty_{-\infty}R(x)\;dx=2\pi i\sum_{z\in H}\Res_zR(z).\]

    下半分での留数はしばしば対称的な形となる．
\end{tcolorbox}

\begin{discussion}[有理関数の実数軸上での積分]\label{discussion-residue-calculation-for-general-integral}
    $\R$上に極を持たない有理関数$R(z)=\frac{P(z)}{Q(z)}\in\C(z)$で，$\deg Q-\deg P=:m\ge 2$の時の積分
    \[I:=\int^\infty_{-\infty}R(x)\;dx=\lim_{r\to\infty}\int^r_{-r}R(x)\;dz\]
    の値を考える．

    十分大きく$M>0$を取れば，$R(z)$の極は全て$\abs{z}<M$に含まれる．
    この時，$\exists K\in\R,\;\abs{R(z)}<K\abs{z}^{-m}\qquad(\abs{z}\ge M)$
    が成り立つ．$m\ge 2$の時広義積分が収束することを見る．

    半円板$D_r:=\{z\in\Delta(0,r)\mid\Im z>0\}$の境界での積分を考えると，
    \[\int_{\partial D_r}R(z)\;dz=\int^r_{-r}R(x)\;dx+\int_{C_r}R(z)\;dz\]
    が成り立つ．左辺は$2\pi i\sum_{z\in D_r}\Res_zR(z)$に等しい．
    また$r>M$においては
    \begin{align*}
        \Abs{\int_{C_r}R(z)\;dz}&\le\int_{C_r}\abs{R(z)}\cdot\abs{dz}\\
        &\le\int_{C_r}K\abs{z}^{-m}\cdot\abs{dz}\\
        &=Kr^{-m}\cdot\pi r=\pi Kr^{1-m}\xrightarrow{r\to\infty}0.
    \end{align*}
    よって，
    \[I=\int^\infty_{-\infty}R(x)\;dx=2\pi i\sum_{\Im z>0}\Res_zR(z).\]
\end{discussion}

\begin{example}
    \[\int^\infty_{-\infty}\frac{dx}{(1+x^2)^2}=2\pi i\sum_{z\in H}\Res_z\frac{1}{(1+z^2)^2}\]
    である．関数$\frac{1}{(1+z^2)^2}$は上半平面$H$においては，$z=i$に２位の極を持つ．
    その留数は，$z=i$近傍で正則関数$(z-i)^2\frac{1}{(1+z^2)^2}$は$z=i$周りでTaylor展開可能で，その$z-i$の係数だから（議論\ref{discussion-algorithm-for-residue}），
    \begin{align*}
        \frac{1}{1}\frac{d}{dz}\frac{(z-i)^2}{(1+z^2)^2}&=\left.\frac{d}{dz}\frac{1}{(z+i)^2}\right|_{z=i}\\
        &=\left.\frac{-2}{(z+i)^3}\right|_{z=i}=\frac{-2}{8i^3}=\frac{1}{4i}.
    \end{align*}
    よって，
    \[\int^\infty_{-\infty}\frac{dx}{(1+x^2)^2}=\frac{\pi}{2}.\]
\end{example}

\begin{discussion}[$R=O(x^{-1})$の時]\label{discussion-general-integral-case-O(n^-1)}
    \[I:=\int^\infty_{-\infty}R(x)e^{ix}\;dx\]
    を考える．
    議論\ref{discussion-residue-calculation-for-general-integral}の通り，$m\ge 2$
    では収束する．
    実際，
    \[\abs{e^{iz}}=\abs{e^{-\Im z}}\abs{e^{i\Re z}}\le e^{-\Im z}\le 1\qquad(\Im z>0)\]
    が成り立つから，優級数の方法により，$C_r$上での積分は収束し，
    \[I=\int^\infty_{-\infty}R(x)e^{ix}\;dx=2\pi i\sum_{z\in H}\Res_zR(x)e^{ix}.\]

    だが，この条件は不自然である．$m=1$の時も成り立つはずである．
    実際その通りであるが，$R(x)=O(x^{-1})$なので，絶対収束はしない．より仔細に踏み込んだ収束の証明が必要になる．

    今回，半円板ではなく，開長方形
    \[D_{r_1,r_2,s}:=\{x+yi\in H\mid x\in(-r_1,r_2),y\in(0,s)\}\]
    の境界での積分を考える．
    \begin{align*}
        C_1&=[r_2,r_2+is],&C_2&=[r_2+is,-r_1+is],&C_3&=[-r_1+is,-r_1]
    \end{align*}
    と置くと，
    \[\partial D_{r_1,r_2,s}=[-r_1,r_2]+C_1+C_2+C_3\]
    である．
    \begin{center}
        \begin{tikzpicture}[>=stealth]
            \draw[->,line width=1pt] (-2,0) -- (2,0) node[below right] {Re};
            \draw[->,line width=1pt] (0,-0.5) -- (0,2) node[above right] {Im};
            \node[below left] at (0,0) {$O$};
            \draw[->] (1,0) -- (1,0.5);
            \draw (1,0.5) -- (1,1);
            \draw[->] (1,1) -- (-0.5,1);
            \draw (-0.5,1) -- (-1.5,1);
            \draw[->] (-1.5,1) -- (-1.5,0.5);
            \draw (-1.5,0.5) -- (-1.5,0);
            \node[below] at (1,0) {$r_2$};
            \node[below] at (-1.5,0) {$-r_1$};
            \node[above right] at (0,1) {$s$};
            \draw[->] (-1.5,0) -- (-0.5,0);
            \node[above right] at (1.0,1.0) {$\partial D_{r_1,r_2,s}$};
            \node[right] at (1,0.5) {$C_1$};
            \node[above] at (-0.5,1) {$C_2$};
            \node[left] at (-1.5,0.5) {$C_3$};
        \end{tikzpicture}
    \end{center}
    $r_1,r_2,s$を十分大きく取れば，
    \[\int^{r_2}_{-r_1}R(x)e^{ix}\;dx=2\pi i\sum_{z\in H}\Res_zR(z)e^{iz}-\int_{C_1+C_2+C_3}R(z)e^{iz}\;dz.\]
    であるから，各$C_j$での積分が$0$に収束することを示せば良い．
    \[\exists M,K>0,\;\abs{z}>M\Rightarrow\abs{R(x)}<K\abs{z}^{-1}\]
    という$R(z)=O(z^{-1})$の性質を用いて証明する．
    \begin{description}
        \item[$C_1,C_3$について] 
        $s,r_2>M$の時，
        \begin{align*}
            \Abs{\int_{C_1}R(z)e^{iz}\;dz}&\le\int_{C_1}\abs{R(z)}e^{-\Im z}\abs{dz}&(三角不等式\ref{lemma-triangular-inequality-in-infinite-cardinal})\\
            &\le\int_{C_1}K\abs{z}^{-1}e^{-\Im z}\abs{dz}&(R(z)=O(z^{-1}))\\
            &= Kr_2^{-1}\int^s_0e^{-y}\;dy=Kr_2^{-1}\left[-e^{-y}\right]^s_0&(\max_{z\in C_1}\abs{z}^{-1}=r_2^{-1})\\
            &\le Kr_2^{-1}(1-e^{-s})\le Kr_2^{-1}\xrightarrow{r_2\to\infty}0.
        \end{align*}
        \item[$C_2$について]
        $s>M$の時，
        \begin{align*}
            \Abs{\int_{C_2}R(z)e^{iz}\;dz}&\le e^{-s}\int^{r_2}_{-r_1}\abs{R(x+is)}\;dx&(\max_{z\in C_2} e^{iz}=e^{-s})\\
            &\le e^{-s}\int^{r_2}_{-r_1}K\abs{x+is}^{-1}\;dx\\
            &\le e^{-s}Ks^{-1}\int^{r_2}_{-r_1}\;dx=e^{-s}Ks^{-1}(r_1+r_2)\xrightarrow{s\to\infty}0.
        \end{align*}
        \item[総合]
        ちょっと$r_1,r_2,s$の相互関係が混み合ってきたが，総じて
        \begin{align*}
            \Abs{\int_{C_1+C_2+C_3}R(z)e^{iz}\;dz}&\le K(r_1^{-1}+r_2^{-1}+e^{-s}s^{-1}(r_1+r_2))
        \end{align*}
        これは$s\to\infty$と取ると，$\le K(r_1^{-1}+r_2^{-1})$を得て，その次に$r_1,r_2\to\infty$を取ることになる．
    \end{description}
\end{discussion}

\section{主値積分}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=積分路上にある留数はその半分を取る]
    $\R$上に極を持たない有理関数$R(z)=\frac{P(z)}{Q(z)}\in\C(z)$を考えた．
    $\R$上に極を持つ場合は通常の定義では値が発散する．
    この時，積分は多価関数となっているのだ．
    そこで，積分の値の定義を変えることを考える．

    すると，\textbf{積分路上にある留数はその半分を取る}という法則を得る：
    \[\PV\int^\infty_{-\infty}R(x)e^{ix}\;dx=\pi i\Res_0R(z)e^{iz}+2\pi i\sum_{z\in H}\Res_zR(z)e^{iz}.\]
    上に避ける積分路の極限として考えれば，「半周」だからである．
\end{tcolorbox}

\begin{definition}[Cauchy principle value]
    $R(x)$が$x=0$に１位の極を持つ場合，\textbf{主値積分}を次のように定める：
    \[\PV\int^b_{-b}R(x)e^{ix}\;dz:=\lim_{\delta\to+0}\int_{[-b,-\delta]\cup[\delta,b]}R(x)e^{ix}\;dx.\]
\end{definition}

\begin{lemma}[well-definedness]
    $R(x)$が$x=0$に１位の極を持つ場合，積分$\lim_{\delta\to+0}\int_{[-b,-\delta]\cup[\delta,b]}R(x)e^{ix}\;dx$は収束する．
\end{lemma}
\begin{proof}
    $\Res_0R(z)e^{iz}=:A$と置くと，$[-b,b]$の近傍で正則な関数$f\in\mathcal{O}(U([-b,b]))$が存在して，$R(z)e^{iz}=\frac{A}{x}+f(x)$と表せる．
    $\frac{A}{x}$は奇関数だから，任意の$\delta>0$に対して
    \begin{align*}
        \int_{[-b,-\delta]\cup[\delta,b]}R(x)e^{ix}\;dx&=\int_{[-b,-\delta]\cup[\delta,b]}f(x)\;dx
        &\xrightarrow{\delta\to 0}\int_{[-b,b]}f(x)\;dx.
    \end{align*}
    これは値が定まる．
\end{proof}

\begin{discussion}[積分路上にある留数はその半分を取る]
    $R(z)=O(z^{-1})\;(\deg Q-\deg R\ge 1)$の下で，$b\to\infty$とした時の主値積分
    \[\PV\int^\infty_{-\infty}R(x)e^{ix}\;dx\]
    を考える．議論\ref{discussion-general-integral-case-O(n^-1)}の積分路に半円$C^+_\delta$を付け加えた積分路を考える．$C_r:=C_1+C_2+C_3$とする．
    \begin{center}
        \begin{tikzpicture}[>=stealth]
            \draw[->,line width=1pt] (-2,0) -- (2,0) node[below right] {Re};
            \draw[->,line width=1pt] (0,-0.5) -- (0,2) node[above right] {Im};
            \node[below left] at (0,0) {$O$};
            \draw[->] (1,0) -- (1,0.5);
            \draw (1,0.5) -- (1,1);
            \draw[->] (1,1) -- (-0.5,1);
            \draw (-0.5,1) -- (-1.5,1);
            \draw[->] (-1.5,1) -- (-1.5,0.5);
            \draw (-1.5,0.5) -- (-1.5,0);
            \node[below] at (1,0) {$r_2$};
            \node[below] at (-1.5,0) {$-r_1$};
            \node[above right] at (0,1) {$s$};
            \draw[->] (-1.5,0) -- (-1,0);
            \node[above right] at (1.0,1.0) {$C_r$};
            \draw (0.5,0) arc [radius=0.5, start angle = 0, end angle=180];
            \draw[->] (-0.01,0.5) -- (0.01,0.5);
            \draw[->] (0.5,0) -- (0.75,0);
            \node at (-0.6,0.5) {$C^+_\delta$};
            \node[below] at (0.5,0) {$\delta$};
            \node[below left] at (-0.5,0) {$-\delta$};
        \end{tikzpicture}
    \end{center}
    すると，
    \begin{align*}
        \PV\int^\infty_{-\infty}R(x)e^{ix}\;dx&=\int_{\delta\le\abs{x}\le r}+\int_{C^+_\delta}+\int_{C_r}R(z)e^{iz}\;dz\\
        &=2\pi i\paren{\sum_{z\in H}\Res_zR(z)e^{iz}+A}.
    \end{align*}
    $C_r$上の積分は議論\ref{discussion-general-integral-case-O(n^-1)}と同様に$0$に収束．
    $C^+_\delta$上の積分については，極の主要部$\frac{A}{z}$と正則成分$f(z)$とに分解するが，
    \begin{align*}
        \int_{C^+_\delta}R(z)e^{iz}\;dz&=\int_{C^+_\delta}\frac{A}{z}\;dz+\int_{C^+_\delta}f(z)\;dz\\
        &\xrightarrow{\delta\to 0}\int_{C^+_\delta}\frac{A}{z}\;dz
    \end{align*}
    と，正則部分は$0$に収束する．$f$は十分な近傍で原始関数$F$をもち，そしてこれは連続であるため，$F(\delta)-F(-\delta)\xrightarrow{\delta\to 0}0$であるからである．
    極の主要部については，
    \begin{align*}
        \int_{C^+_\delta}\frac{A}{z}\;dz&=\int^0_\pi\frac{A}{\delta e^{i\theta}}i\delta e^{i\theta}\;d\theta\\
        &=\int^0_\pi Ai\;d\theta=-A\pi i=-\pi i\Res_0R(z)e^{iz}.
    \end{align*}
    以上より，
    \[\PV\int^\infty_{-\infty}R(x)e^{ix}\;dx=\pi i\Res_0R(z)e^{iz}+2\pi i\sum_{z\in H}\Res_zR(z)e^{iz}.\]
\end{discussion}

\begin{example}[$\sin x/x$の積分]
    関数$\frac{e^{ix}}{x}$は$x=0$に１位の極を持つ．$e^{ix}$のTaylor展開の定数項は$1$だから，留数は$1$．
    よって，
    \[\PV\int^\infty_{-\infty}\frac{e^{ix}}{x}\;dx=\pi i\]
    を得る．この両辺の虚部に注目すると，極めて非自明な結果を得る．

    正則関数$\frac{e^{iz}}{z}$の$\R$への制限の虚部は$\frac{\sin x}{x}$である：
    \begin{align*}
        \frac{e^{ix}}{x}&=\frac{1\paren{\cos x+i\sin x}}{x}.
    \end{align*}
    よって，関数$\frac{\sin x}{x}$は$x=0$の時$1$とすれば$\R$上全体で正則に出来るから主値を考える必要はなく（$\frac{e^{ix}}{x}$の極の主要部$\frac{1}{x}$は実部である$\frac{\cos x}{x}$に因るものであるため）
    ことと，$\frac{\sin x}{x}$が偶関数であることに注意すると，
    \[\int^\infty_0\frac{\sin x}{x}\;dx=\frac{\pi}{2}.\]
\end{example}

\begin{itembox}[l]{留数計算と主値積分}
    \textbf{留数計算により，原始関数が存在しない関数についても，留数に注目することで定積分が求まる}．
    高校数学のやり方では辿り着かない分析法である．

    主値積分により，広義積分に意味を与えることができる．
\end{itembox}

\section{対数の多価性を用いた計算}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=積分路上にある留数はその半分を取る]
    有理関数について，分母と分子の次数の差が$1$以上である場合は上半平面の留数に，分母が実数を零点に持つ場合はその留数の半分に注目する方針を見てきた．
    ここで，分母と分子の次数の差が実数$\alpha\in(0,1)$である場合を考える．
    満を持して対数の登場である．
    \[I=\int^\infty_0\frac{R(x)}{x^\alpha}\;dx=\frac{2\pi i}{1-e^{-2\pi i\alpha}}\sum_{z\in\C}\Res_zf(z)\qquad(0<\alpha<1,\deg Q-\deg P\ge 1).\]
    対数を使うと対数関数のRiemann面を思い浮かべるようだ．
    その一葉を，変数変換によって長方形$(-R,R)\times(0,2\pi)$だと思っても良い．
\end{tcolorbox}

\begin{discussion}[非整数冪]
    $R(z)=O(z^{-1})\;(\deg Q-\deg P\ge 1)$とし，$[0,\infty)$上に極を持たないとする．
    \[I:=\int^\infty_0\frac{R(x)}{x^\alpha}\;dx\qquad(0<\alpha<1)\]
    の値を考える（議論\ref{discussion-general-integral-case-O(n^-1)}の通り，これは収束する）．被積分関数を正則関数$f(z):=R(z)z^{-\alpha}=R(z)\exp(-\alpha\log z)$として考える．
    ただし，ここでは対数関数の分枝は$\Im\log z=\arg\in(0,2\pi)$として定めた．
    積分区間は，領域
    \[D(\delta,r,\epsilon):=\Delta(0,\delta,r)\setminus\paren{[0,\infty)\times[-\epsilon,\epsilon]}\qquad(\epsilon<\delta)\]
    とする．
    $f$の特異点は高々有限個で$[0,\infty)$には存在しないから，$r>0$を十分大きく，$\delta,\epsilon>0$を十分小さく取ると，留数定理より
    \[\int_{\partial D(\delta,r,\epsilon)}f(z)\;dz=2\pi i\sum_{z\in\C}\Res_zf(z)\]
    が成り立つ．
    \[\partial D(\delta,r,\epsilon)=C^{out}_r+C^{in}_\delta+C_\epsilon^-+C_\epsilon^+\]
    に分解して考える．
    \begin{center}
        \begin{tikzpicture}[>=stealth]
            \draw[->,line width=1pt] (-2.2,0) -- (2.2,0) node[below right] {Re};
            \draw[->,line width=1pt] (0,-2.2) -- (0,2.2) node[above right] {Im};
            \node[below left] at (0,0) {$O$};
            \draw[domain=-2:1.98, samples=500] plot(\x, {sqrt(4-(\x)^2)});
            \draw[domain=-2:1.98, samples=500] plot(\x, -{sqrt(4-(\x)^2)});
            \draw[domain=-0.5:0.414, samples=500] plot(\x, {sqrt(0.25-(\x)^2)});
            \draw[domain=-0.5:0.414, samples=500] plot(\x, -{sqrt(0.25-(\x)^2)});
            \draw[->] (-0.5,-0.01) -- (-0.5,0.01);
            \draw[->] (-2,0.01) -- (-2,-0.01);
            \draw[->] (0.414,0.282) -- (1.4,0.282);
            \draw (1.4,0.282) -- (1.98,0.282);
            \draw[->] (1.98,-0.282) -- (1.4,-0.282);
            \draw (1.4,-0.282) -- (0.414,-0.282);
            \node[above right] at (0,0.5) {$\delta$};
            \node[above left] at (0,2) {$r$};
            \node[left] at (0,0.282) {$\epsilon$};
            \draw[dotted] (0,0.282) -- (0.414,0.282);
            \node[above] at (1.4,0.282) {$C^+_\epsilon$};
            \node[below] at (1.4,0-.282) {$C^-_\epsilon$};
            \node[below left] at (-0.25,-0.25) {$C_\delta^{\mathrm{in}}$};
            \node[below right] at (-1.5,1.5) {$C_r^{\mathrm{out}}$};
        \end{tikzpicture}
    \end{center}
    \begin{description}
        \item[$C^{in}_\delta$上での積分] 
        $z=\delta e^{i\theta}$と置くと，$\abs{dz}=\delta d\theta$より，
        \begin{align*}
            \exists c\in\R,\quad\abs{f(z)}\abs{dz}&=\abs{R(\delta e^{i\theta})}\delta^{1-\alpha}d\theta
            \le c\delta^{1-\alpha}d\theta\xrightarrow{\delta\to 0}0&(\because \alpha<1)
        \end{align*}
        であるから，積分路$C^{in}_\delta$の如何に拘らず積分は$0$に収束する．
        \item[$C^{out}_r$上での積分]
        先ほどは考えなかったが，$\exists C>0,\;\abs{R(re^{i\theta})}\le Cr^{-1}$が成り立つから，
        \begin{align*}
            \abs{f(z)}\abs{dz}&=\abs{R(re^{i\theta})}r^{1-\alpha}d\theta\le Cr^{-\alpha}\xrightarrow{r\to\infty}0&(\because \alpha>0)
        \end{align*}
        より，積分路$C^{out}_r$の如何に拘らず積分は$0$に収束する．
        \item[$C_\epsilon^\pm$]
        \begin{align*}
            \lim_{\epsilon\to 0}\int_{C^+_\epsilon}f(z)\;dz&=I\\
            \lim_{\epsilon\to 0}\int_{C^-_\epsilon}f(z)\;dz&=-\int^\infty_0R(x)e^{-\alpha(\log x+2\pi i)}\;dx=-e^{-2\pi i\alpha}I
        \end{align*}
    \end{description}より，総じて，
    \begin{align*}
        I(1-e^{-2\pi i\alpha})=2\pi i\sum_{z\in\C}\Res_zf(z)
    \end{align*}
    以上より，
    \begin{screen}
        \[I=\int^\infty_0\frac{R(x)}{x^\alpha}\;dx=\frac{2\pi i}{1-e^{-2\pi i\alpha}}\sum_{z\in\C}\Res_zf(z)\qquad(0<\alpha<1,\deg Q-\deg P\ge 1).\]
    \end{screen}
\end{discussion}

\begin{example}[対数を使うか，指数関数に変数変換をするか．]
    \[I:=\int^\infty_0\frac{dx}{(1+x)x^\alpha}\qquad(\alpha>0)\]
    非積分関数$f(z)=(1+z)^{-1}e^{-\alpha\log z}$の極は$z=-1$のみ．その留数は
    \[\Res_{-1}f(z)=\left.e^{-\alpha\log z}\right|_{z=-1}=e^{-\alpha\pi i}\]
    より，
    \[I=\frac{2\pi i}{1-e^{-2\pi i\alpha}}e^{-\alpha\pi i}=\frac{2\pi i}{e^{\pi i\alpha}-e^{-\pi i\alpha}}=\frac{\pi}{\sin\alpha\pi}.\]
    \begin{description}
        \item[別解] 
        $x=e^y$と変数変換をすると，$dx=e^ydy$で，
        \begin{align*}
            I=\int^\infty_{-\infty}\frac{e^{(1-\alpha)y}}{1+e^y}dy
        \end{align*}
        と書き換えられる．ここで，長方形$L_R:=(-R,R)\times(0,2\pi)$の境界での積分を考えると，
        $f(z):=\frac{e^{(1-\alpha)z}}{1+e^z}$の$L_R$内での極は$z=\pi i$のみであり，そこでの留数は
        \[\lim_{z\to\pi i}(z-\pi i)\frac{e^{(1-\alpha)z}}{1+e^z}=\lim_{z\to\pi i}(z-\pi i)\frac{e^{(1-\alpha)z}}{1-1-(z-\pi i)-\frac{(z-\pi i)^2}{2}-O((z-\pi i)^3)}=\frac{e^{(1-\alpha)\pi i}}{-1}\]
        であるから，
        \begin{align*}
            \int_{\partial L_R}f(z)dz&=2\pi i\Res_{\pi i}f(z)\\
            &=-2\pi ie^{(1-\alpha)\pi i}=2\pi ie^{-\alpha\pi i}
        \end{align*}
        いま，$R\to\infty$の時，右辺は変わらないが，左辺の積分は，虚軸に並行な部分は$0$に収束し，
        $\Im z=0$は$I$に，$\Im z=2\pi$は
        \[\int^\infty_{-\infty}\frac{e^{(1-\alpha)(y+2\pi i)}}{1+e^{y+2\pi i}}dy=e^{(1-\alpha)2\pi i}\int^\infty_{-\infty}\frac{e^{(1-\alpha)y}}{1+e^y}dy\]
        と，$-e^{2\pi i\alpha}I$に収束するので，
        $I(1-e^{2\pi i\alpha})=2\pi ie^{-\alpha\pi i}$を得る．
    \end{description}
\end{example}
\begin{remarks}[$e$と言う写像]
    高さは$2\pi$に取ると，$e$の周期により，$I$とその$-e^{2\pi i\alpha}$倍しか出てこないというテクニックがある．
    ２つの解法で使った積分区間の違いが，$e$の対応を表している．
    円が長方形に変わっているのである．正確には，長方形を伸ばして両短辺を限りなくくっつけようとする．
    利点としては，幅の$\epsilon$を考えなくて良い．が，$2\pi i$で線を引くことを思いつくか．
\end{remarks}

\begin{example}
    \[I:=\int^\infty_0\frac{\log x}{x^2+a^2}dx\quad(a>0)\]
    $\Im\log z\in[0,2\pi)$を満たす$\C\setminus[0,\infty)$上の対数関数を用いて，
    $f(z):=\frac{(\log z)^2}{z^2+a^2}=\frac{(\log z)^2}{(z+ia)(z-ia)}$とおき，
    \[D_{\epsilon}:=\left\{z\mid\epsilon<\abs{z}<\frac{1}{\epsilon},d(z,[0,\infty))>\epsilon\right\}\quad(\epsilon>0)\]
    の境界$C$上での積分を考えると，
    \begin{align*}
        \int_Cf(z)dz&=2\pi i\paren{\frac{(\log(ia))^2}{2ai}+\frac{(\log(-ia))^2}{-2ai}}\\
        &=\frac{\pi}{a}\paren{\paren{\log a+\frac{\pi i}{2}}^2-\paren{\log a+\frac{3\pi i}{2}}^2}&\because e^{\log a+\pi i/2}=ai \footnote{計算規則としてはそうであるが，$ai$とは$a$を90度回転したものであるから，成り立つという意味論を考えると良い．}\\
        &=\frac{\pi}{a}(-2\pi i\log a+2\pi^2)
    \end{align*}
    となる．さて，$\epsilon\to 0$の極限を考えると，左辺の積分の，２つの円弧状の積分路上
    での積分は$0$に収束し，実軸上での積分が２つ残る．$\Im z>0$の方は$I$ではなく$\int^\infty_0\frac{(\log x)^2}{x^2+a^2}dx$に収束し，
    $\Im z<0$の場合は
    \[-\int^\infty_0\frac{(\log x+2\pi i)^2}{x^2+a^2}dx=-\int^\infty_0\frac{(\log x)^2}{x^2+a^2}-4\pi iI+4\pi^2\int^\infty_0\frac{dx}{x^2+a^2}\]
    となるから，左辺は総じて$-4\pi iI+4\pi^2\int^\infty_0\frac{dx}{x^2+a^2}$に収束する．
    両辺の虚部を比較すると，
    \begin{align*}
        \frac{-2\pi^2\log a}{a}&=-4\pi I\\
        I&=\frac{\pi^2}{2a}\log a.
    \end{align*}
\end{example}
\begin{remarks}
    なぜ自乗すればうまくいくかは答えをみないとわからない．
    確かに$\log$の多価性を使っている．いや，なんなんだこれは．
\end{remarks}

\begin{example}[Gauss積分を留数計算で求める方法]
    $\int^\infty_{-\infty}e^{-x^2}dx$は，
    重積分に持っていくのが自然だと思うが，留数計算でも求められる．
\end{example}

\chapter{部分分数展開と因数分解}

\begin{quotation}
    正則関数の標準形について考察する．
    \begin{enumerate}
        \item 有理関数の部分分数分解を$\C$上の有理型関数$\C\to\hatC$に一般化する．これは「有理型関数の可算個の極の主要部をすべて引くと，整関数が残る」という理論である．
        \item 多項式の因数分解を整関数に一般化する．
    \end{enumerate}
    それぞれ無限和と無限積の収束の問題となる．
    これらの議論により，多項式と有理関数の関係と同様，有理型関数は，整関数$/$整関数と表示できることがわかる．
\end{quotation}

\section{有理型関数の部分分数展開}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=「極の主要部を取り除くと多項式が残る」理論]
    部分分数展開とは，「多項式」と，「$\frac{1}{z-b_j}$の多項式」との和の形による表示である．
    これは極の主要部と多項式との和の形への展開とみれる．
    有理型関数とは，極が離散的な$\hatC$-値関数と定義したので，
    有理関数の部分分数展開の自然な一般化となる（有理関数とは$\hatC$上の極が有限な有理型関数で，より一般には極が可算無限または$D\sbs\C$上の有理型関数でも同じ展開が考えられる）が，無限和の収束性にのみ注意をする．

    議論を領域化すると，部分分数展開とは，離散集合$E$とそこでの極の主要部を指定した時に，大域的な有理型関数を構成できるかの問題に帰着する（Mittag-Lefflerの定理\ref{thm-Mittag-Leffler}）．
    %部分分数分解について，理論的には次のように見方を変えることができる．
    %即ち，離散集合$E$のそれぞれの点で特異部が指定された時，それを持つ有理型関数は無限個存在するが，
    %無限和$\sum^\infty_{j=1}\paren{P_j\paren{\frac{1}{z-b_j}}-p_j(z)}$の形のものが特に存在し，その他はこの整関数分の差
    %しかない（定理\ref{thm-partial-fraction-decomposition}）．
    この標準形の理論についての表示が\textbf{部分分数分解}だったのである．
\end{tcolorbox}

\subsection{有理関数の部分分数展開}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    有理関数とは$\hatC$上の有理型関数である．
    部分分数展開とは，「極の主要部を取り除くと多項式が残る」という理論である．
\end{tcolorbox}

\begin{discussion}[有理関数から極の主要部を取り除くと多項式が残ることの証明]
    有理関数$f(z)=\frac{P(z)}{Q(z)}$($P,Q$は共通零点を持たない)について，$Q$の相異なる零点を$b_1,\cdots,b_n$，その位数を$m_1,\cdots,m_n$とする．
    これに対して，$f$の$b_j$での極の主要部を，多項式$P_j\in\C[X]$を用いて$P_j(1/(z-b_j))$と表すと，
    \[S(z):=f(z)-\sum^n_{j=1}P_j\paren{\frac{1}{z-b_j}}\]
    は$\C$上正則であり，$\infty$でも値$\lim_{z\to\infty}S(z)=\lim_{z\to\infty}f(z)$を取る$\hatC$上の有理型関数$\hatC\to\hatC$である．
    $\hatC$上の有理型関数は有理関数である\ref{thm-meromorphic-function-is-rational}から，有理関数$f$から極を全て取り除いた$S$は多項式である．
\end{discussion}

\subsection{整関数についてのMittag-Lefflerの定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    有理関数とは$\hatC$上の有理型関数である．
    そもそも有理型関数とは，離散的な極を除いて正則な$\hatC$-値関数と定義したのだから，
    「極の主要部を取り除くと多項式が残る」理論を$\C$上の有理型関数にも拡張したい．
    より一般に領域$\Om\subset\C$内に集積点を持たない離散集合上で極の主要部を指定すると，大域的な有理型関数が構成できる（Mittag-Lefflerの定理\ref{thm-Mittag-Leffler}）が，
    これの，$\infty\in\hatC$に集積点をもち，特に$\Om=\C$の場合で考える．
\end{tcolorbox}

\begin{screen}
    この議論を$f$が有理型関数である時にも拡張したい．そのためには，$f$の極は離散的なだけで有限個とは限らないから，
    $S$を定義する際に$\sum^\infty_{j=1}P_j(1/(z-b_j))$の収束性を考える必要がある．
\end{screen}

\begin{theorem}[有理型関数の部分分数展開の存在]\label{thm-partial-fraction-decomposition}
    $\{b_j\}_{j\in\N}\subset\C$を$\infty$に集積する$\hatC$上の離散集合で，対応する定数項を持たない多項式の列を$(P_j)_{j\in\N}$とする．
    この時，次が成り立つ．
    \begin{enumerate}
        \item 各$b_j$で特異部$P_j\paren{\frac{1}{z-b_j}}$を持つ$\C$上の有理型関数$f\in\M(\C)$が存在する．
        \item この$f$は，適当な多項式$p_j$と$\C$上の正則関数（従って整関数）$g$が存在して，\[f(z)=\sum^\infty_{j=1}\paren{P_j\paren{\frac{1}{z-b_j}}-p_j(z)}+g(z)\]
        と表せる．
    \end{enumerate}
\end{theorem}
\begin{proof}
    $f$を2の形で構成してしまうことで同時に証明を与える．
    \begin{description}
        \item[$p_j$の定義] 
        $b_j=0$の時$p_j:=0$とする．後の議論に関係することはないので，考えない．\footnote{１つしかない上に，$\abs{b_j}>2R$を満たす点でのもののみが収束性に寄与するので，ここは関係ない．$z=0$での特異部を表す多項式に$z$を代入したもの$P_j(z)$は有界である．}
        $b_j\ne 0$の時は，$P_j\paren{\frac{1}{z-b_j}}$は開円板$\Delta(0,\abs{b_j})$上で正則なので，$z=0$でのTaylor展開$P_j\paren{\frac{1}{z-b_j}}=\sum^\infty_{k=0}a_k^{(j)}z^k$は特に$\Delta\paren{0,\frac{\abs{b_j}}{2}}$上で一様収束する（系\ref{cor-serial-expression-of-regular-functions}）．
        よって，十分大きい$n_j\in\N$をとり，$p_j(z):=\sum^{n_j}_{k=0}a_k^{(j)}z^k$と定めれば，
        \[\Abs{P_j\paren{\frac{1}{z-b_j}}-p_j(z)}<2^{-j}\qquad\paren{z\in\Delta\paren{0,\frac{\abs{z_j}}{2}}}\]
        が成り立つ．
        \item[構成の成功の証明]
        こうして定めた多項式列$(p_j)$に対して，任意の$R>0$について無限和$\sum^\infty_{j=1}\paren{P_j\paren{\frac{1}{z-b_j}}-p_j(z)}$が$\Delta(0,R)$上で$\hatC$-値関数に一様収束することを示す（従って，総じて有理型関数$\hatC\to\hatC$として定まっていることを示す）．
        これは，$(p_j)$の定め方から，$N$を十分に大きく取ると$j\ge N\Rightarrow\abs{b_j}>2R$が成り立つから，$\abs{z}<R\paren{<\frac{1}{2}\abs{b_j}}$について，
        \begin{align*}
            \sum^\infty_{j=N}\Abs{P_j\paren{\frac{1}{z-b_j}}-p_j(z)}\le\sum^\infty_{j=N}2^{-j}<\infty
        \end{align*}
        より，確かに無限和$\sum^\infty_{j=1}\paren{P_j\paren{\frac{1}{z-b_j}}-p_j(z)}$は$\Delta(0,R)$上$\hatC$-値関数に一様収束することがわかる．\footnote{$\sum^{N-1}_{j=1}$は高々有限項なので．}
        この時点ですでに，1.の例として無限和$\sum^\infty_{j=1}\paren{P_j\paren{\frac{1}{z-b_j}}-p_j(z)}$が定める有理型関数を得ている．
        \item[2.部分分数展開の証明]
        こうして，$f(z)$を任意の，$b_j$において主要部$P_j\paren{\frac{1}{z-b_j}}$を持つ有理型関数とすると，
        $g(z)=f(z)-\sum^\infty_{j=1}\paren{P_j\paren{\frac{1}{z-b_j}}-p_j(z)}$は全ての特異点が解消されて$\C$上で正則，即ち整関数になる．
    \end{description}
\end{proof}
\begin{remarks}\mbox{}
    \begin{enumerate}
        \item 有理型関数の極を，$\C$上の点列と見立て，離散的でない部分は全て$\infty$に追いやることで定理を立てたのか．
        この見立てが成功することを1で主張し，部分分数展開の存在を2で示す．
        \item 結局はTaylor展開による消息である．なんとなく，「離散集合$E$のそれぞれの点に特異部を指定された時，これを持つ有理型関数は，無限和$\sum^\infty_{j=1}\paren{P_j\paren{\frac{1}{z-b_j}}-p_j(z)}$が本体で，その他の例とのズレは整関数分しかない」と読み替えられる．
        \item 整数の$2$は$\abs{b_j}>rR$で回収できればなんでもよかった．$r>1$で良いのだろうが，無駄な文字を登場させないようにしたのだろう．
        \item 一般に$p_j$は必要だが，ほとんどの場合実用的には必要ない．
        \item 一般に領域$D$について，$\lim_{j\to\infty}b_j\in\partial D$を満たす点列$\{b_j\}_{j\in\N}\subset D$についても同様の存在定理が成り立つ．
        これをMittag-Lefflerの定理\ref{thm-Mittag-Leffler}という．これも理論的存在である．これはTaylor展開が使えず，ルンゲの定理などの準備が必要になる．
    \end{enumerate}
\end{remarks}

\subsection{部分分数展開の例}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=有理型関数の部分分数展開]
    前回見たAffine空間のような描像であるが，
    整関数$g$が恒等的に$0$である時には，等式を得る．

    なお，１位の極を持つ場合は，Gamma関数の収束性の問題に直面するので，
    ２位の場合より議論が一筋縄では行かなくなる．
    
    それぞれを，有理式でない場合の有理型関数のうち一番簡単なものを例にとって考える．
    いずれも整関数が$0$になる例．
    しかし$\frac{\pi^2}{\sin^2\pi z}$と$\pi\cot\pi z=\pi\frac{1}{\tan\pi z}$とが有理型関数であるとは，随分射程の広い理論を得たものだ．
\end{tcolorbox}

\begin{proposition}[自乗のものは解きやすい]\label{prop-partial-fractional-decomposition}
    \[\frac{\pi^2}{\sin^2\pi z}=\sum_{n\in\Z}\frac{1}{(z-n)^2}\]
\end{proposition}
\begin{proof}
    $f(z):=\frac{\pi^2}{\sin^2\pi z}$と置くと，$f^{-1}(\infty)=\Z$で，極は全て２位．
    \begin{description}
        \item[特異部の計算]
    その主要部は，$z=0$では
    \begin{align*}
        f(z)&=\frac{\pi^2}{\sin^2\pi z}=\frac{\pi^2}{\paren{\pi z-\frac{\pi^3z^3}{6}+O(z^5)}^2}\\
        &=\frac{1}{z^2\paren{1-\frac{\pi^2z^2}{6}+O(z^5)}^2}=\frac{1}{z^2}\paren{1+\frac{\pi^2z^2}{3}+O(z^3)}
    \end{align*}
    より$\frac{1}{z^2}$で，\footnote{$\frac{\sin\pi z}{\pi}=z+z^3\varphi(z)\;(\varphi(0)\ne 0)$を用いても良い．先生はもはや上のような具体的な議論はしないようだ．}
    $z=n\in\Z$では，$f(z)$の周期性から，$\frac{1}{(z-n)^2}$である．\footnote{$z=n$とは$z-n=0$である．従って，周期性（基本周期$1$）とは，変数を$z\mapsto z-n$に変換した場合に同じ値になることをいう．}
        \item[無限和の収束性] 
        $\sum_{n\in\Z}\frac{1}{(z-n)^2}$が$\C$上で$\hatC$-関数に広義一様収束することを示す．
        実際，$\abs{z}\le N$を満たす$N$に対して，
        tailの部分が
        \[\sum^\infty_{n=N+1}\frac{1}{\abs{z\pm n}^2}\le\sum^\infty_{n=N+1}\frac{1}{\abs{N-n}^2}\le\sum^\infty_{m=1}\frac{1}{m^2}<\infty\]
        であることからわかる．
        \item[整関数$g=0$]
        こうして，整関数$g(z):=f(z)-\sum_{n\in\Z}\frac{1}{(z-n)^2}$が定まる．これが$g=0$であることを示せば，定理\ref{thm-partial-fraction-decomposition}より結論を得る．
        これには，$[0,1]\times(-\infty,\infty)$で有界であることを示せば周期性より定数関数であることがわかり，$\infty$での値から$g=0$であることを結論づける．
        \begin{enumerate}
            \item $x\in\R$に依らず，$f$が$\abs{\Im z}\to\infty$について$0$に一様収束$\lim_{\abs{y}\to\infty}\sup_{x\in\R}f(x+iy)=0$することを示す．
            $\sin \pi(x+iy)=\frac{e^{\pi i(x+iy)}-e^{-\pi i(x+iy)}}{2i}$であるから，
            \begin{align*}
                \abs{2\sin\pi(x+iy)}&=\Abs{e^{\pi i(x+iy)}-e^{-\pi i(x+iy)}}\\
                &=\Abs{e^{-\pi y}e^{\pi ix}-e^{\pi y}e^{-x\pi i}}\\
                &=\Abs{e^{2\pi ix}e^{-\pi y}-e^{\pi y}}&\because 両辺に\times\Abs{e^{\pi is}}\\
                &\ge\Abs{e^{-\pi y}-e^{\pi y}}&等号成立はx\in\Z のとき\\
                \therefore\quad 0<\frac{1}{\abs{\sin\pi(x+iy)}}&\le\frac{2}{\Abs{e^{-\pi y}-e^{\pi y}}}
            \end{align*}
            より，
            \begin{align*}
                \abs{f(x+iy)}&=\Abs{\frac{\pi^2}{\sin^2\pi(x+iy)}}\le(2\pi^2)\Abs{e^{-\pi y}-e^{\pi y}}\xrightarrow{\abs{y}\to\infty}0.
            \end{align*}
            \item $x\in[0,1]$に依らず，命題の式の右辺が$\abs{\Im z}\to\infty$について$0$に一様収束$\lim_{\abs{y}\to\infty}\sup_{x\in[0,1]}\sum_{n\in\Z}\abs{x+yi-n}^{-2}=0$することを示す．
            いま，任意の$\epsilon>0$に対して，
            \[\sum_{\abs{n}>N}\abs{x+iy-n}^{-2}\le\sum_{\abs{n}>N}\abs{x-n}^{-2}<\epsilon\]
            である．残りは$\abs{y}>\delta$を満たす$\delta$について
            \[\sum_{\abs{n}\le N}\abs{x+iy-n}^{-2}<(2N+1)\delta^{-2}\]
            が成り立つことより，$\delta$を十分大きくとれば$\abs{n}\le N$の和も$\epsilon$以下に出来る．総じて，
            \[\abs{y}>\delta\Rightarrow\sum_{n\in\Z}\frac{1}{(z-n)^2}\le 2\epsilon\]
            を得た．
            \item 以上より，$\lim_{\abs{y}\to\infty}\sup_{x\in[0,1]}g(x+iy)=0-0=0$．よって，$g$は帯状集合$[0,1]\times(-\infty,\infty)$上で有界で，$g$の周期$1$より，結局$\C$上で有界である．よって，Liouvilleの定理\ref{thm-Liouville}より，$g$は定数関数であるが，$\abs{y}\to\infty$の時の値より，$g=0$．
        \end{enumerate}
    \end{description}
\end{proof}
\begin{remarks}
    証明の構造は次のとおり．
    \begin{enumerate}
        \item 左辺$f(z)$の極の主要部を全て計算する．
        \item すると，定理\ref{thm-partial-fraction-decomposition}より，それらの無限和と整関数$g$の和として$f$が表せることを使う．無限和が収束することを示す必要がある．
        \item 最後に示すべきは$g=0$である．これで命題の式を得る．
    \end{enumerate}
\end{remarks}

\begin{proposition}[次に１位の極を持つもの]
    \[\pi\cot\pi z=\frac{1}{z}+\sum_{n\in\Z\setminus\{0\}}\paren{\frac{1}{z-n}+\frac{1}{n}}.\]
\end{proposition}
\begin{proof}
    $\pi\cot\pi z$の$n\in\Z$での極の主要部は$\frac{1}{z-n}$であるが，
    級数$\sum_{n\in\Z\setminus\{0\}}\frac{1}{z-n}$は収束しない．
    \begin{description}
        \item[無限和のデザイン] 同じ無限和を，
        \[\frac{1}{z}+\sum_{n\in\Z\setminus\{0\}}\paren{\frac{1}{z-n}+\frac{1}{n}}=\frac{1}{z}+\sum_{n\in\Z\setminus\{0\}}\frac{z}{n(z-n)}<\frac{1}{z}+\sum_{n\in\Z\setminus\{0\}}\frac{z}{n^2}.\]
        と考えると，優級数が見つかるために，収束を示せる．これは有理型関数に広義一様収束する．
        従って，整関数$g$が存在して，
        \[\pi\cot\pi z=\frac{1}{z}+\sum_{n\in\Z\setminus\{0\}}\paren{\frac{1}{z-n}+\frac{1}{n}}+g(z).\]
        \item[$g=0$：今回は微分で解決する]
        両辺を微分すると，
        \[-\frac{\pi^2}{\sin^2\pi z}=-z^2-\sum_{n\in\Z\setminus\{0\}}\frac{1}{(z-n)^2}+g'(z)\]
        より，命題\ref{prop-partial-fractional-expansion}より，$g'(z)=0$だから，$g$は定数関数である．
        ここで，
        \begin{align*}
            \sum_{n\in\Z\{0\}}\paren{\frac{1}{z-n}-\frac{1}{n}}&=\sum^\infty_{n=1}\paren{\paren{\frac{1}{z-n}-\frac{1}{n}}+\paren{\frac{1}{z+n}+\frac{1}{n}}}\\
            &=\sum^\infty_{n=1}\frac{2z}{z^2-n^2}
        \end{align*}
        より，
        \[\pi\cot\pi z=\frac{1}{z}+\sum^\infty_{n=1}\frac{2z}{z^2-n^2}+g\]
        であるが，左辺は奇関数，$\frac{1}{z}+\sum^\infty_{n=1}\frac{2z}{z^2-n^2}$も奇関数なので，$g=0$．
    \end{description}
\end{proof}
\begin{remarks}
    $\cot$というのは，$\frac{1}{\sin\pi z}$だと周期が$2$になり，$1$だと$(-1)^n$が付くのがわずわらしい．これを消すためのデザインである．
\end{remarks}

\begin{example}\mbox{}
        \[\tcboxmath{\frac{\pi}{\sin\pi z}=\lim_{m\to\infty}\sum_{\abs{n}\le m}\frac{(-1)^n}{z-n}.}\]
        これは有理型関数$\frac{\pi}{\sin\pi z}$の$n\in\Z$での主要部が$\frac{(-1)^n}{z-n}$であることから予想がつく．
    右辺が一様収束することは，$\pm$の対をセットで考えると
    \[\lim_{m\to\infty}\sum_{\abs{n}\le m}\frac{(-1)^n}{z-n}=\frac{1}{z}+\sum^\infty_{n=1}(-1)^n\frac{2z}{z^2-n^2}\]
    であることからわかる．さて，等式は，\textbf{偶数と奇数で分ける}と見えてくる：
    \begin{align*}
        \sum_{\abs{n}\le m}\frac{(-1)^n}{z-n}&=\sum_{\abs{2n}\le m}\frac{1}{z-2n}-\sum_{\abs{2n+1}\le m}\frac{1}{z-2n-1}\\
        &=\frac{1}{2}\sum_{\abs{2n}\le m}\frac{1}{z/2-n}-\frac{1}{2}\sum_{\abs{2n+1}\le m}\frac{1}{(z-1)/2-n}\\
        \xrightarrow{m\to\infty}&\frac{1}{2}\pi\cot\pi\frac{z}{2}-\frac{1}{2}\pi\cot\pi\frac{z-1}{2}\\
        &=\frac{\pi}{2}\paren{\frac{\cos\frac{\pi}{2}z}{\sin\frac{\pi}{2}z}-\frac{\cos\paren{\frac{\pi}{2}z-\frac{\pi}{2}}}{\sin\paren{\frac{\pi}{2}z-\frac{\pi}{2}}}}\\
        &=\frac{\pi}{2}\paren{\frac{\cos\frac{\pi}{2}z}{\sin\frac{\pi}{2}z}+\frac{\sin\frac{\pi}{2}z}{\cos\frac{\pi}{2}z}}\\
        &=\frac{\pi}{2}\frac{1}{\sin\frac{\pi}{2}\cos\frac{\pi}{2}}=\frac{\pi}{2}\frac{2}{\sin\pi z}=\frac{\pi}{\sin\pi z}.
    \end{align*}
\end{example}

\begin{itembox}[l]{極を二次元的に持つ有理型関数}
    $\Z+i\Z$に極を持つ有理型関数
    \begin{align*}
        f(z)&=\sum_{n,m\in\Z}\frac{1}{(z-n-im)^k}\quad(k\ge 3)
    \end{align*}
    は，$f(z+1)=f(z+i)=f(z)$をみたし，$1,i$を周期とする．
    このような有理型関数を楕円関数という．
    これはRiemann球面ではなく，Torus上の有理型関数とみなせばよく，
    この大地の上の関数の研究を楕円関数論という．
    三角関数は楕円関数の退化と考えられる．
\end{itembox}

\section{無限積}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=整関数の因数分解]
    先ほどは和だったが，積の標準形の理論を立てたい．
\end{tcolorbox}

\begin{discussion}[モチベーション]
    多項式$P$の零でない根を重複度を込めて$a_1,\cdots,a_m$とし，$z=0$での零点の位数を$l\ge 0$とすると，定数$c\ne 0$を用いて
    \[P(z)=z^lc\prod_{n=1}^m(1-\frac{z}{a_n})\]
    と表せる．
    これと同様に，整関数$f$についても，$0$以外の零点を重複度を込めて$(a_n)_{n\in\N}$として，
    \[f(z)=z^le^{g(z)}\prod_{n=1}^\infty(1-\frac{z}{a_n})\]
    という形の，整関数$g$を用いた表示を得たい．ここで，無限積の収束性の議論が必要である．いつ収束するのだろうか．
\end{discussion}

\subsection{無限積の定義}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=無限積という概念]
    安直に部分積の極限と考えると，何も証明できない理論を得る．
    そこで，「有限項を除いて$0$でない数に収束する列」を無限積の極限とする．
\end{tcolorbox}

\begin{definition}[複素数の無限積の収束]\mbox{}
    \begin{enumerate}
        \item 
    複素数列$(z_n)_{n\in\N}$に対し，無限積$\prod_{n\in\N}z_n$が収束するとは，
    \[\exists N\in\N,\;\exists \alpha_N\in\C,\;\alpha_N=\lim_{m\to\infty}\prod_{n=N}^mz_n\ne 0\]
    が成り立つことをいう．
        \item この時，無限積の極限値を$\prod_{n\in\N}z_n:=\al_N\prod^{N-1}_{k=1}z_k$とする．
    \end{enumerate}
\end{definition}

\begin{lemma}
    この定義は，(1)の条件を満たす$N\in\N$，ひいては$\al_N\in\C^\times$の取り方に依らない．
\end{lemma}

\begin{definition}[関数列の無限積の収束]\mbox{}
    \begin{enumerate}
        \item 関数列$(f_n)$の無限積$\prod^\infty_{n=1}f_n$が収束するとは，$\exists_{N\in\N}\;F_N(z):=\lim_{m\to\infty}\prod^m_{n=N}f_n(z)$が収束し，零点を持たない．
        \item 無限積を$\prod^\infty_{n=1}f_n:=F_N\prod^{N-1}_{n=1}f_n$と定め，$F_m$が一様収束するとき，無限積が一様収束するという．
    \end{enumerate}
\end{definition}

\begin{lemma}[対数微分]
    領域$D$上の零でない正則関数の列$(f_n)$に対して，$F_n:=\prod^\infty_{n=1}f_n$は広義一様収束するとする．
    このとき，$F$は正則であり，
    \[\frac{F'}{F}=\prod^\infty_{n=1}\frac{f'_n}{f_n}\]
    が成り立つ．
\end{lemma}

\subsection{無限積の収束}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    
\end{tcolorbox}

\begin{lemma}[無限積の収束に必要な自明な必要条件]
    無限積$\prod_{n=1}^\infty z_n$が収束するならば，$\lim_{n\to\infty}z_n=1$である．
\end{lemma}
\begin{proof}
    ある$M\in\N$が存在して，$P_m:=\prod^m_{n=M}z_n$は$\al\ne0$に収束する．このとき，
    \[\lim_{m\to\infty}z_m=\lim_{m\to\infty}\frac{P_m}{P_{m-1}}=\frac{\al}{\al}=1.\]
\end{proof}

\begin{discussion}
    そこで，無限積を$\prod^\infty_{n=1}(1+a_n)$と見ることを考える．これが収束するには，$\lim_{n\to\infty}a_n=0$が必要．
    無限積の収束の判定では最初の有限項は無視して良いから，最初から$\abs{a_n}<1$を仮定しても実用性を失わない．
    すると，列$(1+a_n)$は右半平面上の点列である．
    $z$が負の実軸上にないときは，$\log z$を虚部の値域が$(-\pi,\pi)$に含まれるように取れる．
    これを対数の主値といい，$\Log:\C\setminus(-\infty,0]\to\C$で表すのであった\ref{def-principle-value-of-log}．
\end{discussion}

\begin{theorem}[無限積が収束することの特徴付け]
    $\Delta$内の点列$(a_n)$について，次の２条件は同値．
    \begin{enumerate}
        \item $\prod^\infty_{n=1}(1+a_n)$は収束する．
        \item $\sum^\infty_{n=1}\Log(1+a_n)$は収束する．
    \end{enumerate}
\end{theorem}

\begin{proposition}
    $\Delta$内の点列$(a_n)$について，次の２条件は同値．
    \begin{enumerate}
        \item $\sum^\infty_{n=1}\abs{a_n}<\infty$．
        \item $\sum^\infty_{n=1}\abs{\Log(1+a_n)}<\infty$．
    \end{enumerate}
\end{proposition}

\begin{theorem}
    関数列$(f_n)$について，$\sum_{n\in\N}f_n$が一様収束すれば，$\prod_{n\in\N}(1+f_n)$も一様収束する．
\end{theorem}

\subsection{Weierstrassの定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    零点に当たる離散集合と重複度を指定することにより，これに対応する整関数を構成し，無限積で表示できる．
\end{tcolorbox}

\begin{theorem}[Weierstrass]\mbox{}\label{thm-Weierstrass-pre}
    \begin{enumerate}
        \item $\C$内に集積点を持たない点列$\{a_n\}$に対して，整関数$f:\C\to\C$であって，その零点が重複度もこめて$\{a_n\}$と一致するものが存在する．
        \item さらに$a_1=a_2=\cdots=a_m=0,a_n\ne0(n>m)$とするとき，多項式の列$(P_n)_{n=m+1}^\infty$が存在して，\[f(z)=z^me^{g(z)}\prod_{n=m+1}^\infty\paren{1-\frac{z}{a_n}}e^{P_n(z)}\]
        と表示できる．ここで$g(z)$は零点を持たない整関数で，無限積は
        広義一様収束する
    \end{enumerate}
\end{theorem}
\begin{proof}
    一般の複素領域における証明は\ref{thm-Weierstrass-zero}．
    ここでは構成的に証明する．
\end{proof}

\begin{example}
    $\N$に１位の零点を持つ整関数は，$P_n(z)=z/n$ととれて，次のような積表示を持つ：
    \[\tcboxmath{e^{g(z)}\prod^{\infty}_{n=1}\paren{1-\frac{z}{n}}e^{z/n}}\]
\end{example}
\begin{remark}[genus]
    これは，$(P_n)$を常に１次式として取っている．
    実は，ある自然数$k\in\N$に対して，$0$でない$a_n$に関する和$\sum_{n\in\N,a_n\ne0}\abs{a_n}^{-k-1}$が有限であるとき，$P_n(z)$として$k$次式を取れる．
    このような$k\in\N$の最小値を，列$(a_n)$の\textbf{種数}といい，$a_n=n$の場合，種数は１である．
\end{remark}

\begin{corollary}
    $\C$上の有理型関数$F$は，２つの整関数$f,g$の商$f/g$として表せる．
\end{corollary}

\begin{example}
    \[\tcboxmath{\sin\pi z=\pi z\prod_{n\in\Z\setminus\{0\}}\paren{1-\frac{z}{n}}e^{z/n}=\pi z\prod^\infty_{n=1}\paren{1-\frac{z^2}{n^2}}}\]
\end{example}

\section{Gamma関数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Gamma関数は，積分を通じて定義され，関数等式$\Gamma(z+1)=z\Gamma(z)$によって延長されて得る$\C$上の有理型関数で，
    無限積表示の重要な例を与える．
\end{tcolorbox}

\subsection{定義と性質}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    積分の表示により定義できるのは右半平面上の正則関数であるが，性質$\Gamma(z+1)=z\Gamma(z)$を用いて，$\C$上の有理型関数に延長できる．
    構成は，$\Gamma_{-1}:=\frac{\Gamma(z+1)}{z}$とする．
\end{tcolorbox}

\begin{definition}
    \[\Gamma(z):=\int^\infty_0e^{-t}t^{z-1}dt\quad\Re z>0\]
    は，右半平面上の正則関数を定める．
\end{definition}
\begin{proof}
    \[D_\delta:=\Brace{z\in\C\mid\delta<\Re z<1/\delta}\quad\delta\in(0,1)\]
    とおく．$\abs{e^{-t}t^{z-1}}=\abs{e^{-t}t^{\Re z-1}t^{t\Im z}}=\abs{e^{-t}t^{\Re z-1}}$より，
    任意の$z\in D_\delta$について，
    \begin{align*}
        \int^\infty_0\abs{e^{-t}t^{z-1}}&\le\int^1_0e^{-t}t^{\delta-1}dt+\int^\infty_1e^{-t}t^{1/\delta-1}dt\\
        &\le\int^1_0t^{\delta-1}dt+c_\delta\int^\infty_1e^{-t/2}dt<\infty.
    \end{align*}
    ただし，$c_\delta:=\max_{t\ge 1}e^{-t/2}t^{1/\delta-1}$とした．
    よって，$\Gamma_\ep(z):=\int^{1/\ep}_\ep e^{-t}t^{z-1}dt$とすると，これは$\ep\to0$のとき$D_\delta$上で一様に$\Gamma$に収束する（$z\in D_\delta$は任意に取ったので）．
    定理\ref{thm-propagation-of-regularity-through-compact-convergence}より，各$\Gamma_\ep$が$D_\delta$上で正則であることを示せば十分．

    $\gamma$を$D_\delta$内の$C^1$級閉曲線とするとき，Fubiniの定理より，
    \begin{align*}
        \int_\gamma\Gamma_\ep(z)dz&=\int_\gamma\int^{1/\ep}_\ep e^{-t}t^{z-1}dtdz\\
        &=\int^{1/\ep}_{\ep}e^{-t}\int_\Gamma t^{z-1}dzdt=0.
    \end{align*}
    よって，Moreraの定理\ref{thm-Morera}より，$\Gamma_\ep$は正則．
\end{proof}

\begin{theorem}
    $\Re z>0$について，
    $\Gamma(z+1)=z\Gamma(z)$．特に，$\forall_{n\in\N}\;\Gamma(n)=(n-1)!$．
\end{theorem}
\begin{proof}
    部分積分による．
    小さな$\ep>0$について，
    \[\int^{1/\ep}_\ep\dd{}{t}(e^{-t}t^z)dt=-\int^{1/\ep}_\ep e^{-t}t^zdt+z\int^{1/\ep}_\ep e^{-t}t^{z-1}dt.\]
    $\ep\to0$の極限を考えると，右辺は$\Gamma(z+1)+z\Gamma(z)$に，左辺は$0$に収束する．
\end{proof}

\begin{discussion}[複素平面全体への延長]
    
\end{discussion}

\subsection{反転公式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Gamma関数を$\C$上の有理型関数に延長すると，いままでの複素関数論が応用できる．
\end{tcolorbox}

\begin{theorem}[Gamma関数の反転公式]
    有理型関数として等しい：$\Gamma(z)\Gamma(1-z)=\frac{\pi}{\sin\pi z}$．
    特に，$z=1/2$のときより，$\Gamma(1/2)=\sqrt{\pi}$．
    また特に，$\Gamma$は$\C$上に零点を持たない．
\end{theorem}

\begin{corollary}
    \[\frac{1}{\Gamma(z)}=ze^{g(z)}\prod^\infty_{n=1}\paren{1+\frac{z}{n}}e^{-z/n}\]
    で，オイラー定数
    \[\gamma:=\lim_{n\to\infty}\paren{\sum^n_{k=1}\frac{1}{n}-\log n}\]
    を用いて，$g(z)=\gamma z$と表せる．
\end{corollary}

\subsection{ベータ関数}

\begin{definition}
    \[B(z,w):=\int^1_0(1-t)^{z-1}t^{w-1}dt\quad(\Re z>0,\Re w>0).\]
\end{definition}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item $B(z,w)=\frac{\Gamma(z)\Gamma(w)}{\Gamma(z+w)}$．
        \item $B(z,w)=\int^\infty_0\frac{u^{z-1}}{(1+u)^{z+w}}du$．
    \end{enumerate}
\end{proposition}

\part{複素解析学II}

\chapter{Riemannの写像定理}

\begin{quotation}
    単連結領域$D\subsetneq\C$を，中心としたい点$a\in D$を指定して単位円板に双正則同値に移す方法は，
    回転を除いてただ一通りである．これを（$a\in D$で正規化された）Riemann写像という．

    すると，ポテンシャルが存在する領域であった$D$は
    \begin{enumerate}
        \item 双正則同値問題として，議論を幾何学化する．一次分数変換の理論を思い出すと，上半平面$\H$，単円板$\Delta$，第一象限$V$，帯状領域は全てRiemann球面$\hatC$の円として双正則同値である．単連結性な領域という共通項がある．
        \item ある点$a\in D$で正規化されたRiemann写像の一意性は，Schwarzの補題\ref{thm-Schwarz's-lemma}からすぐに従う．
        \item 単連結性は解析的に特徴づけることができる．
        \item $\sup$を用いた極限構成によってRiemann写像を構成する．このために正規族の言葉を整備する．
    \end{enumerate}
\end{quotation}

\section{双正則同値問題}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=幾何学化]
    $\H\sim\Delta\sim V$と帯と２つの同じ円弧で出来たラグビーボールみたいなものは全て$\hatC$上の円として双正則同値である．
\end{tcolorbox}

\begin{example}
    $\Delta$と$\C$は位相同型であるが，双正則同値ではない．
    実際，正則写像$\C\to\Delta$が存在したならば，これは$\C$上の有界関数だから，Liouvilleの定理\ref{thm-Liouville}より定数関数となり，可逆ではない．
\end{example}

\begin{example}[Cayley transformation]
    $\H$と$\Delta$は双正則同値である．
    \[\xymatrix@R-2pc{
        H\ar[r]^-{\sim}&\Delta\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        z\ar@{|->}[r]&\frac{i-z}{i+z}
    }\]
    これはRiemann球面$S^2$で考えるとわかりやすい．
    \begin{align*}
        i&\mapsto 0,&-i&\mapsto\infty,&0&\mapsto 1,
    \end{align*}
    より，大円が$S^2$を分割して得る同型な円板を，少し回転させながらずり上げる変換である．
    うまく証明ができないが，Riemann球面$S^2\subset\R^3$を$\Im$に平行な平面で切って得る大円（立体射影で$\R$へ）が，$\C$で切って得る大円（立体射影で不変な$S^1\subset\C$）に写る．
    Poincaréの円板モデルもこの動きだという．
\end{example}

\begin{example}
    $H$と第一象限$V:=\{z\in\C\mid\Re z,\Im z>0\}$とは双正則同値である．
    \[\xymatrix@R-2pc{
        H\ar[r]^-{\sim}&V\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        z\ar@{|->}[r]&\sqrt{z}
    }\]
    $0$でのYacobianは消えているから，ここで角度を保つ必要はない．
\end{example}

\begin{example}[楕円関数の消息]
    帯$U:=\{z\in\C\mid \Im z>0,\abs{\Re z}<\pi/2\}$と$H$とは双正則同値．
    \[\xymatrix@R-2pc{
        \sin:U\ar[r]^-{\sim}&D_{>0}\ar[r]^-{\sim}&H\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        z\ar@{|->}[r]&ie^{iz}=w\ar@{|->}[r]&-\frac{1}{2}\paren{w+\frac{1}{w}}
    }\]
\end{example}

\begin{example}
    $0,1\in\C$を通る２つの同じ円弧で，点$0$での接線の偏角$\pm\pi/2m$とする．これに囲まれる領域を$U$とする．
    $V_1:=\{z\in\C\mid \abs{\arg z-\pi}<\pi/2m\}$とすると，$f(z)=\frac{(z-1)^m-z^m}{(z-1)^m+z^m}$は
    \[
        \xymatrix@R-2pc{
        f:U\ar[r]^-{\sim}&V_1\ar[r]^-{\sim}&\Delta\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        z\ar@{|->}[r]&\frac{z}{z-1}=w\ar@{|->}[r]&-w^m
    }\]
\end{example}

\section{Riemannの写像の一意性}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=２次元領域分類の霊性]
    零点の位置$f(a)=0$と，そこでの回転$f'(a)>0$との２つで，単連結領域から円板$\Delta$への写像は分類できる，という定理\ref{thm-biholomorphism-on-unit-disk}
    の一般化である．
    単連結性は同相写像（特に双正則写像）で保たれる位相的性質であることに注意．
    Poincaré予想のような分類の霊性を感じる．
    平面上の単連結な開集合は非常に難しい。例えば、集合それ自身は有界であったとしても、境界は無限の長さをもついたるところで微分可能でなくフラクタルな曲線が存在する。そのような集合が角度を保持するような方法でうまく正規な円板に写像することができるという事実は、直感に反するように見える。
\end{tcolorbox}

\begin{theorem}[Riemann mapping theorem]\label{thm-Riemann-mapping-theorem}
    $D\subsetneq\C$を単連結領域とする．
    任意の点$a\in D$に対して
    \[f(a)=0,\;f'(a)>0\]
    を満たす双正則写像$f:D\to\Delta$はただ一つ存在する．
    これを点$a$で正規化されたRiemann写像と呼ぶ．
\end{theorem}
\begin{remark}[単連結でない領域の消息]
    円環(annulus) $A(r_1,r_2):=\Delta(0,r_1,r_2),A(r'_1,r'_2)$が双正則同値であるための必要十分条件は$\frac{r_1}{r_2}=\frac{r'_1}{r'_2}$である．
    Riemannの写像定理の次に単純な結果として，穴を一つもつ有界領域(doubly connected domain)は，ある円環に双正則同値となる．
\end{remark}

\begin{discussion}[Riemann写像の間の関係：２つの円板の正則自己同型との合成により自由に規格化できる]
    $f:D\to\Delta$を任意のRiemann写像とする．
    まず，$\phi_a(z)=\frac{z-a}{1-\overline{a}z}$は$a$を$0$に，$1/\o{a}$を$\infty$に写す$\Delta$の正則自己同型だから，これとの合成
    \[\tilde{f}(z):=\phi_{f(a)}\circ f=\frac{f(z)-f(a)}{1-\overline{f(a)}f(z)}\]
    は$f(a)=0$を満たし，これはRiemann写像のままである．
    この微分係数を求めると
    \[\tilde{f'}(a)=f'(a)\frac{1+\abs{f(a)}^2}{(1-\abs{f(a)}^2)^2}\]
    より，$f'(a)$の偏角$\theta$によって$\hat{f}:=e^{-i\theta}\tilde{f}$と定めれば，$\hat{f}$は$a\in D$で規格化されたRiemann写像である．
\end{discussion}

\begin{lemma}[Poincaré：正規化されたRiemann写像の一意性]
    $f_1,f_2:D\to\Delta$を$a\in D$で正規化されたRiemann写像とする．
    $f_1=f_2$である．
\end{lemma}
\begin{proof}
    双正則写像$F:=f_1\circ f_2^{-1}:\Delta\to\Delta$は$F(0)=0,F'(0)>0$を満たすから，
    Schwarzの補題より，$\abs{F'(0)}\le 1$である．
    $F^{-1}=f_2\circ f_1^{-1}$についても同様に$\abs{F^{'-1}(0)}\le 1$だから，$\abs{F'(0)}=1$．
    定理\ref{thm-biholomorphism-on-unit-disk}より$\exists_{\theta\in\R}\;F(z)=e^{i\theta}z$であるが，
    $F'(0)>0$より，$\theta=0$．よって，$F=\id_\Delta$．
\end{proof}

\section{単連結性の特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    単連結領域を，微分方程式$f'=g$が解を持つ空間として解析の言葉で特徴づけることができる．
    群みたいな領域なのだな．
    この特徴づけの利点は，解析学化されたので，圏論的な方法で証明ができる．
    コンパクト性の$\Hom(X,2)$を用いた特徴付けのような手法である．
\end{tcolorbox}

\begin{proposition}[単連結性の特徴付け]\label{prop-characterization-of-simply-connectedness}
    領域$D\subset\C$について，次の３条件は同値である．
    \begin{enumerate}
        \item (純粋に位相的な定義) 任意の閉曲線$\gamma:\partial\Delta\to D$は1点とhomotopicである．すなわち，$\gamma$は閉円板上への連続な延長$\wt{\gamma}:[\Delta]\to D$をもつ．
        \item (コンパクト集合からの補集合が連結：ホモロジーからの定義\footnote{\textbf{穴がない}という．穴という概念は，$\C\setminus D$の有界な連結部分として検出する．よってこの条件は，$\C\setminus D$に有界な連結成分が存在しない，と言い換えて良い．}) $\hat{C}\setminus D$が連結である．\footnote{これは２次元球面$S^2$特有の性質である．}
        \item (任意の正則関数が原始関数をもつ空間：１次のde Rham cohomologyが消える) $\O(D)$を$D$上の正則関数全体の集合とする．微分$\frac{d}{dz}:\O(D)\to\O(D)$は全射である．
    \end{enumerate}
\end{proposition}

\begin{lemma}[解析的単連結性は双正則写像によって保たれる]
    $f:U\to V$を双正則写像とする．$V$が解析的単連結ならば$U$もそうである．
\end{lemma}
\begin{proof}
    変数を$f(z)=w$とする．$f^\sharp\varphi:=f^*\varphi f'=\varphi\circ f\cdot f'$と置くと，
    連鎖律とは，
    \[\xymatrix{
        \O(V)\ar[r]^-{f^*}\ar[d]_-{\frac{d}{dw}}&\O(U)\ar[d]^-{\frac{d}{dz}}\\
        \O(V)\ar[r]^-{f^\sharp}&\O(U)
    }\]
    が可換であることをいう．$f$が全単射であることと$f^*,f^\sharp$が全単射であることは同値である．\footnote{線形代数からの証明で出来るだろうか．}
    よって，$\frac{d}{dw},\dd{}{z}$の全射性は同値である．
\end{proof}
\begin{remarks}
    $f^\sharp$は$\varphi\in\O(U)$を1-形式$\varphi(z)dz$と見たときの引き戻しであるから，$\dd{}{z},\dd{}{w}$は，
    複素多様体$\hat{C}$上の外微分$d\varphi$の２種の近傍$U,V$での表現である．
    この間に座標変換が存在するから，上の図式が可換になる．
\end{remarks}

次を証明すれば，単位円板と同相な集合は単連結であるという命題と併せて，
命題\ref{prop-characterization-of-simply-connectedness}の(3)$\Rightarrow$(1)と併せてRiemannの写像定理\ref{thm-Riemann-mapping-theorem}が証明できる．
\begin{theorem}
    解析的単連結領域$D\subsetneq\C$に対して，Riemann写像$D\to\Delta$が存在する．
\end{theorem}
\begin{lemma}[logと平方根の存在]\label{lemma-existence-of-log}
    $D$を解析的単連結領域とする．$f\in\O(D)$が零点を持たなければ，$e^F=f,G^2=f$を満たす$F,G\in\O(D)$が存在する．
    これらを$F=\log f,G=\sqrt{f}$と書く．
\end{lemma}
\begin{proof}
    \begin{description}
        \item[$F$] $D$上の$f'/f$の原始関数を$\wt{F}$とする．これは定数倍の差を除いて一意であることを示す．
        \begin{align*}
            \paren{\frac{e^{\wt{F}}}{f}}'&=e^{\wt{F}}\paren{\frac{\wt{F}'}{f}-f'/f^2}\\
            &=e^{\wt{F}}\paren{\frac{f'}{f^2}-\frac{f'}{f^2}}=0
        \end{align*}
        より，$\exists_{c\in\C^*}e^{\wt{F}}/f=c$．
        改めて$e^k=c$をみたす$k\in\C$について，$F:=\wt{F}-k$とおけば，$e^F=e^{\wt{F}-k}=\frac{e^{\wt{F}}}{c}=f$．
        \item[$G$]
        $G:=e^{F/2}$とおけば，$G^2=e^F=f$．
    \end{description}
\end{proof}
\begin{remarks}
    平方根という関数も，奥底では対数関数と繋がっているのか……．
\end{remarks}

\section{Riemann写像の存在}

\begin{theorem*}[Riemann mapping theorem]
    $D\subsetneq\C$を単連結領域とする．
    任意の点$a\in D$に対して
    \[f(a)=0,\;f'(a)>0\]
    を満たす双正則写像$f:D\to\Delta$はただ一つ存在する．
    これを点$a$で正規化されたRiemann写像と呼ぶ．
\end{theorem*}
\begin{proof}
    $a\in D$を任意にとる．単連結領域$D$上の正則関数の集合$\calF$を
    \[\calF:=\Brace{f\in\O(D)\mid fは単射,f(D)\subset\Delta,f(a)=0,f'(a)>0}\]
    と定める．まずはこれを満たす写像が存在すること：$\calF\ne\emptyset$が問題となる．
    次に$g'(a):=\max\{f'(a)\mid f\in\calF\}$を満たす$g\in\O(D)$が存在することを示す．
    これは一般的に成り立つ構成である．最後に，こうして得た$g:D\to\Delta$がRiemann写像であることを示す．
    \begin{description}
        \item[Step1. $\calF\ne\emptyset$] 単連結領域を$\Delta$内に縮小し，微分係数が正実数となるような単射を構成することを考える．
        \begin{enumerate}
            \item 実は補集合上に円板が取れれば，一次分数変換により$D$を$\Delta$に変換することができる．
            $\C\setminus D$がある円板$\Delta(b,r)$を含む場合を考える．有理型関数$g(z)=\frac{r}{z-b}$は，$\Delta(b,r)$を$\infty$を中心として原点から距離$1/r$の点を境界とする領域に移すから，$g(D)\subset\Delta$を満たし，双正則である．あとは微分係数の条件だが，$\arg g'(a)=:\theta$とすれば，$e^{-i\theta}g\in\calF$が成り立つ．
            \item $\C\setminus D$に円板が取れない場合は，対数関数で脱出する．任意に$b\in\C\setminus D$を取ると，関数$z-b$は$D$上に零点を持たないから，補題\ref{lemma-existence-of-log}より，$D$上で$\varphi(z):=\log(z-b)\in\O(D)$が定義できる．いま$\exp\circ\varphi(z)=z-b$より，retractionが存在するとは$\varphi$は単射であるから，双正則写像$\varphi:D\to\varphi(D)$を定める．\footnote{この議論は，$\varphi(z)=\sqrt{z-b}$としても成り立つ．とにかく脱出できればいい．}
            この時，移った先にて，$\C\setminus\varphi(D)$は円盤を含むことを証明する．$w\in\varphi(D)$ならば，$\varphi$の単射性から$2\pi i+w\notin\varphi(D)$が必要である．したがって，開集合$D$内に取れる円板$\Delta(w,r)\subset D$に対して，$\varphi(\Delta(2\pi i+w,r))\subset\C\setminus\varphi(D)$である．
        \end{enumerate}
        \item[Step2. $g$の構成] $g'(a):=\max\{f'(a)\mid f\in\calF\}$に導関数が収束する$\calF$の列$(f_n)$が取れる：$g'(a)=\lim_{n\to\infty}f'_n(a)$．
        Montelの定理\ref{thm-Montel}より，$(f_n)\subset\O(D,\Delta)$は広義一様収束する部分列を持つから，最初から$(f_n)$は広義一様収束するとして考えて良い$g=\lim_{n\to\infty}f_n$．
        すると，$f'_n(a)\rightrightarrows g'(a)=M>0,f_n(a)\rightrightarrows g(a)=0$である．また，$f$は定数ではなく，各$f_n$は単射だから，Hurwitzの定理\ref{thm-Hurwitz}より，$f$は単射．いま，収束先である$f$の値域は$f(D)\subset[\Delta]$であるが，正則関数$f$は開写像なので，$f(D)\subset\Delta$．よって，$f\in\calF$．
        \item[Step3. $g:D\to\Delta$がRiemann写像である] 単射で$g(a)=0,g'(a)>0$を満たす$g:D\to\Delta$がRiemann写像であるためには，あとは全射であれば良い．
        そこで，$g$が全射でない：$\exists_{b\in\Delta\setminus f(D)}$と仮定して矛盾を示す．この$b$について，$\phi_b(z)=\frac{z-b}{1-\o{b}z}:\Delta\to\Delta$は双正則写像である．

        $F_1(z)=\sqrt{z}$を用いて，写像$G:=\phi_{\sqrt{-b}}\circ F_1\circ\phi_b\circ g$と定めると，\footnote{$\phi_b^{-1}(0)=b$より，$\phi_b(g(D))$は$0$を含まないから，この上で関数$z$は零点を持たない，したがって$\sqrt{z}$を構成できる．}
        $G:\Delta\to\Delta$は単射な正則写像で，$G(a)=0$を満たす．
        続いて，$F:=\psi_b^{-1}\circ F_2\circ\phi^{-1}_{\sqrt{-b}}:\Delta\to\Delta$は$F(0)=0$を満たす$2$対$1$写像となる．
        すなわち，$F$はSchwarzの補題の条件を満たすが，回転変換$F(z)=e^{i\theta}z$ではないから，$\abs{F'(0)}<1$（円板上の正則自己同型の分類\ref{thm-biholomorphism-on-unit-disk}）．

        いま，$g=F\circ G=(\psi_b^{-1}\circ F_2\circ\phi^{-1}_{\sqrt{-b}})\circ(\phi_{\sqrt{-b}}\circ F_1\circ\phi_b\circ g)$だから，Chain Ruleより，
        $g'(a)=F'(0)G'(a)$であるが，$g'(a)>0$より，$g'(a)=\abs{g'(a)}=\abs{F'(0)}\abs{G'(a)}<\abs{G'(a)}$である．
        すると，$\wt{g}(z):=\frac{\o{G'(a)}}{\abs{G'(a)}}G(z)$と置くと，$\wt{g}(a)=0,\wt{g}'(a)>0$で単射なだけでなく，$\wt{g}'(a)=\abs{G'(a)}>g'(a)$かつ$\wt{g}\in\calF$を満たす関数が作れたことになる．
        これは$g$の構成の最大性に矛盾する．
    \end{description}
\end{proof}
\begin{remarks}\mbox{}
    \begin{enumerate}
        \item Step1から不思議である．Riemann写像の条件から全射性だけを省けば簡単に構成できることをどうして見抜けたのか．
        \item Step2ではなぜ最大構成をしているのか．
        \item Step3では，最大構成した$g$は全射じゃなきゃ拡大算譜が存在するので矛盾することを突いている．
        $F_1(z)=\sqrt{z}$で領域を縮ませている．なのに逆の$F$も縮小写像である必要があるから，このままでは
        Schwarzの補題に矛盾する．
    \end{enumerate}
\end{remarks}

\begin{proposition}[Step 3の感覚：双正則写像は「広げ切っている」]
    $f,g:\Delta\to\Omega$を正則関数，$f$を全単射とし，$f(0)=g(0)$と仮定する．この時，$\forall_{r\in(0,1)}\;g(\Delta(0,r))\subset f(\Delta(0,r))$．
\end{proposition}

\begin{theorem}[Paul Montel 1876-75 France]\label{thm-Montel}
    $\O(D,\Delta)$の列$(f_n)$は広義一様収束する部分列を持つ（正規族である）．
\end{theorem}
\begin{proof}
    正則関数の族$\F\subset\O(D)$について，次の２条件が同値であることを示す．
    \begin{enumerate}
        \item $\F$は広義一様有界である．\footnote{任意のコンパクト集合$K\subset D$について一様に有界であることをいう．}
        \item $\F$は正規族である．
    \end{enumerate}
    $\F(D)\subset\Delta$は一様有界である．
    \begin{description}
        \item[$\Rightarrow$] $\F$が広義一様有界である時，コンパクト集合$\{z\}$でも有界だから，一様有界である．あとは，正則関数の族$\F$が同程度連続であることを示せば，Ascoli-Arzelàの定理\ref{thm-Ascoli-Arzelà}より，$\F$は正規族であることが従う．
        \begin{enumerate}
            \item $\F$が局所一様有界ならば，$\F':=\{f'\mid f\in\F\}$も局所一様有界である．つまり，任意の閉円板$[\Delta(z_0,r)]\subset D$上で$\forall_{f\in\F}\;\abs{f(z)}<M$である時，Cauchyの評価より，
            \begin{align*}
                f'(z)&\le\frac{1}{2\pi i}\int_{\partial\Delta(z_0,1/2)}\frac{\abs{f(\zeta)}}{\abs{\zeta-z}}\abs{d\zeta}\\
                &=\frac{1}{2\pi}\frac{M}{(r/2)^2}2\pi r=\frac{4M}{r^2}
            \end{align*}
            である．
            \item これより，任意の$z,w\in[\Delta(z_0,r/2)]$に対しては，線分$[z,w]$上での$f'$の積分を考えることで，
            \[\abs{f(z)-f(w)}=\Abs{\int_If'dz}\le\int_I\abs{f'}\abs{dz}\le\frac{4M}{r^2}\abs{z-w}\]
            が示せる．
            \item 任意のコンパクト集合$K\subset D$について，十分小さな半径$r>0$について，有限個の開円板による被覆を取ることにより，一様なLipschitz定数$M$を定めることができる．
        \end{enumerate}
        \item[$\Leftarrow$] もちろんAscoli-Arzeràの定理の２条件(1),(2)からも広義一様収束性は従う．同程度連続性を駆使して取った有限開被覆について，ある代表点では有界で（一様有界）であるためである．直接の方法で示す．
        \[\xymatrix@R-2pc{
            e:\O(D)\times D\ar[r]&\C\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (f,z)\ar@{|->}[r]&f(z)
        }\]
        は連続である．$\F$が正規族，すなわち，相対コンパクトであるならば$[\F]$はコンパクトで，任意のコンパクト集合$K\subset D$との積$[F]\times K$もコンパクトである．
        したがって，$e([\F]\times K)$もコンパクトより，$\C$の有界閉集合であるから，これは$\F$の$K$上での一様有界性を表す．
    \end{description}
\end{proof}
\begin{remarks}
    一様有界性が，evaluation mapping $e$の像の有界性に置き換えて議論できるとは，初めて気づいた．
\end{remarks}

\begin{theorem}[Adlof Hurwitz 1859-19 German]\label{thm-Hurwitz}
    $\O(D)$の列$(f_n)$が$\lim_{n\to\infty}f_n=f$に広義一様収束するとする．
    \begin{enumerate}
        \item 各$f_n$が零点を持たないならば，$f$も零点を持たない，または，$f=0$である．
        \item 各$f_n$が単射ならば，$f$も単射または定数である．
    \end{enumerate}
\end{theorem}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $f\ne 0$の場合を考える．$f$の零点は離散的であるから，$\forall_{a\in D}\;\exists_{r>0}\;\partial\Delta(a,r)上にfの零点はない$．
        偏角の原理より，$\Delta(a,r)$内の零点の個数は，$\frac{1}{2\pi i}\int_{\partial\Delta(a,r)}\frac{f'(z)}{f(z)}dz$．
        補題より，コンパクト集合$\partial\Delta(a,r)$上にて$f_n\rightrightarrows f$のとき$\frac{f'_n}{f_n}\rightrightarrows\frac{f'}{f}$であるから，上の積分は$\lim_{n\to\infty}\frac{1}{2\pi i}\int_{\partial\Delta(a,r)}\frac{f'_n}{f_n}dz$に等しい．各$f_n$は零点を持たないから，$=0$．
        \item $f_n$は単射なので，任意の$a\in D$について関数$f_n-f_n(a)$は$D\setminus\{a\}$上で零点を持たない．よって，$f$が定数でないならば，$f-f(a)$も$D\setminus\{a\}$上零点を持たない．これは$f$の単射性を表す．
    \end{enumerate}
\end{proof}

\begin{lemma}
    あるコンパクト集合上で$f_n\rightrightarrows f$のとき，$f'_n\rightrightarrows f_n$であり，
    $\frac{f'_n}{f_n}\rightrightarrows\frac{f'}{f}$である．
\end{lemma}
\begin{proof}
    一様収束に対する正則性の遺伝\ref{thm-propagation-of-regularity-through-compact-convergence}より$f'_n\rightrightarrows f_n$である．

\end{proof}

\section{正規族}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    関数の族が，一斉に$\delta$が取れることを同程度連続(equicontinuous)といい，また，任意の関数列がある関数に広義一様収束することと族として相対コンパクトであることは同値になり，また広義一様有界であることとも同値になる（Montelの定理）．これを正規族という．
    Ascoli-Arzelàの定理は，

    理論構築上は単調族に当たるものにも思えるが，内容的には，点列コンパクトの概念の一様収束バージョンである．
    Montelの定理\ref{thm-Montel}を示すために，正規族の特徴づけを２つ与える．
    ここでは$(S,d)$を距離空間として，ここから$C(D,S)$にコンパクト開位相を生成する距離を入れた．
    一般には$D$を収束空間，$S$を一様空間とできる．

    ここで「広義一様有界」「広義一様収束」が頻出するが，Ascoli-Arzelàの定理を示して思うのは，
    コンパクト集合上では有限だから，「任意のコンパクト集合について」というコンパクト集合についての全称量化は本質的な階層わけである．
\end{tcolorbox}

\begin{definition}[normal family]
    $(S,d)$を距離空間とする．領域$D\subset\C$に対して，連続写像の空間$C(D,S)$を考える．
    部分集合$\calF\subset C(D,S)$は，$\calF$の任意の写像列$(f_n)$が広義一様収束する部分列を持つとき，$\calF$を正規族という．\footnote{収束先も$\F$にある必要はない．}
\end{definition}

\begin{definition}[compact open topology]
    部分集合$U\subset D,S\subset V$に対し，$W(U,V):=\{f\in C(D,S)\mid f(U)\subset V\}$と表すとき，
    $C(D,S)$に
    \[\Brace{W(K,V)\mid K\subset Dはコンパクト，V\subset Sは開集合}\]
    が生成する位相を定義する．これを\textbf{コンパクト開位相}という．\footnote{幾何をやる人はこの位相に慣れましょう．これはnatural topologyとも呼ばれ，任意の位相空間$A\in\Top$に対して，$A\times D\to S$が連続であることと$A\to C(D,S)$が連続であることとが同値になる最大の位相でもある．}
\end{definition}

\begin{lemma}\mbox{}
    \begin{enumerate}
        \item 位相空間$C(D,S)$での関数$(f_n)$の収束は，広義一様収束である．
        \item 評価写像\[\xymatrix@R-2pc{
            \ev_z:C(D,S)\ar[r]&S\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            f\ar@{|->}[r]&f(z)
        }\]は連続である．\footnote{コンパクト開位相は，この評価写像を連続にする最弱の位相（始位相）である．}
    \end{enumerate}
\end{lemma}

\begin{proposition}
    領域$D\subset\C$のコンパクト集合の単調増大列$(K_n)_{n\in\N}$であって，$\cup_{n\in\N}K_n=D,K_n\subset K^\circ_{n+1}$を満たすものを取る．\footnote{確かに取れる．例えば，$K_n:=\{z\in D\mid d(\partial D,z)\ge 1/n,\abs{z}\le n\}$}
    \begin{enumerate}
        \item 関数$d_K(f,g):=\max\{d(f(z),g(z))\mid z\in K\}<\infty$を用いて，$d_D:C(D,S)\times C(D,S)\to\R$を
        \[d_D:=\sum^\infty_{n=1}\frac{1}{2^n}\frac{d_{K_n}(f,g)}{1+d_{K_n}(f,g)}<\infty\]
        とおくと，これは距離関数となる．
        \item この距離$d_D$が定める位相は，$C(D,S)$のコンパクト開位相である．\footnote{「邪道かもしれませんが，$C(D,S)$に距離を入れるのが複素解析では定番です．」Montelから始まるミーム進化なようだ．$\sup=\max$の用例が多くなってきたが，この現実的には計算可能・構成可能ではない議論に耐えられるかが，専門の違いな気がする，とのこと．}
    \end{enumerate}
\end{proposition}

\begin{definition}[relatively compact]
    位相空間の部分集合$U\subset X$に対し，$\o{U}$がコンパクトであるとき，これを\textbf{相対コンパクト}という．\footnote{「極限を考えたらはみ出してしまうかもしれない」という正規族の状況設定に極めて親和的な概念である．}
    $\C$では有界であることに同値．
\end{definition}

\begin{theorem}[Montelの定理の超克]\label{thm-regular-family-and-relatively-compact}
    $\calF\subset C(D,S)$が正規族であることは，$\calF$が相対コンパクトであることに同値．
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[$\Leftarrow$] 任意に$\calF$の列$(f_n)$を取る．$[\calF]$が点列コンパクトであるから，$(f_n)$は$[\calF]$上で収束する部分列を持つ．よって，$\calF$は正規族である．
        \item[$\Rightarrow$] $[\calF]$の点列$(f_n)$が収束する部分列を持つことを示せば良い．いま，任意の$n\in\N$に対して$d_D(f_n,g_n)<\frac{1}{n}$を満たすような$\calF$の列$(g_n)$を選び取れる．\footnote{多分選択公理を使った．}すると$(g_n)$は収束する部分列を持つ．よって，$(f_n)$も収束する．
    \end{description}
\end{proof}
\begin{remarks}
    広義一様有界から，微分の広義一様有界までが出るから，微積分学の基本定理に持っていって，Lipschitz連続性．
\end{remarks}

\begin{theorem}[Ascoli-Arzelàの定理]\label{thm-Ascoli-Arzelà}
    $\calF\subset C(D,S)$が正規族になることは，次の２条件が成り立つことに同値．
    \begin{enumerate}
        \item $\calF$は任意のコンパクト集合$K\subset D$上で，同程度連続(equicontinuous)である：
        $\forall_{\epsilon>0}\;\exists_{\delta>0}\st\forall_{f\in\calF}\;\forall_{z,w\in K}\;\abs{z-w}<\delta,d(f(z),f(w))<\epsilon$．\footnote{$\F$に属する全ての正則関数が，一斉に$\delta$が取れて連続になる．まあ同程度と言っても驚くほど連続な奴（定数関数など）はいるかもしれない．Lipschitz定数が$f$に依らずに取れることをいう．}
        \item $\calF$は\textcolor{red}{各点有界}（または「局所広義一様有界」）である：$\forall_{z\in D}\;\calF(z):=\{f(z)\in S\mid f\in\calF\}$は相対コンパクト．\footnote{任意の$\F(z)$が相対コンパクトであるとは，これら全てを含むコンパクト集合が上に取れると言うことである．\textcolor{red}{ではない．合併についてTynochoffの定理と同様の結果が成り立つはずはない．wikipediaには各点連続性について書かれているし，nLabでも一様性についての記載はないが，$L^p$空間への一般化であるFrechét-Kolmogorovの定理は一様であるようだ．}4/27/2021授業で訂正が入った．「一様有界」と提示されていたが，それは$\F$を空間と捉えた場合についてのことで，どの$f\in\F$を取っても「一様に」相対コンパクト，ということである．結局，各点毎で良い．}
    \end{enumerate}
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1),(2)$\Rightarrow\;\F$は正規族である]
        $\F$の列$(f_n)$をとる．ここから収束する部分列を作れば良い．
        \begin{description}
            \item[構成] まず，領域$D$内の有理点$Q=\{x+yi\in D\mid x,y\in\Q\}$に附番して，族$(z_n)_{n\in\N}$を用意し，その上で各点収束する部分列$(g_n)$を構成する．
            \begin{enumerate}
                \item まず，集合$\{f_n(z_1)\}_{n\in\N}\subset\F(z_1)$は有界より，相対コンパクトなので定理\ref{thm-regular-family-and-relatively-compact}より正規族で，部分列$(f_{1,n}(z_1))_{n\in\N}$であって収束するものが取れる．
                \item 続いて，ここからさらに，$(f_{1,n}(z_2))_{n\in\N}$も相対コンパクト性より正規族だから，収束する部分列$(f_{2,z}(z_2))_{n\in\N}$が定まる．このように，正規族$(f_{j-1,n}(z_j))_{n\in\N}$から収束する部分列$(f_{j,n}(z_j))_{n\in\N}$を構成することができ，収束列の列$((f_{j,n}(z_j))_{n\in\N})_{j\in\N}$が定まる．ここから，対角線の列$g_n:=f_{n,n}$を選び出すと，任意の$j\in\N$について$(g_n(z_j))_{n\in\N}$は収束する．
            \end{enumerate}
            \item[成功]
            この関数列$(g_n)_{n\in\N}$が$D$上で広義一様収束することを示す．任意のコンパクト集合$K\subset D$をとる．ある$r>0$に対して，$\wh{K}:=\{z\in D\mid d(z,K)\le r\}$もコンパクトであり，$\wh{K}\cap Q$は$\wh{K}$で稠密になる．\footnote{要証明だが，$K$に孤立点が存在して，それが有理点でない場合を除いている．}
            この$\wh{K}$を再び$K$と書く．この上で$(g_n)_{n\in\N}$が一様収束することを示す．$K$上で，任意に取った$\epsilon>0$に対して，(1)の同程度連続性を満たす$\delta>0$をとる．$Q\cap K$の稠密性より，$(\Delta(z,\delta))_{z\in Q\cap K}$は$K=\o{Q\cap K}\subset_{z\in Q\cap K}\Delta(z,\delta)$より$K$の開被覆となるから，有限集合$L\subset Q\cap K$が存在して，$K\subset\cup_{z\in L}\Delta(z,\delta)$を満たす．
            $L$の各点で$(g_n)_{n\in\N}$は収束するので，$\exists_{N>0}\;\forall_{n,m>0}\;\forall_{\zeta\in L}\;d(g_n(\zeta),d_m(\zeta))<\epsilon$．
            よって，任意の$z\in K$に対しても，$\abs{z-\zeta}<\delta$を満たす$\zeta\in L$が存在するから，これについて分解して，$n,m>N$のとき
            \[d(g_n(z),g_m(z))\le d(g_n(z),g_n(\zeta))+d(g_n(\zeta),g_m(\zeta))+d(g_m(\zeta),g_m(z))<3\epsilon\]
            と評価できる．(2)より$\F(z)$は相対コンパクトなので，$[\F(z)]$は完備より，Cauchy列$(g_n(z))_{n\in\N}$は収束する．上の不等式評価は$K$上一様である．
        \end{description}
        \item[$\F$は正規族$\Rightarrow$(1)]
        任意にコンパクト集合$K\subset D$をとる．任意の$\epsilon>0$に対して，$\F$は正規族より$[\F]$はコンパクトだから，開被覆$(V(f,\epsilon))_{f\in\F}$は有限部分被覆$(V(f_n,\epsilon))_{n\in[N]}$をもつ．各$f_n\in\F$は$K$上で一様に連続であるから\footnote{任意の連続関数$f:D\to S$は，コンパクト集合$K\subset D$上では，最小値関数が定まるから$\delta:=\min\{x\in D\mid \abs{f(x)-f(y)}<\epsilon\}$とすれば一様に取れる．}，
        ある$\delta>0$を取ると，$\forall_{n\in[N]}\;\forall_{z,w\in K}\;\abs{z-w}<\delta\Rightarrow d(f_n(z),f_n(w))<\epsilon$．
        よって，任意の$f\in\F$に対して，$d_K(f,f_n)<\epsilon$を満たす$f_n$が取れて，$\forall_{z,w\in K}\;\abs{z-w}<\delta\Rightarrow d(f(z),f(w))<3\epsilon$．
        こうして一様な$\delta>0$をとる算譜が構成できた．
        \item[$\F$は正規族$\Rightarrow$(2)]
        評価写像
        \[\xymatrix@R-2pc{
            \ev_z:C(D,S)\ar[r]&S\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            f\ar@{|->}[r]&f(z)
        }\]は連続で，連続写像のコンパクト集合の像はコンパクトだから，$\ev_z([\F])\supset\F(z)$は相対コンパクト．\footnote{$\ev_z([\F])=[\F(z)]$は非自明だが位相空間論の初等的な知識から言える．像の逆像は拡大するしかないから$\F\subset\ev_z^{-1}([\F(z)])$．$\ev_z$が連続だから右辺は閉より，$[\F]\subset\ev_z^{-1}([\F(z)])$．}
    \end{description}
\end{proof}
\begin{remarks}\mbox{}
    \begin{enumerate}
        \item 同程度連続性$\delta$が返してくる$d(g_n(z),g_m(z))<\epsilon$と，各有理点上での収束による$d(g_n(\zeta),g_m(\zeta))<\epsilon$が交錯する，その論理の糸を綺麗に暴き出している．
        有理点のみに注目すれば稠密だから，それを基点に分解するという作戦が立つ．全く違う文脈だが，対角線論法が効果的になる．
        \item 議論が前半と並行になる．一様連続性と同程度連続性が反転する．
    \end{enumerate}
\end{remarks}

\section{有理型関数に対するMontelの定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    前節で$D\subset\C$を領域，$(S,d)$を距離空間として正規族の理論を展開した．
    距離空間としてRiemann球面を取り，その間の正則関数の空間$\O(D,\hatC)=\M(D)\cup\{\infty\}$を考え（有理型関数の族を一点拡張），
    この場合におけるAscoli-Arzelàの定理の系を導きたい．
    そのためには，同型$S^2\simeq\hatC$を駆使して，$S^2\subset\R^3$のノルムを利用して評価をする．
\end{tcolorbox}

\begin{lemma}[立体射影]\label{lemma-stereographic-projection}
    次のように，平面$\C$への写像に対応する空間$\R^3$への写像を$\wt{\cdot}$で表す：
    \[\xymatrix{
        D\ar@{.>}[r]^-{\wt{f}}\ar[dr]_-{f}&(S^2,d)\setminus\{N\}\ar[d]^-{p_+}\ar@{}[r]|-\ni&(\xi_1,\xi_2,\xi_3)\ar@{|->}[d]\\
        &\hatC=\C\cup\{\infty\}\ar@{}[r]|-\ni&z
    }\]
    立体射影$p_+:S^2\setminus\{N\}\to\C$に対して，図式を可換にする$\wt{f}:D\to S^2$が存在し，
    \[\xi_1+i\xi_2=\frac{2z}{1+\abs{z}^2},\xi_3=\frac{1-\abs{z}^2}{1+\abs{z}^2}\]
    が成り立つ．
\end{lemma}

\begin{lemma}[球面上の距離の評価]
    距離空間$(S^2,d)$を，$d$を球面$S^2$上の２点を含む大円の弧長として定める．
    $\rho(f;z):=\frac{2\abs{f'(z)}}{1+\abs{f(z)}^2}$とすると，
    定義域$D$内の任意の$C^1$級曲線$\gamma:[0,1]\to D$と，その像である球面$S^2$上の曲線$\wt{\gamma}:=\wt{f}\circ\gamma:[0,1]\to S^2$について，
    任意の$a,b\in [0,1]$について
    \[d(\wt{\gamma}(a),\wt{\gamma}(b))\le\int_{\gamma}\rho(f;z)\abs{dz}\]
    が成り立つ．
\end{lemma}
\begin{proof}\mbox{}
    \begin{description}
        \item[速度ベクトルの長さ] 球面上で２点$\xi,\eta\in S^2\setminus\{N\}$を積分することを考えるために（北極を含めた議論は後述），速度ベクトル$\wt{\gamma}'(t)$のノルムを考える．
        ここで，平面上の点を援用するために，対応する点を$z:=p_+(\xi),w:=p_+(\eta)$とする．
        $\R^3$の点としての距離は
        \[\norm{\xi-\eta}^2=\norm{\xi}^2+\norm{\eta}^2-2(\xi,\eta)=2-2(\xi,\eta)\]
        であるから，内積を求めるが，ここで複素数$z,w\in\C$を用いて，補題\ref{lemma-stereographic-projection}より，
        \[(\xi,\eta)=\frac{1}{(1+\abs{z}^2)(1+\abs{w}^2)}\paren{\underbrace{4\Re z\cdot\o{w}}_{=\xi_1\eta_1+\xi_2\eta_2}+\underbrace{(1-\abs{z}^2)(1-\abs{w}^2)}_{\xi_3\eta_3}}\]
        いま，$2\Re z\o{w}=-\abs{z-w}^2+\abs{z}^2+\abs{w}^2$より，
        \begin{align*}
            (\xi,\eta)&=\frac{1}{(1+\abs{z}^2)(1+\abs{w}^2)}\paren{-2\abs{z-w}^2+2\abs{z}^2+2\abs{w}^2+1-\abs{z}^2-\abs{w}^2+\abs{z}^2\abs{w}^2}\\
            &=1-\frac{2\abs{z-w}^2}{(1+\abs{z}^2)(1+\abs{w}^2)}
        \end{align*}
        より，
        \begin{align*}
            \norm{\xi-\eta}^2&=\frac{4\abs{z-w}^2}{(1+\abs{z}^2)(1+\abs{w}^2)}\\
            \Lrarrow\norm{\xi-\eta}&=\frac{2\abs{z-w}}{\sqrt{(1+\abs{z}^2)(1+\abs{w}^2)}}
        \end{align*}
        これを用いて，速度ベクトル$\wt{\gamma}'(t)$の速さを求める．今回も平面$\C$上で考えるために，$\gamma_+:=p_+\circ\wt{\gamma}=f\circ\gamma$とおくと（北極を含めた議論は後述），
        \[\frac{\norm{\wt{\gamma}(t+h)-\wt{\gamma}(t)}}{\abs{h}}=\frac{2\abs{\gamma_+(t+h)-\gamma_t(t)}}{\abs{h}\sqrt{(1+\abs{\gamma_+(t+h)}^2)(1+\abs{\gamma_+(t)}^2)}}\]
        より，$h\to 0$を考えると，$\gamma_+=f\circ\gamma$についての連鎖律より，
        \[\norm{\wt{\gamma}'(t)}=\frac{2\abs{\gamma'_+(t)}}{1+\abs{\gamma_+(t)}^2}=\frac{2\abs{f'(\gamma(t))}\abs{\gamma'(t)}}{1+\abs{f(\gamma(t))}^2}\]
        したがって，$\norm{\wt{\gamma}'(t)}=\rho(f;\gamma)\abs{\gamma'(t)}$．

        いま，$\rho(1/f;\gamma(t))=\rho(f;\gamma(t))$に注目\footnote{検算にもなる}．
        北極を含めた$p_-$と$\gamma_-$についても，同様の議論が成り立つ．
        \item[積分]
        以上より，曲線$\wt{\gamma}:[0,1]\to S^2$の長さ$L(\wt{\gamma})$は，
        \begin{align*}
            L(\wt{\gamma})&=\int^1_0\rho(f;\gamma(t))\abs{\gamma'(t)}dt\\
            &=\int_\gamma\rho(f;z)\abs{dz}
        \end{align*}
        と表せる．よって，$\wt{\gamma}(a),\wt{\gamma}(b)$の距離は，この２点を結ぶあらゆる曲線の長さの下限であるから，
        \[d(\wt{\gamma}(a),\wt{\gamma}(b))\le\int_{\gamma}\rho(f;z)\abs{dz}\]
        が従う．
    \end{description}
\end{proof}

\begin{theorem}[有理型関数に関するMontelの定理]
    $\F\subset\O(D,\hatC)$を$D$上の$\hatC$-値正則関数の族とする．\footnote{「有理型関数に広義一様収束，または定数関数$\infty$に発散」とよく言われるが，こちらの方が一般的な理解ができる．}
    \begin{enumerate}
        \item $\F$が正規族である．
        \item 任意のコンパクト集合$K\subset D$に対して，$\sup_{z\in K,f\in\F}\rho(f,z)<\infty$である．ただし，$\rho(f;z):=\frac{2\abs{f'(z)}}{1+\abs{f(z)}^2}$．\footnote{正の曲率をもつ球面距離．}
    \end{enumerate}
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[方針] $\hatC$はコンパクトであるから，$\F$は$\forall_{z\in D}\;\F(z)$は相対コンパクトである，という条件を満たす．よって，Ascoli-Arzelàの定理\ref{thm-Ascoli-Arzelà}より，同程度連続性の条件を満たすことが，$\F$が正規族であることと同値になる．
        \item[(2)$\Rightarrow$(1)] $K:=[\Delta(z_0,r)]\subset D$とおき，$K$上$\rho(f;z)\le M$とする．任意の線分$[z,w]\subset K$と任意の$f\in\F$について，補題より，
        \[d(\wt{f}(z),\wt{f}(w))\le\int_{[z,w]}\rho(f;\zeta)\abs{d\zeta}\le M\abs{z-w}\]
        を得る．これは$K$上での$\F$の同程度連続性を表す．Ascoli-Arzelàの定理より．
        \item[(1)$\Rightarrow$(2)]
        Montelの定理\ref{thm-Montel}同様，関数
        \[\xymatrix@R-2pc{
            \rho:\O(D,\hatC)\times D\ar[r]&\R\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (f,z)\ar@{|->}[r]&\rho(f;z)
        }\]
        の連続性を示せば，$[F]\times K$のコンパクト性より，一様有界性が従う．れんぞk
        連続性は，$\rho$の分子の$f'$について，Cauchyの評価より．
    \end{description}
\end{proof}

\section{穴のない領域とHomology型のCauchyの定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Riemannの写像定理の証明を，単連結性の特徴づけと同時に証明したが，
    もう一つの特徴づけ(2)を模索する．こちらは積分の言葉で定義しているので，連続性で語るより強い特徴づけを得ることになる．
    \begin{enumerate}
        \item (純粋に位相的な定義) 任意の閉曲線$\gamma:\partial\Delta\to D$は1点とhomotopicである．すなわち，$\gamma$は閉円板上への連続な延長$\wt{\gamma}:[\Delta]\to D$をもつ．
        \item (ホモロジーからの定義\footnote{\textbf{穴がない}という．穴という概念は，$\C\setminus D$の有界な連結部分として検出する．よってこの条件は，$\C\setminus D$に有界な連結成分が存在しない，と言い換えて良い．}) $\hat{C}\setminus D$が連結である．\footnote{これは２次元球面$S^2$特有の性質である．}
        \item (解析的な定義：１次のde Rham cohomologyが消える) $\O(D)$を$D$上の正則関数全体の集合とする．微分$\frac{d}{dz}:\O(D)\to\O(D)$は全射である．
    \end{enumerate}
\end{tcolorbox}

\begin{definition}[homologous]\mbox{}
    \begin{enumerate}
        \item $D$内の２つの閉曲線$\gamma_1,\gamma_2$が任意の$p\in C\setminus D$に対して，$n(\gamma_1,p)=n(\gamma_2,p)$を満たすとき，$\gamma_1,\gamma_2$は\textbf{ホモローグ}またはホモロガスであるという．\footnote{コホモロジーは一形式についてで，微分方程式が解けるかの議論をしている．その双対として積分で定義しているので，射や圏論的議論から脱している．複素解析学の二次元の場合は，2-形式からが消えているので，そもそも図式が描けない理想郷となっている．}
        \item 特に$\forall_{p\in\C\setminus D}\;n(\gamma,p)=0$を満たすとき，$\gamma$は$D$に関して$0$とホモロガスという．
        \item $D$がhomology的に単連結であるとは，$D$内の任意の閉曲線が$0$とホモローグであることとする．
    \end{enumerate}
\end{definition}
\begin{remark}[整理]\mbox{}
    \begin{description}
        \item[homologus] logosとは「調和」「釣り合い」の意味ももち，homologosで「一致している」という意味のギリシャ語であった．その後中世ラテン語に入り，語源は1660．\footnote{生物では「鳥の翼と馬の前足は相同である」といい，形態だけでなく遺伝子が共通の祖先に由来することをいう．Goetheも『植物変態論』で考察し，生物学分野で形態学（Morphologie）という語を初めて用いた．}
        \item[homolog(ue)] ギリシャ語のhomologousの中性形homologonからフランス語に入ったもの．いずれにしろ積分で定義する．
        \item[homotope] top(os)とはギリシャ語で「場所」を意味する．フランス語的．ポアンカレに敬意を払うのか，古書はこちらからよくとる．
        \item[homotopic] 英語的で現代だとhomotopeでは検索結果がでない．いずれにしろ連続変形で定義する．
    \end{description}
\end{remark}

\begin{theorem}[homology型のCauchyの積分定理]
    $D$内の閉曲線$\gamma$が$0$とhomologueであるならば，$\forall_{f\in\O(D)}\;\int_\gamma fdz=0$．
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[$D$が有界の場合] $\partial D,\Im\gamma$はコンパクトであり，$\partial D\cap\Im\gamma=\emptyset$であるから，$\delta:=d(\partial D,\Im\gamma)>0$となる．
        $\C$を一辺$\delta/3$の正方形に分割し，そのうち$D$に含まれる閉正方形を$Q_1,\cdots,Q_k$とする．$K:=\cup_{i\in[k]}Q_i$と置くと，$\Im\gamma\subset K^\circ$が成り立つ．すなわち，$\gamma$と$\partial K$は交わらない．
        \item[$\partial K$では回転数$0$]
        $z_0\in\partial K$ならば，$n(\gamma,z_0)=0$である．実際，$z_0\in\partial K$のとき，$z_0$を含む閉正方形$Q$であって，$\C\setminus D$と交わるものが存在する．
        この$Q$と$\gamma$とは交わらないから，$n(\gamma,z)$は$Q$上で定数．$n(\gamma,z)$は$\C\setminus D$上では$0$という仮定であるから，$n(\gamma,z_0)=0$．
        \item[$K$でのCauchyの定理]
        $\forall_{z\in\partial K}\;\frac{1}{2\pi i}\int_{\partial K}\frac{f(\zeta)}{\zeta-z}d\zeta=f(z)$である．
        まず，$z$が$Q_j$の辺上にないとき，ある$j\in[k]$がただ一つ存在して$z\in Q_j^\circ$を満たすから，
        \[\int_{\partial K}\frac{f(\zeta)}{\zeta-z}d\zeta=\sum^k_{j=1}\int_{\partial Q_j}\frac{f(\zeta)}{\zeta-z}d\zeta=\int_{\partial Q_j}\frac{f(\zeta)}{\zeta-z}d\zeta=2\pi if(z)\]
        である．両辺は$z$について連続なので，一致の定理より上式を得る．
        \item[結論]
        以上より，$z\in K^\circ$について，次のように計算できる．ただし，Fubiniの定理を用いた．
        \begin{align*}
            \int_\gamma f(z)dz&=\int_\gamma\frac{1}{2\pi i}\int_{\partial K}\frac{f(\zeta)}{\zeta-z}d\zeta dz\\
            &=\int_{\partial K}f(\zeta)\underbrace{\frac{1}{2\pi i}\int_\gamma\frac{1}{\zeta-z}dz}_{=-n(\gamma,\zeta)}d\zeta=0
        \end{align*}
        \item[$D$が有界でない場合]
        十分大きな$r$に対し，$D':=\Delta(0,r)\cap D$とおけば，$\gamma$は$D'$でも$0$とhomologueとなる．非有界な部分は無限遠点の連結成分，無限遠点では回転数は$0$．
    \end{description}
\end{proof}


\begin{theorem}[単連結性の特徴づけの最後のピース]
    領域$D\subset\C$について，$D$に穴がないこと（ホモトピー的に単連結であること）とホモロジー的に単連結であることは同値である．
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[$\Rightarrow$] 回転数$n(\gamma,z)$が$\C/D$上で定数であることから解る（補題\ref{lemma-character-of-winding-number}）．
        十分遠くの点$p\in\C\setminus D$では回転数が$0$であるため．
        \item[$\Leftarrow$]
        対偶命題を示す．すなわち，$\hatC\setminus D$が連結でないとして，ある点$z_0\in\C\setminus D$と閉曲線$\gamma:S^1\to D$が存在して$n(\gamma,z)\ne 0$を満たすことを示せば良い．
        \begin{enumerate}
            \item 仮定より，$\hatC\setminus D=V\cup V_\infty$を満たす互いに素な空でない$\hatC$の閉集合で$\infty\in V_\infty$を満たす$V,V_\infty$が存在する．
            $V,V_\infty$は$\hatC$の閉集合なのでコンパクトだから，$\delta:=d(V,V_\infty\cap\C)>0$が取れる．\footnote{$d(V,V_\infty\cap\C)$は$V$について最小値を取る点が存在する．そこで，$\delta=0$となったら，閉集合$V_\infty$と交わりを持つことになってしまうので矛盾．閉集合と距離が$0$になる点は閉集合の中にあることより．}
            そこで，$\C$を一辺$\delta/3$の正方形に分割する．
            \item $z_0\in V$を正方形の辺上にないように任意にとる．すると，$V$と交わる正方形を$Q_1,\cdots,Q_n$として$K:=\cup_{i\in[n]}Q_i$とすると$V\subset K$であり，$\frac{1}{2\pi i}\int_{\partial K}\frac{d\zeta}{\zeta-z_0}=\sum^n_{i=1}n(\partial Q_j,z_0)=1$が成り立つ．
            \item ここで，$\partial K$がいくつかの閉曲線に分割できれば，その中の一つの曲線$\gamma$について，$n(\gamma,z_0)\ne 0$を満たす．この選び出し方の算譜が存在することを示す．
        \end{enumerate}
    \end{description}
\end{proof}
\begin{remarks}
    $\hatC\setminus D$が連結でないことと，$D$の内部に穴があって，それを囲む閉曲線を取ると回転数が消えなくなってしまうことは同値になるから，回転数によって穴の数を測れるということである．
    これがホモロジーの手法なのか．
\end{remarks}

\chapter{境界の対応}

\begin{quotation}
    幾何学化された複素解析学はさらに加速する．
    双正則写像の境界挙動を調べる複素解析学とトポロジーの中間領域で，特に正則関数論の部分を強調して扱う．
    一般に，Jordan領域の間の双正則写像は境界まで同相に延長できる．
    このことを点列で境界の位相的性質を特徴付けて，解析的な言葉で議論しているのが非常に興味深い．
\end{quotation}

\section{境界は境界に対応する}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    （有界）領域間の同相写像の，閉包への同相延長$\wt{f}:[\Delta]\iso D$が存在するのは如何なる時か？
    \begin{enumerate}
        \item $[\Delta]$はコンパクトなので$[D]$もコンパクトであることが必要，したがって$D$は有界であることが必要．
        \item $D_1:=\{z\in\C\mid 1<\abs{z}<2\}\setminus(1,2)$は単連結であるからRiemann写像$f:\Delta\iso D$が存在する．が，同相に延長したら，$[D]$は円環となり，単連結ではないので矛盾．
        \item 実は全てが境界の位相的性質で定まる．まずは次の定理が成り立つ：境界同士が対応する，すなわち境界に同相写像を定める：$\wt{f}|_{\partial\Delta}:\partial\Delta\iso\partial D$．
        これは点列の言葉ではすぐに示せる．
    \end{enumerate}
\end{tcolorbox}

\begin{theorem}
    $f:U\iso V$を有界領域間の同相写像とする．
    $U$の点列$(z_n)$が$U$の境界点$z_\infty\in\partial U$に収束する時，これが定める$V$の点列$(f(z_n))$の集積点は全て$\partial V$上にある．

    特に，同相な延長$\wt{f}:[U]\iso [V]$が存在した場合は，制限$\wt{f}|_{\partial U}\iso\partial V$も同相．
\end{theorem}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $(z_n)$が定める$V$-点列$(w_n):=(f(z_n))$の，収束する部分列$(w_{n_j})_{j\in\N}$を任意にとり，収束先を$w_\infty$とする．
        これが$w_\infty\in V$ならば，逆の対応$f^{-1}$を考えると，$\lim_{j\to\infty}z_{n_j}=\lim_{j\to\infty}f^{-1}(w_{n_j})=f^{-1}(w_\infty)\in U$がしたがってしまうから，$z_\infty\in\partial U$の仮定に矛盾．したがって
        $(w_n):=(f(z_n))$の全ての部分列は$\partial V$上に収束する．
        \item $\wt{f}:[U]\iso [V],f:U\iso V$が全単射であるから$\wt{f}|_{\partial U}\iso\partial V$も全単射．連続写像の制限は連続．
    \end{enumerate}
\end{proof}
\begin{remarks}
    結局の描像としては，位相空間の間に同相写像がある場合，収束列同士が対応する．すると境界点は境界点に対応する．
    と思ったが，(2)は独立に示せてしまった．この定理関係なくないか？というより(1)もほぼ自明ではないか．(1)を経由せずに(2)に至れるし．
    特に(1)の内容もおかしい．連続写像による収束列の像は収束列である．
\end{remarks}

\begin{example}
    $D_2:=\Delta\setminus(0,1)$とすると，補集合が連結なので$D$は単連結．
    よってRiemann写像$D\to\Delta$が存在するが，境界が同相でないので，同相な延長$\wt{f}:[U]\iso [V]$が存在するための必要条件を満たさない．
\end{example}

\section{単純な境界点}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=同相拡張が存在するための十分条件を位相の言葉の中に探す]
    任意に点列を指定すれば，それを通って境界点に至る曲線が取れるとき，単純であるという．いかにも純距離空間論的な定義である．
    すると$\partial\Delta$は単純であるから，$\partial D$も単純である必要が生じ，これが同相延長の存在のための十分条件ともなる．
    なお，この「境界の単純性」は，「$S^1$との同相性」と同値で，後者はJordan閉曲線という．
\end{tcolorbox}

\begin{definition}[simple / reachable]
    点$p\in\partial D$が\textbf{単純}であるとは，$p$に収束する任意の$D$-列$(z_n)$に対して，次の条件を満たす曲線$\gamma:[0,1]\to[D]$（この曲線を$(z_n)$を通って$p$に至る曲線という）が存在することをいう：
    \begin{enumerate}
        \item $\Im\gamma\subset D$かつ$\gamma(1)=p$．
        \item $[0,1)$内の狭義増加列$(t_n)$で，$\gamma(t_i)=z_i$を満たすものが取れる．
    \end{enumerate}
\end{definition}
\begin{example}\mbox{}
    \begin{enumerate}
        \item $D$が凸領域であれば，任意の境界点は単純である．与えられた点$(z_n)$を折れ線でつないで区分的に連続な曲線を得れば良い．
        \item $D_2:=\Delta\setminus(0,1)$の場合は，$(0,1]$上の点は単純でない．次のように定まる点列$(z_j)_{j\in\Z_+}$
        \[z_n:=\frac{1}{2}-\paren{\frac{1}{2}}^ji\]
        を通って$(0,1)$に至る曲線$[0,1]\to D$は存在しない．
        \item 境界が区分的$C^1$級ならば，単純である．$\partial D_2$は実は区分的$C^1$級ではない！これはJordanの閉曲線定理で見覚えのある主張である．\footnote{多角形の場合のみ大事だが，これは鏡像の原理より従うために，ここでは示さない．}
    \end{enumerate}
\end{example}

\begin{definition}[Jordan curve]\mbox{}
    \begin{enumerate}
        \item 単純な閉曲線$\gamma:[0,1]\to\C$のことをJordan閉曲線という．すなわち，埋め込み$S^1\mono\C$のことをJordan閉曲線という．
        \item $\partial D\simeq S^1$を満たす有界領域$D$をJordan領域という．
    \end{enumerate}
\end{definition}
\begin{remark}\mbox{}
    \begin{enumerate}
        \item Jordan領域は単連結である．
        \item $D$がJordan領域であることと，$\partial D$が単純であることは同値である．Dieudonnéのsimpler proofがあるらしい．
    \end{enumerate}
\end{remark}

\section{同相拡張定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $\partial\Delta$と同相な境界（＝Jordan曲線）をもつ（単連結\footnote{Jordan領域は単連結なので}）領域$D$上からは，拡張されたRiemann写像$\wt{f}:[\Delta]\to[D]$が存在する．
\end{tcolorbox}

\begin{theorem}[同相拡張定理 Carathéodory (13)]
    $D\subset\C$を単連結な有界領域とする．次の２条件は同値である．
    \begin{enumerate}
        \item 双正則写像$f:\Delta\to D$は，同相写像$\wt{f}:[\Delta]\to[D]$に延長できる．
        \item $\partial D$の各点は単純である．
    \end{enumerate}
\end{theorem}

\begin{lemma}
    $f:\Delta\to D$を双正則写像とする．
    \begin{enumerate}
        \item $\Area(D):=\iint_D1dudv=\iint_\Delta\abs{f'(z)}^2dxdy$．ただし，$z=x+yi,f(z)=w=u+vi$とした．
        \item 
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 正則写像$f$のJacobi行列は$\paren{\begin{pmatrix}u_x\\v_x\end{pmatrix}J\begin{pmatrix}u_x\\v_x\end{pmatrix}}$であるから，Jacobianが$\abs{f'(z)}$となる．\footnote{これは一辺$f'(z)$の正方形の面積を表している．}
        \item 

    \end{enumerate}
\end{proof}

\chapter{鏡像の原理}

\begin{quotation}
    境界対応理論の具体例として，円板を長方形に写す双正則写像を積分表示したい．
    鏡像の原理よりこれは大域への延長をもち，これは楕円関数への途へ続く．
\end{quotation}

\section{正則関数の延長}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=involutionが定める解析接続]
    解析接続の理論を，まず共役が自然に定める延長として具体的な実装法を定式化する．
    共役変換とは実軸対象変換に他ならないから，まずは上下半平面の対応の理論に見えるが，
    Riemann球面から見れば，これは円円対応の理論である．
    この手法はinvolution一般に通用する．ある上半平面上の領域$\Omega_+$上で正則で，\textbf{$I$上でinvolutionの作用について不変ならば}，$\Omega_-$への解析接続の手法はこのinvolutionの手法で与えられ，一意である，という極めて対称性の破れた議論である．
    解析接続の一般論が待たれる．
\end{tcolorbox}

\begin{notation}[領域の演算]
    領域$D$に関して，
    \begin{enumerate}
        \item $\o{D}:=\{\o{z}\in\C\mid z\in D\}$と定める．
        \item $D=\o{D}$を満たすとき，$D$を\textbf{実軸対称}であるという．
        \item $D_\pm:=\{z\in D\mid\pm\Im z>0\}$とおき，$I:=D\cap\R$とする．$\o{D_+}=D_-$が成り立つ．
    \end{enumerate}
\end{notation}

\begin{theorem}[Schwarz reflection principle]\label{thm-Schwarz-reflection-principle}
    $\Omega$を実軸対象な領域とする．
    連続関数$f:\Omega_+\cup I\to\C$が
    \begin{enumerate}
        \item $\Omega_+$上正則，
        \item $I$上実数値
    \end{enumerate}
    ならば，正則な延長$\wt{f}:\Omega\to\C$が（一意に）存在する．
\end{theorem}
\begin{proof}
    実はこの延長は，共役変換が自然に定める延長
    \[\wt{f}(z):=\begin{cases}
        f(z),&z\in\Omega_+\cup I,\\
        \o{f(\o{z})},&z\in\Omega_-.
    \end{cases}\]
    である．これは，
    \begin{enumerate}
        \item 仮定(1)より$\Omega_\pm$上正則である．
        \item $\Omega_-$については，$\Omega_+$上での冪級数展開に複素共役を前後で合成して，任意の$z_0\in\Omega_-$について$\wt{f}(z)=\o{\sum_{n\in\N}a_n(\o{z}-z_0)^n}\;(z\in\Omega_-)$と冪級数展開できるが，右辺は連続関数であるから（多項式という連続関数の一様収束極限であるため），
        $=\sum_{n\in\N}\o{a_n(\o{z}-z_0)^n}=\sum_{n\in\N}\o{a_n}(z-\o{z_n})^n$となる．よって$\Omega_-$上複素解析的だから，特に$\Omega_-$上正則である．
        \item さらに$I$上実数との仮定(2)より，
        $\Omega$上連続でもある．
    \end{enumerate}
    あとは$\Omega$上の正則性を示すのであるが，これはMoreraの定理による．任意の閉三角形$T\subset D$を取る．
    $T_\pm:=T\cap\Omega_\pm$と定めると，
    \[\int_{\partial T}\wt{f}dz=\int_{\partial T_+}\wt{f}dz+\int_{\partial T_-}\wt{f}dz\]
    であるが，$T^\circ_\pm\subset\Omega_\pm$では$\wt{f}$は正則であったから，右辺は$0$である．
\end{proof}
\begin{remarks}[葉での蝶の作り方]
    共役$z\mapsto\o{z}$により$\Omega_+$を正則に$\Omega_-$に映せた時点で，
    あとは測度$0$の$I$上では連続でさえあれば勝ちは決まっていた勝負である．
    抜け道感は強く，確かに，解析接続の一般論が欲しくなる．
\end{remarks}

ひとまずはどこまで一般化できるかの道を探る．
まず，involutionを複素共役ではなく反転を考えると，$\C$上で見るとまるで違う結果を得る．
が，実際は$\hatC$で大円が移動したのみである．

\begin{notation}[inversion involution]
    ${}^*:w\mapsto w^*:=\frac{1}{\o{w}}$を$S^1$に関する$w$の反転という．
\end{notation}

\begin{corollary}\label{cor-reflection-principle-about-circle}
    $\Omega$を実軸対象な領域とする．
    連続関数$f:\Omega_+\cup I\to\C\setminus\{0\}$が
    \begin{enumerate}
        \item $\Omega_+$上正則，
        \item $I$上で$\abs{f(z)}=1$(すなわち$f(I)\subset S^1$)
    \end{enumerate}
    ならば，正則な延長$\wt{f}:\Omega\to\C$が存在する．
\end{corollary}
\begin{proof}
    ２通りで証明する．
    \begin{enumerate}
        \item \[\wt{f}(z):=\begin{cases}
            f(z),&z\in\Omega_+\cup I,\\
            \frac{1}{\o{f(\o{z})}}=f(\o{z})^*,&z\in\Omega_-.
        \end{cases}\]
        とおくと，
        $I$上では$f(z)\o{f(\o{z})}=1$を満たすから，極限$\lim_{z\to a\in I}\wt{f}(z)$が一意に定まるので$f$は$\Omega$上連続．
        すると，定理と全く同様の議論が成り立ち，Moreraの定理より$\wt{f}$は$D$上正則．
        \item 定理では複素共役が正則関数でないためにできなかった合成写像の論法が，今回は使える．
        Cayley変換という一次分数変換$\varphi(z):=i\frac{1-z}{1+z}$は，$S^1$上に同型$\varphi:S^1\iso\R$を定める．
        これを用いて$g:=\varphi\circ f$とおくと，この写像はSchwarzの鏡像の原理\ref{thm-Schwarz-reflection-principle}の条件を満たすから，延長$\wt{g}:\Omega\to\C$が存在する．
        $\wt{f}:=\varphi^{-1}\circ\wt{g}$は$f$の延長である．
    \end{enumerate}
\end{proof}
\begin{remarks}
    複素共役に加えて，反転involutionも合成すると，これまた非自明な系を得る．
\end{remarks}

\section{実解析的曲線に関する鏡像}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=定義域の境界に実解析的な部分があれば，そこから浸透して関数を正則に延長できる]
    上半平面と単位円は見慣れた登場人物（$\hatC$の大円）である．
    共役とは$\R$についての反転で，反転とは$S^1$についての反転であった．
    ここからより一般的な実解析的曲線についての反転（流出）に拡張せねば，円板と長方形の対応は得られない．
    むしろここからの拡張可能性が鏡像の原理の真価である．

    鏡像の原理の真の動作原理を，おそらく「$C^\om$級正則曲線」を複素多様体の座標関数として駆使することで，
    一般化して描き出している．というのは，任意の$C^\om$級曲線に対して，その近傍に拡張できる，という議論を実軸$\R\subset\C$に引き戻して行い，
    さらに鏡像の原理で対称性を付け足す．
\end{tcolorbox}

\begin{definition}[regular curve and its extension：$C^\om$正則曲線＝実解析的な単射曲線と，その単射正則延長]\mbox{}
    \begin{enumerate}
        \item $C^\omega$級単純閉曲線$\gamma:I:=[a,b]\to\C$が，どの点でも微分が消えていないとき，これを\textbf{$C^\om$正則曲線}と呼ぶ．
        これはすなわち，任意の$t_0\in I$について，$\abs{t-t_0}<r(t_0)$の範囲に定義域を制限すれば，$\gamma$は冪級数表示された$C^\infty$級同型\footnote{微分が消えないので}$\gamma(t)=\sum^\infty_{n=0}a_n(t-t_0)^n\;(t\in(t_0-r(t_0),t_0+r(t_0)))$となることをいう．
        \item このとき，一致の定理より，$\R\mono\C$によって，$\gamma$の$(t_0-r(t_0),t_0+r(t_0))$への制限は正則な延長$\wt{\gamma}:\Delta(t_0,r(t_0))\to\C$をもつ．
        この議論は任意の$t_0\in(a,b)$について成り立つのであったから，結局$I\osub V:=\cup_{t_0\in I}\Delta(t_0,r(t_0))$上で成り立ち，結局，\textbf{$C^\om$正則曲線$\gamma:I\to\C$は正則な延長$\wt{\gamma}:V\to\C$を持つ}．
    \end{enumerate}
\end{definition}

\begin{lemma}
    $C^\om$正則曲線$\gamma:I:=[a,b]\to\C$の正則な延長$\wt{\gamma}:V\mono\C$は単射なまま実現出来る（すなわち，双正則写像$\wt{\gamma}:V\iso\Im\wt{\gamma}$を定める）．
\end{lemma}

\begin{definition}[片側にある領域]
    領域$D$と$C^\om$正則関数$\gamma$の位置関係を考える．いま，$\gamma$は$D$の境界の一部であるとする：$\Im\gamma\subset\partial D$．
    このとき，$\gamma$の単射正則延長$\wt{\gamma}:V\mono\C$について，
    $\wt{\gamma}^{-1}(D)\subset V_+$または$\wt{\gamma}^{-1}(D)\subset V_-$が成り立つ時，\textbf{$D$は$\gamma$に関して片側にある}という．
\end{definition}

\begin{theorem}[一般化された鏡像の原理]
    $f:D\to\C$を定数でない正則写像とし，$\gamma:I:=[a,b]\to\C$を$C^\om$級正則曲線とする．
    \begin{enumerate}
        \item 始域：$\Im\gamma\subset\partial D$かつ$D$は$\gamma$に関して片側にある(仮に$\wt{\gamma}^{-1}(D)\subset V_-$とする)．
        \item 終域：$f$は$\Im\gamma\cup D$上に連続な延長$\wt{f}:D\cup\Im\gamma\Im\wt{f}$を持ち\footnote{例えば$D$の境界がJordan曲線である＝$S^1$に同相である場合はこの仮定を満たす}，境界対応について，ある$C^\om$級正則曲線$\mu$が存在して，$\wt{f}(\Im\wt{\gamma})\subset\Im\wt{\mu}$が成り立つ\footnote{これは，$\Im\gamma\subset[D]$という部分の$f$による像が，$\wt{\mu}^{-1}$の定義域に含まれることを保証する仮定．}
    \end{enumerate}
    とする．このとき，$f$は$\Im\gamma$を超えて正則な延長$\o{f}:\Im\gamma\cup D\subset\Omega\to\C$をもつ．
\end{theorem}
\begin{proof}
    Schwarzの鏡像の原理\ref{thm-Schwarz-reflection-principle}の場合に還元して証明する．
    合成
    \[\xymatrix@1{
        \varphi:=\wt{\mu}^{-1}\circ\wt{f}\circ\wt{\gamma}|_{V_-}:V_-\cup I \;\ar@{^{(}->}[r]^-{\wt{\gamma}}&[D]\ar[r]^-{\wt{f}}_-\sim&\Im\wt{f}\ar[r]^-{\mu}&\C
    }\]
    を考える．ただし$\wt{\mu}$は$\Im\wt{f}$全域で定義されているとは限らないが，$\wt{f}\circ\wt{\gamma}(V_-\cup I)$上では，条件(2)より，定義されている．
    これは$V_-$上正則かつ$V_-\cup I$上連続で(仮定(2)より)，$\varphi([a,b])\subset\R$を満たすから，鏡像の原理\ref{thm-Schwarz-reflection-principle}より，
    正則な延長$\wt{\varphi}:V:=V_-\cup I\cup V_+\to\C$を持つ．
    ただし，$I\osub V$は十分小さく取ることで実軸対称に取れる．
    これに対して，$\o{f}:=\wt{\mu}\circ\wt{\varphi}\circ\wt{\gamma}^{-1}:D\cup\Im\wt{\gamma}\to\C$とすれば条件を満たす．
\end{proof}
\begin{remarks}
    まさか！鏡像の原理はそうやって使うのか．実軸$I\subset\R$を，曲線のパラメータの埋め込み先としては見てなかった！
    魔法かと思った．
    いや，Schwarzの鏡像の原理\ref{thm-Schwarz-reflection-principle}引き戻しているだけか．
    そう思うと，すごく当たり前な一般化である．しかし，曲線$\R\supset I\mono\C$というものを，$\R$上への引き戻しとは見ていなかった．
    
    結局どうなったかというと，$\gamma:I\mono\C$の単射正則延長$\wt{\gamma}:V\mono\C$が定める同型$\wt{\gamma}:V\iso\Im\wt{\gamma}$の分だけ定義域を延長できる，という話である．それに$\mu$という存在（$\Im\gamma$の延長$\Im\wt{\gamma}$を$\R\subset\C$周りに引き戻せることを保証する双正則写像）を借りて来て議論しているので，当たり前といえば当たり前である．
\end{remarks}
\begin{remark}
    (2)の境界への連続延長は，
    Jordan領域$D$からの双正則写像では十分成り立つ．
    連続拡張の理論よりも正則拡張の理論の方が簡単であるという不思議な観測．

    曲線$I\to\C$を用いて理論を構築したが，定義域を円板として$\Delta\to\C$を用いても，系\ref{cor-reflection-principle-about-circle}に帰着させて，「定義域が円板から漏れ出す」という形の同様な理論構築ができる．
    いずれも鏡像の原理と呼ぶ．
    
    鏡像の原理は調和関数についても成り立ち，この理論は連続拡張の議論(2)さえ迂回する．
    歴史的には鏡像の原理が最初で，Paul Painlevéが実解析部分からの実解析浸透，Carathéodoryの定理(13)がJordan部分からの連続浸透の理論ができた．
    「\textbf{regularityを落とした方が難しいというのが，解析によくあることです．}」
\end{remark}

\section{Schwarz-Christoffel}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=上半平面から単体ポリゴンの内部上への共形変換]
    
\end{tcolorbox}

\begin{example}\label{exp-rectangle-and-Jacobi-sn-function}
    
\end{example}

\chapter{調和関数}

\begin{quotation}
    $D\subset\R^n$を滑らかな境界を持つ有界領域とし，その上の
    Laplace作用素の固有値問題を考える．
    固有値$\{\lambda_n\}_{n\in\N}$から$D$の幾何学的な情報がどのくらいわかるか？という視点がKacの固有値問題の見方であり，
    "Can one hear the shape of a drum?"と表現した．
    WeylはLorentzの1910年講演"Old and new problems of physics"で「完全に反射する容器の中の電磁波の周波数分布は，十分高周波な領域では容器の体積のみに依存する」
    という予想を聞いて，
    \[\frac{N(\lambda)}{\lambda}\xrightarrow{\lambda\to\infty}\frac{\abs{D}}{2\pi}\quad N(\lambda):=\#\Brace{n\ge1\mid\lambda_n\le\lambda}\]
    を示した．また，Minakshisundaram-Pleijeel (1948)は，Riemann多様体$M^d$上において，固有値$\{\lambda_n\}_{n\in\N}$から
    $D$の面積だけでなく，$\partial D$の長さ，$D$の穴の数を復元可能であることを示した．
\end{quotation}

\section{共役調和関数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    実調和関数は，ある正則関数が存在してその実部だと考えることが出来る．
    その正則関数の虚部を，元の調和関数の共役調和関数という．
\end{tcolorbox}

\begin{definition}[harmonic function]\mbox{}
    \begin{enumerate}
        \item $\partial_z:=\frac{1}{2}(\partial_x-i\partial_y),\partial_{\o{z}}:=\frac{1}{2}(\partial_x+i\partial_y):C^1(\R^2)\to C^1(\R^2)$を\textbf{Cauchy-Riemann作用素}という．
        \item 正則関数$f:\C\simeq\R^2\to\R^2\simeq\C$とは，$\partial_{\o{z}}f=0$を満たす$C^1$級関数として特徴付けられる．
        \item これら微分作用素の積について，$\partial_z\partial_{\o{z}}=\frac{1}{4}(\partial_z^2+\partial_y^2)=:\frac{1}{4}\Laplace$を\textbf{(negative) Laplacian}という．\footnote{negativeとは固有値を指す．幾何学者は固有値を正にするため，$-\Laplace$をLaplacianとする．普遍的に$\frac{d^2\sin x}{dx^2}=-\sin x$というようなことが起こる．}
        \item $\Laplace u=0$を満たす$C^2$級関数$u:\R^2\to\R$を\textbf{調和関数}という．\footnote{Laplace作用素は実は線型作用素で，その核をいう．したがって実調和関数の全体は実線型空間をなす．}したがって，正則関数は調和関数であり，したがって$f=u+iv$について各$u,v:\R^2\to\R$は調和関数である．\footnote{係数比較をすれば良い．}
        \item 全ての調和関数が，何かしらの正則関数の成分として理解できるかが自然な問いとなる．実は$\log=\log\abs{-}+i\arg$の虚部のような例を弾けば良い．
    \end{enumerate}
\end{definition}

\begin{theorem}[実調和関数が定める正則関数：単連結領域上の実調和関数は共役調和関数をもつ]
    $u:D\to\R$を単連結領域$D$上の実調和関数とする：$\Lap u=0$．
    \begin{enumerate}
        \item $\partial_zu$は正則関数である．
        \item 任意の$z_0\in D$に対して$f(z):=2\int^z_{z_0}\partial_zu(\zeta)d\zeta+u(z_0)$と定める．するとこれは正則関数であり，$\Re f=u$を満たす．
    \end{enumerate}
\end{theorem}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $u$が$C^2$級であることに注意して，$\Lap u=4\partial_z\partial_{\o{z}}u=4\partial_{\o{z}}\partial_zu=0$より，$\partial_zu$は正則関数である．
        \item (1)の結果より$f$は正則で，$D$が単連結であるとの仮定より，(2)の$f$の積分は積分路の取り方に依らない．
        ここで，積分される1-形式$2\partial_zudz$を実部と虚部に分けると，
        \begin{align*}
            2\partial_zudz&=(u_x-iu_y)(dx+idy)\\
            &=(u_xdx+u_ydy)+i(-u_ydx+u_xdy)=du*i*du.
        \end{align*}
        よって，
        \[2\Re\int^z_{z_0}\partial_zud\zeta=\int^z_{z_0}du=u(z)-u(z_0).\]
    \end{enumerate}
\end{proof}

\begin{definition}[Hodge star operator, harmonic conjugate function]\mbox{}
    \begin{enumerate}
        \item 
    $*:\Omega^1(\R^2)\to\Omega^1(\R^2)$は，基底を$*dx=dy,*dy=-dx$と対応させる\footnote{待てよ，この関係はsinとcosみたいだな．}
    線型作用素とみなせ，これを\textbf{ホッジ双対}という．これは$*^2=-\id$を満たす複素構造となり\footnote{複素構造とは線型空間に対して定義され，二乗して$-\id$となる自己同型をいう．したがって，$\R$の複素構造は$i$である．線型空間としての複素構造を考えるからこそ，代数のように$\sqrt{-1}$とは捉えないのかも知れない．}，実際，
    \[\begin{pmatrix}dy\\-dx\end{pmatrix}=\begin{pmatrix}0&-1\\1&0\end{pmatrix}\begin{pmatrix}dx\\dy\end{pmatrix}.\]
    \item $u$の定める正則関数$f$の虚部は$v(z)=\int^z_{z_0}*du+C$と表せる．これを\textbf{共役調和関数}という．
    \end{enumerate}
\end{definition}

\begin{example}[共役調和関数]\mbox{}
    \begin{enumerate}
        \item $u(x,y)=x^2-y^2$とすると，$\Lap u=2-2=0$より，これは調和関数．$\R^2$全体（単連結）で定義されているから，これまた$\R^2$上に共役調和関数を持つはずである．実際，
        \begin{align*}
            du&=2xdx-2ydy,&*du&=2xdy+2ydx,
        \end{align*}
        より，基準は$0$にとると$u(0,0)=0$だから，
        \begin{align*}
            v&=\int^z_02\wt{x}d\wt{y}+2\wt{y}d\wt{x}\\
            &=\int^1_0(2txy+2tyx)dt\\
            &=4xy\int^1_0tdt=2xy.
        \end{align*}
        ただし積分路は$[0,1]\ni t\mapsto tz=(tx,ty)=(\wt{x},\wt{y})$ととった．
        すると，$u,v$が定める正則関数は$f(z)=u+iv=x^2-y^2+i2xy=z^2$であった！
        \item $u=\log\abs{z}=\frac{1}{2}\log(x^2+y^2)$と置くと，$C^*$上の調和関数である．これも単連結であるから，共役調和関数を持つはずである．
        \[\begin{cases}
            x=r\cos\theta,&dx=\cos\theta dr-r\sin\theta d\theta,\\
            y=r\sin\theta,&dy=\sin\theta dr+r\cos\theta d\theta.
        \end{cases}\]
        の極座標で考えると，
        \begin{align*}
            du&=\frac{xdx+ydx}{x^2+y^2}\\
            *du&=\frac{xdy-ydx}{x^2+y^2}\\
            &=\frac{r\cos(\sin\theta dr+r\cos d\theta)-r\sin\theta(\cos\theta dr-r\sin\theta d\theta)}{r^2}=d\theta.
        \end{align*}
        よって，$v=\int^z_0d\theta=\arg\theta$．
    \end{enumerate}
\end{example}

\begin{notation}[Hodge双対の幾何学的意味]
    正則な曲線$\gamma$に関する右法線微分を$\partial_Nu=\sin\theta(t)\partial_x-\cos\theta(t)\partial_yu$と定義すると，
    \[\int_\gamma *du=\int_{\gamma}\partial_Nu\abs{dz}.\]
\end{notation}

\begin{theorem}[Greenの公式]
    $D$を区分的$C^1$級境界を持つ有界領域，$u,v$を$[D]$上の$C^1$関数で，$D$上で調和であるものとする．このとき，
    \[\int_{\partial D}(u\partial_Nv-v\partial_Nu)\abs{dz}=0.\]
\end{theorem}

\begin{theorem}[平均値の性質]
    $D:=\Brace{z\in C\mid0<\abs{z}<\rho}$とする．$u$を$D$上の調和関数とすると，$r$に依らない定数$A,B\in\C$が存在して，任意の$r\in(0,\rho)$に対して，
    \[\frac{1}{2\pi r}\int_{\abs{z}=r}u\abs{dz}=A+B\log r.\]
\end{theorem}

\begin{corollary}
    $u$が領域$D$で調和であれば，$\Delta(z_0,R)\subset D$に対して，
    \[\frac{1}{2\pi}\int^{2\pi}_0u(z_0+Re^{i\theta})d\theta=u(z_0).\]
\end{corollary}

\begin{corollary}[最大値・最小値の原理]
    領域$D$上の調和関数が$D$内で最大値または最小値を持てば，$u$は定数である．
\end{corollary}

\section{Poisson積分}

\begin{definition}\mbox{}
    \begin{enumerate}
        \item 領域$D$に対して，$\H(D):=\Brace{u\in C^0([D])\mid uはD上調和}$とおく．$D=\Delta(0,r)$の時は$\H_R$とも表す．
        \item 最大・最小値の原理より，$u\in\H(D)$は境界での値$u|_{\partial D}$で一意に定まる．なぜならば，境界で恒等的に$0$な$\H(D)$の元は，零関数ただ一つであり，２つの境界で同じ値を取る関数の差を考えることでここに帰着できる．
        \item 境界上で連続な関数$u\in C^0(\Delta(0,R))$に対して，Poisson積分を$P[u](z):=\frac{1}{2\pi}\int^{2\pi}_0\frac{R^2-\abs{z}^2}{\abs{\zeta-z}^2}u(\zeta)d\theta\quad(\zeta=Re^{i\theta})$と定義する．これはPoisson核と$u$の積について，境界を一周する積分である．ひとまず，$P[u]:\Delta(0,R)\to\C$とする．
    \end{enumerate}
\end{definition}

\begin{theorem}
    任意の$u\in\H_R$について，$u=P[u]\quad\on\Delta(0,R)$．
\end{theorem}

\begin{corollary}
    特に，$\frac{1}{2\pi}\int^{2\pi}_0\frac{R^2-\abs{z}^2}{\abs{\zeta-z}^2}d\theta\equiv 1$．
\end{corollary}

\begin{theorem}[the solution to the Dirichlet problem]
    任意の境界上の連続関数$u\in C^0(\partial\Delta(0,R))$に対して，$P[u]$は，境界値問題$\Delta U=0\quad\on\Delta(0,R),U=u\quad\on\partial\Delta(0,R)$の一意な解を与える．
\end{theorem}

\section{一般のDieichlet問題}

\section{Green関数}

\chapter{大域的解析関数}

\section{収束冪級数の解析接続}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=Weierstraßの関数論]
    Cauchyは正則関数を定義とし，解析性は定理であった．
    一方Weierstraßは，むしろ収束冪級数を所与のものとし，正則関数を関数要素を繋いだものとして理解する理論を構築した．
    しかし，この方法で計算するのは非常に複雑になる．Élie Cartanの教科書は冪級数の方法でlogを定義するらしい．
\end{tcolorbox}

\begin{definition}[analytic continuation, global analytic function]\mbox{}
    \begin{enumerate}
        \item $z_0\in\C$を中心とする，収束半径$r>0$の冪級数$P_0(z)=\sum^\infty_{j=0}a_j^{(0)}(z-z_0)^j$を\textbf{$z_0$中心の関数要素}という．
        \item $z_1\in\Delta(z_0,r)$に対して，$z_1$を中心とする，関数要素$P_0$の冪級数展開$P_1(z)=\sum^\infty_{j=0}a_j^{(1)}(z-z_1)^j$は，$z_1$中心の関数要素でもある．このとき，$P_1$は$P_0$の\textbf{直接解析接続}であるという．
        \item $P_n$が$P_0$の\textbf{解析接続}であるとは，$P_{j+1}$が$P_j$の直接解析接続となっているような列$P_0,P_1,\cdots,P_n$が存在することをいう．
        \item 収束冪級数全体の集合を$\O$で表す．このとき，
        \[P\sim Q:\Leftrightarrow QはPの解析接続である\]
        は同値関係を定める．\footnote{$P$は$P$の解析接続である．$P\sim Q$のとき，列を逆に辿れば$Q\sim P$．推移律は，列を繋げれば良い．}$\O$の$\sim$に関する同値類を，\textbf{Weierstrassの意味での大域的解析関数}という．
    \end{enumerate}
\end{definition}

\begin{remark}
    次のように議論すると，解析接続が速くなるが，やはり列を取って議論しなければならない点は本質的ではない．
    \begin{enumerate}
        \item 一般の領域$\Omega\subset\C$と，$\Omega$上の正則関数$f$の組$(f,\Omega)$を\textbf{関数要素}とする．
        \item $(f_1,\Omega_1)$が$(f_0,\Omega_0)$の\textbf{直接解析接続}であるとは，$\Omega_1\cap\Omega_2\ne\emptyset$上で$f_0=f_1$が成り立つことをいう．
    \end{enumerate}
\end{remark}

\section{関数の芽の層}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=岡潔の霊性]
    関数要素を冪級数に限る必要はなく，一般の領域$\Omega\subset\C$とその上の正則関数の組を考えると，同様にして解析接続の概念が定義できる．
    しかし，解析関数の列の議論の代わりに位相を定義して議論することで，理論が大きく変化する．
    こちらが本質である．
    層のetale空間を用いて定義する．前層を通過する定義とは違う．
\end{tcolorbox}

\begin{notation}
    空でない集合に対して，$\O(U)$で$U$上の正則関数全体のなす複素線型空間，$C^r(U)\;(r\in\N\cup\{\infty\})$で$U$上の$C^r$級関数全体のなす複素線型空間を表す．\footnote{複素関数論では$U$に連結性も仮定して領域としたが，層の議論をする場合は通例は仮定しない．}
    これらをまとめて$\F(U)$と表す．$f\in\F(U)$に対し，組$(f,U)$を$\F$の関数要素という．
    なお，層を表すときは$\cC^r$と表すことが多い．
\end{notation}

\subsection{層の定義}

\begin{definition}[germ, stalk, sheaf]\mbox{}
    \begin{enumerate}
        \item $p\in\C$の周りの関数要素全体がなす集合を\[\wt{\F_p}:=\coprod_{U:pを含む開集合}\F(U)=\Brace{(f,U)\mid fはpの開近傍U上の\F 関数}\]と表す．
        \item $(f,U),(g,V)\in\wt{F}_p$に対し，同値関係$f\sim_pg$を次のように定める：$p$を含む開集合$W\subset U\cap V$が存在して，$W$上で$f=g$．\footnote{推移律は，$W$が$p$の開近傍であることによる．この局所化の方法は常套手段であり，冪級数展開を考えることの一般化となっている．}
        \begin{enumerate}[(a)]
            \item この同値関係$\sim_p$に関する$f$の同値類を$f_p$と表し，\textbf{関数$f$の点$p$での芽}という．
            \item $p$での芽全体を$\F_p:=\wt{\F}_p/\sim_p$と表し，$\F$の$p$での\textbf{茎}という．\footnote{$\C\times\C$上での関数のグラフを考えると，茎は4次元上の存在で，そこから芽が出ている構造．}これは複素線型空間をなす．\footnote{$(f+g)_p=f_p+g_p$．}
        \end{enumerate}
        \item 最後に$p$を動かして，集合$\F=\coprod_{p\in\C}\F_p$と全射$\pi:\F\to\C;\pi(f_p)=p$の組を，関数$\F$の$\C$上の(複素線型空間の)層という．\footnote{層は茎と芽からできている．茎が縦の構造，芽がそこから広がる横の構造である．不定域イデアル．}
    \end{enumerate}
\end{definition}
\begin{remark}[Weierstrassの構成の一般化となっている]\mbox{}
    \begin{enumerate}
        \item 正則関数の層$\O$について\footnote{Analyticなので$\A$で書く流儀もあるが，フランスでは岡が由来なのか，$\O$で書く．}，$f_p\in\O_p$は，$f$の$p$での冪級数展開と同一視できる．すなわち，$\O$はWeierstrassの関数要素全体の集合と同一視できる．すなわち，$f\sim_pg\Leftrightarrow f$と$g$の冪級数表示は一致する．一方$\F=\cC^\infty$では$\Leftarrow$が成り立たない．
        \item $f_p\in\cC^\infty$は，代表元$f\in C^\infty$が$p$でTaylor級数を定めるが，収束するとは限らないので，Taylor級数が一致しても$C^\infty$関数の芽として一致するとは限らない．すなわち，写像$f_p\mapsto\sum^\infty_{j,k=0}\frac{1}{j!k!}\pp{^{j+k}f(x_0,y_0)}{x^j\partial y^k}(x-x_0)^j(y-y_0)^k$は定まるが，可逆でない．例えば，$f(x+yi)=
        \begin{cases}
            0,&x\le 0,\\
            e^{-\frac{1}{x}},&x>0.
        \end{cases}$の$p=(0,0)$でのTaylor級数は$0$となるが，$p$での芽としては定数関数$0$とは異なる：$f_p\ne 0_p$．
    \end{enumerate}
\end{remark}

\begin{definition}[関数の層の位相]\mbox{}\label{def-topology-of-sheaf}
    \begin{enumerate}
        \item $\F$の関数要素$(f,U)\in\wt{F}$に対し，$V_{(f,U)}:=\Brace{f_p\in\F\mid p\in U}$とおき，$\Brace{V_{(f,U)}\subset\F\mid (f,U)は\F の関数要素}$を開基とする位相を定める．すなわち，$V\subset\F$が開とは，$\forall_{\wt{p}\in V}\;\exists_{(f,U)\in\wt{F}_p}\;\wt{p}=f_p\land V_{(f,U)}\subset V$に同値．
        \item このとき，$\pi:\F\to\C$は連続で，任意の関数要素$(f,U)\in\wt{\F}$に対して制限$\pi:V_{(f,U)}\to U$は同相写像となる．\footnote{$W\osub U\Lrarrow\pi^{-1}(W)=V_{(f,W)}$より．}この性質は，$\F$の位相を特徴づける．
        \item さらに，複素線型空間としての演算
        \[\xymatrix@R-2pc{
            \C\times\C\times(\F\times_\pi\F)\ar[r]&\F\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (\lambda,\mu,f_p,g_p)\ar@{|->}[r]&\lambda f_p+\mu g_p
        }\]も連続．
    \end{enumerate}
\end{definition}

\begin{definition}[一般の層]\mbox{}\label{def-sheaf}
    \begin{enumerate}
        \item 局所同相な連続全射$\pi:\F\to X$について，$\F$を$X$上の\textbf{層}といい，ファイバー$\F_p:=\pi^{-1}(p)$を$p$上の\textbf{茎}という．
        \item \textbf{複素線型空間の層}とは，さらに次の２条件を満たすことをいう：
        \begin{enumerate}[(i)]
            \item 各茎$\F_p$は複素線型空間の構造を持つ．
            \item 複素線型空間としての演算
            \[\xymatrix@R-2pc{
                \C\times\C\times(\F\times_\pi\F)\ar[r]&\F\\
                \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
                (\lambda,\mu,f_p,g_p)\ar@{|->}[r]&\lambda f_p+\mu g_p
            }\]が連続である．
        \end{enumerate}
    \end{enumerate}
\end{definition}
\begin{remark}
    関数の層では，$\F(U)$の複素線型構造が，商である茎$\F_p$に誘導される．
    その他$X$の代数的構造に併せて，それぞれの層がある．
    一般の層について解析接続の理論が展開できるが（局所同相性とHausdorff性以外使わない，リフトの一意性\ref{thm-uniqueness-of-lift}など），それが意味を持つかは別である．複素線型空間の層は，コホモロジーやクザンの問題で議論する．
\end{remark}

\subsection{正則関数の層の性質}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    層の構成が，Weierstrassの理論の一般化となっていることを見る．
    こうして，大域的解析関数を層$\O$の連結成分として特徴付けた．
    層とは局所同相な束であるが，局所同相性を仮定するのみで，連結性の言葉で解析接続が議論できる．
\end{tcolorbox}

\begin{proposition}\mbox{}\label{prop-sheaf-of-holomorphic-functions-is-Hausdorff}
    \begin{enumerate}
        \item 正則関数の層$\O$はHausdorffである．
        \item $C^\infty$級関数の層$\cC^\infty$はHausdorffではない．
    \end{enumerate}
\end{proposition}

\begin{theorem}[大域的解析関数の特徴付け]
    $\O$の連結成分は，Weierstrassの意味の大域的解析関数と一致する．
\end{theorem}
\begin{proof}
    大域的解析関数$\f\subset\O$を任意に取り，これが連結であり，かつ，開かつ閉であることを示す．
    $\f$が連結ならば，これを含む連結成分が存在することが従い，さらに$\f$が開かつ閉であるとき，これより真に大きい連結成分が存在すると矛盾するから，$\f$が連結成分であることが従う．
    \begin{description}
        \item[連結性] 
        \begin{enumerate}
            \item $P_0,P_1\in\f$を直接解析接続とする．$P_0$の収束円を$U\subset\C$とすると，$P_1$は$P_0$の$\pi(P_1)$での芽でもあるから，$P_1\in V_{(P_0,U)}$．$V_{(P_0,U)}\simeq U$より連結．よって，$P_0,P_1$を含む連結成分が存在する．
            \item 一般に$P,Q\in\f$を取ると，直接解析接続の列$P=P_0,P_1,\cdots,P_n=Q$が存在する．各$P_{j+1}$と$P_j$は同じ連結成分に入るので，$P=P_0,Q=P_n$も同じ連結成分に入る．\footnote{$A,B$が連結で交わりを持つならば$A\cup B$なので，「同じ連結成分に含まれる」という関係は推移的である．}
        \end{enumerate}
        \item[開かつ閉]
        \begin{enumerate}
            \item $P\in\f\Rightarrow \exists_{U\osub\C}\;P\in V_{(P,U)}\subset\f$．ただし$U$は$P$の収束円など．
            \item $\O$は$\sim$の同値類に分割され，各同値類は開だから，各同値類は閉でもある．
        \end{enumerate}
    \end{description}
\end{proof}

\begin{tbox}{red}{$\O$の連結性}
    \begin{itemize}
        \item $\O$の連結成分を大域的解析関数という．
        \item $\O\pi:\O\to\C$は局所同相で，したがって局所弧状連結であるから，連結成分は弧状連結である．こうして曲線に沿った解析接続という考え方が自然に生じる．
        \item 連結性は元々$A,B$が連結で交わりを持つならば$A\cup B$も連結という伝播則を持つのであった．
    \end{itemize}
\end{tbox}

\section{大域的解析関数とRiemann面}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Weierstrass流の正則関数$\f\subset\O$の見方は，関数要素の貼り合わせである．
    これを適切に位相空間（層）へと埋め込んで，Riemann面という名前をつける．
    すると，これは普遍性をもち，種々の定義の難しい関数をliftして真の姿をあらわにさせる．
    分枝を適切に展開すると連結になるのである．
\end{tcolorbox}

\begin{definition}[global analytic function, Riemann surface]\mbox{}
    \begin{enumerate}
        \item 正則関数の芽の層$\O$の連結成分を\textbf{大域的解析関数}といい，$\cR(\f)$などと表す．これは集合であって関数でない点に注意．
        \item 評価写像$e:\O\to\C;f_p\mapsto f(p)$は連続である．これを$\cR(\f)$に制限して得られる連続関数を$\f:\cR(\f)\to\C$と表す．任意の開基$V_{(f,U)}$上では$\f|_{V_{(f,U)}}=f\circ\pi$より，$\f$は局所的に定義された$f$を貼り合わせて作られる大域的関数とみなせる．連結成分$\cR(\f)$を大域的解析関数$\f$のRiemann面という．
    \end{enumerate}
\end{definition}

\begin{example}[平方根関数のRiemann面]
    \[\cR(\sqrt{z}):=\Brace{P(z)\in\O\mid P(z)^2=z}\]
    ここで，$P$は収束冪級数とみなし，$P(z)^2=z$は$P$の収束円上での等式とした．
    これは確かに連結である\ref{prop-connectedness-of-the-Riemann-surface-of-inverse-functions}．
    \[\xymatrix{
        \O\ar@{->>}[d]&\;\cR(\sqrt{z})\ar@{->>}[d]^-{\pi}\ar[dr]^-{e}\;\ar@{^{(}->}[l]\\
        \C&\;\C\setminus\{0\}\ar@{x->}[r]_-{\sqrt{z}}\;\ar@{^{(}->}[l]&\C
    }\]
    これは，ファイバー束$\pi:\cR(\sqrt{z})\epi\C\setminus\{0\}$により，局所的にしか定義されない（あるいは２価関数）$\sqrt{z}:\C\setminus\{0\}\to\C$の各分枝をliftして，$\cR(\sqrt{z})$上で整合的に連続（１価）写像として定義している．
\end{example}

\begin{example}[対数関数のRiemann面]
    \[\cR(\log z):=\Brace{P\in\O\mid e^{P(z)}=z}\]
    も連結となる\ref{prop-connectedness-of-the-Riemann-surface-of-inverse-functions}．
    \[\xymatrix{
        \O\ar@{->>}[d]&\;\cR(\log z)\ar@{->>}[d]^-{\pi}\ar[dr]^-{e}\;\ar@{^{(}->}[l]\\
        \C&\;\C\setminus\{0\}\ar@{x->}[r]_-{\log z}\;\ar@{^{(}->}[l]&\C
    }\]
    $\log:\C\setminus\{0\}\to\C$は可算無限個の分枝を持つが，$\pi:\cR(\log z)\epi\C\setminus\{0\}$によってliftすれば１価関数となる．
\end{example}

\section{曲線に沿った解析接続}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Weierstrassの議論では直接解析接続の列を取っていたところが，lifting problemに圏論化された．
\end{tcolorbox}

\begin{definition}[lift, analytic continuation along a curve]\mbox{}
    \begin{enumerate}
        \item 曲線$\gamma:[a,b]\to\C$に対し，曲線$\wt{\gamma}:[a,b]\to\O$で$\pi\circ\wt{\gamma}=\gamma$を満たす$\wt{\gamma}$を$\gamma$の\textbf{リフト}という．
        \[\xymatrix{
            &\O\ar@{->>}[d]^-{\pi}\\
            [a,b]\ar[r]^-{\gamma}\ar@{.>}[ur]^-{\wt{\gamma}}&\C
        }\]
        \item $\Im\wt{\gamma}\subset\cR(\f)$であるとき，$\wt{\gamma}$を$\f$の\textbf{曲線$\gamma$に沿った解析接続}という．\footnote{これを満たす$\f$は存在する．連結成分から逃れることはできない．列の議論をlifting problemに，射の言葉に翻訳したのである．}
    \end{enumerate}
\end{definition}

リフトは存在するとは限らないが，存在するなら一意である．

\begin{theorem}[リフトの一意性]\label{thm-uniqueness-of-lift}
    $\wt{\gamma_1},\wt{\gamma_2}$を$\gamma$のリフトとする．
    $\wt{\gamma_1}(a)=\wt{\gamma_2}(a)\Rightarrow\wt{\gamma_1}=\wt{\gamma_2}$である．
\end{theorem}
\begin{proof}
    $I:=\Brace{t\in[a,b]\mid \wt{\gamma_1}(t)=\wt{\gamma_2}(t)}$としたとき，$a\in I\ne\emptyset$．よって，$I$が$[a,b]$の開かつ閉集合であることを示せば，$I=[a,b]$が従う．
    \begin{description}
        \item[閉] $\O$のHausdorff性\ref{prop-sheaf-of-holomorphic-functions-is-Hausdorff}から従う．連続写像$\Phi:=(\wt{\gamma_1},\wt{\gamma_2}):[a,b]\to\O\times\O$について，$I=\Phi^{-1}(\Delta_\O)$より（正則関数の層はHausdorff\ref{prop-sheaf-of-holomorphic-functions-is-Hausdorff}）．
        \item[開] $\O$の局所同相性\ref{def-sheaf}から従う．任意に$t_0\in I$を取ると，$\wt{\gamma_1}(t_0)=\wt{\gamma_2}(t_0)=:\wt{p}$．$\O$の局所同相性より，$\wt{p}$の開近傍$U\osub\O$が存在して，$\pi:U\iso\pi(U)$は可逆．すると，$\wt{\gamma_j}$は連続なので，$t_0$の開近傍$I_0\subset[a,b]$が存在して，$\wt{\gamma_j}(I_0)\subset U$，すなわち，$I_0$では$\wt{\gamma_j}=\pi^{-1}\circ\gamma$より，$\pi\circ\wt{\gamma_1}=\gamma=\pi\circ\wt{\gamma_2}\;\on I_0$．よって，$t\in I_0\subset I$．
    \end{description}
\end{proof}

\section{モノドロミー定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    領域上の解析接続は，ホモトピー類で定まる．
    これは局所同相性な束が普遍的に持つ位相幾何学的性質．
\end{tcolorbox}

２つの始終点が一致する領域$\Omega$上の曲線$\gamma_j:[a,b]\to\Omega,\gamma_0(a)=\gamma_1(a),\gamma_0(b)=\gamma_1(b)$を考える．
$\gamma_0$と$\gamma_1$が$\Omega$上homotopicとは，連続写像$\Phi:[0,1]\times[a,b]\to\Omega$であって，次を満たすものが存在することである．
\begin{description}
    \item[端点] $\Phi(s,a)=\gamma_0(a),\Phi(s,b)=\gamma_0(b)\;\forall_{s\in[0,1]}$．
    \item[極限状態] $\Phi(0,t)=\gamma_0(t),\Phi(1,t)=\gamma_1(t)\;\forall_{t\in[a,b]}$．
\end{description}

\begin{theorem}[モノドロミー定理]\label{thm-monodromy}
    領域$D$と点$p\in D$上の関数の芽$f_{p}\in\O_{p}$を考える．
    $p$を始点とする任意の$D$の曲線$\gamma$は，$f_p$を始点とするリフト$\wt{\gamma}$を持つとする．
    このとき，$\wt{\gamma}$の終点は$\gamma$のホモトピー類で定まる．
    すなわち，次が成り立つ：$\gamma_0\sim\gamma_1\land\wt{\gamma_0}(a)=\wt{\gamma_1}(a)=p\Rightarrow\wt{\gamma_0}(b)=\wt{\gamma_1}(b)$．
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[方針] $\gamma_0,\gamma_1$のホモトピー$\Phi:[0,1]\times[a,b]\to D$の$\wt{\Phi}(s,a)=f_p\;(s\in[0,1])$を満たすリフト$\wt{\Phi}:[0,1]\times[a,b]\to\O$を構成すればよい．すると，$\wt{\Phi}(s,b)$は１点$\gamma_1(b)$のリフトなので定値．特に$\wt{\gamma_0}(b)=\wt{\Phi}(0,b)=\wt{\Phi}(1,b)=\wt{\gamma_1}(b)$が従う．\footnote{三角錐型の可換図式が見える．高さ方向が$\pi:\O\to\C$．}
        \item[構成] 各$s\in[0,1]$について，$\gamma_s:=\Phi(s,-):[a,b]\to D$の$f_p$を始点とするリフト$\wt{\gamma_s}$が，仮定より存在するから，これを用いて$\wt{\Phi}(s,t):=\wt{\gamma_s}(t)$を構成とする．こうして定めた$\wt{\Phi}:[0,1]\times[a,b]\to\O$が連続だと示せばよい．構成より，第一引数を固定したとき，第二引数については連続であることに注意．
        \item[連続要件] 任意に$\sigma\in[0,1]$を固定し，$I_\sigma:=\Brace{\tau\in[a,b]\mid\wt{\Phi}(s,t)は(\sigma,\tau)のある近傍上で連続}$とおき，$I_\sigma=[a,b]$を示せばよい．$I_\sigma$は定め方から開集合であるから，$I_\sigma\ne\emptyset$かつ閉であることを示せばよい．
        \begin{enumerate}
            \item $a\in I_\sigma$を示す．$\pi:\O\epi\C$の局所同相性より，$\pi:U\iso\pi(U)$を満たす$f_p$の近傍$U\osub\O$が存在する．
            これを用いて，$(\pi|_U)^{-1}\circ\Phi$は，$(\sigma,a)\in[0,1]\times[a,b]$の近傍における$\Phi$のリフトを定め，また連続である．$\gamma_\sigma$のリフトの一意性より，$\Phi$のリフトも一意で，$\wt{\Phi}=(\pi|_U)\circ\Phi$も$(\sigma,a)$の近傍で連続．\footnote{つまり，$(\sigma,a)$の周りで局所同相な$\pi$で持ち上げると，その持ち上げ方は一意であることが$\gamma$の一意性から従う．各$\sigma\in[0,1]$について切ると図式を可換にするものは一意だから．一方，大域的に定義できるかとそれが大域的に連続かが非自明．}
            \item $I_\sigma$の点列$(t_n)$が$\tau\in[a,b]$に収束するとする．$\tau\in I_\sigma$を示す．
            まず，$\wt{\Phi}(\sigma,\tau)\in\O$の近傍$U$で，$\pi:U\iso\pi(U)$が同相になるものをとる．$\Phi(\sigma,t)=\wt{\gamma_\sigma}(t)$の$t\in[a,b]$についての連続性より，$t$を含む開区間$J_t\osub[a,b]$で，$\wt{\Phi}(\{\sigma\}\times J_t)\subset U$を満たすものが取れる．次にこれを用いて$t_n\in J_s$を満たす$t_n$があり，$\wt{\Phi}$は$(\sigma,t_n)\in I_\sigma$上連続であるから，$\sigma\in J_s\osub[0,1]$を満たす開区間が存在して，$\wt{\Phi}(J_s\times\{t_n\})\subset U$だけでなく，$\Phi$の連続性より$\Phi(J_s\times J_t)\subset\pi(U)$も満たすように取れる．すると，$J_s\times J_t\osub[0,1]\times[a,b]$上では連続関数$(\pi|_U)^{-1}\circ\Phi$が定まり，
            $t_n\in I_\sigma$より$J_s\times\{t_n\}$上では$\wt{\Phi}$と一致する．するとさらに$\gamma_s\;(s\in J_s)$のリフトの一致性より，結局$J_s\times J_t$全体で$\wt{\Phi}=(\pi|_U)^{-1}\circ\Phi$であるから，$\wt{\Phi}$は$(\sigma,\tau)\in J_s\times J_t\osub[0,1]\times[a,b]$上で連続．
        \end{enumerate}
    \end{description}
\end{proof}
\begin{remarks}[ホモトピーも連続にリフトできるということ]
    基本的には$\pi:\O\epi\C$は局所同相（＝局所的には連続に可逆）であるから，近傍で少しずつ持ち上げることが出来る．
    これでホモトピーも持ち上げることができるから，終点はホモトピー類で定まる，という議論ができるのが「リフト」の言葉の強みであろう．
    その議論の内容は連結性を使うと簡潔になる．第一変数（曲線を変えるパラメータ）が肝になるのでこれを固定して考える．スタート地点$(\sigma,a)$では局所的に一意に連続に持ち上げられるが，それを繰り返した結果大域的に繋がるかの問題はいつだって連結性の問題である．
    まず第二引数について連続性から$J_t$を取り，帰納法の仮定を利用して第一引数についても$J_s$を取り，議論を積位相に持ち上げることに成功する，という壮大な位相空間論アルゴリズム．

    モノドロミーは，ホモトピー論のところで一般の被覆空間について再び議論されるが，この解析接続での議論が歴史上人類の初対面．
    局所同相性だけから従う位相幾何学の消息で，正則関数とは実は関係がない．
\end{remarks}

\begin{corollary}
    領域$U\subset\C$に対して$\O_U:=\pi^{-1}(U)$とおき，$P\in\O_U$は$\pi(P)$を始点とする$U$内の任意の曲線に対して$P$を始点とするリフトを持つとする．
    この時，$P$を含む$\O_U$の連結成分を$\cR_U(P)$と置く．
    \begin{enumerate}
        \item $U$が単連結ならば，$\pi:\cR_U(P)\to U$は同相写像である．
        \item $U:=\Delta^*=\Brace{z\in\C\mid0<\abs{z}<1}$とする．$z_0:=\pi(P)$に対して，閉曲線$r_n(t):=z_0e^{2\pi nt}\;(t\in[0,1])$を考える．ある$n$について$\gamma_n$の$P$を始点とするリフトが閉曲線になる時，このような$n$の最小値を$N$とすれば，ある$U$上の正則関数$F\in\O(U)$が存在して，$\cR_U(P)=\Brace{Q\in\O_U\mid F(z)=Q(z^N)がQの収束円上で成り立つ}$と表せる．
    \end{enumerate}
\end{corollary}

\begin{proposition}[逆関数のRiemann面の連結性]\label{prop-connectedness-of-the-Riemann-surface-of-inverse-functions}
    定数でない整関数$f:\C\to\C$に対して，
    \[\cR(f^{-1}):=\Brace{P\in\O\mid f(P(z))=zがPの収束円上で成り立つ}\]
    は連結である．すなわち，たしかに大域的解析関数を定める．
\end{proposition}
\begin{proof}
    任意の２点$P_0,P_1\in\cR(f^{-1})$を結ぶ$\O$内の曲線を構成すれば良い．
    $\pi(P_j)=:z_j$を関数の芽の中心，$P_j(z_j)=:w_j$を$P_j$の冪級数展開を考えたときの定数項とする．
    \begin{description}
        \item[構成] 両端点$z_0,z_1$において，関係式を微分すると$f'(w_j)\cdot P'_j(z_j)=1$を得る．特に$f'(w_j)\ne 0$であるから，$f$は$w_j$の近傍において可逆である（逆写像定理\ref{thm-inverse-mapping-theorem}）．
        つまり，$E:=\Brace{w\in\C\mid f'(w)=0}$と定めると，$w_0,w_1\in\C\setminus E$．
        $f$は零でないとしたから離散集合となり，$\C\setminus E$は連結だから，
        $w_0$と$w_1$を結ぶ$\C\setminus E$内の曲線$\gamma$が存在する．対応する曲線を$\mu:=f\circ\gamma$とおく．
        \item[リフトの構成]
        すると，$\gamma$は$\C\setminus E$内の曲線としたから，各$t\in[0,1]$に対して$f$は$\gamma(t)$の近傍$U_t$から$\mu(t)$の近傍$V_t$への双正則写像$f|_{U_t}$を定める（逆写像定理\ref{thm-inverse-mapping-theorem}）．
        これに対して，リフト$\wt{\mu}:[0,1]\to\O$を
        \[\wt{\mu}(t)=\paren{(f|_{U_t})^{-1}の\mu(t)での芽}\]
        と定めれば，これは$\wt{\mu}(0)=P_0,\wt(\mu)(1)=P_1$を満たす連続曲線である．
    \end{description}
\end{proof}
\begin{remarks}
    正則関数の局所的な逆関数は微分が消えていないから，局所的に双正則写像を定める．
    するとこれを集めていけば連結なRiemann面が出来るというのは自然な出来事であるが，これが層の言葉で厳密に定式化されている．
\end{remarks}
\begin{remark}[層の位相]
    $\O$で曲線が引ける＝大域的解析関数という定義は不思議だ．$\O$にはどんな距離構造が入っているのか？
    少なくとも位相としては，$\wt{\mu}$は連続になっている．
    $V_{(f,U)}$は区間$[0,1]$内の開区間に対応している．
    なるほど，層の位相は自然だな．解析接続のために考えられた位相だ．
\end{remark}

\chapter{楕円関数}

\begin{quotation}
    歴史的には楕円の誇張を求める問題から生じた数学的対象である．
    数学的には，torus上の有理型関数と考えられ，torusがコンパクトであるために，多くの代数的性質を満たす（ペー関数の普遍性\ref{thm-universality-of-p}など）．
\end{quotation}

\section{楕円関数の定義}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    周期は，$\C$の部分$\Z$-加群の構造を持つ．
\end{tcolorbox}

\subsection{周期加群}

\begin{definition}[period]
    有理型関数$f:\C\to\hatC$に対して，
    \[M:=\Brace{w\in\C\mid \forall_{z\in\C}\;f(z+w)=f(w)}\]
    を$f$の\textbf{周期加群}（または格子）といい，$M$の元を\textbf{周期}という．
\end{definition}
\begin{lemma}
    $w_1,w_2\in M$に対し，$w_1-w_2\in M$を満たす．すなわち，$M$は$\C$の加法について部分アーベル群をなす．
\end{lemma}
\begin{proof}
    $w_1,w_2\in M$のとき，
    \[f(z+w_1-w_2)=f(z-w_2)=f(z-w_2+w_2)=f(z).\]
    $0\in M$と併せると$-w_2\in M$なので，$M$はたしかに部分群である．
\end{proof}

\begin{example}[多項式の周期]
    $f\in\C[Z]$のとき，$M=\{0\}$または$M=\C$である．
    \begin{enumerate}
        \item $f$が定数ならば，$M=\C$．$M$が離散でない場合はこの場合に限る．
        \item $f$が定数でない多項式ならば，$M=\{0\}$．
    \end{enumerate}
    実際，$w\in M\setminus\{0\}$が取れたならば，$f(z)=0$の根$z_0$が少なくとも１つは存在するが，これに対して$z_0+nw\;(n\in\Z)$は別の根である．
    したがって$f(z)=0$は無限個の根を持ち，$f\in\C[Z]$に矛盾．
\end{example}

\begin{example}[指数関数の周期]
    \[f(z)=\exp\paren{\frac{2\pi iz}{w}}\;(w\ne 0)\]
    の周期加群は$\Z w$である\ref{thm-period-of-exponential}．
\end{example}

\begin{proposition}
    有理型関数$f:\C\to\hatC$の周期加群$M$が$w\Z$を含むとする．このとき，$f$はFourier展開可能である．
\end{proposition}
\begin{proof}
    $F(w):=f\paren{\frac{w}{2\pi i}\log w}$とおけば，右辺は$\log w$の分枝の選び方に依らずに定まるので，有理型関数$F:\C^*\to\hatC$が定まり，$f(z)=F\paren{\exp\paren{\frac{2\pi iz}{w}}}$を満たす．
    $F$の$w=0$におけるLaurent展開を$F(w)=\sum_{n\in\Z}a_nw^n$とすると，
    \[f(z)=\sum_{n\in\Z}a_ne^{\frac{2\pi iz}{w}}\]
    となる．
\end{proof}

\subsection{楕円関数の定義}

\begin{example}[Jacobi elliptic function (1829)]\label{exp-Jacobi-elliptic-function}
    Schwartz-Christoffelの公式\ref{exp-rectangle-and-Jacobi-sn-function}より，第1種不完全楕円積分
    \[F(w):=\int^w_0\frac{dw}{\varphi(w)}\qquad\varphi(w)=\sqrt{(1-w^2)(1-k^2w^2)}\;(0<k<1)\]
    で定まる$F:H\to\C$は，$H$を長方形$R:=\Brace{z\in\C\mid\abs{\Re z}<\frac{k}{2},0<\Im z<k^*}$に写す双正則写像であり，$k=\int^1_0\frac{dt}{\varphi(t)},k^*=\int^{1/k}_0\frac{dt}{\varphi(t)}$を満たす．\footnote{レムニスケートの長さに対応しているらしい．}
    鏡像の原理で，$F:H\iso R$の逆関数$f:R\iso H$は$\C$上の有理型関数に拡張される．したがって，周期加群$2K\Z+2iK^*\Z$をもつ．\footnote{Jacobiの楕円関数は，特定の性質を持つ有理型関数として特徴づけることもできる．}
    $f(z)=sn(z;k)$とも書き，\textbf{エスエヌ関数}と呼ぶ．$\sin$から$i$を落とした表記をし，$sn(z,k)\xrightarrow{k\to 0}\sin(z)$となる．
\end{example}

\begin{theorem}
    $\C$の離散部分加群$M$は，次のいずれかである．
    \begin{enumerate}[(i)]
        \item $M=\{0\}$，
        \item $\exists_{w\in\C^*}\;M=\Z w$，
        \item $\exists_{w_1,w_2\in\C^*}\;\frac{w_1}{w_2}\notin\R\land M=\Z w_1+\Z w_2$．
    \end{enumerate}
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[(ii)] (i)でないとき，$w_1\in M\setminus\{0\}$が$\abs{w_1}=\min\Brace{\abs{w}\in\R\mid w\in M\setminus\{0\}}$\footnote{$M$は可算であることに注意．}を満たすように取ると，$M\cap\R w_1=\Z w_1$が成り立つことを示す．
        
        任意の元$w\in M\cap\R w_1$を取ると，ある$\lambda\in\R$が存在して$w=\lambda w_1$と表せる．$\lambda\in\left[n-\frac{1}{2},n+\frac{1}{2}\right)$を満たす$n\in\Z$が存在する．これについて，
        \[\abs{w-nw_1}=\abs{(\lambda-n)w_1}=\abs{\lambda -n}\abs{w_1}\le\frac{1}{2}\abs{w_1}<\abs{w_1}\]
        であるが，$\abs{w_1}$は$M\setminus\{0\}$内で最小となるようにとったから，$\abs{w-nw_1}=0$が従う．すなわち，$w=nw_1\;(\exists_{n\in\Z})$．
        \item[(iii)] さらに(ii)でもないと仮定すると，$\abs{w_2}=\min\Brace{\abs{w}\in\R\mid w\in M\setminus\R w_1}$を満たす$w_2\in M\setminus\R w_1$について，$M=\Z w_1+\Z w_2$と表せることを示す．
        $w_1,w_2$は線型独立で，$\abs{w_1}\le\abs{w_2}$であることに注意．
        任意に$w\in M\setminus\R w_1$を取ると，$w_1,w_2\in M$は一次独立だから$w=\lambda_1w_1+\lambda_2w_2\;(\lambda_1,\lambda_2\in\R)$と表せる．
        $\lambda_j\in\left[n_j-\frac{1}{2},n_j+\frac{1}{2}\right)\;(j=1,2)$を満たす$n_j\in\Z$が取れる．
        \begin{align*}
            \abs{w-(n_1w_1+n_2w_2)}&=\abs{(\lambda_1-n_1)w_1+(\lambda_2-n_2)w_2}\\
            &<\abs{\lambda_1-n_1}\abs{w_1}+\abs{\lambda_2-n_2}\abs{w_2}&w_1,w_2は線型独立なので等号不成立\\
            &\le\frac{1}{2}\abs{w_1}+\frac{1}{2}\abs{w_2}\le\abs{w_2}
        \end{align*}
        より，$\abs{w_2}$の$M\setminus\R w_1$上での最小性から，$\abs{w-(n_1w_1+n_2w_2)}=0$が必要．
    \end{description}
\end{proof}
\begin{definition}[elliptic function]\mbox{}
    \begin{enumerate}
        \item 有理型関数$f:\C\to\hatC$の周期加群が$M=\C$または$M=\Z w_1+\Z w_2$であるとき，$f$を\textbf{楕円関数}という．\footnote{定数関数も楕円関数と呼ぶので，楕円関数全体の集合は線型空間をなす．}
        \item $w_1,w_2$を$\Z$-加群$M$の\textbf{基底}，$f$の\textbf{基本周期}という．
        \item $Q(w_1,w_2):=\Brace{\lambda_1w_1+\lambda_2w_2\in\C\mid\lambda_1,\lambda_2\in[0,1)}$を\textbf{周期平行四辺形}または\textbf{基本領域}という．
        \item よく$\Im\frac{w_2}{w_1}>0$と約束し，$w_1=1,w_2=\tau,\Im\tau>0$と正規化する．
    \end{enumerate}
\end{definition}

\subsection{楕円関数の次数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=楕円関数は，Riemann球面上の値を，同じ重複度で取る]
    楕円関数は基本領域上で積分すると$0$になり，ここから引き出される著しい性質がある．
    \textbf{楕円関数は，Riemann球面上の値を，同じ重複度で取る}．特に全射である．
\end{tcolorbox}

\begin{theorem}[楕円関数の値]\label{thm-property-of-elliptic-function}
    $f$を一次独立な周期$w_1,w_2$を持つ楕円関数とする．
    \begin{enumerate}
        \item $f$が正則ならば定数である．
    \end{enumerate}
    以下，$f$は定数でないとし，$f$の周期加群を$M=\Z w_1+\Z w_2\;)\Im w_2/w_1>0$，これが定める基本領域を$Q\subset\C$とする．
    \begin{enumerate}\setcounter{enumi}{1}
        \item $\sum_{a\in Q}\Res_af=0$．
        \item $\forall_{w\in\hatC}\;\abs{\Brace{z\in Q\mid f(z)=w}}=\const=:\deg f\in\N$（重複度も込める）．この値を$f$の\textbf{次数}といい，$\deg f$で表す．
        \item $\deg f\ge 2\;(\Lrarrow \deg f\ne 1)$．
    \end{enumerate}
\end{theorem}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 正則，特に連続な$f$は$[Q]$上で有界であるから，周期性より，$\C$上でも有界である．したがって，Liouvilleの定理\ref{thm-Liouville}より，$f$は定数である．
        \item \begin{description}
            \item[$\partial Q$上に$f$の極がないとき] 留数定理\ref{thm-residue}より，
            \[2\pi i\sum_{a\in Q}\Res_af=\int_{\partial Q}f(z)dz.\]
            $\partial Q$とは，$[0,w_1],[w_1,w_1+w_2],[w_1+w_2,w_2],[w_2,0]$の４辺上での積分に分解できるが，周期性より，平行な対辺上での積分は相殺される．よって，$=0$．
            \item[$\partial Q$上に$f$の極があるとき]
            $f$の極は離散的だから，$Q$を平行移動して$Q+\alpha$の境界上には極がないような$\alpha\in Q$が存在する．よって，周期性から，
            \[\sum_{a\in Q}\Res_af=\sum_{a\in Q+\alpha}\Res_af=0\]
        \end{description}
        \item 偏角の原理による．
        任意の$w\in\C$に対して，関数$\frac{f'(z)}{f(z)-w}$は有理型関数で，再び$w_1,w_2$を周期にもつから楕円関数である．偏角の原理\ref{thm-argument-principle}より，この関数を$Q$で積分することで$f(z)=w$の解を重複度もこめて数えることができるが，
        \[\sum_{a\in Q}\Res_af\frac{f'(z)}{f(z)-w}=0.\]
        したがって，
        \[\abs{\Brace{z\in Q\mid f(z)=w}}=\abs{\Brace{z\in Q\mid zはfの極}}\]
        となり，右辺は$w$に依らない．

        関数$\frac{f'(z)}{f(z)-w}$が$\partial Q$上に極をもつ場合は同様に平行移動$+\alpha$を考えれば良い．
        \item 
        $\deg f=1$ならば，$f$は$Q$内に１位の極を１つもつ．
        極での留数は消えないので，これは(2)に矛盾．
    \end{enumerate}
\end{proof}
\begin{remarks}\mbox{}
    \begin{enumerate}
        \item 有理型関数とは$D\setminus f^{-1}(\infty)$上正則な関数のことだから\ref{def-meromorphic function}，定数でない楕円関数はしたがって正則でなく，したがって少なくとも１つの極を（$Q$に）もつ．
        \item 楕円関数$f$の基本領域で$f$を積分すると$0$になる．
        \item (2)の事実は，楕円関数$f$は全ての値を同じ重複度だけ取るので，特に極の個数に一致し，これを\textbf{次数}という．
        \item (2)は$\deg f\ne 1$も含意している．
    \end{enumerate}
\end{remarks}

\subsection{複素トーラス}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $\Hom_{\C\Diff}(T^2,\hatC)$の元が楕円関数である．
    となると関数空間的な対象かといえば，$\wp,\wp'$からなる有理式で表され，実は代数的に扱える対象である．
\end{tcolorbox}

楕円関数$f:\C\to\hatC$は商加群$\C/M$上の双正則写像$\o{f}:\C/M\to\hatC$を引き起こす．
\[\xymatrix{
    \C\ar[r]^-f\ar@{->>}[d]_-\pi&\hatC\\
    \C/M\ar@{.>}[ur]_-{\o{f}}
}\]
\begin{align*}
    \lambda_1w_1&\sim\lambda_1w_1+w_2,&\lambda_2w_2&\sim\lambda_2w_2+w_1
\end{align*}
を同一視すると考えれば，$\C/M$は（複素）トーラスに位相同型である．

\section{Weierstraßの楕円関数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    周期加群$L=\Z w_1+\Z w_2$が定める楕円関数を考える．
    Weierstraßの基本的な研究方針であるが，具体的な級数の形から関数に迫ることを原則とした．
    しかし，一度このような超越的な方法で具体的に楕円関数の例を１つ得ると，他の楕円関数は$\wp,\wp'$を用いて代数的に表現される．
\end{tcolorbox}

\subsection{Weierstrassのペー関数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $\C$上の楕円関数を，基本周期$L$から$\sum_{w\in L}\frac{1}{(z-w)^2}$というように作りたいが，
    このままだと発散するので
    収束するように少し調整する．
\end{tcolorbox}

\begin{lemma}
    \[\sum_{w\in L^*}\abs{w}^{-\alpha}<\infty\qquad(\alpha >2).\]
\end{lemma}
\begin{proof}
    $\R$の部分集合
    \[\Brace{\frac{\abs{n_1}+\abs{n_2}}{\abs{n_1w_1+n_2w_2}}\in\R\;\middle|\;n_1,n_2\in\R,n_1\ne 0\lor n_2\ne 0}\]
    は有界である．実際，$n_1=r\cos\theta,n_2=r\sin\theta$とおくと，
    \[\frac{\abs{n_1}+\abs{n_2}}{\abs{n_1w_1+n_2w_2}}=\frac{\abs{\cos\theta}+\abs{\sin\theta}}{\abs{\cos\theta w_1+\sin\theta w_2}}\]
    と表せるため，コンパクト集合$[0,2\pi]$の連続写像による像であることがわかる．
    したがって，ある$C\in\R$が存在して，
    \begin{align*}
        \sum_{w\in L^*}\abs{w}^{-\alpha}&\le C^\alpha\sum_{(n_1,n_2)\in\Z^2\setminus\{(0,0)\}}\paren{\abs{n_1}+\abs{n_2}}^{-\alpha}\\
        &= C^\alpha\sumn\sum_{\abs{n_1}+\abs{n_2}=n}n^{-\alpha}\\
        &= C^\alpha\sumn 4n\cdot n^{-\alpha}=4C^\alpha\sumn n^{1-\alpha}.
    \end{align*}
    $\sumn n^{-\alpha}<\infty\Lrarrow\alpha>1$と併せて，主張が成り立つ．
\end{proof}
\begin{remark}[一体これはどういう証明？]
    ３次元だともう一つ指数がズレる．
\end{remark}

\begin{theorem}[Weierstrass's p-function]
    級数
    \[\wp(z)=\frac{1}{z}+\sum_{w\in L^*}\paren{\frac{1}{(z-w)^2}-\frac{1}{w^2}}\footnote{極も周期$w$を持つのでこのような構成になるのは自然で，第二項を引くことで収束させている．}\]
    は有限個を除いて$\C$上一様収束し，$L$を周期とする楕円関数となる．ただし，$L^*:=L\setminus\{0\}$とした．
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[一様収束] 
    任意のコンパクト集合$K\subset\C$に対して，$K\subset\Delta(0,R)$を満たす$R>0$が存在するから，任意の$R>0$に対して，$\abs{z}\le R$で収束することを示せば良い．
    すると，$\abs{w}\ge 2R$を満たす$w\in L$に対して，$\Abs{\frac{z}{w}}\le\frac{1}{2}$が成り立つから，
    \begin{align*}
        \Abs{\frac{1}{(z-w)^2}-\frac{1}{w^2}}=\Abs{\frac{2zw-z^2}{w^2(z-w)^2}}=\frac{\Abs{2-\frac{z}{w}}}{\Abs{\frac{z}{w}-1}^2}\frac{\abs{z}}{\abs{w}^3}\le 10\frac{R}{\abs{w}^3}.
    \end{align*}
    よって，補題よりこれらの項の和は優級数$10R\sum_{w\in L^*}\frac{1}{\abs{w}^3}$を持つ．
    したがって，級数$\wp(z)$は$\Delta(0,R)$上で，$\abs{w}<2R$を満たす有限個の項を除いて，一様に収束する．
    \item[周期]
    よって，ペー関数は$\C$上項別微分可能\ref{thm-冪級数は項別微分できる}である（有限個の例外項には通常の微分法則を適用）から，微分
    \[\wp'(z)=-2\sum_{w\in L^*}\frac{1}{(z-w)^3}\]
    も$\C$上広義一様収束する．これは明らかに$L$を周期とする楕円関数であるから，$\wt(z)-\wp(z+w)\;(w\in L)$の微分は$0$である．よって，$C_w\in\C$が存在して，$\wp(z)-\wp(z+w)=C_w$と表せる．
    いま，$\wt(z)=\wp(-z)$であることより，特に$z=-\frac{w}{2}$の場合を考えると，$\wp\paren{-\frac{w}{2}}-\wp\paren{\frac{w}{2}}=0=C_w$が従う．したがって，$L$の元は$\wp$の周期加群に含まれる．
    一方で，$\wp$の極は$L$の元のみであるから，これ以外に$\wp$の周期は存在しない．
    \end{description}
\end{proof}
\begin{definition}[half period]
    周期$w\in L$が$\frac{w}{2}\notin L$を満たすとき，$\frac{w}{2}$を\textbf{半周期}という．
    周期$L=\Z w_1+\Z w_2$の定める基本領域$Q$内の半周期は３つで$\frac{w_1}{2},\frac{w_2}{2},\frac{w_1+w_2}{2}$である．
\end{definition}

\subsection{Eisenstein級数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    \begin{itemize}
        \item Weierstrassの楕円関数$\wp$は$M$でのみ２位の極をもち，偶関数である．したがって，級数展開とその項別微分を考えることより，$\wp'$は$M$でのみ３位の極をもち，半周期でのみ１位の零点を持つことが分かる．
        \item Weierstrassの楕円関数も，楕円積分の逆関数となっている．
        \item Weierstrassの楕円関数のLaurent級数展開
        \[\wp(z)=z^{-2}+\frac{1}{20}g_2z^2+\frac{1}{28}g_3z^4+O(z^6)\]
        を得る．
    \end{itemize}
\end{tcolorbox}

\begin{definition}[Eisenstein series]
    \[G_k:=\sum_{\om\in M^*}\om^{-2k}\]
    を\textbf{アイゼンシュタイン級数}という．
\end{definition}

\begin{theorem}\mbox{}
    \begin{enumerate}
        \item 導関数$\wp'$の零点は，$\wp$の半周期上の１位の零点に尽きる．
    \end{enumerate}
    半周期での$\wp$の値を
    \begin{align*}
        e_1&:=\wp\paren{\frac{w_1}{2}},&e_2&:=\wp\paren{\frac{w_2}{2}},&e_3&:=\wp\paren{\frac{w_1+w_2}{2}}
    \end{align*}
    と定める．
    \begin{enumerate}\setcounter{enumi}{1}
        \item $e_1,e_2,e_3$は互いに異なる．
        \item $\varphi(w):=4(w-e_1)(w-e_2)(w-e_3)$とおくと，$\wp$は微分方程式$(\wp')^2=\varphi(\wp)$を満たす．
        \item 多項式$\varphi$はEisenstein級数を用いた次の表示を持つ：
        \[\varphi(w)=4w^2-g_2w-g_3.\qquad\paren{g_2=60G_2,\quad g_3=140G_3}\]
    \end{enumerate}
\end{theorem}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 
        \begin{description}
            \item[半周期ならば零点] $\wp$は定義である級数展開より偶関数であるから，$\wp'$は奇関数である：$\wp'(-z)=-\wp'(z)$．これは級数展開の項別微分を考えれば明らか．
            よって，任意の半周期$\frac{w}{2}$に対して，
            \[\wp'\paren{\frac{w}{2}}=-\wp'\paren{-\frac{w}{2}}=-\wp'\paren{-\frac{w}{2}+w}=-\wp'\paren{\frac{w}{2}}\]
            より，$\wp'\paren{\frac{w}{2}}=0$である．すなわち，半周期は零点である．
            \item[零点ならば半周期]
            一方で，$\deg\wp=2$より，$\deg\wp'=3$である．これは$z=0$での$\wp$のLaurent展開の主要部に注目すれば良い．
            よって，$Q$内の$\wp'$の零点は半周期の３点に１位ずつである\ref{thm-property-of-elliptic-function}．
        \end{description}
        \item $\wp(z)=e_i\;(i=1,2,3)$は$z=e_i$で２位の零点である．
        したがって，$e_1=e_2,e_2=e_3,e_3=e_1$のいずれか１つでもなりたてば，$\deg f=2$に矛盾する．
        \item $\wp'$は$M$上でのみ３位の極をもち，半周期でのみ１位の零点を持つ．よって，$(\wp')^2$は$M$上でのみ６位の極をもち，半周期でのみ２位の零点を持つ．

        一方で，$F(z):=(\wp(z)-e_1)(\wp(z)-e_2)(\wp(z)-e_3)$と置くと，$F:\C\to\hatC$も$M$上でのみ６位の極を持ち，半周期でのみ２位の零点を持つ（たしかに$F'\paren{\frac{\om}{2}}=0$で，$F''\paren{\frac{\om}{2}}\ne0$）．
        したがって，$\frac{F}{(\wp')^2}:\C\to\hatC$は極を持たない，$\C$上の正則関数となるから，$\exists_{c\in\C}\;F=c(\wp')^2$が従う．
        
        あとは，原点でのLaurent展開の主要部
        \begin{align*}
            \wp(z)&=\frac{1}{z^2}+O(1),&\wp'(z)&=\frac{-2}{z^3}+O(1)
        \end{align*}
        を比べることで，$c=4$を得る．
        \item 

    \end{enumerate}
\end{proof}
\begin{remark}[楕円積分]
    $D\subset\hatC$を$e_1,e_2,e_3$を含まない単連結領域とし，この上の関数$I(w,w_0):D\times D\to\hatC$を考える：
    \[I(w,w_0):=\int^w_{w_0}\frac{d\zeta}{\sqrt{4(\zeta-e_1)(\zeta-e_2)(\zeta-e_3)}}.\]
    \ref{lemma-existence-of-log}
\end{remark}

\subsection{ペー関数の普遍性}

\begin{theorem}[ペー関数の普遍性]\label{thm-universality-of-p}
    離散加群$M$を周期とする楕円関数$f$は，有理式$Q\in\C(Z,W)$が存在して，$f=Q(\wp,\wp')$と表せる．
\end{theorem}


\section{楕円積分}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    振り子の数値計算ではsn関数\ref{exp-Jacobi-elliptic-function}が現れる．その微小角近似では，$sn(z,k)\xrightarrow{k\to 0}\sin(z)$が成り立つ．
    $\sin\frac{\theta(t)}{2}=k\cdot sn(w_0t;k)$より，$\frac{\theta}{2}(t)=\frac{\alpha}{2}\sin(w_0t)\mod O(\alpha^2)$．
\end{tcolorbox}

\begin{proposition}
    最大角$0<\alpha<\frac{\pi}{2}$で糸の長さが$l$の単振り子の振れ角$\theta(t)$は，
    \[\theta=2\arcsin\paren{k\cdot sn(w_0t;k)}\]
    と表せる．
\end{proposition}
\begin{proof}
    運動方程式は
    \[\ddot{\theta}+w_0^2\sin\theta=0,\qquad w_0=\sqrt{\frac{g}{l}}\]
    と表される．両辺に$\dot{\theta}$をかけて$t$で積分すると，
    \[\frac{1}{2}\dot{\theta}^2-w_0^2\cos\theta=-w_0^2\cos\alpha\]
    を得る．$1-\cos\theta=2\sin^2\frac{\theta}{2}$より，
    \[\frac{1}{4w_0}\dot{\theta}^2=k^2\sin^2\frac{\theta}{2}\qquad\paren{k=\sin\frac{\alpha}{2}\in(0,1)}\]
    と表せる．ここで，$\sin\frac{\theta}{2}=k\sin\varphi$と変数変換すると，
    \[\dot{\varphi}^2=w_0^2(1-k^2\sin^2\varphi)\]
    \[\int^{\varphi(t)}_0\frac{d\varphi}{\sqrt{1-k^2\sin^2\varphi}}=w_0t\]
    $x=\sin\varphi=\frac{1}{k}\sin\frac{\theta}{2}$と置くと，
    \[\int^{x(t)}_0\frac{dx}{\sqrt{(1-x^2)(1-k^2x^2)}}=w_0t\]
    \[\sin\frac{\theta(t)}{2}=k\cdot sn(w_0t;k)\]
    が成り立つ．
\end{proof}

\section{楕円曲線のもつ群構造}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $\wp:\C/M\to\hatC$は２対１写像であることがわかった．ここから，微分$\wp'$の情報も加味して，
    $(\wp,\wp'):\C/M\iso E$を得る．これは加群としても同型である．\footnote{なんというかfiber座標みたいだ．}
    楕円曲線を有限体$\bF_p$上で考えても群の構造が入るが，群構造は複雑で，$g^n,g$から$n$を複合する（離散対数問題$\log_gg^n\;(g\in E)$）のが極めて難しく，これが暗号理論で応用される．
\end{tcolorbox}

\chapter{Cauchy-Riemannの方程式}

\begin{quotation}
    Mittag-Lefflerの定理から始める．極という特異点の言葉を避けるため，貼り合わせの言葉で同値換言する．
    さらに有理型関数への言及を避けるため，Cousinの第一問題という純粋に正則関数についての問題に還元する（同値ではない，Mittag-Lefflerの定理の拡張になっている）．
    Cousinの第一問題は開被覆を任意に取る問題設定の局所性が煩雑なので，$\Cinf$関数の世界を借りることによって偏微分方程式の解の存在問題に帰着する．
    ここに辿り着くまで多くの命が燃やされた．
    
    「Stein多様体上の解析的な問題には位相的な障害しかない」ことを岡の原理という（第三論文でのテーマ）．
    \begin{quote}
        Cousinの第二問題だけは未知の位相的条件を明らかにすることが残されているが，多分本質的困難はないであろうと予想していたのである．

        結果はその通りであった．しかも，今第三者として見直してみると実に見事な出来栄えである．主定理はこう云っているのである．

        二複素変数の空間に於て，単葉，連結，有限な正則領域内に零点（複数）が与えられたとき，若し非解析解があるならば解析解もある．
        
        『春雨の曲』第七稿
    \end{quote}
    岡潔はLeviの問題に取り組んで世界で初めて解決したが，後年にLars Valter Hörmander 31-12が関数解析と偏微分方程式の手法によって$\o{\partial}$-問題を解決することの帰結として解き直した．
    Hörmanderの教科書に記述がある内容である．
    $\partial_z$が全射を定める空間を単連結というのであった．
    $\o{\partial}$が全射を定める空間を考えることで解決する．
    関数解析の勝利であるか？
    領域化された議論と「その上の関数」という空間に対する位相解析への導入．
    作用素$\partial_z$を全射にする領域$D$を単連結といい，作用素$\partial_{\o{z}}$を全射にする領域$D$を
\end{quotation}

\section{Mittag-Lefflerの定理とCousinの問題}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    極とそこでの主要部を局所的に指定することで，領域の上に同じ特異点挙動をする（局所的に差が正則である）有理型関数を構成することができるか？
    この議論を，極という特異点の知識から，偏微分方程式の解の存在条件という多変数関数論のアイデアへと還元していく．
    するとCousinの問題という，局所的なデータ（開被覆とその上の有理型関数）から大域的な有理型関数を構成するクラスの問題に行き着く．
    関数の芽の考え方に近く，層という概念とコホモロジー(Čech cohomology)の概念の霊性源であることがすぐにわかる．
    Mittag-Lefflerの定理の一般次元化がCousinの第一問題であり，Cartanにより層係数コホモロジーの言葉で，「一次元ホモロジー群が$0$になるときは常に解ける，特にStein多様体上では常に解ける」と解決された．
    第二問題は，第一問題が加法的であるとしたら乗法的なもので，与えられた零点を持つ一変数正則函数の存在についてのヴァイエルシュトラスの定理の多次元への一般化となっている．
\end{tcolorbox}

\begin{theorem}[Mittag-Leffler]\label{thm-Mittag-Leffler}
    任意の領域$\Omega\subset\C$について，
    次の２つの同値な主張が成り立つ．
    \begin{enumerate}
        \item $\Omega$上の離散集合（＝集積点\footnote{集積点は孤立点の対義語}を持たない）を$\{z_j\}_{j\in\N}\subset\Omega$と附番し，対応する定数のない多項式の列$P_j\in\C[z],P_j(0)=0$を考える．$\Omega$上の有理型関数$f\in\M(\Omega)$で，極は$\{z_j\}_{j\in\N}$で，かつ，$z_j$での主要部が$P_j\paren{\frac{1}{z-z^j}}$であるようなものが存在する．
        \item $\Omega$の開被覆$\{\Omega_j\}_{j\in\N}$と対応する有理型関数の列$(f_j)\in\prod_{j\in\N}\M(\Omega_j)$で$f_j-f_{l_j}\in\O(\Omega_j\cap\Om_{l_j})$を満たすものに対して，有理型関数$f\in\M(\Omega)$であって，$f-f_j\in\O(\Omega_j)$を満たすものが存在する．
    \end{enumerate}
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[２つの条件が同値であることの証明] \mbox{}\\
        \begin{description}
            \item[(1)$\Rightarrow$(2)] 任意に開被覆$\{\Om_j\}_{j\in\N}$とその上の有理型関数の列$(f_j)\in\prod_{j\in\N}\M(\Omega_j)$を取る．$S:=\Brace{z\in\Om\mid\exists_{j\in\N}\;zはf_jの極}$と定めると，これは$\Omega$の離散集合で特に可算あるから\footnote{離散集合$S\mono\R^2$は，$\Q^2$が$\R^2$上稠密であるから，$\Q^2$への単射を持つはずだが，$\Q^2$の時点で可算集合であるから，$S$も可算．}，附番$S=\{z_l\}_{l\in\N}$が取れる．
            これに対して，$P_j\in\C[z]$を$P_l\paren{\frac{1}{z-z_l}}$が$f_j$の主要部となるように選ぶと，これは(2)の仮定より$f_j$の取り方に依らない．(1)が定める$\{z_j\}$と$\{P_j\}$に関する有理型関数$f\in\M(\Om)$は，当然$f-f_j\in\O(\Om_j)$を満たす．
            \item[(2)$\Rightarrow$(1)] 離散集合$\{z_j\}_{j\in\N}\subset\Omega$と対応する多項式の列$P_j\in\C[z]$を任意に取る．$\Om_j$を他の$z_i\;(i\ne j)$を含まない$z_j$の任意の近傍を取り，$f_j:=P_j\paren{\frac{1}{z-z_j}}\in\M(\Om_j)$とおく．そして，$\Om_0:=\Om\setminus\{z_j\}_{j\in\N},f_0:=0$とおく．$(\Om_j)$の取り方より，$\Om_j\cap\Om_k$は$j\ne k$のときそもそも極を取る点を含まないから，明らかに$f_j-f_k\in\O(\Om_j\cap\Om_k)$が成り立つ．
        \end{description}
        \item[(2)の証明] Cousinの第一問題\ref{problem-Cousin-I}から従う．$g_{jk}:=f_j-f_k\in\O(\Om_j\cap\Om_k)$と置くと，これはCousinの問題のcocycle条件を満たすから，解$(g_j)$が存在する．これに対して$f:=f_j+g_j\;(\on\Om_j)$と定めれば，$f$は$\Om$上で定まる．$(f_j+g_j)-(f_k+g_k)=(f_j-f_k)+(g_j-g_k)=g_{jk}+g_{kj}=0\;(\on\Om_j\cap\Om_k)$であるため．
    \end{description}
\end{proof}

\begin{problem}[Cousin I：]\label{problem-Cousin-I}
    領域$\Om$の可算開被覆$(\Om_j)_{j\in J}$と正則関数$g_{jk}\in\O(\Om_j\cap\Om_k)\;(j,k\in J,\Om_j\cap\Om_k\ne\emptyset)$が，cocycle条件
    \begin{align*}
        g_{jk}+g_{kj}&=0,\quad(\on\Om_j\cap\Om_k\ne\emptyset),&g_{jk}+g_{kl}+g_{lj}&=0,\quad(\on\Om_j\cap\Om_k\cap\Om_l\ne\emptyset),
    \end{align*}
    を満たすとする．このとき，必ず$g_j\in\O(\Om_j)$であって$g_{jk}=g_k-g_j\;(\on\Om_j\cap\Om_k\ne\emptyset)$を満たすものが作れるか？\footnote{作れる場合，cocycle条件（貼り合わせの条件）と大域的関数$g$の存在とが同値になる．}
\end{problem}
\begin{remark}
    すでに有理型関数という言葉も，$\Om$上の大域的関数にも言及されない形にまで還元されていることに注意．
    有理型関数を正則関数の貼り合わせの問題と見るというのが現代的な視点である．
\end{remark}

\begin{proposition}[$\Cinf$関数での解の存在]\label{prop-solution-to-Cousin-I-of-C-infty-functions}
    Cousinの第一問題\ref{problem-Cousin-I}は，$C^\infty$関数については常に解ける．
\end{proposition}
\begin{proof}
    領域$\Om$の可算開被覆$(\Om_j)_{j\in J}$と正則関数$g_{jk}\in\O(\Om_j\cap\Om_k)\;(j,k\in J,\Om_j\cap\Om_k\ne\emptyset)$を任意に取る．
    \begin{description}
        \item[構成] $\{\Om_j\}$に属する１の分割$\{\varphi_j\}_{j\in J}$を取る：
        \begin{itemize}
            \item $\varphi_j\in C^\infty(\Om)$，$\supp\varphi_j\subset\Om_j$．
            \item $\sum_{j\in J}\varphi_j=1$で局所有限：$\forall_{z\in\Om}\;\exists_{V:zの近傍}\;\abs{\Brace{j\in J\mid V\cap\supp\varphi_j\ne\emptyset}}<\infty$．\footnote{１の分割の存在は難しくて，まず連続関数で作ってから，modifierで滑らかにする．}
        \end{itemize}
        これに対して$g_j:=\sum_{k\in J}\varphi_k\cdot g_k\;(\on\Om_j)$とおく．ただし，$\varphi_kg_k$は$\Om_k$の外では$0$とする．すると，$g_j\in\Cinf(\Om_j)$である．
        \item[証明]
        $\Om_j\cap\Om_k\ne\emptyset$について，
        \begin{align*}
            g_j(z)-g_k(z)&=\sum_{l\in J}\paren{\varphi_l(z)g_{lj}(z)-\varphi_l(z)g_{lk(z)}}\\
            &=\sum_{j\in J}\varphi_l(z)\paren{g_{lj}(z)-g_{lk}(z)}\\
            &=g_{jk}(z)\sum_{j\in J}\varphi_l(z)&\because g_{jk}+g_{kl}+g_{lj}=0\\
            &=g_{jk}(z).
        \end{align*}
    \end{description}
\end{proof}
\begin{remark}
    １の分割の存在証明は難しくて，まず連続関数で作ってから，mollifierで滑らかにする．
    $\Cinf$関数なら貼り合わせが自由にできるが，正則関数では１の分割が作れない．
\end{remark}

\begin{example}[Cousin Iが解けない例と単連結性との関係の観察]
    $(g_{jk}),(g_j)$を定数関数として与えて簡単な例を作っても重要な示唆が得られる．
    領域として$\Om:=\Brace{z\in\C\mid 1<\abs{z}<2}$を考えると，これは単連結ではない（単連結性の特徴付け\ref{prop-characterization-of-simply-connectedness}）．
    しかし，３つの単連結な開集合$\Om_1,\Om_2,\Om_3\;(\Om_1\cap\Om_2\cap\Om_3=\emptyset)$で被覆でき，
    \begin{align*}
        g_{12}&=1,&g_{23}&=10,&g_{31}&=100,
    \end{align*}
    と定めれば，$(g_{jk})$はcocycle条件を満たしてしまうが，一次方程式
    \[\begin{cases}
        -g_1+g_2\hphantom{+g_3}&=g_{12}=1\\
        \hphantom{-g_1}-g_2+g_3&=g_{23}=10\\
        \hphantom{-}g_1\hphantom{-g_2}\;-g_3&=g_{31}=100
    \end{cases}\]
    は解を持たない．
    \[\det\begin{pmatrix}-1&1&0\\0&-1&1\\1&0&-1\end{pmatrix}=0.\]

    しかし，$\Om':=\Brace{z\in\C\mid\abs{z}<1}$と定めると，同じく３つの開集合$\Om'_1,\Om'_2,\Om'_3$で被覆できるが，$\cap_{i=1,2,3}\Om'_i\ne\emptyset$が成り立つときは（$\Om$の場合と異なり，このように取ることが可能であるが，もちろんこれを満たさない例も作れるであろう），値域の空間に条件$g_{12}+g_{23}+g_{31}=0$が加わるから，$\rank\begin{pmatrix}-1&1&0\\0&-1&1\\1&0&-1\end{pmatrix}=2$と併せると，これは解を持つ．

    これは，$\Om,\Om'\subset\C$では１次のcohomology群が異なることに起因する．そのため，単連結性\ref{prop-characterization-of-simply-connectedness}が肝要となるのである．
\end{example}

\section{Cauchy-Riemann方程式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=Cousinの第一問題を偏微分方程式の解の存在問題に帰着する]
    では正則関数はどうであるかというと，
    定数関数よりはたくさんあるが，
    滑らかな関数よりはない．
    この消息を探るためには，$\Cinf$関数の特殊化として正則関数を捉える視点が有用である．
    \textbf{Cousinの第一問題を微分方程式の問題に還元する視点が肝要}になる．

    $\forall_{g\in\O(D)}\;\exists_{f\in\O(D)}\;\pp{f}{z}=g$が成り立つとき，$D\subset\C$を単連結というのであった（単連結性の特徴付け\ref{prop-characterization-of-simply-connectedness}）．
    同様のことをCauchy-Riemann作用素$\o{\partial}$ \ref{def-CR-operator}で，さらに$\Cinf$関数について考える．
    これは正則凸という領域のクラス（ある意味で「連結性を仮定しない単連結」＝「任意の閉曲線が１点にhomotopic」）を定め，多変数関数論への入口となる．
\end{tcolorbox}

\begin{theorem}[コーシーリーマン作用素の全射性]\label{thm-Cauchy-Riemann-operator-is-epic}
    領域$\Om\subset\C$上の任意の$\Cinf$関数$f\in\Cinf(\Om)$に対して，$\pp{u}{\o{z}}=f$を満たす$\Cinf$関数$u\in\Cinf(\Om)$が存在する：$\forall_{g\in\Cinf(\Om)}\;\exists_{f\in\Cinf(\Om)}\;\pp{f}{\o{z}}=g$．
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[構成] 補題\ref{lemma-holomorphic-compact}より，正則凸なコンパクト集合の「狭義」単調増加列$(K_j)$で$\cup_{j\in\N}K_j=D$を満たすものを取る．
        各$K_j$に対して，$D$にコンパクトな台を持つ$C^\infty$関数$\psi_j\in C_0^\infty(D)$を，$K_j$の近傍で$1$になるように取る．$\psi_0=0$とする．これに対して，$\varphi_j:=\psi_j-\psi_{j-1}\;(j=1,2,\cdots)$とすると，$(\varphi_j)$は$C^\infty$級の１の分割である：
        \begin{enumerate}[(a)]
            \item $\varphi_{j+1}(=\psi_{j+1}-\psi_j)$は$K_j$の近傍で$0$なコンパクト台を持つ$C^\infty$関数，
            \item $\sum_{j=1}^\infty\varphi_j=1\;\on D$．
        \end{enumerate}
        実際，(b)については，局所有限であることによる．任意に$z\in D$を取ると，$\exists_{m\in\N_+}\;z\in K_m\land\varphi_j(z)=0\;(j>m)$であるから（すなわち$m=\min\Brace{j\in\N_+\mid z\in K_j}$），\[\sumj\varphi_j(z)=\sum_{j=1}^m\varphi_j(z)=\sum^m_{j=1}(\psi_j(z)-\psi_{j-1}(z))=\psi_m(z)-\psi_0(z)=1.\]

        ここで，任意に取った$g\in C^\infty(D)$に対して，$g_j:=\varphi_jg$と定めると，$\varphi_j$がコンパクトな台を持つことより，$g_j\in C_0^\infty(D)$である．
        すると補題\ref{lemma-existence-of-solution-to-PDE-when-compact-support}より，$\partial_{\o{z}}\wt{f}_j=g_j$を満たす$\wt{f}_j\in C^\infty(D)$が存在する．$g_j$は$K_{j-1}$の近傍で$0$なので，$\wt{f}_j\in\O(K_{j-1})$である（正則性の特徴付け\ref{thm-charactorization-of-complex-differentialability}）．
        すると，各$K_{j-1}$は正則凸であることから，Rungeの定理\ref{thm-Runge}(3)$\Rightarrow$(1)より，$\norm{\wt{f}_j-h_j}_{K_{j-1}}<2^{-j}$を満たす$h_j\in\O(D)$が存在する．これに対して$f_j:=\wt{f}_j-h_j$とおけば，$\partial_{\o{z}}f_j=\partial_{\o{z}}\wt{f}_j-\partial_{\o{z}}h_j=g_j-0=g_j$である．
        これに対して$f:=\sumj f_j$と定めると，これは各$K_l$上で一様収束するから，$D$上で広義一様収束する．\footnote{$D$内の任意のコンパクト集合$K$上で，任意の$\epsilon>0$に対して，$K_j$を十分大きく取れば良い．}
        このとき，$f$が滑らかで，$\partial_{\o{z}}f=g\;\on D$を示せば良い．
        \item[確認]
        任意の$\overset{\circ}{K}_m$上で$\partial_{\o{z}}f=g\;\on\overset{\circ}{K}_m$を示せば十分である．
        $K_m$上では，$f=\sum^m_{j=1}f_j+\sum_{j=m+1}^\infty f_j$と分解すると，第２項の無限和は，各項が$\norm{f_j}_{K_m}<2^{-j}\;(j>m)$と評価でき，また特に$f_j\in\O(K_m)$であるから，$K_m$上で一様収束する正則関数列である．したがって，第二項は全体として$\overset{\circ}{K}_m$上正則である（正則性の遺伝\ref{thm-propagation-of-regularity-through-compact-convergence}）．\footnote{$f_j$の定義域は$K_j$の近傍であるが，一様収束するための評価は$K_j$上でしか成り立たないので，結局正則性が遺伝するのは$\overset{\circ}{K}_j$上にて．}
        よって，\[\partial_{\o{z}}f=\sum^m_{j=1}\partial_{\o{z}}f_j=\sum^m_{j=1}g_j=g\sum^m_{j=1}\varphi_j=g\qquad\on\overset{\circ}{K}_m.\]
    \end{description}
\end{proof}
\begin{remarks}
    正則凸なコンパクト増大列（$\sigma$-有限性に似ている議論）を取って１の分割を構成し，これを用いてコンパクト台を持つ関数の議論を全体に持ち上げている．
    その途中での$C^\infty$級関数と正則関数との交錯が美しい．
\end{remarks}

\begin{lemma}[Cousinの第一問題の定理への還元への成功]
    定理\ref{thm-Cauchy-Riemann-operator-is-epic}の設定下では，Cousinの第一問題\ref{problem-Cousin-I}は正則関数について常に解ける．
\end{lemma}
\begin{proof}
    正則関数は特に$\Cinf$関数だから，
    正則関数についてのCousinの第一問題$(\Om_j),(g_{jk})$に対する，$\Cinf$解$(g_j)$が存在して，$g_j-g_k=g_{kj}\in\O(\Om_j\cap\Om_k)$を満たす\ref{prop-solution-to-Cousin-I-of-C-infty-functions}．
    問題の仮定より，各$g_{jk}$は正則だから，両辺を$\o{z}$で偏微分すると$\pp{g_j}{\o{z}}-\pp{g_k}{\o{z}}=0$（正則性の特徴付け\ref{thm-charactorization-of-complex-differentialability}）．
    したがって，関数$g:\Om\to\C$を$g=\pp{g_j}{\o{z}}\;\on\Om_j$を満たすように定めると，これは確かに$\Om$上全域で$\Cinf$級に定まる（重なっている部分で$\pp{g_j}{\o{z}}=\pp{g_k}{\o{z}}$であるため）．
    これに対して，$\pp{u}{\o{z}}=-g$を満たす$u\in\Cinf(\Om)$を取る（定理\ref{thm-Cauchy-Riemann-operator-is-epic}）．
    これに対して，$\wt{g}_k:=g_k+u$とおくと，これは正則で，Cousin Iの解となる．
    \begin{enumerate}
        \item $\pp{\wt{g}_k}{\o{z}}=\pp{g_k}{\o{z}}+\pp{u}{\o{z}}=g-g=0$より正則．
        \item $(\wt{g}_k)$は大域的な関数$g+u:\Om\to\C$を定め，cocycle条件を満たす．
    \end{enumerate}
\end{proof}

\begin{lemma}[解の存在の十分条件：コンパクト台]\mbox{}\label{lemma-existence-of-solution-to-PDE-when-compact-support}
    \begin{enumerate}
        \item (Cauchyの積分表示\ref{thm-Cauchy's-integral-expression}の$C^1$関数への一般化) $\Om$を区分的$C^1$級境界を持つ有界領域とする．任意の$f\in C^1([\Om])$に対して，
        \begin{align*}
            f(z)&=\frac{1}{2\pi i}\int_{\partial\Om}\frac{f(w)}{w-z}dw+\frac{1}{2\pi i}\int_\Om\frac{1}{w-z}\pp{f(w)}{\o{w}}dw\wedge d\o{w}\\
            &=\frac{1}{2\pi i}\int_{\partial\Om}\frac{f(w)}{w-z}dw-\frac{1}{\pi}\int_\Om\frac{1}{w-z}\pp{f(w)}{\o{w}}dudv\qquad(z\in D)
        \end{align*}
        が成り立つ（ただし，$w=u+iv$とした．$d\o{w}\wedge dw=2idu\wedge dv$に注意）．
        \item (コンパクト台を持つ$g$についての解の表示) $g\in\Cinf(D)$がコンパクトな台を持つとき，$g$は$\C\setminus D$では$g=0$と定義することが，$g$の$\C$への$\Cinf$級の延長を与えることから，
        \[f(z)=\int_\C\frac{g(w)}{w-z}\frac{dw\wedge d\o{w}}{2\pi i}=-\frac{1}{\pi}\int_\C\frac{g(z+w)}{w}dudv\]
        が定まり，$\pp{f}{\o{z}}=g$の解を与える．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $z$と$w$が衝突する際に非積分関数は正則性を失うので，$z$を含まない部分での積分族で近似すれば良い．
        任意の$\epsilon>0$について，$\Om_\ep:=\Om\setminus\Delta(z,\ep)$とおいて，$C^1$級1-形式$\frac{f(w)}{w-z}dw$に対して$\Om_\ep$上においてGreenの定理\ref{prop-Green}より，
        \begin{align*}
            d\paren{\frac{f(w)}{w-z}dw}&=d\paren{\frac{f(w)}{w-z}}\wedge dw\\
            &=\paren{\pp{}{w}\paren{\frac{f(w)}{w-z}}dw+\pp{}{\o{w}}\paren{\frac{f(w)}{w-z}}d\o{w}}\wedge dw\\
            &=\frac{1}{w-z}\pp{f(w)}{\o{w}}d\o{w}\wedge dw+f(w)\underbrace{\pp{\paren{\frac{1}{w-z}}}{\o{w}}}_{=0}d\o{w}\wedge dw\\
            &=-\frac{1}{w-z}\pp{f(w)}{\o{w}}dw\wedge d\o{w}
        \end{align*}
        に注意すれば，
        \[\int_{\partial\Om-\partial\Delta(z,\ep)}\frac{f(w)}{w-z}dw=-\int_{\Om_\ep}\frac{1}{w-z}\pp{f(w)}{\o{w}}dw\wedge d\o{w}\]
        を得る．$\epsilon\to0$を考えると，$\partial\Delta(z,\ep)$での積分は$2\pi if(z)$に収束する．これはCauchyの積分表示\ref{thm-Cauchy}(2)の証明と全く同一で，$f$の連続性のみから従う．
        \item 
        \[f(z)=-\frac{1}{\pi}\int_\C\frac{g(z+w)}{w}dudv\]
        を$\o{z}$で偏微分すると，$\Abs{\pp{g(z+w)}{\o{z}}}$は$z$に依らず$w$について可積分なので，Lebesgueの優収束定理より微分と積分の交換が可能で，
        \begin{align*}
            \pp{f}{\o{z}}&=-\frac{1}{\pi}\int_\C\pp{g(z+w)}{\o{z}}\frac{1}{w}dudv\\
            &=-\frac{1}{\pi}\int_\C\frac{1}{w-z}\pp{g(w)}{\o{z}}dudv
        \end{align*}
        これが$=g(z)$であることは次のようにしてわかる．$\supp g$は有界閉であるから，特に有界より，$\supp g\subset\Delta(0,R)$を満たす$R>0$が存在する．
        $\Om:=\Delta(0,R)$と置くとこれは区分的$C^1$級の有界閉領域だから，(1)より，
        \[g(z)=\frac{1}{2\pi i}\int_{\partial\Om}\frac{g(w)}{w-z}dw-\frac{1}{\pi}\int_\Om\frac{1}{w-z}\pp{g(w)}{\o{z}}dudv\]
        であるが，$\supp g\subset D$は有界閉であるから，特に閉より，$\partial D$上では$g=0$である．よって，
        \[\frac{1}{2\pi i}\int_{\partial\Om}\frac{g(w)}{w-z}dw=0\qquad\qquad\therefore\quad g(z)=-\frac{1}{\pi}\int_\Om\frac{1}{w-z}\pp{g(w)}{\o{z}}dudv.\]
    \end{enumerate}
\end{proof}

\begin{notation}
    領域$D$上で定義されたコンパクトな台を持つ$C^\infty$級関数全体からなる集合を$C_0^\infty(D)$で表す．
\end{notation}

\begin{lemma}[領域の「正則-コンパクト性」]\label{lemma-holomorphic-compact}
    任意の領域$D$に対して，コンパクト集合$K_j\subset D$の列$(K_j)$で，次を満たすものが存在する：
    \begin{enumerate}
        \item $K_1\subset\overset{\circ}{K_2}\subset K_2\subset\overset{\circ}{K_3}\subset K_3\subset\cdots$を満たす増大列で，$\cup_{j\in\N}K_j=D$．
        \item 各$K_j$は$D$で正則凸：$\forall_{j\in\N}\;\wh{K_j}_D=K_j$．
    \end{enumerate}
\end{lemma}
\begin{proof}
    \[L_j:=\Brace{z\in D\mid\dist(z,\partial D)\ge\frac{1}{j}かつ\abs{z}\le j}\]
    とおくと，$(L_j)$は(1)を満たすコンパクト集合の列である．

    これに対して，$K_j:=\wh{L_j}_D$とおくと，$K_j$もコンパクト\ref{remarks-convex-hull}で，(2)を満たす正則凸な集合である．
    $K_j\subset\overset{\circ}{K}_{j+1}$は明らかでないが，必要な$(K_j)$の部分列を取ることより，(1)を満たすようにできる．
\end{proof}
\begin{remarks}
    $\wh{\wh{K}}=\wh{K}$を用いて，コンパクト集合の正則凸包を取ることで，正則凸なコンパクト集合を構成する．
\end{remarks}

\section{Rungeの近似定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=岡の原理：関数論を位相的条件に還元する]
    コンパクト台を持つ$g\in\Cinf(D)$については解が存在することがわかった\ref{lemma-existence-of-solution-to-PDE-when-compact-support}．
    そこで，解析にはよくある発想で，一般の$g\in\Cinf(D)$に対して，$D$内にコンパクトな台を持つ関数の列$(g_n)$で近似し，$f:=\lim_{n\to\infty}f_n$と構成すれば，これは$\pp{f}{\o{z}}=g$を満たすのではないかという作戦が立つ．
    しかし$(g_n)$の積分の列$(f_n)$の収束性が問題になる．$f_n$を$\O(D)$において補正・近似することを考えるのがRungeの近似定理である（関数空間の稠密性）．
    すると議論が領域化される．

    コンパクト集合$K\subset D$に正則凸包の意味で「穴が空いていない」とき（$K=\wt{K}_D$），$K$上の正則関数は$D$上一様に近似できる．
    $K$を特に離散的に取ると，これは補間定理を意味する．
\end{tcolorbox}

\begin{notation}[コンパクト集合上の正則関数]
    コンパクト集合$K\subset D$に対して，$\O(K):=\cup_{K\subset U}\O(U)$を$K$の開近傍$U$で定まっている正則関数の集合と定める．すなわち，$f\in\O(K)$は，$f\in\O(U)$について$f|_K$を考えていることに相当する．
\end{notation}

\begin{definition}[holomorphically convex hull]\mbox{}
    \begin{enumerate}
        \item $V\subset D$が相対コンパクトであるとは，$V$の$D$に於ける閉包がコンパクトであることをいう．これは，$[V]\subset D$かつ$V$が有界であることに同値．よって，$V$が相対コンパクトでないことは，$\partial V\not\subset D$または$V$が非有界であることに同値．\footnote{「$D$で相対コンパクト」というときは，空間$D$内で閉包をとるわけだが，空間$D$には相対位相$D\mono\C$が入っている，ということである．}
        \item コンパクト集合上の正則関数の空間$\O(K)$に一様ノルムを$\norm{f}_K:=\max_{z\in K}\abs{f(z)}$で定める．
        \item コンパクト集合$K\subset D$に対して，$\wh{K}_D:=\Brace{z\in D\mid\forall_{f\in\O(D)}\;\abs{f(z)}\le\norm{f}_K}$を，$K$の$D$に於ける\textbf{正則凸包}という．
        \item $K=\wh{K}_D$が成り立つとき，$K$は$D$で\textbf{正則凸}であるという．これが近似可能性の特徴付けになる（Rungeの近似定理\ref{thm-Runge}）．
        \item 領域$D$が正則凸であるとは，任意のコンパクト集合$K\subset D$に対して，$\wh{K}_D$も$D$内でコンパクトになることをいうようだ．
    \end{enumerate}
\end{definition}
\begin{remarks}[正則凸包とは？]\label{remarks-convex-hull}
    正則凸包の条件は最大値の原理のようなことを言っていて「最大値の原理が成り立つ集合」とも読める．
    また，正則凸包は閉集合である：$\wh{K}=\bigcap_{f\in\O(\C)}\Brace{z\in\C\mid\abs{f(z)}\le\norm{f}_K}$．\footnote{一般の領域$D\subset\C$については，$D$で閉であることしか言えてないわけであるが，境界点$a\in\partial D$について$D$上の正則関数$f(z)=\frac{1}{z-a}\in\O(D)$を考えると，$a$での$\C$の開近傍は十分小さくとれば$\wt{K}_D$とは交わらない．よって，$\wh{K}_D$は$\C$でも閉だとわかる．このような都合の良い関数が取ってこれるのが一変数の特徴であるという．}
    そして，特に$f=\id$の場合を考えることで，$\abs{z}\le\norm{\id}_K$を満たす必要があるから，有界でもある．
    （実はこうして$\wh{K}_D$が再びコンパクトになるのは，$D$が領域だからである．）
    正則凸包は初めは抽象的に感じるかもしれないが，非常に有効で解析学に遍く使われる手法である．
    Rungeの近似定理\ref{thm-Runge}の(2)$\Leftrightarrow$(3)より，\textbf{$\wh{K}_D$とは，$K$に対して，$D\setminus K$の相対コンパクトな連結成分（＝$D$にすっぽり包まれている有界集合）を合併したものになる}ことが解る．
    したがって，$K=\wh{K}_D$であるとは，$K$は「任意のループが１点にhomotopicである」という意味で「単連結」であることだとも言える．\footnote{一般に単連結であるというときは基本群を考えるので連結性を仮定する．}
\end{remarks}
\begin{remark}[convex hullでみる凸包に対する直感]
    「線型凸包」の概念になら直感が効く．
    コンパクト集合$K\subset\R^n$に対して，線型写像に関する同様の定式化
    \[\wh{K}_D:=\Brace{x\in\R^n\mid\forall_{f\in\Hom_\R(\R^n,\R)}\;f(x)\le\sup_{w\in K}f(w)}\]
    は$K$の凸包（$K$を含む最小の凸集合）を定める．\footnote{平面上あるいは低次元ユークリッド空間内の有限点集合に対してその凸包を計算するアルゴリズム問題は、計算幾何学の基本的問題の一つである。凸包問題はパターン認識，地理情報処理などに広く応用される．パターン認識の分野においては，平面上の$m,n$点からなる２つの集合があるとき，それぞれについて凸包を作り，これが線型分離可能ならば，２つの集合は本質的に異なると見なすことが多い．２次元において，有限離散集合の凸包は多角形になる．}
    これは，線型写像$f:\R^n\to\R$が定数で抑えられる$f(x)<c$という条件は$\R^n$上に超平面によって指定される半平面を定め，これがあらゆる「測量の仕方」$f\in\Hom_\R(\R^n,\R)$について成り立つことは凸性を表す．
    これを一般化して，調和関数・劣調和函数についての凸包なども考えられる．
\end{remark}

\begin{theorem}[Runge's approximation theorem (1885)]\label{thm-Runge}
    領域$D$内のコンパクト集合$K\subset D$に対して，次の３条件は同値である．
    \begin{enumerate}
        \item (関数論) 任意の$f\in\O(K)$が$D$上の正則関数で一様に近似可能である：$\forall_{f\in\O(K)}\;\forall_{\ep>0}\;\exists_{g\in\O(D)}\;\norm{f-g}_K<\ep$．\footnote{$D=\C$の場合も含意している点に注意．この場合は，Taylor展開を考えれば，「多項式近似が出来るか？」という問題と同値．こちらの方をRungeの定理と呼ぶことが多い．}
        \item (位相) $D\setminus K$は$D$上相対コンパクトな連結成分を持たない．
        \item (中間：正則凸) $K=\wh{K}_D$．
    \end{enumerate}
\end{theorem}
\begin{proof}
    (3)$\Rightarrow$(2),(2)$\Leftrightarrow$(1),そして(2)$\Leftrightarrow$(1)を既知として(1)$\Rightarrow$(3)を示す．
    \begin{description}
        \item[(3)$\Rightarrow$(2)] 
        対偶を示す．(2)が成り立たない，すなわち，$D\setminus K$が$[V]\subset D$を満たす有界な連結成分$V$を持つと仮定して，$z\in\wh{K}_D$を満たす$z\in D\setminus K$を構成する．このとき特に$\partial V\subset D$である．
        \begin{enumerate}[(a)]
            \item いま，$\partial V\subset K$が成り立つ．実際，任意の$a\in\partial V$について，$\partial V\subset D$より$a\in D$でもある．領域$D$は開集合より，$\exists_{\ep>0}\;\Delta(a,\ep)\subset D$である．よって，$V$が連結成分であることより，任意の$0<\ep'\le\ep$に対して，$\Delta(a,\ep')\cap K=\Delta(a,\ep')\setminus D\ne\emptyset$が成り立つ．これは$a$が$K$の触点であることを意味し，$K$が閉集合であることより$a\in K$が従う．
            \item したがって，$\partial V\subset K$より，この相対コンパクトな連結成分$V$の点$z\in V$を取れば，最大値の原理\ref{cor-maximum}より，
            \[\abs{f(z)}\le\max_{w\in\partial V}\abs{f(w)}\le\norm{f}_K\quad\forall_{f\in\O(D)}\]
            という評価が常に出来るから，$z\in\wh{K}_D$となる．$z\in V\subset D\setminus K$より(3)は成り立たない．
        \end{enumerate}
        \item[(1)$\Rightarrow$(2)]
        対偶を示す．(2)が成り立たない，すなわち，$D\setminus K$が$[V]\subset D$を満たす有界な連結成分$V$を持つと仮定して，$D$上の正則関数の列$(f_n)$で，正則関数に収束しないものを構成する．
        \begin{enumerate}[(a)]
            \item 任意の$a\in V$に対して，$f(z):=\frac{1}{z-a}\in\O(K)$であり，$\norm{f_n-f}_K\to0$を満たす$\O(D)$の関数列$(f_n)$が存在すると仮定して矛盾を導く．
            \item $f_n$はノルム$\norm{\cdot}_K$に関するCauchy列なので，$\norm{f_n-f_m}_{[V]}\le\norm{f_n-f_m}_{\partial V}\le\norm{f_n-f_m}_K$より，$\norm{\cdot}_{[V]}$に関してもCauchy列になる．
            \item そこで，$f_n$の$[V]$上での（一様）収束極限を$f_\infty\in\O(V)\cap C([V])$とすると，$[V]$上での連続性より，$\partial V$上でも$(z-a)f_\infty(z)=1$が成り立つ．よって，一致の定理より，$[V]$上でも$(z-a)f_\infty(z)=1$が成り立つが，これは$f_\infty$が$a$で正則であることに矛盾する．
        \end{enumerate}
        \item[(2)$\Rightarrow$(3)] 
        $K\subset\wh{K}_D$は明らかなので，$K\supset\wh{K}_D$を示せば良い．
        対偶命題$a\notin K\Rightarrow a\notin\wh{K}_D$を示す．
        \begin{enumerate}[(a)]
            \item 任意の$a\in D\setminus K$を取り，$a$を含む$D\setminus K$の連結成分を$V$とする．(2)の仮定より，$V$は相対コンパクトではない．
            $V$は開集合だから，$\epsilon>0$が存在して，$V\setminus[\Delta(a,\ep)]$であり，$D$上相対コンパクトではない（相対コンパクトでないことは$\partial V\not\subset D$または$V$が非有界であることと同値で，いずれの性質も明らかに保たれる）．
            よって，$K':=K\cup[\Delta(a,\ep)]$も(2)の仮定を満たすから，(1)の近似が成り立つ．
            \item $f\in\O(K')$として$f=\chi_{[\Delta(a,\ep)]}$を取ると，(1)より，$\max_{z\in K}\abs{f(z)-g(z)}<\frac{1}{3}$を満たすような$g\in\O(D)$が存在する．したがって，$f$は$K$上では$0$で$[\Delta(a,\ep)]$上では$1$だから，
            \[\abs{g(a)}\ge\frac{2}{3}>\frac{1}{3}>\max_{z\in K}\abs{g(z)}\]
            となり，これは$a\notin\wh{K}_D$を意味する．
        \end{enumerate}
        \item[(2)$\Rightarrow$(1)] 
        任意に$f\in\O(K)$を取ると，$f$の定義域を$K\subset U\osub D$とすると，$f\in\O(U)$でもある．$f$を一様に近似する$D$上の正則関数の列を，まず$f$を$\partial U(\subset D\setminus K)$上に極を持つ有理関数$R$で$K$上一様に近似してから，有理関数$R$を$\partial D$上（$D=\C$などの場合は十分遠くに）に極を持つ有理関数で$K$上一様に近似することで，有理関数に注目して構成する．
        \begin{enumerate}
            \item Cauchyの積分表示の被積分関数が$z$の有理式であり，それが一様連続であるために，Riemann和を任意制度で取ることができる．$F$のRiemann和とは有理関数の和で，有理関数である．
            
            $U$は有界としても良い．$f:=\dist(K,\partial U)>0$とする．$\C$を一辺$d/2$の正方形に分割し，$U$に含まれる閉正方形を附番し，$E_1,\cdots,E_n$とする．$E:=\cup_{j=1}^nE_j$と定めると，これは$U$に含まれるコンパクト集合で，$K\subset E\subset U$である．よって，$z\in K$上で$f(z)=\frac{1}{2\pi i}\int_{\partial E}\frac{f(\zeta)}{\zeta-z}d\zeta$が成り立つ\ref{thm-Cauchy's-integral-expression}．

            この被積分関数$F(z,\zeta):=\frac{1}{2\pi i}\frac{f(\zeta)}{\zeta-z}$は，コンパクトな定義域$(z,\zeta)\in\partial\times K$上一様連続なので，特に$\forall_{\epsilon>0}\;\exists_{\delta>0}\;\abs{\zeta-\zeta'}<\delta,z\in K\Rightarrow\abs{F(z,\zeta)-F(z,\zeta')}<\epsilon$が成り立つ．
            よって，折線$\partial E$を長さ$\delta$以下の線分$[\zeta_j,\zeta_{j+1}]\;(j\in N)$に分割すれば，このRiemann和$R(z):=\frac{1}{2\pi i}\sum^N_{j=1}F(z,\zeta_j)(\zeta_{j+1}-\zeta_j)$は$z$のRiemann和とは有理関数で，任意の$z\in K$に対して次の評価を満たす：
            \begin{align*}
                \abs{f(z)-R(z)}&\le\frac{1}{2\pi}\Abs{\sum^N_{j=1}\int_{[\zeta_j,\zeta_{j+1}]}(F(z,\zeta)-F(z,\zeta_j))d\zeta}\\
                &\le L(\partial E)\epsilon.
            \end{align*}
            \item 
            任意の$j\in n$について，$\zeta_j\in D\setminus K$を含む連結成分$V$を取ると，仮定(2)より$[V]\subsetneq D$または$V$は非有界である．
            \begin{description}
                \item[$V$の閉包が$D$をはみ出るとき] $\zeta'_j\in\partial V\cap\partial D$が存在して，$V\subset D\setminus K$が連結より，$K$と交わらない長さ確定な曲線で$\zeta_j,\zeta_j'$を結ぶことができるから，補題\ref{lemma-transportation-of-poles-of-rational-functions}より，$R$の第$j$項$\frac{F(z,\zeta_j)(\zeta_j-\zeta_{j+1})}{2\pi i}$は$\zeta_j'$にのみ極を持つ有理式$R_j$で$K$上一様に近似できる．
                \item[$V$が非有界のとき] $\zeta_j'\in V$であって，$K\subset\Delta(0,\abs{\zeta_j'})$を満たすように出来る．$V$は連結だから$\zeta_j,\zeta_j'$は$K$と交わらない長さ確定な曲線で結べて，補題\ref{lemma-transportation-of-poles-of-rational-functions}より，$\frac{F(z,\zeta_j)(\zeta_{j+1}-\zeta_j)}{2\pi i}$は$\zeta_j'$に極を持つ有理関数$\wt{R}$で$K$上一様に近似できる．
                すると，$\wt{R}$の$0$でのTaylor展開は$\Delta(0,\abs{\zeta_j'})$上広義一様収束，$K$上一様収束するから，これを有限項で止めて得る多項式$R$で$K$上一様に近似できる．
            \end{description}
            以上より，有理式$\sum_{j=1}^nR_j$によって$f$を$K$上一様に近似できる．
        \end{enumerate}
    \end{description}
\end{proof}
\begin{remarks}\mbox{}
    \begin{enumerate}
        \item (2)の反例としては，$D=\Delta(0,10),K=[\Delta(0,2,3)]$が考えられる．$D\setminus K$の連結成分のうち単連結な方の点$a$について，関数$\frac{1}{z-a}$は$\O(K)$の元ではあるが，$a\in D$に極を持つため$\O(D)$の元ではない．近似しようとすると最大値の原理が崩れることになる．
        \item しかし，$D=\Delta(0,1,10)$とすると問題がない．$D\setminus K$の２つの連結成分の閉包はいずれも$D$に完全には含まれておらず，いずれも相対コンパクトではない．$a\in D\setminus K$について，これを極とする正則関数を考えても，実は$\C\setminus D$のコンパクトな連結成分内に極を持つ有理式で近似可能である．
        \item (2)$\Rightarrow$(3)の証明はRungeの近似定理の威力の良い証左となっている．$f=\chi_{[\Delta(a,\ep)]}\in\O(K)$は$D$上に延長できない．できたとすると，一致の定理より$f=0\land f=1$である必要があり，これは矛盾．しかし，任意の正数で誤差を指定すれば，その範囲内では延長できるのである．
        \item (2)$\Rightarrow$(1)について，Cauchyの積分表示の被積分関数$F$が$z$の有理式であることに注目し，Riemann和を任意精度で取ることができることを一様近似に活用する．$F$のRiemann和とは有理関数の和で，有理関数である．こんな美しい手法思いついてみたい．正方形分割で積分路を作るこの証明は創作の息吹を感じるが，数学としては，statementが$\O(K)\overset{\textrm{dense}}{\supset}\O(D)|_K$の稠密性を表しているので，$\O(K)$をBanach空間と見て，Hahn-Banachの定理から証明できる．
    \end{enumerate}
\end{remarks}

\begin{lemma}[有理式の極の曲線に沿った移動]\label{lemma-transportation-of-poles-of-rational-functions}
    $K\subset\C$をコンパクト集合，$\gamma:[0,1]\to\C$を$K$と交わらない長さ確定な曲線とする．\footnote{$C^1$級曲線は長さ確定である\ref{thm-C1-length-definedness}．}
    この時，$\gamma(0)$にのみ極をもつ有理関数は，$\gamma(1)$にのみ極を持つ有理関数で，$K$上一様に近似できる．
\end{lemma}
\begin{proof}\mbox{}
    \begin{description}
        \item[方針] $d:=\dist(\Im\gamma,K)>0$($\Im\gamma\cap K=\emptyset$より)とおき，$[0,1]$の細分$0=t_0<t_1<\cdots<t_n=1$を$\gamma([t_j,t_{j+1}])$の長さが$d/3$以下になるようにとる．
        ($\gamma$が長さ確定な曲線のとき，連続性からこの操作ができる)．
        これについて，任意の$j\in n$について，
        任意の$a:=\gamma(t_j)$にのみ極をもつ有理関数は$R(z)=\sum_{l=-N}^ma_l(z-a)^l$と表せるから，これを$b:=\gamma(t_{j+1})$にのみ極を持つ有理関数で$K$上一様に近似すれば良い．これを$n$回繰り返せば，誤差は$n\epsilon$で評価できるためである．
        \item[証明]
        $R$は，$a$（と$\infty$）にのみ極を持つから，$b$を中心とした円環$\Delta(b,\abs{a-b},\infty)$上で正則より，この上でのLaurent展開$R(z)=\sum_{l=-\infty}^mb_l(z-b)^l$が存在する\ref{thm-decomposition-of-holomorphic-function}．\footnote{$b$に極を持つ成分については，$R$の$a,b$周りでの振る舞いは指定されていないので，真性特異点の可能性もあり，Laurent展開の主要部は無限項の可能性がある．しかし，$\infty$を特異点とする成分については，$\infty$は$m$位の極であるという性質は変わってはいけないので，Taylor展開が$m$次で停止する．}
        これは円環$\Delta(a,\abs{a-b},\infty)$上で広義一様収束するため，特に$K$上で一様収束する．
        このLaurent展開の主要部を，十分大きい$M>0$次の項で切れば，$\sum^m_{-M}b_l(z-b)^l$は$R$との誤差（一様ノルム$\norm{\cdot}_K$による距離）を$z\in K$上一様に，任意に小さくできる．
    \end{description}
\end{proof}
\begin{remarks}
    本質は「証明」部分で，十分細かく分割すれば，$K$を排斥したまま円環$\Delta(b,r,\infty)$であって，有理関数$R$がその上で正則であるようなものが取れる．
    これのLaurent展開を取ることが，「一様に近似」に当たるのである．
\end{remarks}

\begin{tbox}{red}{}
    正則凸包についてRungeの定理が含意することと，線型凸包との関係を，関数解析（Hahn-Banachの定理）の観点から考えてみたい．
    $n\ge 2$のとき，$K\subset D\subset\C^n$について，$\wt{K}_D$を求めるのは難しく，位相だけからは定まらなくなるので，函数解析から離陸してしまう，とのこと．
\end{tbox}

\section{Weierstrassの定理と補間定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Cauchy-Riemann作用素$\partial_{\o{z}}:C^\infty(D)\epi C^\infty(D)$の全射性\ref{thm-Cauchy-Riemann-operator-is-epic}を用いて，零点を指定して正則関数を構成することを考える．
    証明の方針は２段階で，まず$\Cinf$関数の理論（台をうまく取った関数）を用いて$\Cinf$関数を構成し，Cauchy-Riemann方程式の全射性を用いて補正する方法を考える．
    \begin{itemize}
        \item Weierstrassの零点からの構成$\Map(Z,\N_+)\to\O(D)$．
        \item 補完定理：$Z$上での値からの正則延長の存在．
    \end{itemize}
\end{tcolorbox}

\begin{lemma}\label{lemma-branch-of-log}
    $a,b\in\C$を結ぶJordan曲線（自己交叉のない曲線）$\gamma:[0,1]\mono\C$について，$\C\setminus[\gamma]$上では多価関数$\log\frac{z-a}{z-b}$の１価の分枝が存在する．
\end{lemma}
\begin{proof}
    一次分数変換$F(z):=\frac{z-a}{z-b};\hatC\iso\hatC$により，$\Im\gamma$は$0$と$\infty$を結ぶ$\hatC$内のJordan曲線$F(\Im\gamma)$に写る（単射の合成は単射）．
    よって，$D:=\hatC\setminus[\Im\gamma]$の像$F(D)$は，連結集合$F([\Im\gamma])$の補集合なので，$0$を含まない単連結領域である（単連結性の特徴付け\ref{prop-characterization-of-simply-connectedness}）．
    よって，$F(D)$上には正則関数$\log:F(D)\to\C$が定まる\ref{lemma-existence-of-log}（$F(D)$は原点を含まないので，$\log w$の$w\in F(D)$は$F(D)$上零点を持たないことに注意）．
    以上より，$\log\circ F:\C\setminus[\gamma]\mono\hatC\setminus[\gamma]\iso F(D)\to\C$は正則．
\end{proof}

\begin{theorem}[Weierstrass]\label{thm-Weierstrass-zero}
    領域$D\subset\C$内の$D$上に集積点を持たない\footnote{$D$の点であって，全ての開近傍が$Z$に交わってしまうような点がない．任意の$z\in D$が$Z\cup\{z\}$の孤立点であることをいう}離散部分集合$Z\subset D$を考える．写像$m:Z\to\N_+$に対して，$f\in\O(D)$であって，$f$の零点は$Z$のみで，$a\in Z$での零点の位数が$m(a)$であるようなものが存在する．
\end{theorem}
\begin{proof}
    $D=\C$の場合は定理\ref{thm-Weierstrass-pre}で示したから，ここでは$D\ne\C$すなわち$\partial D\ne\emptyset$の場合を考える．
    まず，零点が$Z$のみで，各零点$a\in Z$の近傍$U_a$では$g(z)=(z-a)^{m(a)}h_a(z)\;(h_a\in\O(U_a))$と表示できる（したがって正則）であるような$C^\infty$級関数$g\in\Cinf(D)$を構成する，位相幾何の問題を解く．
    次に，これを補正して$D$上正則にすることを考える．
    \begin{enumerate}
        \item 
    \begin{description}
        \item[準備] 任意の$a\in Z$に対して，$d:=\dist(a,\partial D)\;(\partial D\ne\emptyset)$とし，$\abs{b-a}=d$を満たす$b\in\partial D$をとる．$Z$は$D$上離散的なので，$a$と$b$を連結集合$(\Delta(a,d)\setminus Z)\cup\{a,b\}$内でJordan曲線$\gamma$を用いて結ぶことができる．
        このJordan曲線の補集合$D\setminus[\Im\gamma]$では対数関数の分枝が定まるが，$[\Im\gamma]$上では定まらない．この問題を克服するために，$[\Im\gamma]$の近傍で$1$となる滑らかな関数を定める．
        まず$\Im\gamma$の$\Delta(a,d)$での近傍$V$を，$Z\setminus\{a\}$と交わらないように選ぶ（$\Im\gamma$上の各点でこのような近傍をとって合併すれば良い）．
        そして，$\rho_a\in\Cinf(D)$であって，$\supp\rho_a\subset V$かつ$\rho_a$は$\Im\gamma$の$\Delta(a,d)$でのさらに小さい近傍上で$1$となるものを取る．\footnote{取れるのか？}
        \item[構成]
        $D\setminus[\Im\gamma]$上には$\log\paren{\frac{z-a}{z-b}}$の分枝が定まる\ref{lemma-branch-of-log}から，
        \[g_a(z):=\begin{cases}
        \exp\paren{m(a)\rho_a(z)\log\frac{z-a}{z-b}},&z\in D\setminus[\Im\gamma],\\
        \paren{\frac{z-a}{z-b}}^m,z\in[\Im\gamma].
        \end{cases}\]
        と定めると，$\rho_a$が$[\Im\gamma]$の近傍で$1$なので$D\cap[\Im\gamma]$上で$\Cinf$級に繋がり，$g$は$D$上$\Cinf$級に定まる．そして，$a$にのみ$m$位の零点をもち，$a$の近傍で表示$\paren{\frac{z-a}{z-b}}^m$の表示を持つわけだから，正則である．
        \item[総合] $\rho_a$は（少なくとも）$V$の外では$0$としたので$g_a$は$1$であるから，
        $\supp(g_a-1)\subset\supp\rho_a\subset\Delta(a,d)$なので，$(\supp(g_a-1))_{a\in Z}$は局所有限だから，$g:=\prod_{a\in Z}g_a$は各点において有限項を除いて$1$で，$a\in Z$にのみ$m(a)$位の零点をもち，その近傍で正則である．
    \end{description}
    \item この$g\in\Cinf(D)$を補正して正則にすることを考える．
    零点を増やさぬように，$h\in\Cinf(D)$を用いて$f(z):=g(z)e^{h(z)}$の形で正則関数$f\in\O(D)$構成することを考える．
    そのためには，
    \[\pp{}{\o{z}}(ge^h)=e^h\paren{\pp{g}{\o{z}}+g\pp{h}{\o{z}}}\]
    であるから，$\pp{h}{\o{z}}=-\frac{1}{g}\pp{g}{\o{z}}$を満たす$h\in\Cinf(D)$を構成すれば良い．

    右辺$-\frac{1}{g}\pp{g}{\o{z}}$は$g$の零点$a\in Z$上で値が定まらないことが問題だが，
    $g$は$a$の近傍$U_a$上正則なので，$\frac{-1}{g}\pp{g}{\o{z}}$は$U_a\setminus\{a\}$上では零だから，$a$でも$g(a)=0$と定めると，$D$全体で$\Cinf$級に定まっている．
    よって，Cauchy-Riemann作用素の全射性\ref{thm-Cauchy-Riemann-operator-is-epic}より，$h\in\Cinf(D)$が取れる．よって，$f\in\O(D)$が定まる．
    \end{enumerate}
\end{proof}
\begin{remarks}
    これまた極めて手作り感のある証明で，(1)の位相幾何の問題（２次のcohomologyが$H^2(D,\Z)=0$である）は複素平面の各種性質を駆使して逍遥遊しているような感覚である．（零点$Z$の分布によっては解けないことも十分ある）．
    Mittag-Lefflerの定理\ref{thm-Mittag-Leffler}とはまた違った消息で，１の分割で位相幾何的な議論を迂回することができないことが肝要となる．
    なお，層のコホモロジーを使うと，Cousinの問題と同じように解決できる．Cousin IIも同様な位相的な障害に阻まれるが，同様のcohomologyの問題$H^2(D,\Z)=0$に行き着く．
\end{remarks}

\begin{theorem}[補間定理]
    $D\subset\C$を領域，$Z\subset D$をその離散部分集合とする．
    任意の関数$f:Z\to\C$は正則関数$\o{f}:D\to\C$に延長できる．
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[$\Cinf$級での構成] まず，$\Cinf$級の延長$g:D\to\C$を考える．
        $Z=:\{a_j\}_{j\in\N}$が有限集合ならば$f$として多項式を取れば良いから，可算無限の場合を考える．\footnote{非可算無限ならば集積点を持つ？}
        $Z$の離散性より，各$d_j>0$が存在して，$B_j:=\Delta(a_j,d_j)$が互いに交わらないようにできる．このとき，$\rho_j\in\Cinf(D)$を$\supp\rho_j\subset B_j$かつ$a_j$の近傍では$\rho_j=1$となるようにとり，$g(z):=\sumj\rho_j(z)f(a_j)$と定めると，$g\in\Cinf$であり，$f$の$\Cinf$延長となっている．
        \item[正則に補正]
        この$g$を$Z$上での値を変えずに正則にすることを考える．$h\in\O(D)$を，$Z$に一位の零点を持つような正則関数とする（Weierstrassの定理\ref{thm-Weierstrass-zero}）．
        これに対して$\o{f}:=g+\psi\;(\psi\in\Cinf(D))$とおくと，$\o{f}(a)=g(a)$であるから，あとは$\o{f}\in\O(D)$となるように$\psi\in\Cinf(D)$を選べば良い．
        これは，
        \begin{align*}
            \pp{\o{f}}{\o{z}}=0&\Lrarrow\pp{g}{\o{z}}+h\pp{\psi}{\o{z}}=0\\
            &\Lrarrow\pp{\psi}{\o{z}}=\frac{1}{h}\pp{g}{\o{z}}
        \end{align*}
        を満たす$\psi\in\Cinf(D)$を取れば良いのだが，いま$g$は$Z$の近傍で定数としたから，$\partial_{\o{z}}g$は$Z$の近傍で$0$．よって，$\frac{1}{h}\pp{g}{\o{z}}$が定義できない範囲では$0$と定めれば，これは$D$上$\Cinf$級とみなせる．
        よってCauchy-Riemann作用素の全射性\ref{thm-Cauchy-Riemann-operator-is-epic}から従う．
    \end{description}
\end{proof}

\section{正則領域}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    正則関数が自然に生息するのはどんな場の上にであろうか．
    実は一次元の場合は，全ての開集合が正則領域となる．
    この証明はWeierstrassの定理\ref{thm-Weierstrass-zero}と一致の定理\ref{cor-identity-theorem}による．
\end{tcolorbox}

\begin{definition}[domain of holomorphy]\mbox{}
    \begin{enumerate}
        \item 領域$D$上の正則関数$f\in\O(D)$に対して，次が成り立つとき，$D$を$f$の\textbf{存在領域}という：$\forall_{p\in\partial D}\;\forall_{p\in U:近傍}\;\forall_{g\in\O(U)}\;\forall_{V\subset D\cap U:連結成分}\;f\ne g\;\on V$．\footnote{例えば$\log$について$\C\setminus[0,\infty)$は存在領域ではない．$3\in[0,\infty)$の近傍$\Delta(3,1)$上全域では$\log$に一致させられないが，$\Delta(3+1/2i,1/2)$上で一致するような延長は存在する．Riemann面の言葉で表現するともっとスッキリするだろう．}
        \item $f$を特に指定しないとき，一般に\textbf{正則領域}という．
    \end{enumerate}
\end{definition}

\begin{theorem}
    任意の領域$D\subsetneq\C$はある正則関数$f\in\O(D)$の存在領域である．
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[構成] 任意の領域$D\subsetneq\C$に対し，$\partial D\ne\emptyset$なので，$D_j:=\Brace{z\in D\mid\dist(z,\partial D)<\frac{1}{j}}$とおく．$Z:=\cupj \paren{D_j\cap\paren{\frac{1}{2^j}\Z+\frac{i}{2^j}\Z}}$とすると，これは$D$内の離散集合で，$\partial D$の全ての点を集積点とする（任意の$z\in\partial D$の任意の近傍は$Z$と交わる）．すると，Weierstrassの定理\ref{thm-Weierstrass-zero}より，この離散集合$Z$上に零点を持つ正則関数$f\in\O(D)$が存在する．
        \item[確認] 仮にこの$f$が，境界点$a\in\partial D$のある近傍$U$上での正則な関数$g\in\O(U)$であって，$D\cap U$のある連結成分上で$f$に一致するものが存在すれば，？？？
        ともかく，境界点$a\in\partial D$の近傍での正則な延長が存在するとしたら，零点は$a$に集積するので一致の定理より$f=0$が必要だが，これは矛盾．
    \end{description}
\end{proof}
\begin{remark}
    円板上では具体的に構成可能で，Riemannの写像定理で単連結領域上にも具体的に構成可能である．
\end{remark}

\section{多変数の正則関数への拡張}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=一変数と多変数で同じところ]
    基本的な結果は素直に拡張できるが，正則関数の存在域というのが恐ろしく掴みにくくなる．
    現在は一般の複素多様体上のDolbeault operatorと複素多様体上のde Rham cohomologyの理論をDolbeault cohomologyの理論でまとめられているようだ．
\end{tcolorbox}

\begin{definition}[Dolbeault operator]\mbox{}
    \begin{enumerate}
        \item 領域$D\subset\C^n$上の$C^1$級複素数値関数$f\in C^1(D)$が\textbf{正則}であるとは，次が成り立つことをいう：$\forall_{j\in[n]}\;\pp{f}{\o{z}_j}=0$．
        \item 微分作用素$\o{\partial}:\Omega^0(D)\to\Omega^1(D)$を$\o{\partial}f:=\sum_{j=1}^n\partial_{\o{z}_j}fd\o{z}_j$と定めれば，正則条件は$\o{\partial}f=0$と表せる．
    \end{enumerate}
\end{definition}

\begin{theorem}[Cauchyの積分表示]\label{thm-Cauchy-integral-expression-multivariable}
    任意の点$a=(a_1,a_2)\in D$に対して，十分大きな$r_1,r_2>0$が存在して，$(z_1,z_2)\in\Delta(a,r)$上で次が成り立つ：
    \[f(z)=\frac{1}{(2\pi i)^2}\int_{\abs{z_1-a_1}=r_1}\int_{\abs{z_2-a_2}=r_2}\frac{f(\zeta_1,\zeta_2)}{(\zeta_1-z_1)(\zeta_2-z_2)}d\zeta_1d\zeta_2\]
    ただし，$[\Delta(a_1,r_1)]\times[\Delta(a_2,r_2)]\subset D$を満たす範囲で．
\end{theorem}
\begin{proof}
    多変数正則関数は各変数ごとにも正則だから，Cauchyの積分表示を変数毎に適用することで得られる．
\end{proof}

\begin{theorem}[多変数複素関数の冪級数展開]
    任意の$a\in D$について，その近傍上で
    \[f(z)=\sum_{j,k=0}^\infty A_{jk}(z_1-a_1)^j(z_2-a_2)^k\]
    が成り立つ（特に$\Delta(a_1,r_1)\times\Delta(a_2,r_2)$で収束）．
\end{theorem}
\begin{remark}
    しかし，正確にどのような領域上で収束するかの議論は難しく，収束半径のような指標はない．正則凸性の概念が開発された．
\end{remark}

\begin{theorem}[一致の定理]\label{thm-identity-multivariable}
    $f\in\O(D)$が空でない開集合上で零であれば，零関数である．
\end{theorem}
\begin{proof}
    冪級数展開が零になる領域が開かつ閉であるため．
\end{proof}

\section{多変数のCauchy-Riemann方程式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=一変数と多変数で違うところ：Hartogs現象]
    $\Cinf$級関数から$\Cinf$級1-形式へのCauchy-Riemann作用素$\o{\partial}:\Omega^0(D)\to\Omega^1(D)$がいつ逆像を持つか？
    実は$\o{\partial}^2=0$を満たす範囲では（明らかにcohomologyの消息）全射で，さらに$f$をコンパクト台を持つように選べてしまう．
    このことより，コンパクトな「穴」の空いている領域は，正則領域ではないことがわかる．
    特に，孤立特異点は常に除去可能である．
    また，孤立した零点を持たない．
    これは一変数の場合とは全く違う消息である．
    一変数で成立するが多変数では成り立たない現象をハルトークス現象(Hartogs' phenomenon)という。この現象は、このハルトークスの拡張定理や正則領域の考え方、ひいては多変数複素函数論の発展を導いた。
\end{tcolorbox}

\begin{discussion}[逆像を持つ必要条件：閉形式である]\label{discussion-CR-operator-in-mulivariable}
    $\o{\partial}:\Omega^1(D)\to\Omega^2(D)$を，$g=g_1d\o{z}_1+g_2d\o{z}_2$に対して
    \[\o{\partial}g:=\sum_{j=1}^n\o{\partial}g_j\wedge d\o{z}_j=\frac{1}{2}\paren{\pp{g_2}{\o{z}_1}-\pp{g_1}{\o{z}_2}}d\o{z}_1\wedge d\o{z}_2\]
    と定めると，$\o{\partial}f=g$のとき，
    $f\in\Cinf(D)$は特に$C^2$級で，
    $\partial_{\o{z}_1}\partial_{\o{z}_2}f=\partial_{\o{z}_2}\partial_{\o{z}_1}f$より$\partial_{\o{z}_2}g_1=\partial_{\o{z}_1}g_2$となり，$\o{\partial\partial}f=\o{\partial}g=0$が必要．
\end{discussion}

\begin{theorem}[十分性]\label{thm-CR-operator-in-multivariable-is-epic}
    コンパクト台を持つ1-形式$g=g_1d\o{z}_1+g_2\o{z}_2\;(g_1,g_2\in\Cinf_0(\C^2))$が$\o{\partial}g=0$を満たすとする．
    このとき，あるコンパクト台を持つ$\Cinf$関数$f\in C_0^\infty(\C^2)$が存在して$\o{\partial}f=g$が成り立つ．
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[解の構成] 先ず$\partial_{\o{z}_1}f=g_1$を解くと，１変数の場合\ref{lemma-existence-of-solution-to-PDE-when-compact-support}より，
        \begin{align*}
            f(z)&=\frac{1}{2\pi i}\int_\C\frac{g_1(\zeta,z_2)}{\zeta-z_1}d\zeta\wedge d\o{\zeta}\\
            &=\frac{1}{2\pi i}\int_\C\frac{g_1(z_1-\zeta,z_2)}{\zeta}d\zeta\wedge d\o{\zeta}.
        \end{align*}
        実はこれは２変数の場合$\o{\partial}f=g$を満たしてしまう．
        実際，$\o{\partial}g=0$なので$\partial_{\o{z}_2}g_1=\partial_{\o{z}_1}g_2$（議論\ref{discussion-CR-operator-in-mulivariable}）とCauchyの積分表示\ref{thm-Cauchy-integral-expression-multivariable}より，
        \begin{align*}
            \partial_{\o{z}_2}f(z)&=\frac{1}{2\pi i}\int_\C\frac{\partial_{\o{z}_2}g_1(z_1-\zeta,z_2)}{\zeta}d\zeta\wedge d\o{\zeta}\\
            &=\frac{1}{2\pi i}\int_\C\frac{\partial_{\o{z}_1}g_2(z_1-\zeta_1,z_2)}{\zeta}d\zeta\wedge d\o{\zeta}=g_2(z).
        \end{align*}
        \item[コンパクト台を持つ]
        $\supp g:=\supp g_1\cup\supp g_2$はコンパクトだから，$L>0$が存在して$\supp g$は球$\abs{z}\le L$に含まれる．
        このとき$g$は$\abs{z}>L$にて$0$であるから$\o{\partial}f=0$で，$f$は$\abs{z}>L$にて正則である．
        したがって，特に$\abs{z_2}>L$という開集合に注目すれば，この上で$g_1(z)=0$なので$f(z)=\frac{1}{2\pi i}\int_\C\frac{g_1(z_1-\zeta,z_2)}{\zeta}d\zeta\wedge d\o{\zeta}=0$である．
        よって一致の定理より，$\abs{z}>L$上では$f=0$である．
    \end{description}
\end{proof}
\begin{remarks}
    最後のコンパクト台を持つところで，正則関数の一致の定理の消息だけ借りているのが面白い．
\end{remarks}

\begin{theorem}[Hartogs (1906)]\label{thm-Hartogs}
    $D\subset\C^2$を領域，その中のコンパクト集合$K\subset D$を$D\setminus K$が連結であるとする．
    このとき，任意の正則関数$f\in\O(D\setminus K)$は$K$上にも$\o{f}\in\O(D)$に延長できる．
\end{theorem}
\begin{proof}\mbox{}
    \begin{description}
        \item[$\Cinf$級での構成] 
        $\rho\in\Cinf_0(D)$を$K$の近傍で$1$になるように取り，\[f_0:=\begin{cases}(1-\rho)f,&z\in D\setminus K,\\0,&z\in K.\end{cases}\]と定めると，$f_0\in\Cinf(D)$である．
        \item[正則に補正]
        $\o{\partial}f_0$の$\opart$による逆像の元を$f_0$から引くことで，これを正則にすることを考える．
        $f$は正則なので，$\opart f_0=-\opart\rho\cdot f$より$\supp\opart f_0\subset\supp\opart\rho(\subset D\setminus K)$なので，$\opart f_0\in\Omega^1(D)$は$\C^2\setminus D$上では零と定めると，$\C^2$上にコンパクトな台を持つ$\Cinf$級1-形式$g$に延長でき，$\opart g=0$は$\C^2\setminus D$では勿論，$D$上でも$\opart g=\opart(\opart f_0)=0$を満たす．
        よって，定理\ref{thm-CR-operator-in-multivariable-is-epic}より，$\opart h=g$を満たす$h\in\Cinf_0(\C^2)$が存在する．
        これに対して$\o{f}:=f_0-h$と定めると，$\opart\o{f}=\opart f_0-\opart h=g-g=0$より$\o{f}\in\O(D)$．
        \item[検証] こうして構成した正則関数$\o{f}\in\O(D)$が$D\setminus K$上で$\o{f}=f$を満たすことを示せば良い．
        $h$は$\opart h=g$を満たすので，$\supp g$の外では正則で，かつコンパクトな台を持つので，$\C^2\setminus\supp g$の有界でない連結部分$V$\footnote{実はただ一つ}上では$h=0$となる．
        また$\supp g=\supp\opart f_0\subset\supp\opart\rho\subset D\setminus K$なので，特に$V\cap D\ne\emptyset$で，その上では$\o{f}=f_0+0=f$が成り立つ（$V$は$\C^2\setminus\supp g\subset\supp\opart\rho$の非有界な連結部分なので，$\rho=0$であり，$f_0=f$）．
        $D\setminus K$は連結なので，その一部$V\cap D\subset D\setminus K$で一致するならば，$D\setminus K$上全域で$\o{f}=f$である．
    \end{description}
\end{proof}
\begin{remark}
    このコーシー・リーマンの方程式によるアプローチは、Leon Ehrenpreisが論文 (Ehrenpreis 1961) で導入したとのこと．
\end{remark}

\begin{corollary}
    多変数正則関数$f\in\O(D)$の零点集合$Z:=f^{-1}(0)$はコンパクトでない．
    特に，多変数正則関数の零点は孤立しない．
\end{corollary}
\begin{proof}
    $\frac{1}{f}\in\O(D\setminus Z)$を考える．$Z$がコンパクトならば，$Z\subset K:=\Brace{z\in D\mid\abs{z}\le 1-\epsilon}$を満たす$\epsilon>0$が存在する．
    特に$\frac{1}{f}\in\O(D\setminus K)$より，Hartogsの拡張定理\ref{thm-Hartogs}より，これは$\O(D)$上に延長できるが，これは矛盾．
\end{proof}
\begin{remarks}
    多変数関数の零点集合を追い求める旅は，まさに雲を掴むよう．
    多項式でこれを考えるのが代数幾何で（代数学の基本定理など成り立たない），正則関数でこれを考えるのが
    解析空間．
\end{remarks}

\begin{theorem}
    領域$D\subset\C^n$について，次の条件は同値．
    \begin{enumerate}
        \item $\opart f=g$が解ける．
        \item $D$は正則領域である．
        \item $D$は正則凸：コンパクト集合$K\subset D$に対し，$\wh{K}_D$もコンパクト．\footnote{この条件は多変数の場合は「相対コンパクトな穴を埋めろ」という純位相的な操作にはならない．}
        \item $D$は擬凸(subharmonic functionを用いる)である．\footnote{かなり微分幾何的に定義できるこの概念で特徴づける理論が岡潔の理論で，一度は完成を見る．}
    \end{enumerate}
    (2)$\Rightarrow$(4)を岡の補題という．
    (1)で打開策を見つけ，同様にsubharmonic functionで解いたのがLars Valter Hörmanderであり，
    以降多変数関数論は偏微分方程式論化された．
    現代ではSobolev空間などの道具が揃っているので(1)が標準的な方法となっている．
\end{theorem}

\chapter{超幾何関数}

\begin{quotation}
    RiemannによるGaussの超幾何関数の研究の整理は，「超幾何関数は多項式複素冪の複素積分である」とみれる．
    ２項関数のTaylor展開
    \[(1+x)^\alpha=\sum_{n=0}^\infty\frac{\alpha(\alpha-1)\cdots(\alpha-n+1)}{n!}x^n,\quad\abs{x}<1.\]
    は組み合わせの数$\begin{pmatrix}\alpha\\n\end{pmatrix}$の母関数(generating function)であるが，超幾何関数はより複雑は非復元抽出の場合の数を生成する解析関数である．
    したがって，この確率母関数を解析することにより，組み合わせの数の間の関係や増大度について種々の情報が得られる．
\end{quotation}

\section{Introduction}



\chapter{リーマン面の概念とその位相}

\section{Weierstraßの解析関数の概念}

\begin{screen}
    解析接続の原理はWeierstraßのMathematische Werkeの第1巻(1894)で初めて発表された．
    関数要素を貼り合わせて大域を目指すという発想である．
    これは一致の定理を得た時から常に意識されたものである，離散的でない近傍において，局所的に関数要素を定めた時点で，
    大域の何かを選択しているはずなのである．
    この「大きな関数概念（Weierstraßの意味での解析関数）」を相手取るのが，関数論である．

    ある点における関数の値は，その点を中心とする関数要素の取る値として得られる．
    発想が極めて多様体らしい構成であり，そのために位相の言葉が整備された．
    こうして，多価性も，葉っぱを分ければ一変数として扱える．
    こうして関数を捉えるのである．
    \begin{quotation}
        It turns out that the plan to conquer a largest possible domain of the $z$-plane, for the function to be defined, is possible in only one way. But the uniformity (single-valuedness) of the function is usually lost in the process of analytic continuation.
        This is not to be regarded as a defect; rather it is a great merit that in this fashion also the many-valued analytic functions become amenable to an exact treatment.\cite{Weyl}
    \end{quotation}
\end{screen}

\begin{remark}
    以下の議論は，適切な貼り合わせにより，有理型関数の理論（有理型関数$f:D\to\hatC$とLaurent展開）に拡張される．
    が，もっぱらは正則関数$f:D\to\C$とTaylor展開で議論する．
\end{remark}

\begin{definition}[function element]
    ある点$a\in\C$について，$z=a$以外でも収束する$(z-a)$の正の整数の冪級数とその収束半径$r\in\hatC$の組$((A_n\in\C)_{n\in\N},r)$を，\textbf{$a$を中心とする関数要素}という．
    \[\mathfrak{P}(z-a)=\sum^\infty_{n=0}A_n(z-a)^n.\]
    この冪級数の収束域は，$\Delta(a,r)$と$\partial\Delta(a,r)$の部分集合との，合併からなる．
\end{definition}

\subsection{直接解析接続と間接解析接続}

\begin{definition}[direct (analytic) continuation]
    $b\in\Delta(a,r)$について，$b$を中心とする関数要素
    \[\mathfrak{O}(z-b)=\sum^\infty_{n=0}B_n(z-b)^n\]
    を考える．これは少なくとも$\Delta(b,r-\abs{b-a})$の範囲で収束するが，より広い収束域を持ち得る．
    この時，この関数要素$\mathfrak{O}=((B_n),r')$を用いて，関数要素$\mathfrak{P}$が拡張される．
    この時，$\mathfrak{O}(z-b)$は$\mathfrak{P}(z-a)$の\textbf{直接解析接続}であるという．
\end{definition}

\begin{definition}[(indirect) analytic continuation]
    直接解析接続の列$(f_n)_{n\in\N}$を（間接）\textbf{解析接続}といい，その像$\{f_n\}_{n\in\N}$を\textbf{解析関数}という．
\end{definition}
\begin{remark}
    which is approximately analogous to the fact of projective geometry that the general projective transformation may be obtained by a sequence of an arbitrary number of immediate projective, i.e., perspective, transformations.
\end{remark}

\subsection{曲線に沿った解析接続}

\begin{definition}[曲線に沿った解析接続]
    曲線$\gamma=(z_\lambda)_{\lambda\in[0,1]}:[0,1]\to\C$は$\gamma(0)=a,\gamma(1)=c$を満たすとする．
    これに対して，次の条件を満たす関数要素の族$\{\mathfrak{P}_\lambda:=(z_\lambda,r_\lambda)\}_{\lambda\in[0,1]}$が存在する時，
    関数要素$\frakP_0$は$\gamma$に沿って\textbf{解析接続可能}であるという．この族を\textbf{解析接続}という．
    \begin{quote}
        (\#) 任意の$\lambda_0\in[0,1]$と$\frakP$について，$\gamma$の部分弧$\Im\gamma\cap\Delta(z_0,r_{\lambda_0})$を像とするような任意の区間$\Delta(\lambda_0,\epsilon)\subset[0,1]$に対して，$\frakP_\lambda\;(\lambda\in\Delta(\lambda_0,\epsilon))$は全て$\frakP_0$から直接接続によって生じる．
    \end{quote}
    また，関数要素$\frakP_1$を，$\gamma$に沿った解析接続によって$\frakP_0$から生じる関数要素と呼ぶ．
\end{definition}

\begin{proposition}[解析接続の一意性]
    始点$a$における関数要素$\frakP_0$と曲線$\gamma$に対して，解析接続$(\frakP_\lambda)_{\lambda\in[0,1]}=(\frakP_0,\gamma)$が一意に定まる．特に，終点$c$における関数要素$\frakP_1$が一意に定まる．
\end{proposition}
\begin{proof}
    $a$での関数要素$\frakP_0$と$\gamma$についての，２つの異なる解析接続$(\frakP_\lambda),(\frakP'_\lambda)$が取れたと仮定し，矛盾を導く．
    $\lambda_0\in[0,1]$を$\lambda_0:=\inf\{\lambda\in[0,1]\mid\frakP_\lambda,\frakP'_\lambda\}$と定めると，$\lambda_0>0$である．
    $r_0>0$を十分小さくとり，関数要素$\frakP_{\lambda_0},\frakP'_{\lambda_0}$はいずれも$\Delta(z_{\lambda_0},r)$上で収束すると考えて良い．
    この時，区間$[\Delta(\lambda_0,\epsilon)]\subset[0,1]$であって，部分弧$\gamma':=\gamma([\Delta(\lambda_0,\epsilon)])\subset\Delta(z_{\lambda_0},r_0/2)$を定めるようにできる$\epsilon>0$が存在する．
    この部分弧$\Im\gamma'$上に属する関数要素について，$0<\lambda_0-\epsilon<\lambda_1<\lambda_0$を満たす$\lambda_1$は$\frakP_{\lambda_1}=\frakP'_{\lambda_1}$を満たすはずだが，これは同じ収束域$\Delta(z_{\lambda_0},r_0)$内での事実$\frakP_{\lambda_0}\ne\frakP'_{\lambda_0}$に矛盾．
    よって，$(\frakP_\lambda)=(\frakP'_\lambda)$．
\end{proof}
\begin{remarks}[曲線の連結性]
    曲線に沿った解析接続とは，直接解析接続によって編み上げた概念であるから，このような位相的な議論でその一意性が確認できる．
    これは連続版ドミノ倒しである．おそらく本質は曲線の連結性である．
    しかし，今後の議論のたくさんを懐胎している良い概念であるように思われる．
\end{remarks}

\begin{proposition}[homotopy型の一意性]
    ２点$a,c$を結ぶ２つの曲線$z_1,z_2$がhomotopicである時，終わりの関数要素は等しい．
\end{proposition}
\begin{remark}
    Weylはhomotopicという条件の代わりに
    \[\exists\delta>0,\;\forall\lambda\in[0,1],\;\abs{z_1(\lambda)-z_2(\lambda)}<\delta.\]
    と述べている．こちらの方が強い定理を得る．
    が，穴が空いている場合を除けていないのではないか？
\end{remark}

\begin{itembox}[l]{解析接続の一意性}
    話を局所から編み上げるために，一意性については証明が必要であったが，
    解析接続がある始点$\frakP_0=(a,r)$から可能であるならば，
    その道中常に関数型が等しいので，一意的に決まっている．
    だが，それもhomotopicな場合に限る．穴が開いている場合は多価関数となる．

    可縮性はもっと一般的なのだろうか？
\end{itembox}

\subsection{正則領域}

\begin{definition}[critical point]
    曲線$\gamma$について解析接続不可能であるとする．
    この時，ある点$\Lambda_0\in(0,1]$が存在して，
    曲線$\gamma|_{[0,\Lambda_0)}$に沿っては解析接続可能だが，
    曲線$\gamma|_{[0,\Lambda_0]}$に沿っては不可能となる．
    この点を\textbf{臨界点}という．
\end{definition}

\begin{definition}[regular, singular, natural boundary]
    正則関数$f$の$z=a$における冪級数展開の収束半径を$r$とする．
    この時，収束円周上の点$w\in\partial\Delta(a,r)$について
    \begin{enumerate}
        \item $w$のある近傍において，$f$が解析接続可能である時（即ち，同じ形をした関数要素を持つとき），点$w$は\textbf{正則}，
        \item 解析接続不可能である時，$w$は\textbf{特異}
    \end{enumerate}
    であるという．$\partial\Delta(a,r)$の点が全て特異である時，円周$\partial\Delta(a,r)$を\textbf{自然境界}という．

    円板$\partial(a,r)$に止まらず，任意の領域$D$に対して，境界点が全て特異である時，$\partial D$を自然な境界という．
    自然境界を持つ領域は正則領域である．
\end{definition}

\begin{definition}[domain of holomorphy]
    開集合$\Omega\subset\C^n$が\textbf{正則領域}であるとは，
    ある正則関数$\Omega\to\C$が存在して，
    これ以上真に広い領域の中で解析接続できないことをいう．
\end{definition}

\begin{proposition}
    $n=1$の時，すべての開集合$U\subset\C$は正則領域である．
\end{proposition}
\begin{remark}
    即ち，「その領域の境界上の至る所で集積する零点を持つような正則函数を定義することが出来る。そのような境界はしたがって、逆函数の定義域に対する自然境界でなければならない[要出典]」．
    $n\ge 2$に対しては，Hartogsの補題によって，上述の主張は真にはならない．
\end{remark}

\begin{definition}[holomorphically convex hull, holomorphically convex, pseudoconvex]
    \begin{enumerate}
        \item $n$-次元複素多様体$G\subset\C^n$に対して\footnote{領域の一般化として}，そのコンパクトな部分集合$K\subset G$の\textbf{正則凸包}とは，次の集合$\hat{K}_G$をいう：
        \[\hat{K}_G:=\{z\in G\mid \forall f\in\mathcal{O}(G),\;\abs{f(z)}\le\sup_{w\in K}\abs{f(w)}\}\]
        \item 領域$G$内の任意のコンパクト集合$K$に対して，$\hat{K}_G$もコンパクトならば，領域$G$を\textbf{正則凸}という．
        \item 領域$G$が\textbf{(Hertogs)擬凸}であるとは，連続多重劣調和関数$\varphi$が存在して，任意の実数$x\in\R$に対して，集合$\{z\in G\mid\varphi(z)<x\}$が$G$-相対コンパクトとなることをいう．この調和関数をexaustion functionという．
    \end{enumerate}
\end{definition}

\begin{theorem}
    領域$\Omega$について，次の５条件は同値．
    \begin{enumerate}
        \item $\Omega$は正則領域である．
        \item $\Omega$は正則凸である．
        \item $\Omega$は擬凸である．
        \item $\Omega$はLevi凸である．
        \item $\Omega$は局所Levi性を持つ．
    \end{enumerate}
    1$\Leftrightarrow$2をカルタン＝トゥレンの定理という．1$\Rightarrow$3を岡の補題という(53)．
    5$\Rightarrow$1をLeviの問題という．
\end{theorem}

\begin{definition}[Stein manifold]
    
\end{definition}
\begin{remark}
    考案者の Karl Stein (1951) の名にちなむ．
    \begin{quote}
        From the point of view of cohomology Stein manifolds are to complex manifolds as Cartesian spaces are to smooth manifolds.\footnote{\href{https://ncatlab.org/nlab/show/Stein+manifold}{nLab "Stein Manifold"}}
    \end{quote}
\end{remark}

\begin{theorem}[Behnke, Stein, 1948]
    連結かつ非コンパクトなリーマン面はシュタイン多様体である．
\end{theorem}

\begin{quotation}
    1変数の場合はWeierstrassの定理より$\C$の任意領域は正則領域であるが，多変数の場合はそうでないので，
    正則領域の研究が最も基礎的である．多変数関数論は正則領域の理論として興り，岡潔はその三大問題を$\C^n$の上で解いた．
    昔，収束整級数を中心と併せて考え，関数要素と呼んだが，収束円は整級数ごとに異なる．
    中心を動かしたとき，岡が不定域イデアルとして把えた算術概念は今の言葉では層である．
    Grauertによれば$\alpha$空間は
    $\beta_n$空間に等しく，分岐領域は局所的に$\C^n$の正規解析的集合である．
    層や分岐領域を研究する武器は代数幾何である．
    その香りの濃い仕事は前節で紹介した．岡の独自な手法はCartan, Serreにより代数幾何学的理論に止揚され，
    西洋数学に取り込まれた．岡の成果は昭和30年代の末までにGrauert等によりStein空間まで拡張された．
    筆者の世代にとり，多変数関数論とは正則領域論に他ならない．\cite{梶原}
\end{quotation}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=岡の第七論文]
    Oka VII, Bull. Soc. Math. France 78 (1950)の題名は「いくつかのアリトメチカ的概念について」”Ⅶ-Sur quelques notions arithmétiques”．
    これについて「数学に於ける主観的内容と客観的形式について（草案） 1953.7.1(水 19.5)」が書かれた．
    \begin{quote}
        仏文原稿が書かれたのは，先の対戦の終了後三年目にあたる昭和23年(1948年)７月のことだと言われている．
        論文が出来上がって間もない頃のことであろう，岡潔は「ボロ服に，風呂敷包を肩に振り分けた」姿で故郷紀見村（現在，和歌山県橋本市）を発ち，原稿を手に京都岡崎天王町に住む友人秋月康夫を訪問した．
        20年後，秋月康夫はこの時の情景を感銘の深い致筆で書き留めている．
        \begin{quote}
            敗戦直後の食糧困難に悩んでいる頃だった．ボロ服に，風呂敷包を肩に振り分けた，岡潔君の久しぶりの訪問を受けた．
            第一印象は"彼も随分齢を取ったものだ．まるで百姓のようだ"ということであった．当時，無職であった同君は，家や田を売り，芋を栽培して
            糊口を養いつつ，多変数関数論の開拓に励まれてきていたのである．
            戦中芋畑から，層の概念の芽が，不定域イデアルの形で生み出されたのである．
            この論文は手記のまま，1948年渡米する湯川君に託されたが，角谷・Weilの手を経てHenri Cartanに手渡され，パリで印刷されるに至ったものである．
            プリンストン高級研究所へ招待された我が国の科学者は，この1948年の湯川・角谷両君が戦後最初であった．
            そして翌年に，朝永・小平君と続いた．（「輓近代数学の展望（続）」の「序」）
        \end{quote}
    \end{quote}
    岡潔は
    \begin{quote}
        イデアルと言いますと，Ernst Kummerに始まります．それからそれをDedekindがaxioticに言い直しました．それのelementを数からpolynomialsに広げたのがDavid Hilbert，さらにpolynomialsをanalytic functionに変えようと最初にしたのは，後で知ったのですが，Rückertです．そしてこの後，これをさらに詳しく見ようとして，1940年にHenri Cartanが正則母式(仏: matrices holomorphes)という論文を書いています．これは前の正則凸状の論文とともに非常に重要な論文です．これだけで後は戦争になって，知らなかったのです．所でelementをanalytic functionにしますと，どうなるかと言いますと，polynomialsの場合は数の代わりに個々のelementをfと書けば良いのですが，analytic functionですと，Riemannがしました通り，このfが何処で正則かという領域δを添えて，(f,δ)としなければならない．そのようにペアにして初めて意味を持つんです．だから私は，領域が変わりますから，不定域イデアルとしたんです．
    \end{quote}
    同じことを「多変数解析関数ノート」には
    \begin{quote}
        Weierstrassの解析要素に自由を与え，しかも同時にRiemannの解析要素を，もはや物理的直感さえ痕跡を留めないような一般的な場に延長して，
    \end{quote}
    とある．Cartanの論文「複素変数の解析関数のイデアルとモジュール」の第Ⅱ部「モジュールの層」の冒頭では
    \begin{quote}
        岡とともに，モジュールの層の概念を導入しよう．我々は代数的位相幾何学での「層」という言葉を借用したいと思う．それは，代数的位相幾何学で，Jean Lerayによってhomology論において導入されたものである．我々がここで同じ言葉を使用するのは，ある類似の概念を記述するためである．また，ここでは代数的位相幾何学におけるのと同様に，「局所的に」与えられたものから出発して，「大域的な」諸性質の研究へと移行することが問題になる．層の概念が導入されるのは，そのような理由があるからである．
    \end{quote}
    とある．またその注釈には
    \begin{quote}
        岡潔はこの概念（「モジュールの層」の概念）を彼の論文の第二節において，「不確定領域の正則イデアル」という名前で導入した．我々はここでは異なる用語と異なる表記法を採用するが，この概念の根底にあるものは同一である．
    \end{quote}
    霊性はRiemannのespritを得た岡潔で，潮流は完全にフランスであった．
    現代我々が持つのは「代数幾何学と同じ理論的基盤（イデアル論などの抽象代数学）の上に構築された複素解析幾何学」である．これはこれで好きであるが．
    これについては「関数論をあそこへ初めて持って行ったのは多分Weylです」と言っている．
    \begin{quote}
        「若し論文Ⅰに現れた私の素志を貫くつもりならばこの図に関する論文Ⅰの定理Ⅱ（有理多面体に対する上空移行の原理）を一般の場合に拡張しなければならぬ．また，これまでは領域は絶えず単葉に限定して研究して来たが，この制限を取り去るつもりならばΣが代数的分岐点を持っても良いとしなければ徹底しない．そうでなければ，例えばこれからの研究の成果を多変数代数関数の分野に適用することさえ出来ない．これで腹が決まった．この拡張に全力をあげよう．（『春雨の曲』第七稿）
    \end{quote}
    Riemannの模倣は次からわかる．
    \begin{quote}
        前世紀半ば，リーマンはリーマン面の概念を根底に据えて一複素変数の解析関数の一般領域を展開し，それに基づいてヤコビの逆問題を解決するという構想を描き，しかもそれを遂行した．こうして形成されたのが一変数の代数関数論である．多変数解析関数論の領域において，リーマンと同じ道を歩もうとすれば，まず初めに多変数解析関数論の一般理論を建設し，その土台の上に多変数の代数関数論の構築を目指す，という順序になるであろう．一般理論の革新は存在領域の幾何学的形状の描写だが，不分岐で，しかも有限な領域の場合には，今では「それは擬凸状の領域である」と簡明に答えることが可能であり，僕らはここにハルトークスの逆問題の解決の数学的意味を見ることができるだろう．だが内分岐領域に移ると情勢は混濁し，Grauertの例とGrauertとRemmertの例が明示しているように，明らかに言えることはもう何もない．
    晩年の岡潔は，Riemannの定理という表題で一系の研究記録を書き続けた．第一のノートの第一頁に記入された日付は1961.12.31であり，夫から第九ノートまで進み，さらに二つのノートが遺された．最後のノートの最終記事には1964.9.22という日付が記入された．この一連の思索が結実して新たな論文が生まれることはなかったが，岡清の数学的天才を示す真に偉大な遺稿と思う．この後世への大きな遺産を解読し，「明日の数学」の姿を構想することは，岡潔の没後四半世紀が過ぎた今日もなお依然として，僕らに課された大きな課題であり続けている．
    \end{quote}
    Cartanの論文を読む．
    \begin{quote}
        関数論を解析的多様体上に移すと言うカルタンのアイデアに鍵を与えたのは上空移行の原理である．この原理により，領域は多様体に移されて，領域上の関数論を多様体上の関数論と同一視すると言う視点が確立される．少なくとも客観的形式に関する限り，これら二つの函数論は同等である．そこで関数論を領域，特に分岐点を内包する領域上で考察する代わりに（困難かつ方法がない），解析的多様体に身を移して，イデアルの理論という武器を駆使して理論展開の道を探ろうというのがカルタンのアイデアの骨子であろう．
    \end{quote}
    となると，第Ⅶ論文の改定の意図がわかる．
    \begin{quote}
        カルタンは岡潔の論文の論理的構造に着目するばかりであり，岡清の数学的意図には無頓着である．カルタンはハルトークスの逆問題やレビの問題の解決は目指さなかったし，問題そのものに関心を示した様子も見られないが，カルタンにはカルタンの数学上の意図があったであろう．それは代数幾何学との融和，すなわち代数幾何学と同じ理論的基盤（イデアル論などの抽象代数学）の上に，複素解析幾何学を構成することである．岡の理論により，有限で不分岐な領域の範疇では正則領域と正則凸状領域の概念は論理的に見て同等だが，そのまま複素多様体に移せるのは「正則凸状」の概念である．そこで，「正則凸状な複素多様体」，すなわちスタイン多様体というものが考えられて，正則領域の一般化とみなされた．一変数解析関数論におけるリーマンのリーマン面の概念が抽象化されて一次元複素多様体（今日では単にリーマン面といえば，常に一次元複素多様体のことである）の概念が得られたのと軌を一にして，多変数解析関数論ではスタイン多様体が選定された．さらに「特異点付きの複素多様体」すなわち解析空間の概念が導入され，スタイン多様体に対応してスタイン空間の概念が設定された．複素解析幾何学の根幹をなす概念がこうして定まったが，これは岡の理論があって初めて可能になる出来事なのであった．
        岡潔の理論においてハルトークスの逆問題の解決へと至る具体的な手順は，カルタンの理論に移ると，スタイン空間の理論の二つの基礎定理として集大成された．第七論文の不定域イデアルの理論は「層の理論」に書き直され，「局所有限擬基底を持つ不定域イデアル」の概念は解析的連接層の概念へと移行した．第八報の「基本的な補助的命題」は「解析空間の正規化」の理論として解釈された．また，正則領域におけるクザンの第二問題の可解性を巡って第三報に現れた岡潔のアイデアは「岡の原理」と呼ばれて定着した．岡潔の理論の幾何学的な見地からの翻案を通じて，複素解析幾何学の根幹が成立したのである．
    \end{quote}
\end{tcolorbox}

\subsection{関数概念の更新}

\begin{definition}[Weierstraß's analytic function]
    \textbf{Weierstraßの解析関数}とは，与えられた一つの関数要素$\mathfrak{P}$から，あらゆる連続曲線を考え，
    （曲線に沿った）解析接続によって生じる全ての関数要素からなる集合$\mathbf{G}$のことをいう．
\end{definition}
\begin{remark}
    $\mathbf{G}$の各関数要素は，$\mathbf{G}$の他の関数要素から解析接続によって得られる密林となっている．
\end{remark}

\begin{definition}[value]
    数$A_0\in\C$が解析関数$\G$の$z=a$における値であるとは，次のような関数要素を持つ$\frakP\in\G$ことをいう：
    \[\frakP(z-a)=A_0+A_1(z-a)+A_2(z-a)^2+\cdots\quad\in\G.\]
\end{definition}

\begin{proposition}[極大性]
    ２つの解析関数$\mathbf{G}_1,\G_2$が，一つでも関数要素を共有する時（$\G_1\cap\G_2\ne 0$），両者は同じものである：$\G_1=\G_2$．
\end{proposition}

\begin{itembox}[l]{母なる大地を求めて}
    
\end{itembox}

\section{解析形体の概念}

\begin{screen}
    \begin{quote}
        Certainly, at first glance, there is something artificial about Weierstrass' concept of a many-valued analytic function as a collection of function elements.
        When one talks of $\sqrt{z}$ or log $z$, one hardly envisages the totality of power series which represent pieces of these many-valued functions.
        Nevertheless, Weierstrass' definition, whose simplicity and precision cannot be denied, has the advantage of being a solid starting point for analytic function theory.
        By gradual reworking of Weierstrass' formulation we will arrive at Riemann's formulation, in which the independent variable $z$ as well as the dependent variable $u$, which up to now is represented by a totality $G$ of function elements, appear as uniform analytic functions of a parameter; a parameter, to be sure, which in general takes values not in the complex plane but on a certain two-dimensional manifold, the so-called Riemann surface.
    \end{quote}
    正則な点だけでなく，有限位数の分岐点や極を持つ点についても拡張する．
\end{screen}

\begin{definition}[analytic form / analytisches Gebilde]
    
\end{definition}

\begin{thebibliography}{99}
    \bibitem{Ahlfors}
    Lars V. Ahlfors "COMPLEX ANALYSIS", 3rd ed. (1979)
    \bibitem{Weyl}
    Herman Weyl 『リーマン面』
    \bibitem{梶原}
    \href{https://www.jstage.jst.go.jp/article/sugaku1947/38/3/38_3_270/_pdf}{梶原譲二「最近の多変数関数論」（1985年）}
    \bibitem{Elias Stein}
    Elias Stein and Rami Shakarchi "Complex Analysis"
\end{thebibliography}

\end{document}