\documentclass[uplatex, dvipdfmx]{jsreport}
\title{代数と幾何（担当：阿部紀行先生）}
\author{司馬博文}
\date{\today}
\pagestyle{headings} \setcounter{secnumdepth}{4}
\input{/Users/hirofumi.shiba48/Desktop/数理科学/preamble_no_fonts.tex}
\usepackage[math]{anttor}
\begin{document}
\tableofcontents

\begin{quotation}
    線型代数の代数学の中での特殊な立ち位置が極めて不思議である．
    抽象的に定義した線型空間とその射の概念を，全て数ベクトル空間と行列の場合に引き戻して考えられると言う圏Vectの構造が，
    代数学の手法の模範とも思える．
    \begin{quote}
        抽象的な代数の面白さは，要するに目に見えるものというのは実際には複雑すぎて手に負えないんです．ところがそれを代数にしちゃえば，色々いじくることが出来るんです．
        \begin{flushright}
            広中平祐
        \end{flushright}
    \end{quote}
    そう言えば，集合代数が全てブール代数$2$の演算に引き戻されて，
    全ての「論理」がこの小数の「計算規則」に引き戻される姿は圧巻であった．あの春から，圏論に魅せられ，数学に魅せられたのであった．
    きっと\textbf{可換図式}という圏論のことばは，数学的対象の消息を代数規則に引き戻すまでを担当し，図式追跡以降の集合論的消息は\textbf{方程式}と呼ばれ，計算を司るのだろう．

    冪等性が射影の性質に相当していて，内部空間の分割の仕方に対応しているという代数と幾何の対応も見事なものである．
    線型空間は射影子があるから，位相の議論よりかはすぐに圏論的になっていく．

    そもそも行列というデータ構造が代数的技術としてあまりによくデザインされている．
    内積が基本的対象として認められたならば，その内包する双対性を縦と横という双対的なもので表される．
    すると横は双対写像としての意味を持つ．
    多重線形性は縦と横の双方について成り立つ．
    こうして双対命題を転置で行き来できる枠組みが出来上がる．

    直和が前半の，直積が後半の代数的手法の中心となる．
    基底や行列とは，直和のものを計算するための手法であるから，
    我々が書き方を恣意的に変えるだけであって，ここの要素$a_{ij}$もブロック$A_{ij}$も等しく扱って良い．

    この２点が，Hermite形式の理論において驚くべき祈りを結晶する．
    標準的な分解の理論であるとすると，線型空間は部分空間の言葉で分解する．
    線型写像は射影子の言葉でその分解を与える．
    自己準同型は一般固有空間分解を与え，さらに細かくはJordanの理論がある．
    双対空間は零化空間と非零化空間で分解すると安定する．
    対称形式が与えられた空間は直交で分解するのが標準的である．
\end{quotation}

\chapter{線型空間}

\begin{quotation}
    線型空間は次元という自然数によって分類される．
    \begin{enumerate}
        \item 線型空間には，ベクトルの空間，行列の空間，関数の空間，数列の空間など，様々な例がある．これらを個別にではなく，いっぺんに扱うには，抽象的な扱いが有効である．
        \item もう少し積極的な理由としては，本来は違うはずのものが，同じ性質を持つことがわかることがある．例えば，漸化式を満たす数列と，定数係数線形常微分方程式の解は，全く同じ性質を持つ．
        \item 直和，双対空間，商空間，テンソル積など，公理を確認することによって厳密な構成と既存理論の適用ができるのが，機能として便利である．
        \item 線型空間を考える際には，１つだけを取り上げて考えるよりも，他の線型空間との関係の中で考えた方が良い．
    \end{enumerate}
    どうして線型空間が安定な構造だとわかったのだろうか．
    \begin{notation}\mbox{}
        \begin{enumerate}
            \item $C=\FinVect_K$とする．
        \end{enumerate}
    \end{notation}
\end{quotation}

\section{体}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    線型代数の理論は全ての体の上に定義される．簡単のために$K=\R,\C$
    と考えても良いが，$\R,\C$ではその位相的構造など，余分な条件を課しすぎている．
\end{tcolorbox}

\begin{definition}[field / Körper]
    体とは，全ての零でない元が積について逆元を持つような（零でない）可換環である．

    即ち，和も積もAbel群で，分配し，$0\ne 1$であるようなものである．
\end{definition}
\begin{example}\mbox{}
    \begin{enumerate}
        \item 有理数体の複素化$K=\{a+b\sqrt{-1}\mid a,b\in\Q\}$は体になる．
        \item Hamiltonの四元数は体$\mathbb{H}$をなす．
        \item 体$K$に対して，$X$の$K$-係数の有理式全体は体をなす．これを\textbf{有理関数体}という．
        \item 素数$p$に対して，位数$p$の有限体$\F_p=\{\overline{0},\overline{1},\cdots,\overline{p-1}\}$．
    \end{enumerate}
\end{example}

\begin{lemma}[well-definedness]\mbox{}
    \begin{enumerate}
        \item 和の中立元$0(=0_K)$は一つしかない．
        \item 和の逆元$b:=-a$は一つしかない．
        \item 積の単位元$1(=1_K)$は一つしかない．
        \item 積の逆元$b:=a^{-1}$は一つしかない．
    \end{enumerate}
\end{lemma}
\begin{proof}
    \begin{enumerate}
        \item $0=0+0'=0'$．
        \item $b=b+a+b'=b'$．
        \item $1=11'=1'$．
        \item $b=bab'=b'$．
    \end{enumerate}
\end{proof}

\begin{definition}[characteristic]
    体$K$が$\Q$を（部分体として）含むとき，体の\textbf{標数}は$0$であるという．
    体$K$が有限体$\F_p$を（部分体として）含むとき，体の標数は$p$であるという．
\end{definition}
\begin{remark}
    標数が$0$であるとは，基本零元は$0$だけだということである．
    一方標数が正整数であるとき，他の数でも「割っちゃいけない」ルールが発生することがある．
\end{remark}

\begin{definition}[skewfield / division ring]
    積が可換でない体を\textbf{斜体}という．
\end{definition}

\begin{proposition}[和の中立元は零元となる，体の加群への作用のうち対合であるもの$-1$]
    $a\in K$とする．
    \begin{enumerate}
        \item $0a=a0=0$．
        \item $(-1)a=-a$．
        \item $-(-a)=a$．
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{enumerate}
        \item $a0+a0=a(0+0)=a0$より．
        \item $1a+(-1)a=(1-1)a=0a=0$より．
        \item $a+(-a)=0$という逆元の定義より．
    \end{enumerate}
\end{proof}

\section{線型空間の定義}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    $K$-線型空間$V$の基底$B$とは，後から部分空間の言葉を導入し，それを用いて線型独立の概念を定義した（定義\ref{def-linear-independent}）後から省みると，次の２通りの見方がある（命題\ref{prop-categorical-basis-old}）．
    \begin{enumerate}
        \item 線型独立な$V$の生成系$B\subset V$：$V=\langle B\rangle$．
        \item $B\subset V$の定める同型$B:K^{\oplus n}\to V$．
    \end{enumerate}
    ではなぜ体上の加群にはこういうものが考えられるのか．なんとなく，基底と双対基底というものは組で存在するもののはずである．
\end{tcolorbox}

\begin{definition}[linear space, ground field]
    体$K$上の加群を\textbf{$K$-線型空間}という．この時体$K$を\textbf{係数体}という．

    「上の」とは，加群の積と体の作用が，次の４つの整合性条件を満たすことをいう．
    \begin{enumerate}
        \item 演算$(+)+(\cdot):K\times K\times V$の可換性：$(a+b)x=ax+bx$．
        \item 演算$(\cdot)+(+):K\times V\times V$の可換性$a(x+y)=ax+ay$．
        \item ２つの積演算の合成$(\cdot)+(\cdot)$の結合性：$(ab)x=a(bx)$．
        \item 積の単位元の共有：$1x=x$（体$K$の積の単位元の作用は単位者）．
    \end{enumerate}
\end{definition}
\begin{remark}[線型空間の定義の非対称性]
    スカラー倍や「〇上の加群」というと異質なものが混ざったような印象を受けるが，結局積とは$\cdot:K\times V\to V$である．
    ああ，定義を精査すればするほど，加群論とその先の数学が待ち焦がれる．
    \begin{enumerate}
        \item スカラーの作用と考えれば，これは左からの作用になっているから，特に左加群という．一般の環上の加群では（division ringでさえも），可換性が保たれないので，この区別は肝要になる．
        \item 明らかに値域に$K$が足りていなくて，双対空間がまたれる．こうして理論が対称になる．
    \end{enumerate}
    このとき，空間内部に残る非対称性の残滓が「基底」であるとも理解できる．
\end{remark}

\begin{definition}[basis]
    $(x_i)_{i\in [n]}$が\textbf{基底}であるとは，次が成り立つことをいう：
    \[ \forall x\in V,\; \exists\textcolor{red}{!} a=\begin{pmatrix}a_1\\\vdots\\a_n\end{pmatrix}\in K^n,\; x=a_1x_1+\cdots+a_nx_n. \]
\end{definition}
\begin{remark}[圏論的な基底の定義]
    上記の定義は，いわば線型空間$V$の生成元としての定義であった．
    一方次のような定義もできる（線型空間の場合は，$K$上の自由加群と見做して同様に定義できる．全ての線型空間は自由加群であるというのが，基底定理の主張に他ならない）．

    自由$R$-加群$M$の基底とは，集合$I$が存在して，$R$-加群と見做された$R^I$(a module over itself)への同型$B:M\to\oplus_{i\in I}R$のことである．
\end{remark}
\begin{proposition}[基底の特徴付け１]\mbox{}
    \begin{enumerate}
        \item $B$は，加群$M$の生成元を定める．
        \item $M$基底は，同型$B$を定める．
    \end{enumerate}
\end{proposition}

\begin{definition}[canonical basis]
    数ベクトル空間$K^n$に対して，$e_1,\cdots,e_n$を\textbf{標準基底}という．
\end{definition}

\begin{proposition}[基底の特徴付け２]\label{prop-categorical-basis-old}
    $(x_i)_{i\in[n]}$が定める写像$f:K^n\to V$を，$\begin{pmatrix}a_1\\\vdots\\a_n\end{pmatrix}\mapsto a_1x_1+\cdots a_nx_n$とする．
    次の３条件は同値である．
    \begin{enumerate}
        \item $(x_i)_{i\in[n]}$は$V$の基底である．
        \item 基底の定める写像$f:K^n\to V$は同型である．
        \item $(\forall x\in V,\; \exists a=\begin{pmatrix}a_1\\\vdots\\a_n\end{pmatrix}\in K^n,\; x=a_1x_1+\cdots+a_nx_n)\land(\forall b_1,\cdots,b_n\in K,\; b_1x_1+\cdots+b_nx_n=0\Rightarrow b_1=\cdots=b_n=0)$．
    \end{enumerate}
\end{proposition}
\begin{proof}
    1.$\Leftrightarrow$2.は論理を集合と写像（双射）の言葉で言い換えただけである．
    座標の組み合わせと$V$の点が一対一対応するような基底の取り方を基底という．

    1.$\Leftrightarrow$3.は論理的な言い換えで，$\Rightarrow$はすぐに従うが，$\Leftarrow$は自明ではない．
\end{proof}
\begin{remark}
    $0$の核のみを確認すれば良いことは，論理的なトリックとしては明快であるが，その背後に何かある．
    即ち，$f:K^n\to V$が$0$を$0$に写すことを確認しているのではないか？その確認が取れたら即基底として良い，というのがVeckの性質ではなかろうか？

    きっとこれは核の言葉で理論化される．
\end{remark}

\section{線型空間の構成例}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    まず最初に定義するのが圏論的な意味での直和である（記号$\oplus$は圏論的な意味論介在を表す）．
    これは，線型独立な基底をある種の暴力的操作によって生み出す．
    即ち，任意の$V'$に対して，$\Hom(V\oplus W,V')\to\Hom(V,V')\times\Hom(W,V')$が可逆になるように作る，直積の内面化である．

    これに対して，「線型空間の和」を自然に定義すれば，この意味での「和」が，
    圏論的な意味での直和に一致するかどうか（＝同型が存在するか）によって，
    「次元が潰れているかいないか」を「測る」ことができる．
\end{tcolorbox}

\begin{definition}[direct sum in a categorical sense]
    $K$-線型空間$(V,+_V,\cdot_V),(W,+_W,\cdot_W)$に対して，
    その上の和とスカラー倍の写像が定める写像$+_V\times+_W:(V\times W,V\times W)\to V\times W,\cdot_V\times\cdot_W:K\times(V\times W)\to K$によって，
    集合$V\times W$上の$K$-線型空間と見做したものを，\textbf{直和}と呼び，$V\oplus W$と表す．
    これは圏$\Vect_K$に於ける直和である．
    しかし構成があまりに強力であり，命題\ref{prop-characterization-of-direct-sum}が成り立つように，ほとんどの場合では
    ここまでの必要がない．従ってこちらを\textbf{抽象的な直和}と呼んで区別する．

    このときの直和を定める包含射$i:V\to V\times W,j:W\to V\times W$は，それぞれの基底$x_1,\cdots,x_n\in V,y_1,\cdots,y_m\in W$を$(x_1,0),\cdots,(x_n,0),(0,y_1),\cdots(0,y_m)\in V\oplus W$に埋め込む．
\end{definition}
\begin{remark}
    頭結合が積写像，足結合が和写像である．
    従って，正確には，
    \begin{align*}
        +_V&:V\times V\to V&+_W&:W\times W\to W\\
        \cdot_V&:K\times V\to V&\cdot_W&:K\times W\to W
    \end{align*}
    のそれぞれの直和の間に定まる写像である．
    \[ \xymatrix{
        &V\times V\ar[r]^-{+_V}\ar[d]^-{i}&V\ar[d]^-{i}\\
        (V\times W)\times(V\times W)\ar[r]^-{\sim} &(V\times V)\times(W\times W)\ar@{-->}[r]&V\times W\\
        &W\times W\ar[u]_-{j}\ar[r]^-{+_W}&W\ar[u]_-{j}
    } \]
\end{remark}
\begin{notation}
    $K$-線型空間$V$に対して$V^n$とは，直和$V^n:=V^{\oplus n}$のことである．
\end{notation}

\begin{example}[a trivial example]
    $K^0=\{0\}=0$は$K$-線型空間である．
\end{example}

\begin{example}[a space of matrices]
    行列の空間$M_{mn}(K)$は数ベクトル空間として線型空間をなす．
\end{example}

\begin{example}[a space of functions]
    関数の和とスカラー倍は，組と同様に，point-wiseに定められる．直積の普遍性である．
    \begin{enumerate}
        \item 無限回微分可能な実関数全体の集合$C^\infty(\R):=\{f:\R\to\R\mid fはC^\infty 級\}$は，関数の和とスカラー倍について実線型空間となる．
        \item 開集合$U\subset\C$上の正則関数がなす空間$\mathcal{O}=\{f:U\to\C\mid fは正則関数\}$は，複素線型空間をなす（これは層をなす）．
    \end{enumerate}
\end{example}

\begin{example}[a space of sequences]\label{example-space-of-sequences}
    特に，関数$a:\N\to\R$の全体のなす空間$\R^\N$は，数列の空間である．
\end{example}

\begin{example}[a space of polynomials]
    $K$係数多項式の空間$K[X]:=\{a_0+a_1X+\cdots+a_nX^n\mid n\in\N,a_0,\cdots,a_n\in K\}$は，$K$-線型空間となる．
    多項式は結局一つの関数$K\to K$を表すことからもわかる．
\end{example}

\begin{example}[a space of mappings]
    配置集合$K^X$は$K$-線型空間となる．
\end{example}

\subsection{部分空間}

\begin{example}[部分空間になるもの]\mbox{}
    \begin{enumerate}
        \item $W=\{f\in C^\infty(\R)\mid  f''=0\}$は線型空間．
        \item $W=\{(x_0,x_1,\cdots)\in \R^\N\mid x_{n+2}=x_{n+1}+x_n\}$は線型空間．
    \end{enumerate}
\end{example}

\subsection{体と線型空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    議論の途中で複素化などをすると，体の拡大を自由に行える圏が欲しくなる．
    あるいは$\FinVect_\R$などの圏などないのだろうか．
    環上の加群論と繋がるのだろうか．
\end{tcolorbox}

\begin{example}[extention field]
    $\C$は$\R$-線型空間となり，$\R$は$\Q$-線型空間となる．

    一般に，体$K$に対して，有理関数体$K(X)$は$K$-線型空間となる．
\end{example}

\begin{example}[複素線型空間の構成：conjugation, complexification]\mbox{}\label{example-complexification}
    \begin{enumerate}
        \item 線型空間の共役と言った時は，体の作用についての共役をいう．即ち，$\C$-線型空間$V$に対して，スカラー倍を$a\cdot'x=\overline{a}x$として得る空間$V'$を$\C$-線型空間$V$の\textbf{共軛}という．即ち，体$\C$を同型$\overline{ }$で変換した後の$\C$を採用しても，対合的な$\C$-空間を得るのみである．
        \item $\R$-線型空間$V$に対して，その$\R$-直和空間$V\oplus V$にさらに係数体の拡大$\R\to\C$をし，それに沿ってスカラー倍$\cdot:\C\times(V\oplus V)\to (V\oplus V)$を$(a+bi)(x,y)=(ax-by,bx+ay)$で定める（係数体の拡大前は常に$b=0$だった）．
        こうして得た$\C$-線型空間としての$V\oplus V$を$V_\C$と書き，これを\textbf{複素化}という，従って「直和に係数体の拡大を伴ったもの」という特別な場合を表す．
        また$V=\R$の場合，複素線型空間としての$\C$は，実線型空間$\R$の複素化である：$\R\oplus\R=:\R_\C\simeq\C$．これを一般化したものである．
        $V\oplus V$の元として形式的なまま表せば，$(x,y)=(x,0)+i(y,0)$である．複素数論では$z=x+yi$と略記し，適宜$\R\oplus\R$と同型を取る．
        $x_1,\cdots,x_n$を$V$の基底とすると，$(x_1,0),\cdots,(x_n,0)$は$\C$-線型空間としての$V_\C$の基底である，複素数論では通常こんな見方（$\C$を$\C$-線型空間と見る見方）はしない．
    \end{enumerate}
\end{example}

\begin{remark}[functions on a vector space]
    汎関数では特にそうであるが，線型空間上の関数と行った時は，暗黙のうちに係数体$K$に値を取る．
    これは今までの数学では$K=\R,\C$の場合のみを考えてきたというだけのことである．
\end{remark}

\begin{itembox}[l]{体と線型空間との構造は極めて緊密な関係にある}
    はじめの例は全て線型空間の間の写像の空間を線型空間と満たすという種のものであったが，そこから多項式という表示形式に注目すると，
    体の拡大も線型空間の言葉で捉えられることがわかった．
    Galois理論を線型代数によって定式化したのはEmil Artin，圏論によって定式化したのはAlexander Grothendieckである．

    そして，体の拡大と極大としての複素数，その複素数を得る手順の線型空間への翻訳としての複素化．体と線型空間は切っても切れない関係にある．

    では，物理学の方から提出された，変換性の違いという意味でのベクトルとスカラーの概念と線型代数の出会いはいつだったのであろうか？どうして「線型空間とその係数体の関係だ！」と気づけたのか．
\end{itembox}

\section{部分空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    部分空間は，線型空間の記述において一番肝要になる．いや，正しくは線型空間は部分空間の言葉のみによっても完全に記述できる．
    通常の集合の演算の言葉は上手く通用せず，部分空間とその和によって語り尽くされるのである．

    その，部分空間の言葉による回収作業は，特定の基底などの内部構造を抽象化するわけだから，極めて圏論的な感覚から，次のようにして行われる．
    \begin{enumerate}
        \item 生成の概念により，全ての部分集合は，部分空間のことばに回収される．また，一般の元が「特定の部分集合が生成する空間の元」として理解できる時，それらの部分集合による線型結合という．
        \item 基底とは同型に他ならない．基底の実体とは，その時その時で好きに取れば良いが，その自由性は外部にある同型に因る．これを掴んだ概念を圏論的直和といい，線型空間に於ける基底は基本このことばによって表現される，即ち，圏論的な直和とは線型独立なものの標準的構成法に他ならない．
        \item 線型独立とは，圏論的には，「生成する空間の基底となる関係」のことをいう．これは直観的にどの２つも潰れないことを意味し，形式的には$\langle x_1,\cdots,x_n\rangle=Kx_1\oplus\cdots\oplus Kx_n$を意味するからである．右辺の圏論的直和は，直積による強制的な基底の構成法（に支配される数ベクトル空間$K^n$からの同型があること）を意味し，左辺は生成する部分空間である（この元を一次結合という）．
        \item 「線型空間の和」の概念が極めて自然に定義される．これが圏論的な直和に一致するときが，互いに素な場合に他ならず（命題\ref{prop-characterization-of-direct-sum}），
        \item 線型空間の一般の和の場合は，共通部分と互いに素な部分に分け，互いに素な部分は圏論的直和として構成する，この構成力は集合論的直積に支えられており，形式としての使いやすさは抜群である．すると基底とは同型射なので基底はすぐわかる．これで互いに素な部分＝拡大部分は解決する（系\ref{cor-basis}）．
    \end{enumerate}
\end{tcolorbox}

\begin{definition}[subspace]
    $K$-線型空間$V$の部分集合$W$が次を満たす時，これは線型空間となる．これを$K$-\textbf{（線型）部分空間}という．
    \begin{enumerate}
        \item $\forall x,y\in W, x+y\in W$．
        \item $\forall  a\in K,  \forall x\in  W, ax \in W$．
        \item $0_V\in W$．
    \end{enumerate}
\end{definition}
\begin{proof}
    和とスカラー倍は$W$への制限を取るだけで$W$上の演算として定まる．
    すると$V$の構造が遺伝する形で，$W$も線型空間となる．
\end{proof}

\subsection{部分空間の構成}\label{section-construction-of-subspaces}

\begin{definition}[元が生成する部分空間]
    $K$-線型空間$V$の$x\in V$に対して，$Kx:=\{ax\in V\mid a\in K\}$は部分空間である．
    $x\ne 0$ならば$x$は$Kx$の基底だが，$x=0$の時はそうではない（注\ref{remark-emptyset}）．
\end{definition}

\begin{proposition}[部分空間の和，共通部分]
    $W,W'$を$V$の部分空間とする．
    \begin{enumerate}
        \item 部分空間の\textbf{和}を$W+W':=\{x+x'\mid x\in W,x'\in W'\}$と定める．これは再び$V$の部分空間である．
        \item $W\cap  W'$は$V$の部分空間となる．
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{enumerate}
        \item $W,W'$が部分空間であることより，演算の閉性は$W+W'$でも受け継がれる．$0\in W+W'$．
        \item ２つの部分空間の閉性が$W\cap W'$に受け継がれるので定まっている．
    \end{enumerate}
\end{proof}

\begin{definition}[部分集合が生成する部分空間，生成系]\label{def-generator}
    $x_1,\cdots,x_n\in V$とする．
    \begin{enumerate}
        \item 元$x_1,\cdots,x_n$によって生成される部分空間$Kx_1+\cdots+Kx_n$を$\langle x_1,\cdots,x_n\rangle$と書くこととする．\textbf{この元を}$x_1,\cdots,x_n$の\textbf{線型結合}と呼ぶ．
        \item $V=\langle x_1,\cdots,x_n\rangle$が成り立つ時，$x_1,\cdots,x_n$を$V$の\textbf{生成系}であるという．
    \end{enumerate}
\end{definition}
\begin{remark}[空集合の場合]\label{remark-emptyset}
    この定義では，$V$は空でないことに注意．
    \begin{enumerate}
        \item $0$の基底は$\varnothing$（空な族，またはその値域としての空集合）とする，ただ一つの元$0$ではないとする！これは次元の定義\ref{def-dimention}において，基底$(x_i)_{i\in 0}$が空な族になるためだと考えられる．
        \item 上の定義とは別に$\langle\varnothing\rangle=\{0\}$と約束する．
    \end{enumerate}
\end{remark}

\begin{proposition}[生成する部分空間の特徴付け：閉包]
    $\varnothing\subseteq X\subset V$に対して，$\langle X\rangle$は$X$を含む最小の部分空間である．即ち，次の２条件が成り立つ．
    \begin{enumerate}
        \item $\langle X\rangle$は$X$を含む部分空間である．
        \item $W$も$X$を含む部分空間であるとする．この時，$\langle X\rangle\subset W$．
    \end{enumerate}
\end{proposition}
\begin{proof}
    1は成り立つ．2は，$X=\varnothing$の時は$\langle X\rangle =0$で，また$0\in W$だから，$\langle X\rangle =0\subset W$．

    $X\ne\varnothing$の時．$W$は部分空間だからその２種の演算に対する閉性より，$x_1,\cdots,x_n$の任意の一次結合を含む．従って，$\langle X\rangle\subset W$．
\end{proof}

\begin{proposition}[互いに素であることの特徴付け]\label{prop-characterization-of-direct-sum-2}
    $V$の部分空間$W,W'$について，次の２条件は同値である．
    \begin{enumerate}
        \item $W\cap W'=0$．
        \item 自然な同型射$\varphi:W\oplus W'\to W+W'$が存在する（勿論，$(x,x')\mapsto x+x'$と写す）．
    \end{enumerate}
\end{proposition}
\begin{proof}* 
    1.$\Rightarrow$2.について，$W+W'=\varphi(W\oplus W')$が定義（の言い換え）であるので，全射性は必ず保たれる．
    あとは$\varphi$が単射であることを示せば良い．
    $x,y\in W,x',y'\in W'$が$x+x'=y+y'\Leftrightarrow x-y=y'-x'$とすると，左辺は$W$の元で右辺は$W'$の元．
    従って，これらは$0$に他ならない．よって$x=x',y=y'$が導かれる．よって互いに素な時(1)，$\varphi$は単射．

    2.$\Rightarrow$1.について．$x\in W\cap W'$を取ると，$\varphi(x,0)=x=\varphi(0,x)$であるから，$\varphi$の単射性より，$x=0$．
\end{proof}
\begin{remark}[what is naturality?]
    $W+W'\subset W\oplus W'$という集合を考える．$i:W\to W+W', j:W'\to W+W'$という包含写像が存在し，
    写像の和として$i+j:W\oplus  W'\to W+W'$を考える（$(i+j)(x+x')=i(x)+j(x')=x+y\in W+W'$）．これを「自然な写像」と呼んだ．
    改めて，$W+W'=(i+j)(W\oplus W')$と定める．
    これが直和が定める射に一致する時，可逆になるという訳である．
\end{remark}

\begin{notation}[direct sum]
    命題\ref{prop-characterization-of-direct-sum}より，$W\oplus W':\Leftrightarrow W+W'\land W\cap W'=0$と書く．
    同型$\varphi$により，同一視できるからである．
\end{notation}

\begin{example}[いろいろな直和]
    例えば$K^n$は同一視できない．$K\cap K\cap\cdots\cap K=K\ne 0$だからである．
\end{example}

ここで，必ずしも$\varphi$が同型ではない場合の統一的な取り扱いについて考える．
基本的には「同型が取れる部分（今回では$\langle y_1,\cdots,y_m\rangle$部分と$\langle z_1,\cdots,z_r\rangle$部分）」
を確保してそこから話を組み立てることになる．
すでに部分空間とその和・直和の言葉が整っているので，自由自在に使いこなせば良い．

\begin{corollary}[部分空間の和の基底は，基底の和である]\label{cor-basis}
    $V$を$K$-線型空間とし，$W,W'$を部分空間とする．
    \begin{enumerate}
        \item $(x_i)_{i\in[n]}$を$W\cap W'$の基底，
        \item $(x_i)_{i\in[n]},(y_i)_{i\in[m]}$を$W$の基底，
        \item $(x_i)_{i\in[n]},(z_i)_{i\in[r]}$を$W'$の基底とすれば，
    \end{enumerate}
    $W+W'$の基底は$(x_i)_{i\in[n]},(y_i)_{i\in[m]},(z_i)_{i\in[r]}$である．
\end{corollary}
\begin{proof}
    \textbf{基底についての条件は部分空間と抽象的な圏論の意味での直和の言葉に翻訳するのが良い}．
    $W'':=\langle z_1,\cdots,z_r\rangle\subset W'$と置けば，$W+W'=W\oplus W''$であると示せば良い．
    （しかし$W''=W\setminus W'$とは限らないのが線型空間の肝である．）

    まず，直和の定義より，$x_1,\cdots,x_n,z_1,\cdots,z_r$は全て$V$の基底で線型独立であるから，$(W\cap W')\cap W''=0$より，
    $W'=(W\cap W')\oplus W''= (W\cap W')+ W''$．よって，$W+W'=W+((W\cap W')+ W'')=W+W''$．
    この時実は$W\cap W''\cap (W\cap W')\cap W''=0$より，右辺は直和$W\oplus W''$である（命題\ref{prop-characterization-of-direct-sum}）．
    よって，$W+W'=W\oplus W''$の基底は，$(x_i)_{i\in[n]},(y_i)_{i\in[m]},(z_i)_{i\in[r]}$である．
\end{proof}

\subsection{部分空間の例}

\begin{example}[subspaces of square matrix's spaces]
    \begin{align*}
        S_n(K)&:=\{A\in M_n(K)\mid Aは対称行列，即ち，1\le i<j\le n\Rightarrow a_{ij}=a_{ji}\},\\
        A_n(K)&:=\{A\in M_n(K)\mid Aは交代行列，即ち，a_{ij}=-a_{ij},\;(1\le i<j\le n)\land a_{ii}=0,\;(i\in[n])\},\\
        D_n(K)&:=\{A\in M_n(K)\mid Aは対角行列，即ち，1\le i<le n\Rightarrow a_{ij}=a_{ji}=0\},\\
        T_n(K)&:=\{A\in M_n(K)\mid Aは上三角行列，即ち，1\le i<le n\Rightarrow a_{ij}=0\}.
    \end{align*}
\end{example}

\begin{example}[subspaces of function spaces defined by differential equations]
    $V=\{f\in C^\infty(\R)\mid f^{(m)}=p_1f^{(m-1)}+\cdots+p_{m-1}f'+p_mf, m\in\N\}$は部分空間である．
    例えば空間$\{f\in C^\infty(\R)\mid f''=-f\}$の基底は三角関数$\sin,\cos$である．
\end{example}

\begin{example}[subspaces of sequences' spaces defined by recurrence relations]
    $W=\{(a_n)\in\R^\N\mid a_{n+m}=p_1a_{n+m-1}+\cdots+p_{m-1}a_{n+1}+p_ma_n,\;n\in\N\}$は部分空間である．この空間の基底は，この漸化式を満たす$m$個の数列$b_0,\cdots,b_{m-1}\in W$を，$b_i(j):=\delta_{ij}$と取れば，これは
    この空間の標準基底である．即ち，漸化式を満たす数列という部分空間は，初期条件だけの自由度がある．
\end{example}

\begin{example}[subspaces of polynomials' spaces]
    $V=\{a_0+a_1X+\cdots a_nX_n\in K[X]\mid a_0,\cdots,a_n\in K,n\in\N\}$は部分空間であり，$1,X,\cdots,X^n$は$V$の基底になる．

    また，$f\in K[X]$で割り切れる多項式の全体$(f):=\{fg\mid g\in K[X]\}(=f\cdot K[X])$は部分空間を生成する．
\end{example}

\begin{example}[subspaces of mappings' spaces where mappings have finite supports]
    写像空間のうち，台が有限集合となるようなものからなる部分集合$K^{(X)}:=\{f:X\to K\in K^X\mid f(x)\ne 0となるx\in Xは有限個である\}$は有限次元の部分空間である．
    基底は，台$\supp(f)$の各点$x\in\supp(f)$についての特性関数の逆$e_x(y)=\delta_{xy}$である．
\end{example}

\begin{example}[多項式の空間についての結果：整域というか，環論っぽい]
    $f\in K[X]$を$n\ge 0$次の$0$でない多項式とし，それに対応して$W$を$n-1$次以下の多項式全体のなす$K[X]$の部分空間とする．
    すると，$K[X]=(f)\oplus W$となる．即ち，$f$は$K[X]$の積について$n$次以上の式の全てを生成する．

    大学入試での，任意の多項式$g\in K[X]$に対して$f$で割った商$q\in K[X]$と余り$r\in W$を一意的に対応させる
    という議論は，同型$\varphi:(f)\oplus W\to K[X]$の逆射である．
    
    なお，$K[X]$において，このように$0$を別にして議論したい場合ばかりであるので，
    多項式$0$は$-\infty$次元であると考える．
\end{example}

\section{次元}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    部分空間についての言葉が揃ったので，いよいよ線型空間の分類に取り掛かる．
    「次元」という言葉はいささか自然言語的で生得的であるが，線型空間の分類定理\ref{thm-dimention}と次元の存在定理\ref{thm-basis}が成り立つからこそである．
    この本質は，部分空間を拡大する際に，既存の基底に対して一次独立などの元を取るかに依らず一意的に生成できることに依拠する（補題\ref{lemma-welldefinedness-of-expansion-of-subspaces}）．
    この生成は，元の取り方に依らず，$x_i\in\langle x_1,\cdots,x_{i-1}\rangle$を満たすものを取れば良い．
    こうして，次元という特徴量と，部分空間の拡大法のwell-definedness（などの圏論的性質）を集合論から議論する．
    この際に，線型独立系と生成系が与えられれた時にその中から基底を選びとるアルゴリズムをまず構成すれば（定理\ref{thm-linear-system-extension-algorithm}），殆どの結果はそのアルゴリズムから導ける．
    これらの道具を用いれば最終的に，任意の部分空間は直和因子であることを導ける，これが線型空間が直観的に扱いやすい根源であるとも言える．
    この性質を無限次元にも拡張できる，これは次の節で議論する．

    基底の概念であるが，係数比較の式とは，「基底とは，それが定める射が可逆になるもののことをいう」という定義式に他ならない．
    その全射性を「生成系」の概念で捉え，その単射性を「線型独立」の概念で捉えるのである．
    Vectは今後も全射と単射の２つの概念で進む．
\end{tcolorbox}

部分空間の構成（\ref{section-construction-of-subspaces}節）の言葉で，線型独立性は次のように定められる．
\begin{definition}[linear independent]\label{def-linear-independent}
    $x_1,\cdots,x_n\in V$が\textbf{線型独立}であるとは，$x_1,\cdots,x_n$が自身の生成する部分空間$\langle x_1,\cdots,x_n\rangle$の基底となることをいう．
\end{definition}
\begin{remark}
    部分集合が部分空間を生成することの定義\ref{def-generator}では，生成する部分空間を「元が生成する個々の部分空間の和」の言葉で定義している．従って，一次従属だった場合は，その際に潰れる次元が出てくるため，
    $x_1,\cdots,x_n$は自身の生成する部分空間の元を一意的には表さなくなる．従って，個数が多すぎるために基底にはならなくなる．
\end{remark}

\begin{proposition}[一次独立の特徴付け：一次独立系の拡大法]\label{prop-linear-system-expansion}
    $x_1,\cdots,x_n\in V$に対して，次の２条件は同値．
    \begin{enumerate}
        \item $x_1,\cdots,x_n$は線型独立である．
        \item $x_1,\cdots,x_{n-1}$が線型独立，かつ，$x_n\notin\langle x_1,\cdots,x_{n-1}\rangle$．
    \end{enumerate}
\end{proposition}
\begin{proof}
    1.$\Rightarrow$2.は，$x_n\in\langle x_1,\cdots,x_{n-1}\rangle$と仮定すると，
    $a_1x_1+\cdots+a_{n-1}x_{n-1}-x_n=0$であるが，$x_1,\cdots,x_n$は線型独立であるから，$-1=0$を得るが，これは$K$が体であることに矛盾．

    2.$\Rightarrow$1.は，圏論的には，$\varphi:\langle x_1,\cdots,x_{n}\rangle=\langle x_1,\cdots,x_{n-1}\rangle+Kx_n\to\langle x_1,\cdots,x_n\rangle\oplus Kx_n$が全単射であることを示せば良い．
    従って，$v\in\langle x_1,\cdots,x_{n}\rangle$を任意にとり，$v=a_1x_1+\cdots+a_nx_n$とした時の，表示の一意性を示せば，$\langle x_1,\cdots,x_n\rangle\oplus Kx_n$の元$(a_1x_1+\cdots+a_{n-1}x_{n-1},a_nx_n)$と標準的な同型が取れるので，それで示せたことになる．
    \textbf{表示の一意性を示すには，$=0$の場合のみを確認すれば良い}．
    $a_1v_1+\cdots+a_nv_n=0$とする．この時$a_nv_n=-a_1v_1-\cdots-a_{n-1}v_{n-1}$となるが，$v_n\notin\langle v_1,\cdots,v_{n-1}\rangle$より，$a_n=0$．すると，$v_1,\cdots,v_{n-1}$が基底であることより，$a_1=\cdots=a_{n-1}=0$．
\end{proof}

\begin{shadebox}\begin{theorem}[線型空間の分類定理 (Ernst Steinitz)]\label{thm-dimention}
    $V$を$K$-線型空間とする．$(x_i)_{i\in [m]}$と$(y_i)_{i\in [n]}$がいずれも$V$の基底であるならば，$n=m$である．
\end{theorem}\end{shadebox}
\begin{proof}
    互いに逆写像である写像$f:[m]\to[n]$と$g:[n]\to[m]$を構成する事により，$|X|=|Y|$を証明する．

    部分空間の列$\{V_i:=\langle x_1,\cdots,x_i\rangle\}_{i=0,1,\cdots,m},\{W_j:=\langle y_1,\cdots,y_j\rangle\}_{j=0,1,\cdots,n}$を定める．
    これに対して，$f(i)=j$を，$x_i\in V_{i-1}+W_j$を満たす最小の$j$として定義し，$g$も対称に定義する．
    この時に，$f(i)=j\Leftrightarrow g(j)=i$と示せれば，定理の主張を得る．

    まず$f:[m]\to[n]$を定義する，各$i=1,\cdots,m$に対して，部分空間の増大列
    \[ V_{i-1}=V_{i-1}+W_0\subset V_{i-1}+W_1\subset\cdots\subset V_{i-1}+W_n=V \]
    を考えると，$x_i\notin V_{i-1}+W_0$と$x_i\in V_{i-1}+W_n$とより，$x_i\in V_{i-1}+W_j$を満たす最小の$1\le j\le n$が定まる（この時，部分空間の増大列が無限に長い場合，選択公理が必要となる）．
    この$j$をして，$f(i)=j$と定める．同様にして，$g:[n]\to[m]$を定める．

    この時，$f(i)=j\Leftrightarrow g(j)=i$，即ち$f\circ g=\id,g\circ f=\id$は次の補題に一般化される．
\end{proof}
\begin{lemma}[線型空間の分類定理の論理的核：部分空間の拡大の方法に依らない]\label{lemma-welldefinedness-of-expansion-of-subspaces}
    $x,y\in V, V'\subset V$とする．次の２条件は同値である．
    \begin{enumerate}
        \item $x\notin V'\land x\in V'+Ky$．
        \item $y\notin V'\land y\in V'+Kx$．
    \end{enumerate}
\end{lemma}
\begin{proof}
    1.$\Rightarrow$2.を考える．$x\in V'+Ky$より，$z\in V', ay\in Ky$を用いて，$x=z+ay$と表せる．また$x\notin V'$より，$a\ne 0$である．
    （従って，$V'+Ky\simeq V'\oplus Ky$）．
    この時，$y=\frac{1}{a}(x-z)$より，$y\in V'+Kx, y\notin V'$．逆も同様．
\end{proof}
\begin{remark}[集合論を基礎に据えると，圏論的結果は風景になり，すぐには直接的な武器とはならないのは悲しい．]
    $V$の部分空間の包含関係
    \[\xymatrix{
        V'+Ky\ar[r]^-{j_x}&V'+Kx+Ky\\
        V'\ar[r]_-{i_x}\ar[u]^-{i_y}&V'+Kx\ar[u]_-{j_y}
    }\]
    を考える．これについて，条件1.,2.,はそれぞれ
    \begin{enumerate}[i]
        \item $i_x$は非可逆で，$j_x$は可逆である．
        \item $i_y$は非可逆で，$j_y$は可逆である．
    \end{enumerate}
    と同値である．実はこの図式は可換である．$V'\subsetneq V'+Kx+Ky$の時，可換になる時の各射の様子は，同値なi,iiの場合で尽きるのである．必ず一歩目の時点で拡大し切ってことが終わってしまう．
\end{remark}

\begin{definition}[(Hamel) dimention]\label{def-dimention}
    $n\in\N$に対し，$V$に基底$(x_i)_{i\in[n]}$が存在するならば，$V$は\textbf{有限次元}であるといい，$n=:\dim V$を$V$の\textbf{次元}という．
    有限次元でない線型空間を\textbf{無限次元}であるという．
\end{definition}
\begin{remark}
    より正確には，基底$B$の濃度と定義する．$\dim:\FinVect_K\to\Ord$は直和の構造を保つ．

    基底と次元の概念は複数存在し，特に関数空間などにおいて，無限和まで込めて基底と呼べる性質を，ベクトル空間の基底とアナロジーで考えて基底と呼ぶが，
    それに対して今回の意味での線型空間としての基底を\textbf{ハメル基底}または\textbf{代数的な基底}と言う．
\end{remark}

\begin{theorem}[線型独立系の基底への延長算譜]\label{thm-linear-system-extension-algorithm}
    $\langle x_1,\cdots,x_n\rangle =V$とする．
    \begin{enumerate}
        \item （算譜）いま$x_1,\cdots,x_m\;(m\le n)$が一次独立だったとする．
        \[\{i_1,\cdots,i_r\}:=\{i\in \{m+1,m+2,\cdots,n\}\mid x_i\notin\langle x_1,\cdots,x_{i-1}\rangle\}\]
        とすると，$x_1,\cdots,x_m,x_{i_1},\cdots,x_{i_r}$は$V$の基底である．
        \item （生成系の性質）$\dim V\le n$．等号成立時は，$x_1,\cdots,x_n$が基底である時である．
        \item （線型独立系の性質）$y_1,\cdots,y_m\in V$が線型独立とすれば，$m\le\dim V$である．$m=\dim V$ならば，これらは基底である．
    \end{enumerate}
\end{theorem}
\begin{proof}
    1. データ構造$(x_1,\cdots,x_m,x_{i_1},\cdots,x_{i_r})$の作り方より，$x_1,\cdots,x_m,x_{i_1},\cdots,x_{i_r}$は$V$の生成系であり，また命題\ref{prop-linear-system-expansion}より
    線型独立でもあることを，$l=n-m\ge 0$の帰納法について示せば良い．

    2. 1より$r\ge 0$が存在して$\dim V=m+r\le n$であるから．

    3. 生成系$\langle y_1,\cdots,y_m,x_1,\cdots,x_n$に対して1より，$m\le m+r=\dim V$であるから．
\end{proof}
\begin{remark}[線型独立系の基底への延長アルゴリズムを与えれば，2,3は系として導かれる．]
    前節の可換図式的な考え方を用いれば，$x_{i_1},\cdots,x_{i_r}$とは最短距離の拡張である．他の$x_{m+1},\cdots,x_n$を加えても空間に変化を起こさない．
    線型独立を十分に大きくすると基底となり，さらに大きいものは生成系となる．
\end{remark}

\begin{corollary}[有限次元であることの特徴付け]\mbox{}
    \begin{enumerate}
        \item $V$は有限次元である（＝有限集合$B$が存在して基底となる）．
        \item $V$の生成系であって，有限であるものがある．
        \item 自然数$n$であって，$x_1,\cdots,x_m\in V$が線型独立ならば$m\le n$となるようなものがある．
    \end{enumerate}
\end{corollary}
\begin{proof}
    1が存在を保証する基底を$B\subset V$とする．
    1$\Leftrightarrow$2について，$\Rightarrow$は基底を取れば生成形である．$\Leftarrow$は，生成系から定理\ref{thm-linear-system-extension-algorithm}.1
    で示した算譜により基底を作れる．
    1$\Leftrightarrow$3について，定理\ref{thm-linear-system-extension-algorithm}.3より，$n=\dim V=|B|$と取れば，$m\le n$を満たす．
\end{proof}

\begin{corollary}
    $n:=\dim V$とする．$x_1,\cdots,x_m\in V$に対して，次の３条件は同値．
    \begin{enumerate}
        \item $x_1,\cdots,x_m$は基底である．
        \item $\langle x_1,\cdots,x_m\rangle =V\land m=n$．
        \item $x_1,\cdots,x_m$は一次独立で$m=n$．
    \end{enumerate}
\end{corollary}

\subsection{線型空間の直和分解}

\begin{proposition}[任意の部分空間は直和因子である，direct summand, complement subspace]
    部分空間$W\subset V\in\FinVect_K, n=\dim  V$について，次が成り立つ．
    \begin{enumerate}
        \item $\dim W\le\dim V$であり，等号成立条件は$W=V$．
        \item $x_1,\cdots,x_m$を$W$の基底とする．この時，$x_{m+1},\cdots,x_n\in V$であって，$x_1,\cdots,x_n$が$V$の基底となるようなものが存在する．
        \item $V$の部分空間$W'$であって，$V\simeq W\oplus W'$となるものが存在する．（$W$は$V$の\textbf{直和因子}，$W'$は$W$の\textbf{補空間}という）．
    \end{enumerate}
\end{proposition}
\begin{proof}
    1. 一次独立な元$x_1,\cdots,x_m\in W$が取れたとすると，定理\ref{thm-linear-system-extension-algorithm}.3より，$m\le n$である．
    特に$x_1,\cdots,x_m$が基底である場合もこれに含まれる．従って$W$は有限次元．
    $m=n$である時，定理\ref{thm-linear-system-extension-algorithm}.2より，この線型独立系$x_1,\cdots,x_m$は$V$の基底でもある．従って，$W=\langle x_1,\cdots,x_{m=n}\rangle=V$．

    2. $V$の基底$y_1,\cdots,y_n$を取り，$x_1,\cdots,x_m,y_1,\cdots,y_n$について定理\ref{thm-linear-system-extension-algorithm}.1の算譜を適用すれば良い．

    3. 2において，$W'=\langle y_{i_1},\cdots,y_{i_{n-m}}\rangle$と置けば良い．
\end{proof}

\section{無限次元空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    無限和を定義するには，基底の定義を写像化・圏論化しなければならない．即ち「族」の言葉で定義する．
    今回は無限和の定義と収束性の議論は避け，一次結合や生成する部分空間とは「無限個の元から有限個選んだ和で表せるもの」とする，この話題は関数空間など，位相の構造も込みで考えねば収束性は議論できない．
    そこで，線型代数における直和$\oplus$の概念がはっきりする．

    有限次元の場合と全く同様に，次元定理が成り立つ．また，全ての線型空間の部分空間が射影因子であることが真に一般的に導ける．

    また，ここまで来て新たに示せる定理として，基底の存在定理がある．
\end{tcolorbox}

\begin{definition}[任意個の線型空間の直和]
    線型空間の族$(V_i)_{i\in I}$について，その\textbf{直和}とは，
    \[ \bigoplus_{i\in I}V_i:=\{(x_i)_{i\in I}\in\prod_{i\in I}V_i\mid 有限個のi\in Iを除いてx_i=0\} \]
    のことである．$V_i=K\;(i\in I)$である時，$\prod_{i\in I}=K^I, \oplus_{i\in I}=:K^{(I)}$と表す．$I$が有限集合である時に限って$K^I=K^{(I)}$である．
\end{definition}

\begin{definition}[任意個の一次結合]
    $(x_i)_{i\in I}\in V^I$の生成する空間の元を\textbf{一次結合}といい，$(a_i)_{i\in I}\in K^{(I)}$と有限集合$J\subset I$を用いて，$a_i=0\;(i\notin J)$として，
    \[ \sum_{i\in I}a_ix_i:=\sum_{i\in J}a_ix_i \]
    と定義する．
\end{definition}

\begin{definition}[基底，一次独立，生成系]
    $x=(x_i)_{i\in I}\in V^I$について，
    \begin{enumerate}
        \item $x$が定める写像$\varphi_x:K^{(I)}\to V$が可逆である時，$x$を$V$の\textbf{基底}という．
        \item $x$が$\langle x_i\mid i\in I\rangle$の基底である時，\textbf{線型独立}であるという．
        \item $V=\langle x_i\mid i\in I\rangle:=\{\sum_{i\in I}a_ix_i\mid (a_i)_{i\in I}\in K^{(I)}\}$の時，\textbf{生成系}という．
    \end{enumerate}
\end{definition}

\begin{example}
    $(X^i)_{i\in\N}$は$K[X]$の基底である．しかしその無限和も考えると，$(X^i)_{i\in\N}$はより大きな線型空間の「基底」たり得る．
\end{example}

\subsection{次元定理}

\begin{theorem}
    $(x_i)_{i\in I}\in V^I$が一次独立で，$(y_i)_{i\in J}\in V^J$が生成形であるならば，単射$I\to J$が存在する．
\end{theorem}

\subsection{基底の存在}

\begin{theorem}[basis theorem]\label{thm-basis}
    $K$-線型空間は基底を持つ．
\end{theorem}
\begin{remark}[選択公理と同値]
    It is a famous classical consequence of the axiom of choice (and is equivalent to it by a result of Andreas Blass, proved in 1984).
\end{remark}
\begin{proof}
    
\end{proof}

\chapter{線型写像}

\begin{quotation}
    まず線型写像（線型空間の射）の定義と例を見る．
    次に，数ベクトルのなす空間における線型写像は行列倍写像であるが，基底の理論によって一般の線型空間について拡張可能であることを見る．
    これを「行列表示」と言う．
    最後に「核」と「像」と言う（再び）部分空間の言葉を用いて，線型写像の分類を考える．
\end{quotation}

\begin{history}
    Cramerが1750に連立方程式を解くのに行列式を用いた．
    関孝和も1683に独自に見つけていた．行列式は1800年代にGaussがドイツ語Determinanteと命名し，行列はSylvesterが1850年ごろにmatrixと命名した．
    全く語源的関連はなく，日本でも初めはデテルミナントと母式と訳したが，高木貞治が行列式と行列と命名し直した．
\end{history}

\section{線型空間の射の定義}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    基底は元々「線型独立な生成系」で定義したが，線型写像を定義しその言葉で特徴付けを与える．同じように生成に関連する条件で，「その点の行き先さえ決めれば，線型写像が大域的に定まる」ような点が基底である（定理\ref{thm-categorical-basis}）．
    これを「$y_1,\cdots,y_n$が定める線型写像」という言葉でwell-definedに言及できる．特に$y_1,\cdots,y_n$が基底である時，「$y_1,\cdots,y_n$が定める同型」と言える（命題\ref{prop-characterization-of-isomorphism}）．
    つまるところ，点と射は双対的な存在であり，前者が一次独立な生成系であることは，後者が可逆であることに同値なのである．
\end{tcolorbox}

\begin{definition}[linear mapping]
    写像$f:V\to W$が$K$-線型写像であるとは，次の条件を満たすことをいう．
    \begin{enumerate}
        \item $\forall x,y\in V,\; f(x+y)=f(x)+f(y)$．
        \item $\forall a\in K,x\in V,\; f(ax)=af(x)$．
    \end{enumerate}
\end{definition}
\begin{example}[特別な線型写像]\mbox{}
    \begin{enumerate}
        \item 零対象$0$への／からのただ一つの射を零写像$0$とする．
        \item $A\in M(m,n;K)$とし，$f_A:v\mapsto Av$を$A$倍写像とする．$\times A$とも書く．
    \end{enumerate}
\end{example}

\begin{proposition}[vector space of linear mappings]
    $f,g$を線型写像とする．
    \begin{enumerate}
        \item $f+g$も線型写像である．
        \item $af$も線型写像である．
    \end{enumerate}
\end{proposition}

\begin{shadebox}\begin{theorem}[基底の特徴付け：その行き先を決めれば線型写像全体が決まるような元のこと]\label{thm-categorical-basis}
    $x_1,\cdots,x_n\in V$が定める関手$\FinVect_K\to\Set$の射
    \[\xymatrix@R-2pc{
        {\Hom_{\FinVect_K}(V,W)}\ar[r]^-{G}&W^n\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        {f:V\to W}\ar@{|->}[r]&{\begin{pmatrix}f(x_1)\\\vdots\\f(x_n)\end{pmatrix}}
    }\]
    について，次の２条件は同値である．
    \begin{enumerate}
        \item $x_1,\cdots,x_n$は$V$の基底である．
        \item それらが定める関手の射$G$は可逆である．
    \end{enumerate}
\end{theorem}\end{shadebox}
\begin{remark}[$n$元が定める線型写像]
    この全単射$G$によって，$V$の基底$x_1,\cdots,x_n$と（それにより真に定まる関手の射$G_x$と），$W$の$n$元$y_1,\cdots,y_n$とによって，線型写像$f:V\to W$が一意に定まる．
    特に$V=K^n$でこの標準基底を取った時，$y_1,\cdots,y_n\in W$が定める線型写像という．

    これは命題\ref{prop-categorical-basis-old}ですでに登場していた，パラフレーズである．
\end{remark}

\begin{proposition}\label{prop-characterization-of-isomorphism}
    $x_1,\cdots,x_n\in V$を基底とする．線型写像$f:V\to W$に対して，次の２条件は同値．
    \begin{enumerate}
        \item $f(x_1),\cdots,f(x_n)$は$W$の基底である．
        \item $f:V\to W$は同型である．
    \end{enumerate}
\end{proposition}

\begin{corollary}[induced isomorphism]
    $V$を$n$次元線型空間とする．
    \begin{enumerate}
        \item 次の写像$\mathrm{Iso}(K^n,V)\to\{Vの基底\}; f\mapsto (f(e_1),\cdots,f(e_n))$は可逆である．
        \item $W\subset V$を$m$次元部分空間とする．$K^m$を$K^n$の部分空間と同一視した時，同型$f:K^n\to V$であって，$f(K^m)=W$を満たすものが存在し，$f|_{K^m}:K^m\to W$も同型である．
    \end{enumerate}
    2.の時，$f:K^n\to V$は同型$f|_{K^m}:K^m\to W$を\textbf{引き起こす}という（単射が引き起こす写像・等化子）．
\end{corollary}

\begin{corollary}
    $V,W\in\FinVect_K$について，次の２条件は同値である．
    \begin{enumerate}
        \item $V\simeq W$．
        \item $\dim V=\dim W$．
    \end{enumerate}
\end{corollary}

\begin{proposition}\label{prop-when-dimention-is-same}
    $\dim V=\dim W$とする．線型写像$f:V\to W$に対し，次の３条件は同値である．
    \begin{enumerate}
        \item $f$は同型．
        \item $f$は単射．
        \item $f$は全射．
    \end{enumerate}
\end{proposition}

\subsection{一般の線型空間への拡張}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    空間は無限でも，基底は有限和しか定義したくない．
    このように，基底の空間$X$を指定し，それらの有限形式和全体からなる集合を考えたい場合は，
    $K^{(X)}$を考えればよいのであった．
    これは，$x_1,x_2,\cdots\in X$の特性関数$e_{x_1},e_{x_2},\cdots$を基底とする線型空間である．
\end{tcolorbox}

\begin{proposition}[基底の特徴付け：任意の次元について]\label{prop-categorical-basis-infinity}
    $X$を集合とし，$W$を$K$-線型空間とする．
    \[\xymatrix@R-2pc{
        {\Hom_{\Vect_K}(K^{(X)},W)}\ar[r]&{\Hom_{\Set}(X,W)}\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        f:K^{(X)}\to W\ar@{|->}[r]&g(x):=f(e_x)
    }\]
\end{proposition}
\begin{remarks}[基底としたい集合がある時，それが生成する線型空間を指定する普遍的方法]\label{remarks-K^(X)の構成意志}
    $K^{(X)}$とは，直積のことばから人工的に作った線型空間で，$X$はハメル基底の集合である．
    このテクノロジーはテンソル積を定義するときに使う．
    記号$x_1,x_2,\cdots\in X$は問答無用で基底であり，$K^{(X)}$の元は必ず有限和$a_1x_1+a_2x_2+\cdots+a_nx_n$で表される空間であるという場面設定である．
    この時，$x\in X$の行き先の選択全体の集合$\Map(X,V')$と，それが定める線型写像の空間$\Hom(K^{(X)},V')$には対応がつく．
    これは上記の，基底とそれが定める線型写像との議論の無限への一般化になっているが，ハメル基底という枠組みは抜け出していない．
    
    すると全ての基底は双対基底らしい概念$e_x$となる．これは双対空間の概念よりももっと基本的なもので，
    座標とは何かの根本的な見方としての「一般化された点」に近いものだろう．
\end{remarks}

\section{線型写像の例}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    全ての$K$-線型空間は，$K^n$と同型を取ることによって，そこからの線型写像が$A$倍写像と見做せる．
    まずはこの線型写像と行列，線型同型と可逆行列との対応を可換図式の言葉で調べる．

    次に線型写像の直和の言葉を準備してから，種々の例を構成する．
    線型写像について「直和」とは，直和構成が定める射を，出るもの入るもの全てそう呼んでしまう．
    部分空間をうまく分解すれば，上手な直和に線型写像が標準分解できることがすでに予期される．
\end{tcolorbox}

\subsection{行列の空間}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item $A\in M_{mn}(K)$とすると，$f_A:K^n\to K^m$は線型写像である．
        \item 写像
        \[\xymatrix@R-2pc{
            M_{mn}(K)\ar[r]&\Hom_{\FinVect_K}(K^n,K^m)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            A\ar@{|->}[r]&f_A}\]は可逆．
    \end{enumerate}
\end{proposition}

\begin{definition}[scaler matrices]
    スカラー行列$aI$倍写像を$a$倍写像という．スカラー行列全体のなす空間$M_n(K)$の部分空間を，$K$と表す．
\end{definition}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item 可逆写像\[\xymatrix@R-2pc{
            M_{mn}(K)\ar[r]&\Hom_{\FinVect_K}(K^n,K^m)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            A\ar@{|->}[r]&f_A}\]は線型同型でもある．即ち，$f_A+f_B=f_{A+B},af_A=f_{aA}$．
        \item モノイドとしても同型である．即ち，$A\in M_{mn}(K),B\in M_{nr}(K)$の時，$f_A\circ f_B=f_{AB}$．
    \end{enumerate}
\end{proposition}

\begin{corollary}
    行列積は結合的である．
\end{corollary}

\begin{proposition}[可逆行列]
    $A\in M_n(K)$に対し，次の３条件は同値である．
    \begin{enumerate}
        \item $f_A:K^n\to K^n$は同型である．
        \item $AB=BA=1$を満たす$B\in B_n(K)$が存在する．
        \item $Ae_1,\cdots,Ae_n$（$A$の列ベクトル）は$K^n$の基底である．
    \end{enumerate}
    これを満たす$A$全体からなる集合を$\GL_n(K)$と表す．
\end{proposition}

\subsection{線型写像の直和とそれを用いた構成例}

テンソルというか，行列をもう一度再発明する．
線型写像について「直和」とは，直和構成が定める射を，出るもの入るもの全てそう呼んでしまう．

\begin{definition}[線型写像の直和]\mbox{}
    \begin{enumerate}
        \item $f_1:V_1\to W,f_2:V_2\to W$を線型写像とする．これらの\textbf{直和}を$f_1\oplus f_2(x_1,x_2)=f_1(x_1)+f_2(x_2)$と定める．
        \begin{enumerate}[(1)]
            \item 第一射影は$\pr_1=\id_{V_1}\oplus 0:V_1\oplus V_2\to V_1\oplus 0\simeq V_1$である．この言葉を用いて，$f_1\oplus f_2=f_1\circ\pr_1+f_2\circ\pr_2$である．
            \item $V_1=V_2=W$で，$f_1=f_2=\id$である時，$\id\oplus\id:W\oplus W\to W$は$W$の加法である．
        \end{enumerate}
        \item $W=W_1\oplus W_2$とする．$f_1:V\to W_1,f_2:V\to W_2$の\textbf{直和}$f_1\oplus f_2$を$f(x)=(f_1(x),f_2(x))$と定める．
        \begin{enumerate}[(1)]
            \item $i_1:W_1\to W,i_2:W_2\to W$を直和が定める標準的単射とすれば，$f_1\oplus f_2=i_1\circ f_1+i_2\circ f_2$と表せる．
        \end{enumerate}
        \item $V=V_1\oplus V_2,W=W_1\oplus W_2$とすると，$f(x_1,x_2)=(f_{11}(x_1)+f_{12}(x_2),f_{21}(x_1)+f_{22}(x_2))$は線型写像を定める．これを
        \[ f=\begin{pmatrix}f_{11}&f_{12}\\f_{21}&f_{22}\end{pmatrix} \]
        と表す．次が成り立つからである：
        \[ \begin{pmatrix}y_1\\y_2\end{pmatrix}=\begin{pmatrix}f_{11}&f_{12}\\f_{21}&f_{22}\end{pmatrix}\begin{pmatrix}x_1\\x_2\end{pmatrix}. \]
        \item 次の線型写像も$f_1,f_2$の直和という．
        \[ f=\begin{pmatrix}f_{1}&0\\0&f_{2}\end{pmatrix} \]
    \end{enumerate}
\end{definition}
\begin{remark}[一般化された行列]
    $V=V_1\oplus\cdots V_n,W=W_1\oplus\cdots\oplus W_m$としても同じで，
    \[ f=\begin{pmatrix}f_{11}&\cdots&f_{1n}\\\vdots&\ddots&\vdots\\f_{m1}&\cdots&f_{mn}\end{pmatrix} \]
    と表す．$V_j=W_i=K$の場合，各$f_{ij}$はスカラー倍写像であり，これは行列$A$が定める線型写像$K^n\to K^m$を考えることにあたる．
    写像の合成が行列積にあたる．

    $m=n$の時，直和$f_1\oplus\cdots\oplus f_n$とは，
    \[ f_1\oplus\cdots\oplus f_n=\begin{pmatrix}f_{1}&0&\cdots&0\\0&f_2&\ddots&\vdots\\\vdots&\ddots&\ddots&0\\0&\cdots&0&f_{n}\end{pmatrix} \]
    を指す．これがJordan細胞の元となる．
\end{remark}

\begin{example}[行列内の演算]
    \[\xymatrix@R-2pc{
        {}^t\!:M_{mn}(K)\ar[r]&M_{mn}(K)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        X\ar@{|->}[r]&{}^t\!X
    }\]
    も線型写像である．
\end{example}

\begin{example}[微分演算子]
    \[\xymatrix@R-2pc{
        D:C^{\infty}(\R)\ar[r]&C^\infty(\R)&C^{\infty}(\R)\ar[r]&C^\infty(\R)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        f\ar@{|->}[r]&f'&f\ar@{|->}[r]&\int^x_0f(x)dx
    }\]
    も線型写像である．
    $m$階の微分方程式の解空間として次の部分空間
    \[V:=\{f\in C^\infty(\R)\mid f^{(m)}=p_1f^{(m-1)}+\cdots+p_{m-1}f'+p_mf\}\]
    を定めると，線型写像
    \[\xymatrix@R-2pc{
        F:V\ar[r]&\R^m\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        f\ar@{|->}[r]&{\begin{pmatrix}f(0)\\f'(0)\\\vdots\\f^{(m-1)}(0)\end{pmatrix}}
    }\]
    は同型になる．これは解の一意性条件と同値である．
\end{example}

\begin{example}[差分演算子]\label{example-difference-operator}
    \[\xymatrix@R-2pc{
        D:\R^\N\ar[r]&\R^\N\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        a\ar@{|->}[r]&b(n):=a(n+1)
    }\]
    も線型写像である．これに対して$\Delta:=D-1$を\textbf{差分演算子}と呼ぶ．
    \[ c=\Delta(a)=a(n+1)-a(n) \]

    $m+1\ge 2$項間漸化式により定まる部分空間を
    \[ W=\{a\in\R^\N\mid\forall n\ge 0,\; a(n+m)=p_1a(n+m-1)+\cdots+p_{m-1}a(n+1)+p_ma(n)\} \]
    と置くと，次の同型$G:W\to\R^m$が誘導される：
    \[\xymatrix@R-2pc{
        G:W\ar[r]&\R^m\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        a=(a_n)\ar@{|->}[r]&{\begin{pmatrix}a_0\\\vdots\\a_{m-1}\end{pmatrix}}
    }\]
    逆写像は一意的である，初期条件を満たせば漸化式を満たす数列は一意に定まるからである．
\end{example}

\begin{example}[係数列と冪級数の同型]
    \[\xymatrix@R-2pc{
        T:C^\infty(\R)\ar[r]&\R^\N\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        f\ar@{|->}[r]&(a_n:=f^{(n)}(0))
    }\]
    は全射な線型写像である．次の図式は可換である．
    \[\xymatrix{
        C^\infty(\R)\ar[r]^-D\ar[d]_-T&C^\infty(\R)\ar[d]^-T\\
        \R^\N\ar[r]^-D&\R^\N
    }\]
    $f\in V$の時，その$0$での導値が漸化式を満たすのは必要だから，$T(V)\subset W$は分かるが，実は$T|_V$が$V,W$の間に同型を定める．
    すると，$F=G\circ T|_V$である．
\end{example}

\begin{example}[多項式の剰余]
    $W$を$n-1$次以下の多項式のなす部分空間とすると，$n$次多項式$f\in K[X],f\ne 0$が定める写像
    \[\xymatrix@R-2pc{
        K[X]\ar[r]&W\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        g\ar@{|->}[r]&{g\mod f}
    }\]
    は線型写像である．$f$が一次式$f=X-a$の時は，$W=K$であり，上の写像は$a$での値写像$g\mapsto g(a)$となる．
\end{example}

\begin{example}[hom関手]\label{example-linear-hom-functor}
    集合$X,Y$とその間の写像$f:X\to Y$と体$K$について，
    \[\xymatrix@R-2pc{
        f^*:K^Y\ar[r]&K^X\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        g\ar@{|->}[r]&g\circ f
    }\]
    は線型写像である．
\end{example}

\begin{example}[複素化]\mbox{}
    \begin{enumerate}
        \item \[\xymatrix@R-2pc{
        V_\C\ar[r]&\C^n\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (a,b)\ar@{|->}[r]&a+ib
    }\]
    は$\C$-線型同型である．
    \item \[\xymatrix@R-2pc{
        \R[X]\ar[r]&\C[X]\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (f,g)\ar@{|->}[r]&f+ig
    }\]
    は$\C$-線型同型である．
    \item $\R$-線型写像$f:V\to W$に対して，直和$f\oplus f:V\oplus V\to W\oplus W$は$\C$-線型写像$f_\C:V_\C\to W_\C$を定める．これを\textbf{複素化}という．
    \item $V'$を$V$の共役とする．$f:V'\to W$が$\C$-線型写像であるとは，$f:V\to W$が線型写像であり，かつ次を満たすことをいう：
    \[ \forall a\in\C,x\in V,\; f(ax)=\overline{a}f(x) \]
    \end{enumerate}
\end{example}

\section{行列表示}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    有限次元線型空間$V\in\FinVect_K$の元は，基底$(x_i)$を定める度にベクトルの空間$K^n$からの同型が定まる．
    （$(e_i)$と$(x_i)$とが定める同型）．
    $\FinVect_K$の射は，始域と終域に基底を定めると標準的なベクトルの空間の間の射$K^n\to K^m$が定まる．
    すると，全ての線型写像は行列（ベクトルの空間の間の線型写像）だと思える．これを\textbf{行列表示}という．

    その行列表示は，無言で生じる同型では，ベクトルの空間$K^n$についていつも暗黙に標準基底$(e_i)$を取るから，
    各列ベクトルが，各$V$の（$(e_i)$の埋め込みとしての）基底$(x_i)$の行先の，$K^m$の基底$(e_j)$による表示となっているような行列となる．
    そのうち，自己準同型$f:V\to V$の話に限り，基底を始域も終域も$(x_i)$を用いると，これを\textbf{底の変換行列}という．
    この場合の詳細な理論はJordan標準形として打ち立てられている．
\end{tcolorbox}

\subsection{行列表示}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=行列表示]
    行列表示とは，各基底$x_i\in V$を$e_i$とcodeした空間にて，行列がどう表されるかである．
    基底の行き先は$Kx_i$とcodeされることとなるので，これらを縦ベクトルに並べたものと見做して構わない．
    必然的に，基底$x_1,\cdots,x_m$の係数のみに注目した空間となる．
    これを双対空間の言葉で表す流儀が存在する（内積による表示とも言える）：
    \[\begin{pmatrix}v_1\\\vdots\\v_n\end{pmatrix}=(x_1\;\cdots\;x_n)\begin{pmatrix}a_1\\\vdots\\a_n\end{pmatrix}.\]
    すると，基底$x_1,\cdots,x_n$の定める同型$\varphi:K^m\to V$とは，底の変換行列$x_i\mapsto e_i$に他ならない．
\end{tcolorbox}

\begin{definition}[行列表示(matrix representation), 表現行列]
    $K$を体とし，$V,W$を有限次元$K$-線型空間とする．$B=(x_1,x_2,\cdots,x_n), B'=(y_1,y_2,\cdots,y_m)$をそれぞれ$V,W$の基底とする．$g_B:K^n\longrightarrow V,\; g'_{B'}K^m\longrightarrow W$を，それぞれ基底$B,B'$が定める同型とする．
    この時，以下の図式を可換にする行列$A\in M_{mn}(K)$が存在するので，この行列$A$を\textbf{基底$B,B'$に関する$f$の行列表示／表現行列}という：
    \begin{center}\begin{tikzcd}
        V \ar[r,"f"] & W \ar[d, "g'^{-1}_{B'}"] \\
        K^n \ar[u, "g_B"] \ar[r, "f_A"'] & K^m.
    \end{tikzcd}\end{center}
\end{definition}
\begin{remarks}[行列表示は列ベクトルでみる]
    各基底$x_j$の行き先が，$W$の基底$(y_i)$を用いて$f(x_j)=(y_1\;\cdots\;y_m)\begin{pmatrix}a_{1j}\\\vdots\\a_{mj}\end{pmatrix}$と表せるとする．
    縦ベクトルを$a_j=\begin{pmatrix}a_{1j}\\\vdots\\a_{mj}\end{pmatrix}$と置けば，
    $K^n$の各基底$e_j$は$f_A(e_j)=g^{'-1}_{B'}\circ f\circ g_B(e_j)=g^{'-1}_{B'}(f(x_j))=a_j$より，これらを並べて得る行列が$A=(a_j)_{j\in[n]}$である．
    総じて，\textbf{$A$による$(x_i)$の行き先の，$(y_j)$についての係数表示を列ベクトルとしたもの}となる．
    \[f(x_1,\cdots,x_n)=(y_1,\cdots,y_m)(a_{ij})\]
    この行列表示は，２つの同型$g_B,g'_{B'}$が定める線型Hom関手（例\ref{example-linear-hom-functor}）により写り合っているから，$\Hom_C(V,W)\simeq\Hom_C(K^n,K^m)$である．
\end{remarks}

\begin{example}[covariant, contravariant?]
    $f$を$V=\langle x_1,x_2\rangle$の自己同型とする．
    \begin{align*}
        f(x_1)&=ax_1+bx_2,&f(x_2)&=cx_1+dx_2,
    \end{align*}
    の時，$f$の基底$x_1,x_2$に関する表示は，
    \[ \begin{pmatrix}a&c\\b&d\end{pmatrix} \]
    である．実際，
    \[ (y_1\;y_2) = (x_1\;x_2)\begin{pmatrix}a&c\\b&d\end{pmatrix} \]
    が整合的に成り立つようになっている．
    こうせざるを得ない理由は，$A$倍写像$A\times:K^n\to K^n$の標準基底に関する行列表示が$A$となるようにするためである．
    $A$倍写像の時は左から作用$A\times$するが，一般の空間$V$との同型を取る際は右から作用$\times A$する．
    なぜなら係数の組は縦ベクトルの空間であるが，基底は横ベクトルだからである．２つ合わせて内積となる．
    反変共変の差がどうして転置として現れているのだろうか？
    ここに「双対写像の双対基底に関する行列表示」の構造があるのだろうか？だが内積の言葉が出てきた通り，確かに双線型写像なのであろうか．
\end{example}

\subsection{部分空間・複素化・共軛と行列表示}

\begin{definition}[行列の直和]
    基底$x_1,\cdots,x_n$を$r$個に分割してそれぞれが生成する部分空間の間に定まる射$(f_i)_{i=1,\cdots,r}$の直和$f_1\oplus\cdots\oplus f_r:V\to W$の行列表示は，
    \[ A_1\oplus\cdots\oplus A_r:=\begin{pmatrix}A_1&0&\cdots&0\\0&A_2&\ddots&\vdots\\\vdots&\ddots&\ddots&0\\0&\cdots&0&A_r\end{pmatrix} \]
    となる．$A_1=\cdots=A_r=A$の時，行列の指数と区別して$A^{\oplus r}$と表す．
\end{definition}

\begin{example}[部分空間と行列表示]
    $V,W$の部分空間を，それぞれの基底$x_1,\cdots,x_n,y_1,\cdots,y_m$について，$V'=\langle x_1,\cdots,x_{n'}\rangle,W'=\langle y_1,\cdots,y_{m'}\rangle$と
    取った時，線型写像$f:V\to W$の表現行列が
    \[ A=\begin{pmatrix}A_{11}&A_{12}\\A_{21}&A_{22}\end{pmatrix} \]
    という形になる．この時$V'$の像がすっぽりハマる$f(V')\subset W'$の条件は$A_{21}=0$である．
    この時$f|_{V'}:V'\to W'$の行列表示が$A_{11}$である．
    このように$0$がたくさん出現する行列表示を見つけるのが目標として立つ．
\end{example}

\begin{example}[複素化は表現行列を保存する]
    $f:V\to W$を$\R$-線型写像，$f_\C:V_\C\to W_\C$をその複素化とすると，
    $f$の$x_1,\cdots,x_n\in V,\;w_1,\cdots,w_m\in W$に関する行列表示$A\in M_{mn}(\R)$と，
    基底$(x_1,0),\cdots,(x_n,0)\in V_\C,\;(y_1,0),\cdots,(y_m,0)\in W_\C$とに関する行列表示$A\in M_{mn}(\C)$は一致する．
\end{example}

\begin{example}[共役の行列表示]
    $\C$-線型写像$f:V\to W$について，その共役の間に定めるグラフの等しい写像$f:V'\to W'$はまた$\C$-線型写像である．
    $x_1,\cdots,x_n\in V,\;y_1,\cdots,y_m\in W$に関する$f$の行列表示を$A\in M_{mn}(\C)$とすると，
    同じ線型写像$f:V'\to W'$に対する同じ基底による行列表示は$\overline{A}\in M_{mn}(\C)$となる．
\end{example}

\subsection{底の変換行列とそれによる線型写像の表現行列の反変}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=底の変換行列]
    底の変換行列$P\in\GL_n(K)$とは，基底の変換$(x_i)\mapsto(y_i)$が定める大域的な自己準同型を，基底$(x_i)$について行列表示したものである．
    従って，行列の縦ベクトルは基底の行き先$Px_i$となる．
    横ベクトルとして表した元（基底などの双対空間の存在）には右から作用し，点には左から作用して，移動先を表す．

    行列表示としての関係としては，基底$(x_i),(y_i)$についての恒等写像$\id_V$の行列表示にも等しい．
\end{tcolorbox}

\begin{definition}[底の変換行列(transformation matrix)]
    $x_1,\cdots,x_n$と$y_1,\cdots,y_n$とを$V$の基底とする．$x_1,\cdots,x_n$を$y_1,\cdots,y_n$に写す$V$の自己同型の，基底$x_1,\cdots,x_n$に関する行列表示$A\in \GL_n(K)$を，\textbf{$x_1,\cdots,x_n$から$y_1,\cdots,y_n$への底の変換行列}という．
\end{definition}
\begin{remarks}
    $y_{j}=a_{1j}x_1+\cdots+a_{nj}x_n\;(j=1,2,\cdots,n)$とした時，この内積表示を行列積で表すと
    \[y_j=(x_1\;\cdots\;x_n)\begin{pmatrix}a_{1j}\\\vdots\\a_{nj}\end{pmatrix}\]
    であるから，
    \[ (y_1\;\cdots\;y_n) = (x_1\;\cdots\;x_n)\begin{pmatrix}a_{11}&\cdots&a_{1n}\\\vdots&\ddots&\vdots\\a_{n1}&\cdots&a_{nn}\end{pmatrix}=(x_1\;\cdots\;x_n)A \]
    という関係にある．これは両辺を転置して，
    \[ \begin{pmatrix}y_1\\\vdots\\y_n\end{pmatrix} = \begin{pmatrix}a_{11}&\cdots&a_{1n}\\\vdots&\ddots&\vdots\\a_{n1}&\cdots&a_{nn}\end{pmatrix}^T\begin{pmatrix}x_1\\\vdots\\x_n\end{pmatrix}={}^t\!A\begin{pmatrix}x_1\\\vdots\\x_n\end{pmatrix} \]
    とも表せる．
\end{remarks}

\begin{proposition}[底の変換行列の特徴づけ]\label{prop-transformation-matrix}
    有限次元線型空間$V$について，$P\in\GL_n(K)$を基底$B$から$B'$への底の変換行列とする．
    \begin{enumerate}
        \item 恒等写像$\id_V$の基底$\textcolor{red}{B',B}$に関する行列表示は$P$である．
        \item 有限次元線型空間$W$について，$Q\in\GL_m(K)$を$D$から$D'$への底の変換行列とする．線型写像$f:V\to W$の$B,D$に関する行列表示$A$と$B',D'$に関する行列表示$A'$との間に，次の関係がある：
        \[A'=Q^{-1}AP\]
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] $P$は基底$B,B'$が定める同型を$f_p$とするとその行列表示であるから，各縦ベクトルは，$B'$の元の基底$B$による成分表示の係数からなる．
        恒等写像$\id_V$の基底$B',B$による行列表示の縦ベクトルも，その通りになる．よって，この時の行列表示も$P$である．
        \item[1'.] $f_p$の$B,B'$に関する行列表示は$1$である．$\id_V$の$B',B$に関する行列表示が知りたいのであるが，総じて$\id_V\circ f$の基底$B$に関する行列表示が$P$なのであるから，$\id_V$の$B',B$に関する行列表示も$P$である（下図参照）：
        \[\xymatrix{
            V\ar[r]^-{f_p}&V\ar[r]^-{\id_V}&V\\
            K^n\ar[u]^-{B}\ar[r]_-{1}\ar@/_2pc/[rr]_-{P\times}&K^n\ar[u]_-{B'}\ar[r]&K^n\ar[u]_-{B}
        }\]
        \item[2.] 下図が可換であるために，$AP=QA'$である．$Q\in\GL_m(K)$の可逆性より結論を得る．
        \[\xymatrix{
            K^n\ar@/_2pc/[dd]_-{P\times}\ar[r]^-{A'\times}\ar[d]_-{B'}&K^m\ar[d]^-{D'}\ar@/^2pc/[dd]^-{Q\times}\\
            V\ar[r]^-f&W\\
            K^n\ar[u]^-{B}\ar[r]_-{A\times}&K^m\ar[u]_-D
        }\]
    \end{description}
\end{proof}
\begin{remarks}
    2.の最後の可換図式の大外周りを正当化する見方が，1の特徴づけである．
    $\id_V:V\to V$を潰した図式とみなせる．
    最初はそれに気づかずに，次のような図式を書いていた（レガシー）．
    \[\xymatrix{
        &K^n\ar[r]^-{\times A'}\ar[d]_-{B'}&K^m\ar[r]^-{\times Q}\ar[d]^-{D'}&K^m\ar[d]^-{D}\\
        V\ar[r]^-{\id_V}&V\ar[r]^-f&W\ar[r]^-{\id_W}&W\\
        K^n\ar[u]^-{B'}\ar[r]_-{\times P}&K^n\ar[u]_-{B}\ar[r]_-{\times A}&K^m\ar[u]_-D
    }\]
\end{remarks}

\section{核と像}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    写像が集合代数を保ったのと同様に，線型写像が保つものは演算とその閉包（＝部分空間）である．
    位相のことばように，像と逆像に対応する言葉は，内部構造を外在化させ，議論を大きく動的・関手的にする．
    線型代数では「核」と「像」がこの，中間的な存在に当たる．
    特に，単射が核の言葉で特徴付けられるのが線型写像の特徴であり，一次独立性の特徴付けの１つに出現していた
    \[a_1x_1+\cdots+a_nx_n=0\Rightarrow a_1=\cdots=a_n=0 \]
    はこの特性を指していた．$f$が単射じゃなかったらしわ寄せが核に来るのである．「核の拡大」という病理が起こる．核の正常性診断が，この高校以来の技術「$0$との係数比較」である．

    $f:V\to W$に対して，$V$の基底と$W$の基底を独立に選んで良いのはいつかを考える．
\end{tcolorbox}

\subsection{核と像と単射・全射の特徴付け}

\begin{proposition}
    $f:V\to W$を線型写像とする．
    \begin{enumerate}
        \item $V'$が$V$の部分空間ならば，$f(V')$も$W$の部分空間である．
        \item $W'$が$W$の部分空間ならば，$f^{-1}(W')$も$V$の部分空間である．
    \end{enumerate}
\end{proposition}
\begin{proof}
    
\end{proof}

\begin{definition}[kernel, image, rank]\mbox{}
    \begin{enumerate}
        \item $\Ker f:=f^{-1}(0)$を\textbf{核}という．
        \item $\Im f:=f(V)$を\textbf{像}という．
        \item $\Im f$の次元$\rank f=\dim(\Im f)$を$f$の\textbf{階数}という．
    \end{enumerate}
\end{definition}
\begin{corollary}
    基底の延長算譜\ref{thm-linear-system-extension-algorithm}.1より，
    \[ \rank A=\#\{i\mid 1\le i\le n,\;a_i\notin\langle a_1,\cdots,a_{i-1}\rangle\} \]
    という算譜で求められる．
\end{corollary}

\begin{proposition}[単射の特徴付け]\label{prop-characterization-of-monos-in-terms-of-Kernel}
    線型写像$f:V\to W$について，次の２条件は同値である．
    \begin{enumerate}
        \item $f$は単射．
        \item $\Ker f=0$．
    \end{enumerate}
\end{proposition}
\begin{proof}
    $f$が単射なら，$f^{-1}(0)$はただ一つの元を持つ．$f(0)=0$より$\Ker f=0$．

    $\Ker f=0$ならば，$f(x)=f(x')$の仮定の下で$f(x-x')=0$が必ず成り立つから，$x=x'$が従う．
\end{proof}

\begin{corollary}[可逆性と全単射は同値]\label{cor-invertible-if-全単射}
    線型写像$f:V\to W$について，次の３条件は同値である．
    \begin{enumerate}
        \item $f$は同型．
        \item $f$は全単射．
        \item $\Im f=W\land\Ker f=0$．
    \end{enumerate}
\end{corollary}

\subsection{全射の研究：準同型定理前夜}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    全射についても奇妙な性質が成り立つ．
    これは標準分解の遺伝（準同型定理の一つ）に他ならない．
    即ち：
    \textbf{線型写像が全射である時，その商空間$V/\Ker f$への標準的な可逆写像が$\Ker f$の補空間から存在する}．
\end{tcolorbox}

\begin{proposition}[準同型定理へ向けて]\label{prop-pre-homomorphism-thm}
    $f:V\to W$を全射な線型写像とする．$V$の部分空間$V'$について，次の２条件は同値である．
    \begin{enumerate}
        \item $V=V'\oplus\Ker f$．
        \item $f|_{V'}:V'\to W$は可逆．
    \end{enumerate}
\end{proposition}
\begin{proof}
    
\end{proof}

\begin{corollary}
    線型写像$f:V\to W$について，次の２条件は同値である．
    \begin{enumerate}
        \item $f$は全射である．
        \item $V$の部分空間$V'$であって，$f|_{V'}:V'\to W$が可逆となるものが存在する．
    \end{enumerate}
\end{corollary}

\subsection{分類}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    線型写像は階数によって分類される．
    これは適切な基底を取ることで，ベクトルの空間の間の射（＝行列）の標準形
    \[\begin{pmatrix}1_r&0\\0&0\end{pmatrix}\]
    にまで簡約して求める．その際の算譜を掃き出し法という．
\end{tcolorbox}

\begin{proposition}[線型写像の階数による分類]
    $f:V\to W$を線型写像とし，$\dim V=n, \dim W=m$とする．この時，次の３条件は同値である．
    \begin{enumerate}
        \item $\rank f=r$．
        \item $V$の基底$x_1,\cdots,x_n$と$W$の基底$y_1,\cdots,y_m$であって，次を満たすようなものが取れる：
        \[f(x_i)=\begin{cases}
            y_i,&1\le i\le r,\\
            0,&r<i\le n.
        \end{cases}\]
        \item $V$の基底と$W$の基底で，それらに関する$f$の行列表示が\[\begin{pmatrix}1_r&0\\0&0\end{pmatrix}\]となるものが存在する．
    \end{enumerate}
\end{proposition}

\begin{corollary}[次元定理]\label{cor-thm-of-dimention}
    \[ \dim V=\dim\Ker f+\rank f \]
\end{corollary}

\begin{problem}[elimination (掃き出し法)]
    $f:V\to W$と$V$の基底$x_1,\cdots,x_n$に対して，$y_i=f(x_i)$と置く．
    $\rank f$と$\Im f,\Ker f$の基底を求める算譜を与えよ．
\end{problem}

\section{完全系列と直和分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=完全系列という言葉]
    準同型定理\ref{prop-homomorphism-thm}で，空間の分解は全て射に帰された．
    最強の言葉が完全系列である．ホモロジー代数の威力．

    線型空間の直和分解の様子を，外在的な圏論の言葉で特徴付ける．これには
    図式の完全性の言葉で，空間の直和分解の様子にアクセスできる．
    簡単な応用としては，単射と全射(monicとepic)をある図式が完全かどうかによって特徴付けることができるが，
    一番の結果は次である．ずっと部分空間の分け方を自己準同型の言葉で指定できると思っていた．
    \textbf{線型空間の直和分解は，冪等律$e^2=e$を満たす自己準同型と同一視できる}．
    従って，冪等自己準同型を\textbf{射影子}という．この証明がおそらく完全系列の言葉を使わないとできない．
\end{tcolorbox}

\begin{definition}[exact sequence]
    $f:U\to V,g:V\to W$に対し，$\Ker g=\Im f$が成り立つ時，図式
    \[ U\xrightarrow{f}V\xrightarrow{g}W \]
    を\textbf{完全系列}という．または，\textbf{$V$で完全}ともいう．
\end{definition}
\begin{remark}
    微分形式について，系列が完全であるとは，$d\omega=0\Rightarrow\exists\eta\in\Omega^n(U),\;d\eta=\omega$が成り立つことをいう．
    形式が完全であるとはpotentialを持つことをいう．本質的に$d\omega=0$という形である微分方程式を完全形という．
    なお，加法圏においては，鎖複体と完全系列とは一致する．

    また，完全系列は方程式を解くことの一般化にもなっている．
    \[\Ker g=\{x\in K^n\mid Bx=0\}\]
    を求めるとは，
    \[ \Im f=\{Ay\mid y\in K^m\} \]
    を定める写像$A$を決定することに等しい．即ち，条件（方程式）によって記述されたものを置換公理による記述に置き換えることが
    「方程式を解く」ことに当たる．列挙と選択関数$f$を与えることは等しい．
    「一般的な集合」とかいう異質な概念を必要とせず，具体的構成ができる時，選択公理は問題にならない．構成的数学みたいな議論がある．

    これはvarietyをmanifoldとして捉えるということでもある．
\end{remark}

\begin{proposition}[図式が完全であることの部分空間と直和の言葉による特徴付け]
    線型写像の列
    \[ U\xrightarrow{f}V\xrightarrow{g}W \]
    について，
    \begin{enumerate}
        \item 次の条件は同値である．
        \begin{enumerate}[(1)]
            \item $g\circ f=0$である（$\Im f\subset\Ker g$）．
            \item 直和分解$U=U_1\oplus U_2,V=V_1\oplus V_2\oplus V_3, W=W_1\oplus W_2$が存在して，それに引き起こされる同型$\overline{f},\overline{g}$や第二射影$p:U\to U_2,q:V\to V_2$について，次の図式を可換にする：
            \[\xymatrix{
                &V_2\ar[r]^-{\overline{g}}&W\ar[d]^-j\\
                U\ar[r]^-f\ar[d]_-p&V\ar[r]^-g\ar[u]_-q&W\\
                U_2\ar[r]^-{\overline{f}}&V_1\ar[u]_-i
            }\]
        \end{enumerate}
        \item 次の条件は同値である．
        \begin{enumerate}[(1)]
            \item 図式$U\xrightarrow{f}V\xrightarrow{g}W$が完全である．
            \item 1.の(2)で$V=V_1\oplus V_2\oplus V_3$を$V=V_1\oplus V_2$で置き換えたものが成り立つ．
        \end{enumerate}
    \end{enumerate}
\end{proposition}
\begin{proof}
    1. (1)$\Rightarrow$(2)について，条件を満たす直和分解を構成すれば良い．
    \begin{align*}
        U_1&=\Ker f,&V_1&=\Im f,&W_1&=\Im g,\\
        &&V_1\oplus V_3&=\Ker g.
    \end{align*}
    と定め，残りをその補空間とする．すると準同型定理\ref{prop-pre-homomorphism-thm}より，$f,g$の制限を
    $\overline{f}:U_2\to V_1,\overline{g}:V_2\to W_1$とすればこれは可逆．
    図式は確かに可換になる．
    (2)$\Rightarrow$(1)については，$q\circ i=0$から，$g\circ f=(j\circ\overline{g}\circ q)\circ(i\circ\overline{f}\circ p)=0$より従う．

    2. (1)$\Rightarrow$(2)について，$V_3=\Ker g\setminus\Im f=0$より．
    (2)$\Rightarrow$(1)について，$\Ker g=\Im f= V_1$より．
\end{proof}

\begin{corollary}[全単射の図式による特徴付け]
    線型写像$f:V\to W$について，次の条件は同値である．
    \begin{enumerate}
        \item \begin{enumerate}[(1)]
            \item $f$は単射である．
            \item $0\to V\xrightarrow{f}W$が完全である．
            \item (monic) $r\circ f=1_V$を満たす線型写像$r:W\to V$が存在する．
        \end{enumerate}
        \item \begin{enumerate}[(1)]
            \item $f$は全射である．
            \item $V\xrightarrow{f}W\to 0$が完全である．
            \item (epic) $f\circ s=1_W$を満たす線型写像$s:W\to V$が存在する．
        \end{enumerate}
    \end{enumerate}
\end{corollary}
\begin{proof}
    1. (1)$\Rightarrow$(2)は，図式が完全であるための条件は$\Ker f=0$であることに他ならないから，同値．

    (1)$\Rightarrow$(3)は，
\end{proof}

\begin{remark}[短完全列]
    これより，図式
    \[0\to U\xrightarrow{f}V\xrightarrow{g}W\to 0\]
    が完全とは，$g$が全射で，単射$f$は同型$U\to\Ker g$を定めることに同値．
    従ってこの時，$V$が有限次元ならば$U,W$も有限次元で，$\dim V=\dim U+\dim W$が成り立つ．

    この形の図式を\textbf{短完全列}という．「このとき，$U$は$V$の部分対象と同一視され，$W$は商対象$V/U$と同一視される．
    この単完全列が分裂する(split)とは，$g$がepicであることをいう．即ち，section $s:W\to V$が存在することをいう．
\end{remark}

\begin{shadebox}\begin{proposition}[冪等自己準同型]\mbox{}
    \begin{enumerate}
        \item 線型写像$e:V\to V$が$e^2=e$を満たすならば，$V=\Im e\oplus\Ker e$である．
        \item 次の写像$F$は可逆である：
        \[\xymatrix@R-2pc{
            {\{e\in\End(V)\mid e^2=e\}}\ar[r]^-F&{\{V=W\oplus W'を満たすVの部分空間の組(W,W')\}}\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            e\ar@{|->}[r]&{(\Im e,\Ker e)}
        }\]
    \end{enumerate}
\end{proposition}\end{shadebox}

\begin{definition}[projector]
    $e\in\{e\in\End(V)\mid e^2=e\}$を$V$の\textbf{射影子}という．
    この時$V=\Im e\oplus\Ker e$を\textbf{射影子$e$が定める直和分解}という．  
\end{definition}

\chapter{自己準同型}

\begin{quotation}
    対象と射を明確に定義し，初等的な議論を終わらせたので，
    自己準同型の空間$\End_K(V)$（あるいは正方行列の空間）に話を限って深く追究していく．
    と言っても，「どのような直和に分解すれば良いか」を研究するが，
    空間の直和よりも，行列／線型写像の直和に注目する．

    自己準同型$f$が零化因子に沿って分解できる場合，それは零化する．
    この構造を多項式環の言葉で捉えると最小公倍式としての最小多項式を得る．
    零化空間は最小多項式$\varphi$を用いて$(\varphi)\subset\End(V)$と表せる．

    $f\in\End_K(V)$に対して，線型空間$V$が$f$-安定部分空間に分解できれば，
    最小多項式はそれらの積で，線型写像（従って表現行列も）はそれらの上の直和として得る．
    これが自己準同型の理論である．

    線型写像は，基底を取ると行列として表せる．その貼り合わせだと感じる．
    正しい基底を取ると，上三角，対角，Jordan標準形などの表示が得られる．
    この表示はパッと見ただけで，何と何が貼り合わされているか分かる．
    これは線型空間の分解を調べるにあたって，非常に有効な理論である．
    やはり，Cayleyが一枚噛んでいる．
\end{quotation}

\section{最小多項式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    まずは自己準同型の空間$\End_K(V)$の和と積（線型空間の和と積から定めた）のなす代数を考える．
    が，多項式と呼ぶべき対象に，考察の主軸を置き換える．
    すると，全く同じようにこの空間にも積と和が定まる．
    これは\textbf{$V$を多項式環$K[X]$上の加群}として考えるということになる．
    今回は多項式$F$への$f$の代入が定める自己同型の部分空間$\Ker F(f)\subset V$に注目する．

    すると，有限次元線型空間の自己準同型は必ず最小多項式$F=\varphi$（$\Ker F(f)\subseteq V$の等号を成立させる最小の多項式$F$）を持つ．
    即ち，$\End_K(V)$上で言えば，自身の$K$倍を足したり引いたりすれば$0$写像を作れる．
    この\textbf{最小多項式が空間の構造を写し取っている}，
    これが単項生成するイデアルに注目するのが今回の代数的手法である．
    最小多項式が一次式を因数に持つなら，それが固有値である．一次式に冪が掛かっているなら，そこには冪零成分がある，など．

    最小多項式は最小公倍式として計算できる（命題\ref{prop-algorithm-for-minimal-polynomials-in-the-terms-of-ideal}）．
    これは貼り合わせのような関係で，綺麗な積になるのが$f\in\End_K(V)$が簡単な部分写像の直和として表せる時である．
    ということで，$f\in\End_K(V)$の適切な直和分解を調べたい．
    これが固有値と固有多項式の概念につながり，Cayley-Hamiltonの定理\ref{thm-Cayley-Hamilton}で最小多項式に戻ってくる．

    最小多項式の理論の構成は，基本的にHom同型関手$\End(V)\to\End(K^n)$により，線型写像の演算を行列の演算に置き換えて行う．
    そして置き換えた先もベクトル空間の理論である．あまりにも不思議である．
    これを抽出したものが，「何度$f$を作用させると一次従属な範囲に落ちてくるか」を捉える\textbf{安定部分空間}の概念である．これは自己射が定める軌道のような概念で，まさに射によって内部構造を測るためにある．
    この時の議論の支えはFrobeniusの同伴行列になる．
    これはうまく基底をとった時の，$V$への$f$の作用が，ロケット鉛筆のように綺麗な押し出しをするときの表現行列になっている（命題\ref{prop-stable-subspace}）．
    これ以上推し進めても，代数的な切れ味はそれほどではない．
\end{tcolorbox}

\subsection{最小多項式とは何か}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    体$K$上の加群を環$K[X]$上の加群へと移行する．
    これには，スカラー倍
    \[\xymatrix@R-2pc{
        K[X]\times\End_K(V)\ar[r]&\End_K(V)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (F,f)\ar@{|->}[r]&F(f)
    }\]
    が定まっている．
    この左からの作用の核はイデアルとなり，最小多項式を持つ．
\end{tcolorbox}

\begin{definition}[多項式への代入]
    $F=a_0+a_1X+\cdots+a_nX^n\in K[X]$を多項式とし，$f:V\to V$を$K$-自己準同型とする．
    この代入$F(f):V\to V$を
    \[ F(f) = a_0\id_V+a_1f+\cdots a_nf^n \]
    と定める．
\end{definition}

こうして，体$K$上の加群を環$K[X]$上の加群へと移行するに当たって，
次のように代数法則が引き継がれる．

\begin{proposition}[functoriality]\label{prop-functoriality-of-substitution}
    多項式$F,G\in K[X]$に対して，
    \begin{align*}
        (F+G)(f)&=F(f)+G(f),&(FG)(f)&=F(f)\circ G(f)
    \end{align*}
    が成り立つ．これらが成り立つから，零化自己準同型のなすイデアル$I=\{F\in\End(V)\mid F(f)=0\}$と
    多項式環に対応がつく．零化自己準同型は零元があって，それを含んだものは全て零化自己準同型になるが，それが多項式環では積に対応づけられるから，最小公倍式として得る．これが代数的手法である．
\end{proposition}
\begin{proof}
    多項式が有限的なデータ構造なので，その上の帰納法で示せる．

    $F=a_0+a_1X+\cdots+a_nX^n,\;G=b_0+b_1X+\cdots+b_mX^m$とすると，分配則より
    \begin{align*}
        FG&=a_0(b_0+b_1X+\cdots+b_mX^m)+a_1X(b_0+b_1X+\cdots+b_mX^m)\\
        &\hphantom{===}+\cdots+a_nX^n(b_0+b_1X+\cdots+b_mX^m)\\
        &=a_0b_0+(a_0b_1+a_1b_0)X+\cdots+a_nb_mX^{n+m}=\sum^{n+m}_{k=0}\sum^k_{l=0}a_lb_{k-l}X^l
    \end{align*}
    と計算できる．一方で，$\End(V)$の合成も分配則を満たすから，（$a_1b_0f=a_1f\circ b_0,a_nf^n\circ b_mf^m=a_nb_mf^{n+m}$などにも注意して）
    \begin{align*}
        FG(f)&=a_0b_0+(a_1b_0+a_0b_1)f+\cdots+a_nb_mf^{n+m}\\
        &=a_0(b_0+b_1f+\cdots+b_mf^m)+a_1f\circ(b_0+b_1f+\cdots+b_mf^m)\\
        &\hphantom{===}+\cdots+a_nf^n\circ(b_0+b_1f+\cdots+b_mf^m)
    \end{align*}
    は$(a_0+a_1f+\cdots+a_nf^n)\circ(b_0+b_1f+\cdots+b_mf^m)=F(f)\circ G(f)$に等しい．
\end{proof}

\begin{proposition}[有限次元線型空間の自己射は必ず最小多項式を持つ]\label{prop-existence-of-minimal-polynomial}
    $V\in\FinVect_K,f\in\End_K(V)$は，最小多項式を持つ．
    即ち，$F(f)=0$を満たすmonicな多項式$F\in K[X]$のうち，次数が最小のものがただ一つ存在する．
\end{proposition}
\begin{proof}
    \begin{description}
        \item[$F$の構成] $f$は有限次元空間の自己射だから，基底$x_1,\cdots,x_n\in V$を定めると，表列表示$A$を持つ．この基底が定める同型$\varphi_{x_1,\cdots,x_n}$が定めるHom同型関手$\End(V)\to\End(K^n)$は
        演算を保つから，$F(f)=0\Leftrightarrow F(A)=0$より，行列$A$を積，冪，和によって零に出来るかを考えれば良い．

        $\dim M_n(K)=n^2$より，$1+n^2$個のベクトル$1,A,A^2,\cdots,A^{n^2}$は線型従属．
        よって，
        \[ d:=\min\{d\in n^2+1\mid 1,A,\cdots,A^dが線型従属\} \]
        と置けば，$a_0,\cdots,a_{d-1}\in K$が一意的に存在して
        \[ A^d=a_0\cdot 1+a_1A+a_2A^2+\cdots+a_{d-1}A^{d-1} \]
        と表せる．これに対して，
        \[ F:=X^d-(a_0+a_1X+\cdots+a_{d-1}X^{d-1}) \]
        と置けば，これが求めるmonicな多項式である．
        \item[$F$が確かに次数が最小であることを示す] $G$が$d-1$次以下で$G(f)=0$即ち$G(A)=0$を満たすならば，$1,A,\cdots,A^{d-1}$は一次独立だから，係数が$0$で$G=0$が従う．従って$F$はmonicなもので最小次．
        \item[$F$が一意的と示す] $d$次の多項式$G$についても$G(f)=0$とすると，$F(A)=0=G(A)$の係数比較より$G=F$が従う．
    \end{description}
\end{proof}
\begin{remark}
    最小多項式の理論の構成は，基本的にHom同型関手$\End(V)\to\End(K^n)$により，線型写像の演算を行列の演算に置き換えて行う．
    そして置き換えた先もベクトル空間の理論である．あまりにも不思議である．
    ただ存在を示すのを急ぎすぎていて本質を捉えているとは言い難い，実際この途では$d$についてこれ以上の評価ができない．
    抽象的すぎて，飛び道具を使っている感が否めない，表層の論理の糸の繭に触れただけで，その核心に至っていない．
    この手法の一応の完成は安定部分空間である（命題\ref{prop-stable-subspace}）．
\end{remark}

\begin{definition}[minimal polynomial]
    線型自己準同型$f:V\to V$に対して，$F(f)=0$を満たす$0$でない多項式$F\in K[X]$が存在する時，$f$は\textbf{最小多項式を持つ}という．
    このような$F$のうちmonicなもので次数が最小の多項式を\textbf{最小多項式}という．
\end{definition}

\begin{example}[最小多項式]\mbox{}
    \begin{enumerate}
        \item 線型空間$0$の恒等写像$\id_0$の最小多項式は$1$．
        \item $0$でない線型空間$V$の自己準同型$f$の最小多項式が一次式$X-a$で表せることと，$f$がスカラー$a$倍写像であることは同値．
        \item 行列$\begin{pmatrix}a&b\\c&d\end{pmatrix}$倍写像の最小多項式は，$A$がスカラー行列でなければ，$X^2-(a+d)X+ad-bc$である．
        \item むしろこの最小多項式の次元が2で収まっているのが不思議であるが，最小多項式は固有多項式を割り切るから，次数は$V$の次元よりも小さくなる．上の証明では$d$を具体化しておらず，閉集合上の連続写像$\min$で抽象的に存在を示したので，$n^2$次以下とまでしか言えていない．構成論の負けで，固有多項式の理論を待つのが良い．
    \end{enumerate}
\end{example}

\subsection{主要な行列とその最小多項式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    $K$-線型空間$K[X]$には標準基底$1,X,X^2,\cdots$がある．
    これをcyclicに入れ替えるような線型写像$f$（$1$が生成する$f$-安定部分空間が空間全体となるような$f$）は，零化するには全てを出し尽くさなきゃいけないから
    最小多項式は特徴的になる．
    これが同伴行列で，２つを媒介する理論的な役割を果たす．
    要は，任意の線型空間も，このような同伴行列を考えれば良くなるような$f$-安定部分空間にまで分解すれば良い．（命題\ref{prop-stable-subspace}）．
    これが一般固有空間分解であり，その上のJordan分解である．
\end{tcolorbox}

\begin{definition}[Frobeniusのcompanion matrix]
    monicな多項式$F(X) = X^n+a_1X^{n-1}+\cdots +a_{n-1}X+a_n \in K[X]$に対して，
        \[C(F)=\begin{bmatrix}
        0 & 0 & \dots & 0 & -a_n \\
        1 & 0 & \dots & 0 & -a_{n-1} \\
        0 & 1 & \dots & 0 & -a_{n-2} \\
        \vdots & \vdots & \ddots & \vdots & \vdots \\
        0 & 0 & \dots & 1 & -a_1
        \end{bmatrix}\]
    と定義される正方行列$C(F)\in M_n(K)$のことを\textbf{多項式$F$の同伴行列}と呼ぶ．
\end{definition}
\begin{remark}
    これは，$K$-線型空間$K[X]$上の自己射$X$が商空間$K[X]/(F)$\footnote{$F$で割り切れる多項式全体の集合$(F)=\{GF\in K[X]\mid G\in K[X]\}$．条件$G\in (F)$とは，$F$で割り切れることを意味する．}上に引き起こす自己準同型$F_X$の，基底
    $\overline{1},\overline{X},\cdots,\overline{X^{n-1}}$についての行列表示が$C(f)$となっている．
    即ち，最右の列ベクトルは，最後の基底$\overline{X^{n-1}}$の$X$による像
    \[ X^n=-a_1X^{n-1}-\cdots-a_{n-1}X-a_n \]
    を表している（例\ref{example-companion-matrix}）．
\end{remark}
\begin{definition}[Jordan matrix]
        行列
        \[J(a,n)=\begin{bmatrix}
        a & 1 & 0 & \dots & 0 \\
        0 & a & 1 & \dots & 0 \\
        \vdots & \vdots & \ddots & \vdots & \vdots \\
        0 & 0 & \dots & a & 1 \\
        0 & 0 & \dots & 0 & a
        \end{bmatrix}\in M_n(K)\]
    を\textbf{Jordan行列}という．
\end{definition}

\begin{proposition}[companionship：同伴行列と最小多項式]
    多項式$F(X) = X^n+a_1X^{n-1}+\cdots +a_{n-1}X+a_n \in K[X]$の同伴行列$A:=C(F)\in M_n(K)$の最小多項式は$F$自身である．
\end{proposition}
\begin{proof}
    \begin{description}
        \item[零写像であること$F(A)=0$を示す] 
        同伴行列$A$を元の多項式$F$に代入して得る行列$F(A)$が
        \begin{align}
            F(A)e_i&=0,&(i=1,2,\cdots,n)
        \end{align}
        を満たすことを示す．いきなり多項式$F(A)$を考える前に個々の挙動を見ると，まず
        \begin{align*}
            A^ie_1&=e_{i+1},&(i=0,1,\cdots,n-1)
        \end{align*}
        が帰納的に示せる．これを用いて，$i=n$の時は
        \begin{align*}
            A^ne_1&=A(A^{n-1}e_1)\\
            &=Ae_n\\
            &=\begin{pmatrix}-a_n\\-a_{n-1}\\\vdots\\-a_1\end{pmatrix}\\
            &=-e_1(a_1A^{n-1}+a_2A^{n-2}+\cdots+a_{n-1}A+a_n)
        \end{align*}
        より，
        \begin{align*}
            F(A)e_1&=A^ne_1+(a_1A^{n-1}+\cdots+a_{n-1}A+a_n)e_1\\
            &=-e_1(a_1A^{n-1}+a_2A^{n-2}+\cdots+a_{n-1}A+a_n)\\
            &\hphantom{=}\;+e_1(a_1A^{n-1}+a_2A^{n-2}+\cdots+a_{n-1}A+a_n)\\
            &=0
        \end{align*}
        を得る．他の$e_i$についても，
        \[F(A)e_i=F(A)A^{i-1}e_1=A^{i-1}F(A)e_1=0\]
        が従う\footnote{$F(A)$は$A$とスカラー倍$a_i$のみからなる多項式なので．}．よって，$F(A)=0$．
        \item[$F$がこれを満たす最小次の多項式であることを示す] 
        $n-1$次以下の多項式$G=b_1X^{n-1}+\cdots+b_n$が$G(A)=0$を満たしたとする．すると，特に$G(A)e_1=0$だから，
        \begin{align*}
            b_1A^{n-1}e_1+b_2A^{n-2}e_1+\cdots+b_ne_1&=0\\
            b_1e_n+b_2e_{n-1}+\cdots+b_ne_1&=0
        \end{align*}
        であるから，$b_1=\cdots=b_n=0$が従う．よって$G=0$．よって，$F$が$A=C(F)$の最小多項式である．
    \end{description}
\end{proof}
\begin{remark}[環論的根拠]
    以上の証明で主に使った性質は，標準基底$e_i$に対する挙動（＝同伴行列の列ベクトルの作り方）そのものであった：
    \begin{align*}
        A^ie_1&=e_{i+1},\;\;\;(i=0,1,\cdots,n-1)\\
        A^ne_1&=-e_1(a_1A^{n-1}+a_2A^{n-2}+\cdots+a_{n-1}A+a_n).
    \end{align*}
    $f=X^n+a_1X^{n-1}+\cdots +a_{n-1}X+a_n \in K[X]$を多項式とし，$V=K[X]/(f)$とすると，この商空間の基底は
    $\overline{1},\overline{X},\cdots,\overline{X^{n-1}}$．
    （本来は$K[X]$上の自己準同型である）$X$倍写像が$V$上に引き起こす自己準同型$F$の，この基底に関する行列表示が，多項式$f$の同伴行列である．
    $V$は$\overline{1}$によって生成される$F$-安定部分空間と一致する．$a_n$の右に$a_n\cdot 1$の省略があるので．
\end{remark}

\begin{corollary}[Jordan行列は，冪零成分が最短の零元になる]
    Jordan行列$J(a,n)$の最小多項式は$(X-a)^n$である．
\end{corollary}
\begin{proof}
    対角成分を$a=0$としたJordan行列$J(0,n)$の転置$J^t(0,n)$は多項式$X^n$の同伴行列になっている．
    転置行列と元の行列の最小多項式は一般に一致するから（双対命題），$J(0,n)$の最小多項式も$X^n$である．これに$X=X-a$と代入し直すことで，$J(a,n)=a+J(0,n)$の最小多項式は$(X-a)^n$．
\end{proof}

\begin{proposition}[安定部分空間]\label{prop-stable-subspace}
    $V\in\FinVect_K,f\in\End(V)$とする．$x\in V$．
    $0\le m\le\dim V$を，$x,f(x),\cdots,f^m(x)$が一次独立ではなくなるような最小の自然数とし，$W=\langle x,f(x),\cdots,f^{m-1}(x)\rangle$と置く．
    \begin{enumerate}
        \item $x,f(x),\cdots,f^{m-1}(x)$は$W$の基底であり，$f(W)\subset W$である．
        \item $f^m(x)$の成分表示を$f^m(x)=a_1f^{m-1}(x)+\cdots+a_{m-1}f(x)+a_mx$と置くと，$f|_W$の行列表示は，多項式
        \[ \varphi_x=X^m-(a_1X^{m-1}+\cdots+a_{m-1}X+a_m) \]
        の同伴行列である．
        \item $f|_W$の最小多項式は$\varphi_x$である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] $x,f(x),\cdots,f^{m-1}(x)$は$W$の一次独立な生成系だから基底である．また，$W$の生成系$x,f(x),\cdots,f^{m-1}(x)$が一次独立であることの特徴付け（命題\ref{prop-linear-system-expansion}）より$f^m(x)\in W$であるから，$f(W)=\langle f(x),\cdots,f^m(x)\rangle\subset W$\footnote{等号は任意の$W$の元を取れば，一次独立かは置いておいて，$f(x),\cdots,f^m(x)$が像の生成系に他ならないとわかる．}．不安なら還元論を展開すれば出来るが，どの変形にも証明がつけられるならそれで良い．
        \item[2.] $W$の各基底$x,f(x),\cdots,f^{m-1}(x)$の行き先の，この基底による表示を列ベクトルで並べると，
        \[A=\begin{bmatrix}
            0 & 0 & \dots & 0 & -a_n \\
            1 & 0 & \dots & 0 & -a_{n-1} \\
            0 & 1 & \dots & 0 & -a_{n-2} \\
            \vdots & \vdots & \ddots & \vdots & \vdots \\
            0 & 0 & \dots & 1 & -a_1
            \end{bmatrix}\]
        となり，これは$\varphi_x=X^m-(a_1X^{m-1}+\cdots+a_{m-1}X+a_m)$の同伴行列である．
        \item[3.] 命題より．
    \end{description}
\end{proof}

\begin{definition}[$f$-stable subspace]
    この時の$W$を\textbf{$x$によって生成される$f$-安定部分空間}という．
\end{definition}

\begin{example}
    多項式$F(X) = X^n+a_1X^{n-1}+\cdots +a_{n-1}X+a_n \in K[X]$の同伴行列
        \[A=\begin{bmatrix}
        0 & 0 & \dots & 0 & -a_n \\
        1 & 0 & \dots & 0 & -a_{n-1} \\
        0 & 1 & \dots & 0 & -a_{n-2} \\
        \vdots & \vdots & \ddots & \vdots & \vdots \\
        0 & 0 & \dots & 1 & -a_1
        \end{bmatrix}\]
    に対して，$K^n$の$e_1$によって生成される$A$-安定部分空間は$\langle e_1,\cdots,e_n\rangle=K^n$である．
\end{example}

\subsection{最小公倍式：環論の補足}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    最小多項式を求めるときは，毎回構成して，それ以下の次数のものでは$G(f)=0$にならない
    ことを示すのではなく，特徴付けの方を使う．それは，「最小」多項式の名の通り，$f$を零化する多項式$F$の空間$I$（実はイデアル）
    の生成元になることである．なぜなら，多項式の空間$F[X]$は単項イデアル整域（全てのイデアルが単項生成される）だからである．
\end{tcolorbox}

\begin{notation}[単項イデアル]
    多項式$F\in K[X]$で割り切れる多項式全体の集合を
    \[  (F):=\{FG\mid G\in K[X]\} \]
    と表す．これは単項生成されるイデアルになっている．
\end{notation}

\begin{definition}[integral domain]
    単位元を持つ可換環が$0$以外に零因子を持たない時，$R$を\textbf{整域}という．
\end{definition}

\begin{definition}[ideal]
    $R$を環，$I\subset R$を空でない部分集合とする．$I$が次の２条件を満たす時，$I$を$R$の\textbf{左イデアル}という．
    \begin{enumerate}
        \item $a,b\in I\Rightarrow  -a+b\in I$．
        \item $a\in I,x\in R\Rightarrow xa\in I$．
    \end{enumerate}
    2.の代わりに$a\in I,x\in R\Rightarrow ax\in I$を満たす時，\textbf{右イデアル}という．
    $I$が３つ全てを満たす時，\textbf{両側イデアル}という．
    $R$が可換環であるとき，これら３概念に区別はない．
\end{definition}

\begin{proposition}[最小多項式の特徴付け：最小多項式はイデアルの生成元である]\label{prop-characterization-of-minimal-polynomial}
    $f:V\to V$に最小多項式$\varphi$が存在すると仮定する．monicな多項式$F\in K[X]$に対して，次の２条件は同値．
    \begin{enumerate}
        \item $F=\varphi$．
        \item $\{G\in K[X]\mid G(f)=0\}=(F)$．
    \end{enumerate}
\end{proposition}
\begin{proof}
    $I=\{G\in K[X]\mid G(f)=0\}$がイデアルであることを示す．
    まず$G_1,G_2\in I$と取ると$(G_1+G_2)(f)=G_1(f)+G_2(f)=0$．
    次に，$G|in I, H\in K[X]$を取ると，$GH(f)=G(f)\circ H(f)=0$．よって，
    \[ G\in I,H\in K[X]\Rightarrow GH\in I. \]
    (1)$\Leftrightarrow$(2)は次の補題\ref{lemma-principle-ideal-domain}より分かる．
\end{proof}

\begin{lemma}[$K$-多項式環は単項イデアル整域である]\label{lemma-principle-ideal-domain}
    $I\subset K[X], 1\ne 0$をイデアルとする．$I$に含まれる$0$でない多項式の次数の最小値を$d$とする．
    この時，monicな多項式$F\in K[X]$であって，$(F)=I$となるものがただ一つ存在する．
    また$F$はmonicな多項式としても$K[X]$内でただ一つである．
\end{lemma}
\begin{proof}
    
\end{proof}

\begin{corollary}
    $f,g\in K[X]$を$0$でない多項式とする．
    \begin{enumerate}
        \item $d=\gcd(f,g)$とすると，$(f)+(g)=(d)$である．
        \item $l=\lcm(f,g)$とすると，$(f)\cap(g)=(l)$である．
    \end{enumerate}
\end{corollary}

\subsection{一般の自己準同型の最小多項式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    $f$-安定な部分空間たちに分解できれば，最小多項式はそれらの積になり，
    行列表示はそれらの直和となる．これを目指したいが，ひとまず，
    最小多項式を線型写像の貼り合わせとして計算できるようにする．
    貼り合わせに対応する概念が最小公倍式である．
    この場合は「分解」できなくても，被覆を見つければ良い．
\end{tcolorbox}

\begin{proposition}[最小公倍式としての最小多項式]\label{prop-algorithm-for-minimal-polynomials-in-the-terms-of-ideal}
    $f\in\End_K(V)$について，
    \begin{enumerate}
        \item $W$を$V$の$f$-安定部分空間とする：$f(W)\subset W$．$f$の最小多項式$\varphi$が存在するならば，$f|_W$の最小多項式$\varphi|_W$も存在し，$\varphi$を割り切る．
        \item $W_1,\cdots,W_r$を$V$の$f$-安定部分空間で，$V=W_1+\cdots+W_r, f(W_i)\subset W_i\;(i\in[r])$を満たすとする．各$f|_{W_i}$に最小多項式$\varphi_i$が存在する時，$f$の最小多項式も存在し，$\varphi=\lcm(\varphi_1,\cdots,\varphi_r)$である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] $f|_W$の$\varphi$への代入は，$\varphi(f|_W)=\varphi(f)|_W=0$\footnote{この場合$\varphi(f\circ i)=\varphi(f)\circ i$が成り立つのだな．$i$が冪等だからである．}より，$f|_W$の最小多項式も存在し，$\varphi$を割り切る．
        \item[2.] $(W_i)_{i\in[r]}$は$V$を被覆しているから，$F(f)=0$と$F(f)|_{W_i}=F(f|_{W_i})=0\;\;(i\in[r])$とは同値．これは，$F$が$\varphi_1,\cdots,\varphi_r$で割り切れることに同値．系より，$\varphi=\lcm(\varphi_1,\cdots,\varphi_r)$と置くと$\bigcap_{i\in[r]}(\varphi_i)=(\varphi)$なので，これは$\varphi$で割り切れることに同値．従って，この生成元が$f$の最小多項式．
    \end{description}
\end{proof}

\begin{problem}
    $A=\begin{pmatrix}1&0&0&0\\0&0&0&0\\0&1&0&0\\1&0&1&1\end{pmatrix}$の最小多項式を求めよ．
\end{problem}
\begin{proof}[［解答］]
    $e_1,e_2$の生成する安定部分空間に注目して，
    $W_1:=\langle e_1,e_4\rangle,W_2:=\langle e_2,e_3,e_4$は，$K^4=W_1+W_2$を満たす．
    $W_1$上に$A$が定める自己準同型の表現行列は，部分行列$\begin{pmatrix}1&0\\1&1\end{pmatrix}$だから，最小多項式は$X^2-2X+1=(X-1)^2$．
    $W_2$上に$A$が定める自己準同型の表現行列は，部分行列$\begin{pmatrix}0&0&0\\1&0&0\\0&1&1\end{pmatrix}$だから，これは$X^3-X^2=X^2(X-1)$の同伴行列．
    以上，$A$の最小多項式は，最小公倍式$X^2(X-1)^2$．
\end{proof}

\begin{itembox}[l]{最小多項式の求め方}
    \begin{enumerate}
        \item $f(W)\subset W$を満たす$f$-安定部分空間による被覆を見つける．
        \item それの最小多項式を調べ，その張り合わせが全体空間だから，最小公倍式を見つければ良い．
        \item 「最小公倍式」ってのは，どの部分空間も潰れるために必要である．これがぴったり環論の言葉で表現できる対応がすごいが，もっと厳密に対応を定式化したい気がする．
    \end{enumerate}
\end{itembox}

\section{固有値と対角化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    有限次元線型空間の自己準同型で，対角行列による行列表示を持つようなものは，特に簡単な自己準同型と考えられる．
    この時の対角成分が固有値であり，基底は固有ベクトルからなる．

    固有値の発見は$f-a$の単射性が失われるかどうかで検出できる．
    最小多項式の根は固有値になる．
\end{tcolorbox}

\subsection{固有値と最小多項式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    線型写像$f$がスカラー倍写像に退化する部分空間を固有空間と呼ぶと，
    これに分解するのが一番良さそうである．
    だが，これは$f$-安定な部分空間の中でも特別に振る舞いが良いので，必ずしも
    そんな$f$-安定部分空間ばかりに分解できるわけではないことは容易に予想がつく．

    $f$が退化するところのスカラー倍写像のスカラー倍を固有値という．
    $f|_{V_a}=a$なのだから，$X-a$は$\varphi$を割り切る．従って固有値は最小多項式の根としても求められる（命題\ref{prop-minimal-polynomial's-root-is-eigenvalue}）．

    同伴行列よりもずっと上三角行列は緩い条件で，しかし素性も良いので，
    理論的な安定点として有力候補である．以降，野望としての対角化と上三角化を考える．
\end{tcolorbox}

\begin{definition}[eigenspace, eigenvalue, eigenvector]
    $V\in\Vect_K,f\in\End_K(V)$とする．$V$の特別な部分空間$V_a$
    \[V_a:=\{x\in V\mid f(x)=ax\}=\Ker(f-a)\]
    のことを，\textbf{$a$に属する固有空間}という．
    $V_a\ne 0$である時（$f-a$が単射でない時），\textbf{$a$は$f$の固有値である}という．
    固有空間$V_a$の$0$でない元を，\textbf{固有値$a$の固有ベクトル}という．
\end{definition}
\begin{remark}
    $f-a$は字面は引き算に見えるが，実際は$f(x)-ax=0$を満たす非自明な$x\ne 0$の存在を捉えるための装置である．

    $(V_a)_{a\in V}$は$V$上を探索し，退化しているところを発見したら，$f$がスカラー写像$a$になっている場所を検出できる．少しだけ（ベクトル）解析的に感じる．各点毎の線型代数である点では完全にベクトル解析ではある．
\end{remark}

\begin{proposition}[最小多項式の根が固有値である]\label{prop-minimal-polynomial's-root-is-eigenvalue}
    線型空間の自己射$f\in\End_K(V)$の最小多項式を$\varphi$とする．$a\in K$に対して，次の条件は同値である．
    \begin{enumerate}
        \item $a$は$f$の固有値である．
        \item $\varphi(a)=0$である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1$\Rightarrow$2] $a$を$f$の固有値とすると，$f|_{V_a}=a$．従って，$f$が部分空間$V_a$上に定める準同型$f|_{V_a}$の最小多項式は$X-a$．よって，$\varphi$は$X-a$によって割り切れるから，$\varphi(a)=0$．
        \item[2$\Rightarrow$1] $\varphi(a)=0$の時，$\varphi$は$X-a$で割り切れるから，$G\in K[X]$が存在して，$\varphi=(X-a)G(X)$と表せる．$\varphi$が最小多項式であるから，$G(f)\ne 0$．すると，$f$の代入は$\varphi(f)=(f-a)\circ G(f)=0$と分解できて，この（おそらく完全）系列について
        \[ 0\subsetneq\Im G(f)\subset\Ker(f-a). \]
        よって，$V_a\ne 0$で，$a$は$f$の固有値である．
    \end{description}
\end{proof}
\begin{remark}
    これは同値性を同値変形のみによって示せるはず．２つに分けて証明する必要はないはずだ．

    なお斎藤先生の1$\Rightarrow$2は還元論に走っていて，固有値$a$の固有ベクトル$0\ne x\in V_a$を取ると，
    勿論$\varphi(f)(x)=0$であるが，$V_a$上では$\varphi(a)\cdot x=0$であるから，$\varphi(a)=0$を得る．
    結局$V_a$上での$f=a$を用いている．

    以上より結局，固有多項式と最小多項式は冪のみが違う．
\end{remark}

\begin{proposition}[上三角行列の固有値]\label{prop-eigenvalue-of-triangular-matrices}
    $A\in M_n(K)$を上三角行列とし，$a_1,\cdots,a_n\in K$を対角成分とする．
    \begin{enumerate}
        \item 最小多項式は$F(X):=(X-a_1)\cdots(X-a_n)$を割り切る（実はこれが上三角行列の固有多項式）．
        \item $a_1,\cdots,a_n$は$A$の固有値である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] $V_i:=\langle e_1,\cdots,e_i\rangle\subset K^n\;(1\le i\le n)$と置くと，上からの帰納法により，
        \begin{align*}
            (A-a_n)K^n&\subset V_{n-1}\\
            \vdots\hphantom{\;\;\;\;\;K^n}&\hphantom{\subset}\;\;\;\;\vdots\\
            (A-a_i)\cdots(A-a_n)K^n&\subset V_{i-1}\\
            \vdots\hphantom{\;\;\;\;\;K^n}&\hphantom{\subset}\;\;\;\;\vdots\\
            F(A)K^n&\subset V_0:=0
        \end{align*}
        が成り立つ．完全に環上の加群の書き方である．すでに$K^n$の第$i+1,\cdots,n$射影が$0$になった空間$V_i$において，左から掛ける行列の第$i$行の第$i$列までは$0$で第$i$列も$0$にすれば，それ以降の第$i+1$から$n$列に依らず，像は$V_{i-1}$に縮小する．
        よって，$F$は$\varphi$が割り切る．
        \item[2.] 上三角行列の計算法則として，$\varphi(A)=0$の対角成分はそれぞれ別に計算した$\varphi(a_1),\cdots,\varphi(a_n)$に等しい．よって，$a_1,\cdots,a_n$は全て$\varphi$の零点だから，命題より，固有値である．
    \end{description}
\end{proof}
\begin{remark}
    環上の加群の考え方が非常にしっくり来た．
\end{remark}

\begin{definition}[conjugate]\label{def-conjugate}
    $A,B\in M_n(K)$とする．$B=P^{-1}AP$を満たす基底変換$P\in GL_n(K)$が存在するとき，\textbf{$A$と$B$は共軛である}という．
\end{definition}
\begin{remark}
    共役な行列の「貼り合わせ」が線型写像である．
\end{remark}

\begin{definition}[diagonalizable, triangulizable]
    有限次元線型空間$V$の自己準同型$f$が対角化可能／三角化可能とは，対角行列／上三角行列による行列表示を持つことをいう．
\end{definition}

\subsection{対角化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    最小多項式$\varphi$が特殊な形をしている（相異なる一次式の積，即ち冪を含まない形，即ち冪零成分が零$n=0$である）時，
    $\Ker\varphi(f)=V$は固有空間の直和に分解する．こうして$f$-安定部分空間への分解どころか，さらに素性の良い分解を得た！

    $f$の最小多項式が相異なる一次式の積$\varphi=(X-a_1)\cdots(X-a_r)$に因数分解できるならば，
    代入$\varphi(f)=(f-a_1)\circ\cdots\circ(f-a_r)$は「射影」の合成のような自己準同型を定めるが，
    この核$\Ker \varphi(f)$は実際$\Ker(f-a_1)\oplus\cdots\oplus\Ker(f-a_r)=V_{a_1}\oplus\cdots\oplus V_{a_r}$になる（命題\ref{prop-diagonalization}）．
    これは対角化可能なことに他ならない．$\varphi$は最小多項式なのだから$\Ker\varphi(f)=V$と全体空間に一致するから，
    固有ベクトルだけで基底を作れる（ほどに満遍なく存在する）ということでもある．なお，違う固有値に属する固有空間は交わり得ない：$V_{a_i}\cap V_{a_j}=0\;(i\ne j)$（系\ref{cor-diagonalizability}）．
\end{tcolorbox}

\begin{lemma}[自己射が可換ならば，核と像は$f$が保つ]\label{lemma-commutative}
    $f,g\in\End(V)$とする．$f\circ g=g\circ f$ならば，$f(\Ker g)\subset\Ker g$かつ$f(\Im g)\subset\Im g$である．
\end{lemma}
\begin{proof}
    \begin{description}
        \item[$f(\Ker g)\subset\Ker g$] $x\in f(\Ker g)$を取ると，$\exists y\in\Ker g,\;f(y)=x$であるから，$g(x)=g(f(y))=f(g(y))=f(0)=0$より，$x\in\Ker g$．
        \item[$f(\Im g)\subset\Im g$] $x\in f(\Im g)$を取ると，$\exists y\in\Im g,\;f(y)=x$．よって$\exists z\in V,\;g(z)=y$．$x=f(g(z))=g(f(z))$より，$x\in\Im g$．
    \end{description}
\end{proof}
\begin{remark}\label{remark-1}
    これは次の命題でこのように使う．まず，$G=EF$となり，この多項式が定める線型写像は$G(f)=E(f)\circ F(f)$と分解するとする．
    するとおそらく商集合の普遍性から$\Ker F(f)\subset\Ker G(f)$が従う．$G$の方がたくさんつぶれなきゃいけない．
    少なくとも$G(f)(\Ker F(f))=E(f)\circ F(f)(\Ker F(f))=0$よりすぐ従う．
    これに補題を併せれば，$f\circ F(f)=F(f)\circ f=(F\cdot X)(f)$（多項式環$K[X]$は可換環なので）より，$f(\Ker F(f))\subset\Ker F(f)$が従う．
\end{remark}

\begin{proposition}[一次式の積の形の多項式$F$が定める自己射$F(f)$はいくつかのスカラー倍写像に分解する]\label{prop-diagonalization}
    $a_1,\cdots,a_r\in K$を異なる元とし，多項式を$F=(X-a_1)\cdots(X-a_r)$と置く．この時，$F$は任意の$f\in\End(V)$が与えられる毎に，対角行列$F(f)$を定める\footnote{$V$が無限次元の場合はこの自然言語訳は正しくない}：
    \[ \Ker F(f)=V_{a_1}\oplus\cdots\oplus V_{a_r}\;\;\;(\forall r\in\N,\;f\in\End(V)). \]
    ただし，$f$を勝手な自己準同型$f\in\End(V)$，$V_{a_i}:=\Ker f-a_i$と置いた．
\end{proposition}
\begin{proof}
    $r\in\N$については帰納法で示す．$r=1$の時，$V_{a_1}$の定義に他ならない．$r>1$とする．
    $G=(X-a_1)\cdots(X-a_{r-1})$と置くと，$F=G(X-a_r)$で，この多項式への$f$の代入を考えることで，分解$F(f)=G(f)\circ (f-a_r)$を得る．
    すると，$\Ker F(f)=\Ker G(f)\oplus\Ker(f-a_r)$と表せることを示せば良い．
    この準同型$f-a_r$に注目すれば，これを導ける．

    \begin{description}
        \item[$\Ker F(f)$への制限] $(f-a_r)|_{\Ker F(f)}$の核を調べると，
        \[\Ker((f-a_r)|_{\Ker F(f)})=\Ker(f-a_r)\cap\Ker F(f)=\Ker(f-a_r)\]
        とわかる．
        \item[$\Ker G(f)$への制限] 帰納法の仮定より，$\Ker G(f)=V_{a_1}\oplus\cdots\oplus V_{a_{r-1}}$である．$f$はそれぞれの上ではスカラー倍写像$f=a_i$であるから，$(f-a_r)|_{\Ker G(f)}$は直和$(a_1-a_r)\oplus\cdots(a_n-a_r)$に他ならない．よって，これは同型である．
        \item[$f-a_r$は全射] 注\ref{remark-1}での議論より，$(f-a_r)(\Ker F(f))\subset\Ker G(f)$が成り立つ．即ち，$(f-a_r)|_{\Ker F(f)}:\Ker F(f)\to\Ker G(f)$は全射である．
        \item[終わり] 以上の結果と線型写像の標準分解の命題\ref{prop-pre-homomorphism-thm}より，$\Ker F(f)=\Ker G(f)\oplus\Ker(f-a_r)$を得る．
    \end{description}
\end{proof}
\begin{remark}
    結局，帰納法により，一次式の積の形の多項式$F$が定める自己射$F(f)$の構造が，各$V_{a_i}$上にスカラー倍写像$a_r$として分解することを示した．分解する上に，核もこのように分解するのである．
    それを帰納法で翻訳すれば，$(f-a_r)|_{\Ker F(f)}$という写像を次のように標準分解（というより商集合の普遍性，直和の普遍性でもある）をしたことにあたる：
    \[\xymatrix{
        \Ker G(f)\ar[drrr]_-{\sim}^-{(f-a_r)|_{\Ker G(f)}}\ar[d]_-i\\
        \Ker F(f)\ar[rrr]^-{(f-a_r)|_{\Ker F(f)}}&&&\Ker G(f)\\
        \Ker(f-a_r)\ar[u]^-j\ar[urrr]_-0
    }\]
\end{remark}

\begin{corollary}[対角化可能条件]\label{cor-diagonalizability}
    $V\in\FinVect_K,f\in\End_K(V)$の固有値を$a_1,\cdots,a_r\in K$とすると，次の条件は同値である．
    \begin{enumerate}
        \item $f$は対角化可能．
        \item $V$の固有ベクトルのみからなる基底$x_1,\cdots,x_n$が存在する．
        \item $f$の最小多項式$\varphi$は相異なる一次式の積$(X-a_1)\cdots(X-a_r)$である．
        \item $V=V_{a_1}+\cdots+V_{a_r}$．
        \item $V=V_{a_1}\oplus\cdots\oplus V_{a_r}$．
    \end{enumerate}
\end{corollary}
\begin{proof}
    1と2は言い換えである．
    \begin{description}
        \item[2$\Rightarrow$4] $V=\langle x_1,\cdots,x_n\rangle=V_{a_1}+\cdots+V_{a_n}$．
        \item[4$\Rightarrow$3] まず$a_1,\cdots,a_r$が固有値なのだから，$F=(X-a_1)\cdots(X-a_r)$は最小多項式$\varphi$を割り切る（命題\ref{prop-minimal-polynomial's-root-is-eigenvalue}）．$V=V_{a_1}+\cdots+V_{a_r}$の時，$V$の任意の元は固有ベクトルの和で表せるから，$F(f)=(f-a_1)\circ\cdots\circ(f-a_r)=0$になる．よって，最小多項式$\varphi$は$F$を割り切る．$\therefore\;F=\varphi$．
        \item[3$\Rightarrow$5] 命題より，$V=\Ker\varphi(f)=V_{a_1}\oplus\cdots\oplus V_{a_r}$．
        \item[5$\Rightarrow$2] 言い換えになっている．
    \end{description}
\end{proof}
\begin{remark}
    改めて環の作用$(X-a_1)\cdots(X-a_r)$がどういう意味かわかり，関手性に関する命題\ref{prop-functoriality-of-substitution}
    がやっと理解された．多項式$(X-a_1)\cdots(X-a_r)$の作用は各固有ベクトルの方向に向かって射影を取るようなもので，「一回射影をとれば潰せる」という条件が成り立つものが対角化可能なのである．
    それで命題もわかった．$F(f)=(f-a_1)\cdots(f-a_r)$によって潰れる空間は正確に$\Ker F(f)=V_{a_1}\oplus\cdots\oplus V_{a_r}$なのである．相異なる固有値に属する固有空間は交わらない$V_{a_i}\cap V_{a_j}=0\;(i\ne j)$という主張が紛れ込んでいる．

    また，3$\Rightarrow$1は意義深いな．冪が$2$以上になるとそれは冪零成分を意味する．
    冪が$1$でも，ブロックの大きさは全くわからない．
\end{remark}

\begin{corollary}
    $A=\begin{pmatrix}a&b\\c&d\end{pmatrix}$について，次の条件は同値．
    \begin{enumerate}
        \item $A$は三角化可能．
        \item $X^2-(a+d)X+ad-bc=(X-\alpha)(X-\beta)$を満たす$\alpha,\beta\in K$が存在する．
    \end{enumerate}
\end{corollary}
\begin{proof}
    スカラー行列でないとして示す．
    \begin{description}
        \item[1$\Rightarrow$2] 共役な行列の最小多項式は等しいから，$A$の上三角表示を$\begin{pmatrix}\alpha&\gamma\\0&\beta\end{pmatrix}$とおけば良い．
        \item[2$\Rightarrow$1] $X^2-(a+d)X+ad-bc=(X-\alpha)(X-\beta)$の時，$\alpha,\beta$は$A$の固有値である．$0\ne x\in V_\alpha$とし，これと一次独立でない元を$y$とすると，$K^2$の基底$x,y$に関する行列表示は上三角行列になる．
    \end{description}
\end{proof}
\begin{remark}
    命題\ref{prop-行列の特徴量は線型写像について定まっている}まで到れば，Trとdetが等しいとして導ける．
\end{remark}

\begin{corollary}
    $f\in\End(V)$とし，$W$を$f(W)\subset W$を満たす$V$の$f$-安定部分空間とする．
    $f$が対角化可能ならば$f|_W$も対角化可能である．
\end{corollary}
\begin{proof}
    $f$は対角化可能だから，系\ref{cor-diagonalizability}より，$f$の最小多項式は一次式の積である．
    命題\ref{prop-algorithm-for-minimal-polynomials-in-the-terms-of-ideal}より，$f|_W$の最小多項式はこれを割り切るから，こちらも一次式の積である．
    よって，$f|_W$も対角化可能．
\end{proof}

\begin{corollary}\label{cor-commutative-linear-mappings-triangulization}
    \[S=\{f,g\in\End(V)\mid f,gは対角化可能で，互いに可換：fg=gf\}\]
    とすると，$V$の基底であって，それに関する$S$の任意の元の行列表示が対角行列となるものが存在する．
\end{corollary}
\begin{proof}
    $V$の次元に関する帰納法で示す．$S$の元が全てスカラー倍の時は明らかに成り立ち，$\dim V\le 1$の場合はこれに含まれる．
    $f\in S$をスカラー倍でない準同型とする．$f$に関する固有空間分解を$V=V_{a_1}\oplus\cdots\oplus V_{a_r}$とすると，補題\ref{lemma-commutative}より，任意の$g\in S$について$g(V_{a_i})\subset V_{a_i}$．
    従って系より，$g|_{V_{a_i}}$は対角化可能である．よって帰納法の仮定より，各$V_{a_i}$の基底であって，それに関する$S$の任意の自己準同型の行列表示が対角行列雨になるものが存在する．これを並べれて得られる$V$の基底を考えれば良い．
\end{proof}
\begin{remark}
    同じ共役類に属する行列表示は一斉対角化可能である，最小多項式を共有するためである．
    この代数的現象を座標変換というのである．

    ところで，以前からスカラー倍だけ特別扱いするのはなんだ？なんの退化だ？
\end{remark}

\section{一般固有空間と三角化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    Jordan行列$J(a,n)$の最小多項式は$(X-a)^n$だから，$n>1$の時対角化可能でない（相異なる一次式の積の形でない）例である．
    $2$回以上乗じないと$0$にならない，この現象を冪零という．
    これが固有空間の概念では掴めない要素であるから，
    \textbf{重複度}と呼ばれる次元を追加して調査すると，理論が完全になりそうである．
    こうして，全ての対角化可能でない線型写像は，冪零成分を原因とするということを見る．
    これがJordan分解である．

    最小多項式$\varphi$が冪も含んで一次式の積の形をしている時，
    $\Ker\varphi(f)=V$は一般固有空間の直和に分解する．
    従って数体が$\C$の時，全ての行列は三角化可能である．

    こうして，$f$-安定部分空間に分解して行列の標準形を探すという試み\footnote{$f$-安定な部分空間たちに分解できれば，最小多項式はそれらの積になり，
    行列表示はそれらの直和となる．}は，
    一般固有空間分解の理論に到達する．線型空間の標準的表示を，自己準同型$f\in\End_K(V)$の言葉によって得たことになる．代数の精神である．
\end{tcolorbox}

\subsection{一般固有空間という$f$-安定部分空間}

\begin{definition}[multiplicity]
    多項式$F\in K[X]$の根$a\in K$の重複度が$m$であるとは，
    \[ \exists G\in K[X],\; G(a)\ne 0\land F=(X-a)^mG \]
    が成り立つことをいう．従って，重複度が$0$であるとは，根でないことをいう．
\end{definition}

\begin{definition}[generalized eigenspace]
    $V$を$K$-線型空間とし，$f$を$V$の自己準同型とする．
    $a\in K$とし，$d$を$f$の最小多項式$\varphi$の根$a$の重複度とする．$V$の部分空間
    \[\widetilde{V}_a:=\mathrm{Ker}(f-a)^d\]
    を，\textbf{$a$に属する一般固有空間}という．
\end{definition}

\begin{example}
    Jordan行列$J(a,n)$の定める自己準同型$f:K^n=:V\to V$の最小多項式は$(X-a)^n$であり，$V=\tilde{V}_a$．
\end{example}

\begin{proposition}[一般固有空間への制限は三角化可能である]\label{prop-algorithm-for-making-triangular-matrices}
    一般の線型空間$V$の自己準同型$f$について，$a\in K$を考える．$f$の最小多項式$\varphi$の根$a$の重複度を$d\in\N$とする．
    \begin{enumerate}
        \item (一般固有空間の特徴付け) $\widetilde{V}_a=\{x\in V\mid\exists n\in\N,\; (f-a)^n(x)=0\}$．
        \item ($f$-安定性への到達) $f(\widetilde{V}_a)\subset\widetilde{V}_a,V_a\subset\widetilde{V}_a$．
        \item (三角行列の基底の算譜) $\widetilde{V}_a$が有限次元であるとする．$f|_{\widetilde{V}_a}:\widetilde{V}_a\to\widetilde{V}_a$は三角化可能である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] $W=\{x\in V\mid\exists n\in\N,\; (f-a)^n(x)=0\}$と置く．$\tilde{V}_a\subset W$であるから，あとは$\tilde{V}_a\supset W$を示せば良い．
        $x\in W$を任意に取ると，ある$n\in\N$が存在して$(f-a)^n(x)=0$即ち$x\in\Ker(f-a)^n$が成立する．この時，
        \begin{enumerate}[(1)]
            \item 注\ref{remark-1}より，$F(f)=(f-a)^n$と置くと$f(\Ker F(f))\subset\Ker F(f)$だから，$f(\Ker(f-a)^n)\subset\Ker(f-a)^n$．
            \item $V$の部分空間$\Ker(f-a)^n$に$f$が引き起こす射$(f-a)^n|_{\Ker(f-a)^n}$は$(f-a)^n(\Ker(f-a)^n)=0$を満たすから，$(f-a)^n|_{\Ker(f-a)^n}$の最小多項式は多項式$(X-a)^n$を割り切るので，$e|n$を満たす$e\in\N$を用いて$\psi=(X-a)^e$と書ける．
            \item 1.が成り立つので命題\ref{prop-algorithm-for-minimal-polynomials-in-the-terms-of-ideal}より，$\psi=(X-a)^e$は$f$の最小多項式$\varphi$も割り切るから，$e|d$でもある．
        \end{enumerate}
        以上の議論より，$x$が，$f$が保つような$V$の部分空間$\Ker(f-a)^n$に入っているならば，その部分空間上に定まる自己準同型$(f-a)^n|_{\Ker(f-a)^n}$の最小多項式$\psi$の空間にも入っており（微視的には$\Ker(f-a)^n=\Ker\psi(f)$であるが，$V$の部分空間としては後者の方が大きい可能性がある），次大域的な自己準同型$f$の零化空間$\tilde{V}_a$には局所的なものは収まるから，次の系列を得る：
        \[ x\in\Ker(f-a)^n\subset\Ker\psi(f)=\Ker(f-a)^e\subset\Ker(f-a)^d=\tilde{V}_a \]
        が導けたから，$\tilde{V}_a=W$．
        \item[2.] 注\ref{remark-1}より，$F(f)=(f-a)^d$と置くと$f(\Ker F(f))\subset\Ker F(f)$だから，$f(\Ker(f-a)^d)\subset\Ker(f-a)^d$．また系列を考えれば$d\ge 1$ならば$\Ker(f-a)\subset\Ker(f-a)^d$であるが，$d=0$の時は$(f-a)^d=1$と約束したから，$\tilde{V}_a=0$．一方この時，根$a$の重複度も$d$即ち$a$は固有値ではないと約束したから，$V_a=0$．
        \item[3.] 列$(V_k:=(f-a)^k(\tilde{V}_a))^d_{k=0}$は減少列
            \[\tilde{V}_a=V_0\supset V_1\supset\cdots\supset V_d=0\]
            であり，それぞれの次元の組を$(n_k:=\dim V_k)_{k=0}^d$とする．算譜\ref{thm-linear-system-extension-algorithm}により，$V_k\;(k=0,1,\cdots,d-1)$の基底を帰納的に上から延長することによって定めることができる．
            $V_k$に対して基底は$x_1,\cdots,x_{n_k}$と表せ，$\tilde{V}_a=V_0$の基底$x_1,\cdots,x_{n_0}$を得る．
            
            この基底についての自己準同型$(f-a)|_{\tilde{V}_a}$の行列表示は，
            各$k$について$(f-a)(V_k)=V_{k+1}$と基底が消えていくから，対角成分が全て$0$の上三角行列である．
            従って，$f|_{\tilde{V}_a}$の同じ基底による表示は，対角成分が$a$の上三角行列である．
    \end{description}
\end{proof}
\begin{remark}\label{remark-motivation-for-一般固有空間分解}
    命題\ref{prop-diagonalization}は，一次式の積の形に表せる多項式について，
    \[ \Ker(f-a_1)\cdots(f-a_r)=V_{a_1}\oplus\cdots\oplus V_{a_r} \]
    を示したが，今回は一次式の冪の形に表せる多項式について，
    \[ \Ker(f-a)^d=\tilde{V}_a \]
    内では三角化可能であることを示す．
    3は，潰れていく部分空間の減少列を取り，上から基底の延長を取れば，「後の番号の方から基底として脱落していく」という性質により，行列表示は上三角行列になる．

    すると，$V=\tilde{V}_{a_1}\oplus\cdots\oplus\tilde{V}_{a_r}$
    という形の分解について，三角行列の部分行列が対角線上に並んだものが標準形になることが予想される．
    これが次の定理である．
\end{remark}

\subsection{三角化：線型写像の一般固有空間に沿った分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    注\ref{remark-motivation-for-一般固有空間分解}の通り，各一般固有空間$\Ker(f-a_1)^{d_1}$への制限は上三角行列になる．
    \[\Ker(X-a_1)^{d_1}\cdots(X-a_r)^{d_r}=\Ker(f-a_1)^{d_1}\oplus\cdots\oplus\Ker(f-a_r)^{d_r}\]
    という関手性を示す（定理\ref{thm-triangulization}）．左辺の一次式の積が，何かの線型写像$f$の最小多項式$\varphi$であった場合，$\Ker\varphi(f)=V$であるから，
    この定理は空間$V$の一般固有空間分解を与える．
\end{tcolorbox}

\begin{theorem}[三角化]\label{thm-triangulization}
    $V$を$K$-線型空間とする．$a_1,\cdots,a_r\in K$を相異なる元として，$F=(X-a_1)^{d_1}\cdots(X-a_r)^{d_r}\;(d_i>0)$と置く．
    この時，
    \[ \Ker F(f)=\Ker(f-a_1)^{d_1}\oplus\cdots\oplus\Ker(f-a_r)^{d_r}. \]
\end{theorem}
\begin{proof}
    命題\ref{prop-diagonalization}と同様，$r$についての帰納法で示す．$r=1$の時は定義そのものである．
    $r>1$とした時，$G=(X-a_1)^{d_1}\cdots(X-a_{r-1})^{d_{r-1}}$と置くと，帰納法の仮定より$\Ker G(f)=\Ker(f-a_1)^{d_1}\oplus\cdots\oplus\Ker(f-a_{r-1})^{d_{r-1}}$である．
    $a_1,\cdots,a_r$は相異なるから，$G(a_r)\ne 0$である．
    すると，次の補題が成り立てば，命題\ref{prop-pre-homomorphism-thm}より，$\Ker F(f)=\Ker G(f)\oplus\Ker(f-a_r)^{d_r}$とわかる．
\end{proof}

\begin{lemma}\label{lemma-for-triangulization}
    一般の線型空間$V$とその上の自己準同型$f$について，
    $G\in K[X],a\in K$とし，$W=\Ker G(f)$と置く．$G(a)\ne 0$ならば，次が成り立つ．
    \begin{enumerate}
        \item $f-a$が$W$に引き起こす写像$(f-a)|_W:W\to W$は可逆である．
        \item $\Ker G(f)(f-a)^d=W\oplus\Ker(f-a)^d$．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] $\exists G\in K[X],\; G=Q(X-a)+G(a)$と表せる．ここで$H=-\frac{Q}{G(a)}\in K[X]$と置くと，
        \[H(X-a)=1-\frac{G}{G(a)}\]
        である．よって，$W=\Ker G(f)$の範囲に制限すれば第二項は消えるから，$H(f)\circ (f-a)=(f-a)\circ H(f)=\id$．よって，$(f-a)|_W$は可逆で逆射は$H(f)$．
        \item[2.] $W\subset W':=\Ker G(f)(f-a)^d$と置くと，$W'$に関する$W$の補空間が$\Ker(f-a)^d$だと示せば良い．
        $(f-a)^d(W')\subset W$より，$(f-a)^d$は$W'$上に線型写像$g:=(f-a)^d|_{W'}:W'\to W$を引き起こす．これは制限を課さずとも$\Ker(f-a)^d\subset W'$だから，$\Ker g=\Ker(f-a)^d\cap W'=\Ker (f-a)^d$が成り立つ．よって，命題\ref{prop-pre-homomorphism-thm}より，$W'=W\oplus\Ker g$．
    \end{description}
\end{proof}
\begin{remark}
    1.の証明はまさか逆射を構成している．
    おそらく環上の加群の言葉を用いていて，私には絶対にできない言葉遣いだ．
\end{remark}

\begin{corollary}[三角化可能条件]\label{cor-triangulability}
    $V\in\FinVect_K$とする．次は同値．
    \begin{enumerate}
        \item $f$は三角化可能．
        \item $V$の基底$x_1,\cdots,x_n$で，$f(x_i)\in\langle x_1,\cdots,x_i\rangle\;(i\in[n])$を満たすものが存在する．
        \item $f$の最小多項式$\varphi$は一次式の積に分解する．
        \item $\exists a_1,\cdots,a_r\in K,\;V=\widetilde{V}_{a_1}\oplus\cdots\oplus\widetilde{V}_{a_r}$．
        \item $V$の基底であって，それに関する$f$の行列表示$A$が，その対角成分が全て$a_i\in K$の上三角行列$A_i$の直和$A=A_1\oplus\cdots\oplus A_r$となるものがある．
    \end{enumerate}
\end{corollary}
\begin{proof}
    1と2は少し高度だが，5までくれば言い換えであると分かる．
    \begin{description}
        \item[1$\Rightarrow$3] 任意の上三角行列の最小多項式を$\varphi$とする．対角成分を$a_1,\cdots,a_n$とすると，命題\ref{prop-eigenvalue-of-triangular-matrices}より，$\varphi$は多項式$(X-a_1)\cdots(X-a_n)$を割り切る．よって$\varphi$は一次式の積に分解する．
        \item[3$\Rightarrow$4] $\varphi$は最小多項式なので，$V=\Ker\varphi(f)$だから，定理\ref{thm-triangulization}より従う．
        \item[4$\Rightarrow$5] 上三角行列の算譜（命題\ref{prop-algorithm-for-making-triangular-matrices}）により，各$\tilde{V}_{a_i}$上では$f|_{\tilde{V}_{a_i}}$は上三角化可能である．この基底を並べれば，条件の行列表示を得る．
        
        \item[5$\Rightarrow$1] 5の行列は上三角行列である．
    \end{description}
\end{proof}
\begin{remark}
    4と5の言い換えが今回の自己準同型の理論の本質である．
    自己準同型が三角化できるということは，空間が一般固有空間に分解できる時をいう．
    \textbf{三角化可能かどうか，果てには対角化可能かどうかは，空間の性質に言及している}．Cayley表現の精神である．
\end{remark}

\begin{corollary}
    $V\in\FinVect_K$とし，$f\in\End(V)$を三角化可能とする．
    \begin{enumerate}
        \item 次の条件は同値である．
        \begin{enumerate}[(1)]
            \item $f$は対角化可能．
            \item $f$の固有値$a_1,\cdots,a_r$について，$\widetilde{V}_{a_i}=V_{a_i}\;(i\in[r])$．
        \end{enumerate}
        \item $W$を$f(W)\subset W$を満たす$V$の$f$-安定部分空間とする．$f|_W$は三角化可能である．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] $f$は三角化可能だから，系\ref{cor-triangulability}より$a_1,\cdots,a_r\in K$が存在して$V=\tilde{V}_{a_1}\oplus\cdots\oplus \tilde{V}_{a_r}$と分解できる．
        命題\ref{prop-algorithm-for-making-triangular-matrices}.2より，$V_{a_i}\subset\tilde{V_{a_i}}$なので，(2)の条件は$V=V_{a_1}\oplus\cdots\oplus V_{a_r}$と分解できることを言っている．
        これは$f$が対角化可能であることと同値である（系\ref{cor-diagonalizability}）．
        \item[2.] 系\ref{cor-triangulability}より，$f$の最小多項式$\varphi$は一次式の積に分解する．命題\ref{prop-algorithm-for-minimal-polynomials-in-the-terms-of-ideal}より，$f|_W$の最小多項式は$\varphi$を割り切る．よってこれも一次式の積に分解し，$f|_W$は三角化可能．
    \end{description}
\end{proof}

\begin{definition}[generalized eigenspace decomposition]
    $V$を有限次元$K$-線型空間とし，$f$を$V$の三角化可能な自己準同型とする．
    $a_1,\cdots,a_r\in K$を$f$の固有値とし，$\widetilde{V}_{a_i}$を固有値$a_i$の一般固有空間とする．
    この時，直和分解
    \[V=\widetilde{V}_{a_i}\oplus\cdots\oplus\widetilde{V}_{a_r}\]
    が存在し（系\ref{cor-triangulability}），これを，\textbf{$f$に関する$V$の一般固有空間分解}という．
\end{definition}

\section{冪零自己準同型とJordan標準形}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    三角化の理論をさらにもう一歩だけ深めたい．
    %必ずしも一般の係数体$K$に対して一般固有空間に分解できるとは限らず，もっと線型空間に寄り添って，核心に迫りたい．
    個々の一般固有空間に引き起こされる射に注目して
    $g_i:=(f-a_i)|_{\widetilde{V}_{a_i}}$とすると，$g_i^{d_i}=0$が成り立つわけであるが，
    この固有空間を一般化する際に加味した冪零の要素に注目して，理論を深化させることを考える．
    三角行列の細胞$A_i$が$g_i$の行列表示である．
    $g_i$に注目して，この行列表示がどこまで簡単になるかを考える．

    一般の冪零写像$N$について，線型空間には定理\ref{thm-Jordan-decomposition}のような標準的な分解がある（これはいくらか同伴行列に起こっている現象と似ている！ロケット鉛筆！）．
    この，冪零性の寿命と人生航路を考慮した分解がJordanの理論である．
    これに沿った行列表示を考えれば，三角化よりも踏み込んだ表示Jordan標準形を得る．
    これは，有限次元線型空間の三角化可能な自己準同型は，対角化可能な部分と冪零な部分に分解し，それで全てであることを表している．

    Jordan blockの大きさが冪零成分の系列の長さ（寿命），個数がその系列の空間の次元を表す．対角成分が半単純部分を表す．非対角成分は冪を取るごとにはけてゆく．
    この表示により，共役類の貼り合わせとしての線型写像の振る舞いを一眼で見ることが出来るようになる．
    これが基底変換である．

    そう，三角化可能な有限次元線型空間の自己準同型については，この「冪零成分はJordan blockに，そうでない成分は対角行列に」というのが最も線型代数的に自然なもので，これが上三角行列の真の精緻化としてふさわしいものである．
    Jordan標準形は，一般固有空間のそれぞれに対して，Jordan分解を考えたものである．
\end{tcolorbox}

\begin{definition}[nilpotent]
    $f\in\End(V)$が，$f^n=0$を満たす$n\in\N$を持つ時，\textbf{冪零}であるという．
    即ち，$f$の最小多項式が，$d\in\N$を用いて$X^d$と表せることをいう．
\end{definition}

\subsection{冪零自己準同型のJordan標準形}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    冪零自己準同型は，寿命と人生航路とで分解する，という標準的な見方ができる．
    これがJordan標準形の理論である．
\end{tcolorbox}

\begin{theorem}[Jordan]\label{thm-Jordan-decomposition}
    $V\in\Vect_K, N\in\End(V)$を$N^{m+1}=0$を満たす自己準同型とする．この時，$V$の直和分解
    \[ V=\bigoplus_{p,q\in\N,p+q\le m}V_{p,q} \]
    であって，次の条件を満たすものが存在する．
    \begin{quote}
        (J) $p>0$ならば，$N(V_{p,q})=V_{p-1,q+1}$であり，これは同型$N|_{V_{p,q}}:V_{p,q}\to V_{p-1,q+1}$を引き起こす．$p=0$ならば$N(V_{0,q})=0$．
    \end{quote}
\end{theorem}
\begin{remark}[条件(J)を満たす分解の$N$の言葉による構成法]
    $q$が$N$を作用させた回数で，$p$が$0$にまで潰れるまでの残り回数である．$N^{m+1}=0$の時，$p+q=m$のものまでが存在し，それらに直和分解できるという主張である．
    そして，$N$が直和分解の上に定める写像は整列した同型になる．$p,q\in\N,p+q\le m$とは座標平面上の三角形領域内に含まれる格子点だから，座標系を-45度回転させて次の図を得る．
    核$\Ker N^r$が$p$軸に並行な直線$q=r-1$についての直和で（$r=1$の時は$p$軸そのもの），像$\Im N^r$が$q$軸に並行な直線$p=r-1$についての直和を指し，これらの交点として各部分空間$V_{p,q}$を指定していく．
    \[\xymatrix{
        &&&&V_{m,0}\ar[d]^-{\rotatebox{90}{$\sim$}}\\
        &&V_{1,0}\ar@{.}[urr]\ar[dd]^-{\rotatebox{90}{$\sim$}}&&V_{m-1,1}\ar@{}[dd]|{\vdots}\\
        V_{0,0}\ar@{.}[urr]^-{q=0}\ar@{.}[drr]_-{p=0}&&{}\ar@{}[rr]|{\cdots\cdots}&&{}\\
        &&V_{0,1}\ar@{.}[drr]&&V_{1,m-1}\ar[d]^-{\rotatebox{90}{$\sim$}}\\
        &&&&V_{0,m}
    }\]
    すると，生成する部分空間は結局$(V_{p,0})$の系列であるから，これらを$(V_{0,q})$から構成する．その他は必要に応じて生成元に$N$を作用させて得る：$V_{p,q}=N^q(V_{p+q,0})$．
    \begin{description}
        \item[$(V_{0,q})_{q\in m+1}$の構成] 
        $N^r$の像は$N$の作用回数カウンタ$q$が$r$以上のものの直和$\Im N^r=\oplus_{q\ge r,p\le m-r}V_{p,q}$で，$N$の核は残り回数カウンタ$p$が$0$のもの$\Ker N=\oplus_{q\in m+1}V_{0,q}$である．
        すると，$\oplus_{q\ge 0}V_{0,q}=\Ker N\cap\Im N^r$である．
        \item[$(V_{p,0})_{p\in m+1}$の構成] 
        条件(J)より，$N^q|_{V_{q,0}}:V_{q,0}\to V_{0,p}$は同型だから，これの像として定義する：$(N^q)^{-1}(V_{q,0})=:V_{0,p}$．
        \item[一般の$V_{p,q}$の構成] 
        $V_{p,q}=N^q(V_{p+q,0})$による．
    \end{description}
    以上の構成により，(J)を満たす分解$V=\bigoplus_{p,q\in\N,p+q\le m}V_{p,q}$が作れた．
    $r$の関する帰納法で$\Ker N^{r+1}=V=\bigoplus_{p,q\in\N,p+q\le m}V_{p,q}$を示せば良い．

    実用的には$p+q=m$を満たす右端の列から探す．
\end{remark}
\begin{proof}
    $q\in m+1$に対し，$V_{0,q}\subset V$を
    \[ \Ker N\cap\Im N^q=V_{0,q}\oplus(\Ker N\cap\Im N^{q+1})\;\;\;(q\in m+1) \]
    を満たす$V$の部分空間とする．この時，$\Ker N\cap\Im N^r=\oplus_{r\le q\le m}V_{0,q}\;(0\le r\le m+1)$である．
    上からの帰納法で示す．$r=m+1$ならば，両辺とも$0$である．$r\le m$について，$\Ker N\cap\Im N^{r+1}=\oplus_{r+1\le q\le m}V_{0,q}$とする．
    両辺との$V_{0,r}$の直和を考えると，定め方から，$\Ker N\cap\Im N^r=\oplus_{r\le q\le m}V_{0,q}$を得る．$r=0$の時$\Ker N=\oplus_{0\le q\le m}V_{0,q}$となるまで定義できた．

    続いて，$V_{0,q}\subset\Im N^q$だから，線型写像$N^q$の$(N^q)^{-1}(V_{0,q})$への制限は全射になる（包含写像との分解）．
    そこで，$V_{q,0}\subset V$を，この全射の定義域$(N^q)^{-1}(V_{0,q})$の直和因子$V_{q,0}\oplus\Ker N^q$とすると，$N^q$が$V_{q,0}$に引き起こす写像$N^q|_{V_{q,0}}:V_{q,0}\to V_{0,p}$は同型である（命題\ref{prop-pre-homomorphism-thm}）．
    さらに，これを用いて，$V_{p,q}:=N^q(V_{p+q,0})\;(0<p,0<q,p+q\le m)$とする．

    これらが条件(J)を満たすことを示す．$p+q=r$を満たす$p,q$に対して，$N$の各$V_{p,q}$への制限は全射の列
    \[ V_{r,0}\xrightarrow{N}V_{r-1,1}\xrightarrow{N}\cdots\xrightarrow{N}V_{p,q}\xrightarrow{N}V_{p-1,q+1}\xrightarrow{N}\cdots\xrightarrow{N}V_{0,r} \]
    を定める．これらの合成$N^r|_{V_{r,0}}$が同型だ（となるように構成した）から，各も同型である．
    また$V_{0,p}\subset\Ker N$となるように構成したから，$N(V_{0,p})=0$．以上より条件(P)は満たされる．

    $r$に関する帰納法で，$\Ker N^{r+1}=V=\bigoplus_{p,q\in\N p\le r,,p+q\le m}V_{p,q}$を示す．
    $r=0$の時は，$\Ker N=\oplus_{0\le q\le m}V_{0,q}$となるのであった．$r>0$の場合を示す．
    各同型$N^r|_{V_{r,q-r}}:V_{r,q-r}\to V_{0,q}$の直和
    \[ \oplus_{r\le q\le m}V_{r,q-r}\to\oplus_{r\le q\le m}V_{0,q}=\Ker N\cap \Im N^r \]
    もまた同型である．これは，各要素がそうであったから，包含写像の和$\oplus_{r\le q\le m}V_{r,q-r}\to\Ker N^{r+1}$と$N^r$の制限$(N^r)|_{\Ker N^{r+1}}:\Ker N^{r+1}\to\Ker N\cap\Im N^r$とに分解するから，
    \begin{enumerate}
        \item いま，各$p\le r$について，$V_{p,q}\subset\Ker N^{r+1}$であるが，この和$\sum_{q=r}^m V_{r,q-r}\subset\Ker N^{r+1}$は直和$\oplus_{r\le q\le m}V_{r,q-r}$であり，
        \item 制限$(N^r)|_{\Ker N^{r+1}}:\Ker N^{r+1}\to\Ker N\cap\Im N^r$は全射である．
    \end{enumerate}
    従って，命題\ref{prop-pre-homomorphism-thm}より，$\Ker N^{r+1}=\Ker N^r\oplus(\bigoplus_{r\le q\le m}V_{r,q-r})$であるから，帰納法の仮定と併せて，
    \[ \Ker N^{r+1}=V=\bigoplus_{p,q\in\N p\le r,,p+q\le m}V_{p,q}. \]

    こうして得た主張の$r=m$の場合が，定理の主張である．
\end{proof}

\begin{example}[$J(0,n)$の場合]
    $K^n$上の自己準同型$N:=J(0,n)$を考える．
    これは$N^n=0$であり，$V_{i-1,n-1}=\langle e_i\rangle\;(i=1,\cdots,n)$と置き，それ以外を$0$とすれば，
    \[V=\bigoplus_{p,q\in\N,p+q\le n-1}V_{p,q}\]
    は定理の条件を満たす直和分解である．即ち，$J(0,n)$とは，寿命が$n-1$であるようなものしか存在しない場合である．
\end{example}

\begin{corollary}[冪零準同型のJordan標準形]\label{cor-Jordan-form-of-nilpotents}
    $V\in\FinVect_K$とし，$N\in\End(V)$を$N^{m+1}=0$を満たすとする．
    $n_r:=\dim(\Ker N\cap\Im N^r)-\dim(\Ker N\cap\Im N^{r+1})\;(r=0,1,\cdots,m)$と置く（第$r+1$回目の$N$の作用で潰れる空間の次元）．
    この時，$V$の基底で，それに関する$N$の行列表示$J$が
    \[ J=J(0,1)^{\oplus n_0}\oplus\cdots\oplus J(0,r+1)^{\oplus n_r}\oplus\cdots\oplus J(0,m+1)^{\oplus n_m} \]
    となるものが存在する．
\end{corollary}
\begin{proof}
    定理\ref{thm-Jordan-decomposition}より，直和分割$V=\bigoplus_{p,q\in\N,p+q\le m}V_{p,q}$を取る．
    この時，$n_r=\dim V_{r,0}$となっている．実際，$\Ker N=\oplus_{0\le q\le m}V_{0,q}, \Im N^r=\oplus_{0\le p,r\le q,p+q\le m}V_{p,q}$であるから，
    $\Ker N\cap\Im N^r=\oplus_{r\le q\le m}V_{0,q}$となり，$n_r=\dim V_{0,r}=\dim V_{r,0}$である．２つの空間には同型$N|_{V_{r,0}}:V_{r,0}\to V_{0,r}$が存在するためである．

    いま，
    \[ V_r:=V_{r,0}\oplus V_{r-1,1}\oplus\cdots\oplus V_{0,r}\;\;\;(r=0,1,\cdots,m) \]
    と置く．すると$N(V_r)\subset V_r$であり，$V=\oplus_{i\in m+1}V_i$だから，各$V_r$の基底であって，$N$の$V_r$の制限の行列表示が$J(0,r+1)^{\oplus n_r}$となる基底を構成すれば良い．

    $0\ne x\in V_{r,0}$を取り，$W_x:=\langle N^rx,\cdots,Nx,x\rangle$と置く．$W_x$の基底$x,Nx,N^rx$に関する$N$の行列表示は$J(0,r+1)$である．
    これを$V_{r,0}$の基底$x_1,\cdots,x_{n_r}$について行うと，$V_r=W_{x_1}\oplus\cdots\oplus W_{x_{n_r}}$である．従って，基底$N^rx_1,\cdots,x_1,N^rx_{n_r},\cdots,x_{n_r}$に関する$N|_{V_r}$の行列表示は$J(0,r+1)^{\oplus n_r}$である．
\end{proof}
\begin{remark}
    なるほど，Jordan細胞の２階目は冪零成分を意味していたのか．ちょうど図では$V_{i,r-i}\to V_{i+1,r-i-1}$の動きを意味していて，Jordan標準形上では「残り寿命$p$カウンターが一つ小さい空間の基底に写す」事に当たる．

    また，$J(0,r+1)^{\oplus n_r}$の表記に戦いたが，これがJordan表示の妥協である．$N$-安定部分空間を優先して，$n_r\ge 2$の時，２つセットで移動するわけではないのである．

    また，基底は$N^rx_{n_i},\cdots,x_{n_i}$の順番である．「上に捌ける」ようになっている．
\end{remark}

\begin{problem}[実際の$V_{p,0}$探索に使う算譜]
    $V$の基底$x_1,\cdots,x_n$と$\Im N^r$の$V_{r,0}$に対する補空間$W_r=\sum_{0\le p,r\le p,r\textcolor{red}{<}p+q\le m}V_{p,q}$と，
    その基底$N^ry_1,\cdots,N^ry_s$が与えられているとする．
    始空間$V_{r,0}$とその基底の構成算譜を与えよ．$(1\le r\le m)$である．こうやって$p+q=m$の場合から構成していく．
\end{problem}
\begin{proof}[［解答］]
    $W_r$は残機が尽きている虫の息の$V_{0,r}$を$\Im N^r$から除いた補空間であるから，$N(\Im N^r)=N(W_r)$が成り立つ．
    $\Im N^r$の基底を探し，$x_{i_1},\cdots,x_{i_t}$を用いて，$N^ry_1,\cdots,N^ry_s,N^rx_{i_1},\cdots,N^rx_{i_t}$と表せたとし，
    ここから$V_{0,r}$の基底を遡上して探す方法を考える．
    $N(\Im N^r)=N(W_r)$より，$1\le j\le t$について，
    \[ \exists a_{1j}N^ry_1+\cdots+a_{sj}N^ry_s\in\Im N^r,\; N(N^{r}x_{i_j})=N(a_{1j}N^ry_1+\cdots+a_{sj}N^ry_s) \]
    であるから，
    \[ z_j=x_{i_j}-(a_{1j}y_1+\cdots+a_{sj}y_s) \]
    と置けば，これはちょうど次の$N$の作用で消える元だから，$V_{r,0}$の元である．
    $z_1,\cdots,z_t$の右辺の同型$N^r$による値は$\Im N^r$の基底であるから，同型$(N^r)^{-1}$による像である$z_1,\cdots,z_t$も基底で，
    $V_{r,0}=\langle z_1,\cdots,z_t\rangle$と置けば良い．
\end{proof}

\begin{problem}
    次の行列のJordan標準形を求めよ．
    \[N=\begin{pmatrix}0&0&0&1&0&0\\0&0&0&0&1&-1\\1&-1&0&-1&-1&1\\0&0&0&0&0&0\\0&0&0&0&0&0\\0&0&0&0&0&0\end{pmatrix}\]
\end{problem}
\begin{proof}[［解答］]
    \[N^2=\begin{pmatrix}0&0&0&0&0&0\\0&0&0&0&0&0\\0&0&0&1&-1&1\\0&0&0&0&0&0\\0&0&0&0&0&0\\0&0&0&0&0&0\end{pmatrix},\;N^3=0.\]
    右下から見つかる：$V_{0,2}=\Im N^2=\langle e_3\rangle=\Im N^2\cap\Ker N$．続いて遡上するには，$e_3=N^2e_4,Ne_4=e_1-e_3$を了解すれば，$V_{2,0}=\langle  e_4\rangle,V_{1,1}=\langle e_1-e_3\rangle$とわかる．
    従って，$W_1:=V_{0,2}+V_{1,1}=\langle e_3,e_1-e_3\rangle$とわかる．

    続いて，右端の列の情報を上で考えた算譜に適用して寿命１の列を調べる．
    $\Im N=\langle  e_3,e_1-e_3,e_2-e_3\rangle=\langle e_2-e_3\rangle+W_1$である．
    ここでトリックで，$N(e_2-e_3)=-e_3=-N(e_1-e_3)\in W_1$かつ$e_1-e_3\in W_1$なのを利用して$V_{0,1}=\langle (e_2-e_3)+(e_1-e_3)\rangle =\langle e_1+e_2-2e_3\rangle$とする．
    なぜなら，$e_1+e_2-2e_3=N(e_4+e_5)$だからである．$V_{1,0}=\langle e_4+e_5\rangle$とおける．
    すると，今まで明らかにした空間は$W_0:=\langle e_3,e_1-e_3,e_4,e_2-e_1,e_4+e_5\rangle$となる．

    最後に，$V=\langle e_6\rangle +W_0$で，$Ne_6=e_3-e_2=-Ne_5\in W_0$かつ$e_5\in W_0$であるから，$V_{0,0}=\langle e_5+e_6\rangle$と置けば良い．

    すると，Jordan分解$K^6=\oplus_{0\le p,q\le 2,p+q\le 2}V_{p,q}$を得た．

    Jordan標準形を得るための底の変換行列は，標準基底$e_1,\cdots,e_6\in K^6$の行き先を順に，右下から上への動きで指定して，
    \[ P=\begin{pmatrix}0&1&0&1&0&0\\0&0&0&1&0&0\\1&-1&0&-2&0&0\\0&0&1&0&1&0\\0&0&0&0&1&1\\0&0&0&0&0&1\end{pmatrix}. \]
    Jordan標準形は
    \[ P^{-1}NP=\begin{pmatrix}0&1&0&0&0&0\\0&0&1&0&0&0\\0&0&0&0&0&0\\0&0&0&0&1&0\\0&0&0&0&0&0\\0&0&0&0&0&0\end{pmatrix}. \]
    寿命３のものが一番上のブロックに来ており，次に寿命が２のもの，最後に寿命１のものである．それぞれ次元が３，２，１で合計６である．
\end{proof}

\subsection{一般の自己準同型のJordan分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    これで，冪零準同型の理論は揃った．
    一般の線型写像を考える．対角化できないものは，全てこの冪零成分による．対角化可能であることと，$n=0$であることが同値であるという形で定式化される．
    とりあえず体上の加群としては，上三角化可能なクラスを考えておけば良い．
\end{tcolorbox}

\begin{corollary}[一般の線型写像のJordan標準形]
    $V\in\FinVect_K,f\in\End(V)$を三角化可能とする．
    $f$の固有値を$a_1,\cdots,a_r$とする．この時，自然数の列$1\le p_{1,i}\le\cdots\le p_{l,i}\;(i=1,\cdots,r)$であって，
    行列$J(a_i,p_{j,i})\;(1\le i\le r,1\le j\le l_i)$の直和が$f$の行列表示となるようなものが存在する．
    （実は一意的）．
\end{corollary}
\begin{proof}
    各一般固有空間への制限$(f-a_i)|_{\tilde{V}_{a_i}}$は冪零だから，
    これについて系を適用するとJordan分解を得る．これを並べた直和の行列を得れば良い．

    系より，基底の並べ方を除いて一意的に定まる．
\end{proof}

\begin{definition}[Jordan normal form]
    $V\in\FinVect_K,f\in\End(V)$を三角化可能とする．$f$の行列表示$J$がJordan行列の直和からなる時，$J$を$f$の\textbf{Jordan標準形}であるという．
\end{definition}

\begin{definition}[semi-simple part, nilpotent part, unipotent part]
    $V=\widetilde{V}_{a_1}\oplus\cdots\oplus\widetilde{V}_{a_r}$を$f$に関する一般固有空間分解とする．
    \begin{enumerate}
        \item $V$の自己準同型$s\in\End(V)$で，各$\widetilde{V}_{a_i}$への制限が$a_i$倍写像であるという条件で定まるものを，\textbf{$f$の半単純部分}と言う．
        \item $n:=f-s$を\textbf{$f$の冪零部分}と言う．
        \item $f=s+n$を$f$の\textbf{Jordan分解}と言う．
        \item 固有値$a_1,\cdots,a_r$がいずれも$0$でない時（即ち$V_{0,0}=0$である時），$u:=s^{-1}f$を\textbf{$f$の冪単部分}と呼び，$f=su$を$f$の\textbf{乗法的なJordan分解}と呼ぶ．
    \end{enumerate}
\end{definition}
\begin{remark}\mbox{}
    \begin{enumerate}
        \item 単位元をもつ環（可換でなくてもよい）上の加群は、単純（既約）部分加群の直和であるときに、半単純 (semisimple) あるいは完全可約 (completely reducible) という。 \footnote{\url{https://ja.wikipedia.org/wiki/半単純加群}}
        \item 結局半単純部分と冪零部分の解離が，最小多項式と固有多項式の解離部分に等しい．$n$がfullの時（一般固有空間と固有空間が一致する時も含め，冪零次元が満たされている時），２つの多項式は一致する．一番乖離が大きいのは$n=0$即ち対角化可能である時である．
        \item $J(a,n)=a+J(0,n)$はJordan分解である．
    \end{enumerate}
\end{remark}

\section{行列式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    行列式の本質は外積代数で，特にこれを正規化したものをいう．
\end{tcolorbox}

\subsection{行列式の３通りの定義}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    行列式を
    \begin{enumerate}
        \item 小行列による計算法則（手でやるのが良いアルゴリズム）
        \item 規格化された多重交代線型形式（公理論で採用するもの）
        \item 符号による計算法則（還元主義的）
    \end{enumerate}
    によって定義する．
    これにより，行列式の性質と置換の符号の性質を導く．
    置換の符号は行列式によって定義できるからである．
    これは置換の行列表現と呼び得る，遠回りに見えてもしかしたら極めて有効な代数的手段である：$P(\sigma\circ\tau)=P(\sigma)P(\tau)$．
\end{tcolorbox}

\begin{definition}[determinant]
    $A\in M_n(K)$に対して，\textbf{行列式}$\det:M_n(K)\to K$を次のように帰納的に定義する．
    \begin{enumerate}
        \item $n=0$の時，$M_0(K)=0$であり，$\det\; 0=1$とする．
        \item $A=(a_{ij})\in M_n(K)$の行列式は，$A_i\in M_{n-1}(K)$を$A$の第$n$列と第$i$行を除いて得られる行列として，
        \[ \det A:=\sum^n_{i=1}(-1)^{n-i}\det A_i\cdot a_{in} \]
        と定める．
    \end{enumerate}
\end{definition}

\begin{definition}[permutation, signature, transposition]\mbox{}\label{def-permutation-and-signature}
    \begin{enumerate}
        \item 可逆な写像$\sigma:[n]\to[n]$を$n$文字の\textbf{置換}と呼ぶ．
        $\mathfrak{S}_n:=\Aut([n])$と置く．
        \item 次の写像$\sgn$を\textbf{置換$\sigma$の符号}と言う：
        \[ \xymatrix@R-2pc{
            \sgn:\mathfrak{S}_n\ar[r]&K\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            \sigma\ar@{|->}[r]&\det P(\sigma)=\det\left(e_{\sigma(1)}\cdots e_{\sigma(n)}\right)
        } \]
        ただし，
        \[\xymatrix@R-2pc{
            P:\mathfrak{P}_n:=\Map([n],[n])\ar[r]&M_n(K)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            f\ar@{|->}[r]&P(f)=(e_{f(1)}\;\cdots\;e_{f(n)})
        }\]
        とした．これは群準同型である（例\ref{example-signature-of-permutation}）．
        \item $i<j$に対して次を満たす写像を$(i\;j)\in\mathfrak{S}_n$で表し，\textbf{互換}と言う．
        \[ \begin{cases}
            \sigma(i)=j,\\
            \sigma(j)=i,\\
            \sigma(k)=k,&(k\ne i,j).
        \end{cases} \]
        \item $\sigma\in\End([n])$に対して，$P(\sigma)$とは，置換・互換の行列表現と呼び得る何かであるな：$P(\sigma\circ\tau)=P(\sigma)P(\tau)$．
    \end{enumerate}
\end{definition}

\begin{proposition}[行列式の特徴付け：交代多重線型形式]\label{prop-characterization-of-determinant}
    写像$d:M_n(K)\to K$について，次の４条件は全て同値である．
    \begin{enumerate}
        \item $\forall A\in M_n(K),\;d(A)=d(1)\det A$．
        \item $\forall A\in M_n(K),\;d(A)=d(1)\sum_{\sigma\in\mathfrak{S}_n}\sgn(\sigma)\cdot a_{\sigma(1)1}a_{\sigma(2)2}\cdots a_{\sigma(n)n}$．
        \item 次の二条件を満たす．
        \begin{enumerate}[(1)]
            \item (多重線型性)  $A$の第$j$列$a_j$を，$b\in K^n$で置き換えたものを$B$，$a_j+b$で置き換えたものを$C$，$ca_j$で置き換えたものを$D$とすると，次が成り立つ：
            \begin{align*}
                d(C)&=d(A)+d(B),&d(D)&=c\cdot d(A).
            \end{align*}
            \item (交代性)  $A$のある２列が等しいならば$d(A)=0$．
        \end{enumerate}
        \item 次も含めて三条件を満たす．
        \begin{enumerate}[(1)]\setcounter{enumii}{2}
            \item (歪対称性)  $B$を$A$のある二列$a_j,a_{j'}$を入れ替えて得られる行列とすると，$d(A)+d(B)=0$．
        \end{enumerate}
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[(3)$\Rightarrow$(4)] 
        $A$に対して，$E$を第$i,j'$列をいずれも$a_j+a_{j'}$としたものとすると，$d(A)+d(B)=d(E)=0$．
        \item[(1)$\Rightarrow$(3)]
        $d=\det$として示す．$n=\dim A$についての帰納法で示す．
        \item[(4)$\Rightarrow$(2)]
        $\mathfrak{P}_n:=\Map([n],[n])$をモノイドとし，
        \[\xymatrix@R-2pc{
            P:\mathfrak{P}_n\ar[r]&M_n(K)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            f\ar@{|->}[r]&P(f)=(e_{f(1)}\;\cdots\;e_{f(n)})
        }\]
        とする．(1)の多重線形性より，
        \[d(A)=\sum_{f\in\mathfrak{P}_n}d(P(f))a_{f(1)1}\cdots a_{f(n)n}\]
        が従う．(2)の交代性より，$f\in\mathfrak{P}_n\setminus\mathfrak{S}_n$の時は$d(P(f))=0$が従う．
        あとは，(3)の歪対称性から，$\sigma\in\mathfrak{S}_n$に対し，$d(P(\sigma))=\sgn(\sigma)d(1)$を導けば良い．
        $\{i\in[n]\mid \sigma(i)\ne i\}\cup\{n\}$の最小値$m=m(\sigma)$に関する上からの帰納法で示す．
        $m=n$の時は$\sigma=1$だから明らか．いま，$1\le i<j\le n$に対して(3)から$d(P(\sigma\circ(i\;j)))=-d(P\sigma)$であるが，(1)$\Rightarrow$(4)より特に$d=\det$の時を考えて
        $\sgn(\sigma\circ(i\;j))=-\sgn(\sigma)$である．これを使うと，$m<n$の時，$\sigma'=\sigma\circ(m\;\sigma^{-1}(m))$とおけば，$m(\sigma')>m$と退避される．よって帰納法の家庭より，
        \[d(P(\sigma))=-d(P(\sigma'))=-\sgn(\sigma')=-\sgn(\sigma')d(1)=\sgn(\sigma)d(1)\]を得る．
        \item[(2)$\Rightarrow$(1)]
        (1)$\Rightarrow$(2)より，
        \[\det A=\sum_{\sigma\in\mathfrak{S}_n}\sgn(\sigma)\cdot a_{\sigma(1)1}a_{\sigma(2)2}\cdots a_{\sigma(n)n}.\]
    \end{description}
\end{proof}

\begin{corollary}\mbox{}\label{cor-signature-expression-of-determinant}
    \begin{enumerate}
        \item $\det A=\sum_{\sigma\in\mathfrak{S}_n}\sgn(\sigma)\cdot a_{\sigma(1)1}a_{\sigma(2)2}\cdots a_{\sigma(n)n}$．
        \item $\sigma\in\mathfrak{S}_n$ならば$\sgn(\sigma)=\pm 1$である．また$\sgn(\sigma\circ(i\;j))=-\sgn(\sigma)\;(1\le i<j\le n)$．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 命題の(1)$\Rightarrow$(2)またはその逆が含意している．
        \item $\sgn(\sigma\circ(i\;j))=-\sgn(\sigma)\;(1\le i<j\le n)$は(1)$\Rightarrow$(4)が含意している．$\sgn(\sigma)=\pm 1$も$m=m(\sigma)$に関する上からの帰納法で示せる．
    \end{enumerate}
\end{proof}

\begin{corollary}[行列式の性質]\mbox{}\label{cor-determinant-of-product-and-transposition}
    \begin{enumerate}
        \item $\det BA=\det B\cdot\det A$．
        \item $\sgn(\sigma\circ\tau)=\sgn(\sigma)\sgn(\tau)\;(\sigma,\tau\in\mathfrak{S}_n)$．
        \item $\det{}^t\!A=\det A$．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item \[\xymatrix@R-2pc{
            d_B:M_n(K)\ar[r]&K\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            A\ar@{|->}[r]&\det BA=det(Ba_1\;\cdots\;Ba_n)
        }\]
        は交代重線型形式である．よって，命題\ref{prop-characterization-of-determinant}(3)$\Rightarrow$(1)より，
        \[\det BA=\det d(A)=d(1)\det A=\det B\det A.\]
        \item 定義\ref{def-permutation-and-signature}の写像$P:\Map([n],[n])\to M_n(K)$について，$P(\sigma\circ\tau)=P(\sigma)P(\tau)$であることと，1から従う．
        \item 命題\ref{prop-characterization-of-determinant}.2を主に使って，データ構造から計算すると従う．
    \end{enumerate}
\end{proof}

\begin{example}[上三角行列の行列式]\label{example-determinant-of-triangular-matrices}
    $A=\begin{pmatrix}A_{11}&A_{12}\\0&A_{22}\end{pmatrix}$ならば，$\det=\det A_{11}\det A_{22}$である．
    これはきっとデータ構造自体に内在する機構なのだろう．一つのデータ単位を，一文字$a_{11}$で表すか，ブロック$A_{11}$で表すかの違いで，全く同じ代数的取り扱いが出来るはず．
\end{example}

\subsection{Cramerの公式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    置換の符号も行列式で表せるのであったから，置換の符号も加味した小行列の行列式を余因子という．
    これによって$\det A$が表せることが，多重線形性から示せる．
    $A$が可逆な時は，その逆行列を$\det A$と$\Delta(A)$とで表す公式として使用できる．

    行列のデータ構造は不思議なものである．内積が自然とするなら，
    この双対性を横と縦の対として表現するのである．
\end{tcolorbox}

\begin{definition}[minor, first minor, cofactor matrix]\mbox{}
    \begin{enumerate}
        \item 行列から１つ以上の行や列を取り除いて得られる行列を小行列という．その行列式を小行列式という．小行列式は余因子と符号分だけ違う．
        \item 行列$A$の第$ij$成分を$1$，第$i$行と第$j$列のそれ以外の要素を$0$とした行列の行列式$\Delta_{ij}\in K$を\textbf{余因子}と言う．
        \item 余因子を転置させて並べた行列$\Delta(A):=(\Delta_{ji})\in M_n(K)$を$A$の\textbf{余因子行列}という．
    \end{enumerate}
\end{definition}

\begin{proposition}[Cramer]\label{prop-Cramer}
    \[\Delta(A)A=\det A.\]
\end{proposition}
\begin{proof}
    まず，任意の$j\in[n]$について，$\Delta(A)A$の$jj$成分が$\det A$であることを示す．
    $i\in[n]$について，行列$A$に対して第$j$列を$e_i$で置き換えた行列を$A_{ij}$とすると，多重線形性より
    \[\det A=\sum^n_{i=1}a_{ij}\det A_{ij}\]
    である．実は$\det A_{ij}=\Delta_{ij}$である．多重線形性に含意されているし，また系\ref{cor-signature-expression-of-determinant}.1からもわかる．
    従って，積$\Delta(A)A$の$jj$成分は$\sum^n_{i=1}a_{ij}\Delta{ij}=\det A$．

    次に，$j\ne j'\in[n]$について，$\Delta(A)A$の$jj'$成分が$0$であることを示す．
    第$jj'$成分は，$\Delta(A)$の第$j$行と$A$の第$j'$列の積から来ている．
    従って，$A$の第$j$列を第$j'$列で置き換えて得られる行列を$A'$とすると，行列式の交代性より，
    \[\sum^n_{i=1}\Delta_{ij}a_{ji'}=\sum^n_{i=1}\det A_{ij}a_{ij'}=\det A'=0.\]
\end{proof}

\begin{example}
    自明な例として，二次行列$A=\begin{pmatrix}a&b\\c&d\end{pmatrix}$の逆行列が$A^{-1}=\frac{1}{ad-bc}\begin{pmatrix}d&-b\\-c&a\end{pmatrix}$とわかる．
\end{example}

\begin{corollary}\label{cor-characterization-of-invertibility}
    次の２条件は同値である．
    \begin{enumerate}
        \item $A$は可逆である．
        \item $\det A\ne 0$．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] 系\ref{cor-determinant-of-product-and-transposition}より，$\det AA^{-1}=\det A\det A^{-1}=\det 1=1$．よって，$\det A\ne 0,\det A^{-1}\ne 0$．
        \item[(2)$\Rightarrow$(1)] Cramerの命題\ref{prop-Cramer}より，$A\cdot\frac{1}{\det A}\Delta(A)=\frac{1}{\det A}\Delta(A)\cdot A=1$．スカラーと行列の積は可換であることがうまく使われている．
    \end{description}
\end{proof}

\subsection{特殊な行列式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    そもそも行列式の研究は行列の研究とは全く独立に行われていた．
    Vandermonde行列式は，判別式(discriminant)（よく$\Delta$で表される）やWronskianやLagrange補間多項式などで現れる．
    特に，異なる点$x_1,\cdots,x_n$での値が指定された時，これらを通る$n-1$次以下の多項式が一意に定まる所以は，Vandermonde行列式が差積で表せ，したがって零でないことによる．
    
    列ベクトルの成分を巡回させて得られる行列は$c$に依ってはで，そのような行列全体は可換な代数をなす（実はconvolution operatorなる作用素の核であり，$C^*$-代数である）．
\end{tcolorbox}

\begin{definition}[Vandermonde determinant]\mbox{}
    \begin{enumerate}
        \item 各行が公比$x_i$の等比数列となる行列$V(x_1,\cdots,x_n):=\begin{pmatrix}1&x_1&x_1^2&\cdots&x_1^{n-1}\\1&x_2&x_2^2&\cdots&x_2^{n-1}\\\vdots&\vdots&\vdots&\ddots&\vdots\\1&x_n&x_n^2&\cdots&x_n^{n-1}\end{pmatrix}$をVandermonde行列という．
        \item この行列式$\Delta(x_1,\cdots,X_n)$を\textbf{Vandermonde行列式}という．
    \end{enumerate}
\end{definition}

\begin{lemma}[difference product and Vandermonde determinant]
    Vandermonde行列式は，各行の公比の差積に等しい．
    $\Delta(x_1,\cdots,x_n)=\prod_{1\le i<j\le n}(x_i-x_j)$．
\end{lemma}
\begin{remark}[差積について]
    任意の交代多項式は，対称多項式と差積の積として書け，これが交代多項式の特徴付けとなる．
\end{remark}

\begin{definition}[circulant matrix, associated polynomial]\mbox{}
    \begin{enumerate}
        \item 対角一定行列(diagonal-constant)のことを，ドイツの函数解析学者の名前をとってToeplitz行列ともいう．
        \item 各列ベクトルが，一つ前の列ベクトルを巡回置換したものとして得るToeplitz行列を，\textbf{巡回行列}という．ベクトル$c:=(c_0,\cdots,c_{n-1})^T$を用いて，
        \[C=\begin{bmatrix}c_{0}&c_{n-1}&\dots &c_{2}&c_{1}\\c_{1}&c_{0}&c_{n-1}&&c_{2}\\\vdots &c_{1}&c_{0}&\ddots &\vdots \\c_{n-2}&&\ddots &\ddots &c_{n-1}\\c_{n-1}&c_{n-2}&\dots &c_{1}&c_{0}\\\end{bmatrix}\]
        と表せる．
        \item $f(x):=c_0+c_1x+\cdots+c_{n-1}x^{n-1}$を付随行列という．
    \end{enumerate}
\end{definition}

\begin{lemma}
    １の$n$乗根を$\zeta_j:=e^{2\pi ij/n}\;(j=0,\cdots,n-1)$とする．
    \begin{enumerate}
        \item $\det C=\prod_{j=0,\cdots,n-1}(x_1+\zeta_jx_2+\cdots+\zeta_j^{n-1}x_n)$．
        \item 固有ベクトルは$v_j=\frac{1}{\sqrt{n}}(1,\zeta_j,\zeta_j^2,\cdots,\zeta_j^{n-1})^T$で与えられ，正規直交系をなす．
        \item 巡回行列は可換な代数をなす．
        \item $\rank C=n-d\;(d=\deg\gcd(f(x),x^n-1))$．
    \end{enumerate}
\end{lemma}
\begin{remark}
    実は固有ベクトルは離散フーリエ変換行列によって対角化されるため，高速フーリエ変換によって簡単に計算できるという意味でも大事な対称である．
\end{remark}

\section{固有多項式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    固有多項式とは$\Phi_A:=\det(X-A)\in K[X]$に過ぎない，人工物である．
    まずこれが行列表示に依らない，線型写像の特徴量であることを見る．
\end{tcolorbox}

\subsection{線型写像の固有多項式}

\begin{definition}[characteristic polynomial, trace]
    $A\in M_n(K)$．
    \begin{enumerate}
        \item monicな多項式$\Phi_A:=\det(X-A)\in K[X]$を$A$の\textbf{固有多項式}という．
        \item $\Tr(A):=\sum^n_{i=1}a_{ii}$を\textbf{跡}という．
    \end{enumerate}
\end{definition}

\begin{remark}
    \[ \Phi_A=\det\begin{pmatrix}X-a_{11}&-a_{12}&\cdots&-a_{1n}\\-a_{21}&X-a_{22}&\ddots&\vdots\\\vdots&\ddots&\ddots&-a_{(n-1)n}\\-a_{n1}&\cdots&-a_{n(n-1)}&X-a_{nn}\end{pmatrix} \]
    より，$X^{n-1}$の係数は$-\Tr A$であり，定数項は$(-1)^n\det A$である．
\end{remark}

\begin{example}\mbox{}\label{example-eigenpolynomial}
    \begin{enumerate}
        \item $A=\begin{pmatrix}a&b\\c&d\end{pmatrix}$とすると，注より，$\Phi_A=X^2-(a+d)X+ad-bc$．
        \item $A$が上三角行列ならば，固有多項式は対角成分に関する積$\Phi_A=(X-a_{11})\cdots(X-a_{nn})$．$a_{11},\cdots,a_{nn}$が全て相異なる時，これは最小多項式に一致する．
        \item $A$がJordan行列$J(a,n)$ならば，$\Phi_A=(X-a)^n$である．これも最小多項式でもある．
        \item $A$を$F\in K[X]$の同伴行列とすると，固有多項式は$\Phi_A=F$．これは最小多項式でもある．
    \end{enumerate}
\end{example}

\begin{proposition}[線型写像の特徴量としてのwell-definedness]\label{prop-行列の特徴量は線型写像について定まっている}
    $A,B\in M_n(K)$が共役ならば，$A$と$B$の
    \begin{enumerate}
        \item 行列式
        \item トレース
        \item 固有多項式
    \end{enumerate}
    は等しい．
\end{proposition}
\begin{proof}
    共役の定義\ref{def-conjugate}より，任意の$P\in\GL_n(K)$を取って考えると良い．
    $X$はスカラー行列より，系\ref{cor-determinant-of-product-and-transposition}から，
    \begin{align*}
        \Phi_{P^{-1}AP}&=\det(X-P^{-1}AP)=\det(P^{-1}(X-A)P)=\det(X-A)=\Phi_A
    \end{align*}
    である．
\end{proof}

\begin{definition}[線型写像の固有多項式]\label{def-eigenpolynomial-of-linear-mapping}
    $f\in\End(V)$の行列式，トレース，固有多項式を，$f$の行列表示$A$を任意にとってそこから定める．
    ただし$V\in\FinVect_K$の場合に限る．
\end{definition}

\subsection{固有値の研究}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    最小多項式よりも強い条件を満たすクラスが固有多項式であるはずである．
    その様子を調べる．
\end{tcolorbox}

\begin{proposition}[固有値であることの特徴付け]
    $V\in\FinVect_K,f\in\End(V)$とする．次の２条件は同値である．
    \begin{enumerate}
        \item $a$は$f$の固有値である．
        \item $\Phi_f(a)=0$．
    \end{enumerate}
\end{proposition}
\begin{proof}
    定義\ref{def-eigenpolynomial-of-linear-mapping}より，
    2は$\det(f-a)=0$と同値．系\ref{cor-characterization-of-invertibility}より，これは$f-a$が可逆でないことと同値．
    $V$が有限次元であることより，次元定理\ref{cor-thm-of-dimention}から特に$f-a$が単射でないことと同値．
    よって，$V_a=\Ker(f-a)\ne 0$より，$a$は$f$の固有値である．
\end{proof}

\begin{proposition}[最小公倍式としての固有多項式]\label{prop-eigenpolynomial-as-patching}
    $V\in\FinVect_K,f\in\End(V)$とする．
    \begin{enumerate}
        \item $W$を$f(W)\subset W$を満たす$V$の$f$-安定部分空間とする．$f|_W$の固有多項式は$f$の固有多項式を割り切る．
        \item $g\in\End(W)$とする．全射$p:V\to W$が存在して次が可換になるならば，$g$の固有多項式は$f$の固有多項式を割り切る．
        \[\xymatrix{
            V\ar[r]^-p\ar[d]_-f&W\ar[d]^-g\\
            V\ar[r]^-p&W
        }\]
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $B'=(x_1,\cdots,x_m)$を$W$の基底とし，$B=(x_1,\cdots,x_n)$をその$V$の基底への延長とする．この時，$f$の$B$に関する行列表示は\[A=\begin{pmatrix}A_{11}&A_{12}\\0&A_{22}\end{pmatrix}\]と置ける．いま，$f|_W:W\to W$の行列表示が$A_{11}$である．
        これについて，例\ref{example-determinant-of-triangular-matrices}より，
        \[\det(X-f)=\det(X-A)=\det(X-A_{11})\det(X-A_{22})\]
        であるから，$f|_W$の固有多項式$\det(X-A_{11})$はこれを割り切る．
        \item $x_1,\cdots,x_m$を$\Ker p$の基底とし，$B=(x_1,\cdots,x_n)$をその$V$の基底への延長とすると，$B'=(p(x_{m+1}),\cdots,p(x_n))$が$W$の基底になる．
        いま，図式が可換であることより，$p(f(x_i))=g(p(x_i))=g(0)=0\;(1\le i\le m)$であるから，$f(x_i)\;(1\le i\le n)$の基底$x_{m+1},\cdots,x_n$に関する係数は$0$であるから，$f$の基底$B$に関する行列表示は，
        \[A=\begin{pmatrix}A_{11}&A_{12}\\0&A_{22}\end{pmatrix}\]と置ける．
        この時，$g$の$B'$に関する行列表示が$A_{22}$である．なぜならば，$A=(a_{ij})_{1\le i,j\le n}$と置くと，図式が可換であることより，
        \[p(\sum^n_{i=1}a_{ij}x_i)=p(f(x_j))=g(p(x_j))\;\;(m+1\le j\le n)\]
        だから，$f(x_j)$の$B$に関する行列表示の部分行列と，$g(x_j)$の$B'$に関する行列表示が一致する．
        よって，$\det(X-g)=\det(X-A_{22})$は$\det(X-f)=\det(X-A)$を割り切る．
    \end{enumerate}
\end{proof}
\begin{remark}
    2つの証明は完全にパラレルである．
    貼り合わせとしての線型写像に対して，的確に基底を取ると，固有多項式が計算しやすい形で得られる．
    それを利用した証明である．
    1は$f$-安定部分空間を，2は全射を用いた分解$V=\Ker p+p^{-1}(\Im p)=\Ker p\oplus p^{-1}(\Im p)$を用いている．
\end{remark}

\subsection{最小多項式と固有多項式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    安定部分空間とは，$f$による$x\in V$の軌道である．
    この概念によって，線型空間の内部構造をその射によって
    捉えるスキームが完成し，その花がCayley-Hamiltonの定理である．
\end{tcolorbox}

\begin{theorem}[Cayley-Hamilton]\label{thm-Cayley-Hamilton}
    $V\in\FinVect_K,f\in\End(V)$とする．$\Phi\in K[X]$を$f$の固有多項式とし，$\dim V=n$とする．
    \begin{enumerate}
        \item (Cayley-Hamilton) $f$の最小多項式$\varphi$は，固有多項式$\Phi$を割り切る．即ち，$\Phi(f)=0$．
        \item $f$の固有多項式$\Phi$は，$\varphi^n$なら割り切る．
    \end{enumerate}
\end{theorem}
\begin{proof}
    $x\in V$に対し，$x$が生成する$f$-安定部分空間を$W_x$とする．
        $V$が有限次元より，制限$f|_{W_x}:W_x\to W_x$には最小多項式が存在し，これを$\varphi_x$とする．
        命題\ref{prop-stable-subspace}より，$W_x$の基底であって，それに関する$f|_{W_x}$の行列表示$A$が$\varphi_x$の同伴行列となるもの，$x,f(x),\cdots,f^{m-1}(x)\in W_x$がある．
        例\ref{example-eigenpolynomial}.4より，$A$の固有方程式も$\varphi_x$である．

        $x_1,\cdots,x_n$を$V$の基底とする．
    \begin{enumerate}
        \item $V=W_{x_1}+\cdots+W_{x_n}$だから，命題\ref{prop-algorithm-for-minimal-polynomials-in-the-terms-of-ideal}より，$f$の最小多項式$\varphi$は$\varphi=\lcm\{\varphi_{x_1},\cdots,\varphi_{x_n}\}$．
        命題\ref{prop-eigenpolynomial-as-patching}.1より，最小公倍式は$\Phi$を割り切る．
        \item $\varphi_{x_1}\cdots\varphi_{x_n}$は$\varphi$を割り切るから，$\Phi$が$\varphi_{x_1}\cdots\varphi_{x_n}$を割り切ることを示す．
        直和$W_{x_1}\oplus\cdots\oplus W_{x_n}$の自己準同型$f|_{W_{x_1}}\oplus\cdots\oplus f|_{W_{x_n}}$の固有多項式は，
        積$\varphi_{x_1}\cdots\varphi_{x_n}$である．
        ここで，全射$W_{x_1}\oplus\cdots\oplus W_{x_n}\to V=W_{x_1}+\cdots+W_{x_n}$に命題\ref{prop-eigenpolynomial-as-patching}.2を適用すれば，$f$の固有多項式$\Phi$は$\varphi_{x_1}\cdots\varphi_{x_n}$を割り切ることがわかる．
    \end{enumerate}
\end{proof}
\begin{remark}
    ２つは安定部分空間の理論で繋がるのか．その論の進め方は，まるで積位相である．$\U\subset\O\Leftrightarrow\O_\U\subset\O$．
    また，同伴行列も極めて重要な役割を果たしている．
    ここで全てが繋がるのか！確かに定理の風格がある．
    だが，2はもっと細やかな消息を描写したかったのだろう．「固有多項式は，冪が増えるだけで，因数が新たに増えたりしない」というような．
    命題の形にはしなかったが，細やかに言えば$\Phi$は$\varphi_{x_1}\cdots\varphi_{x_n}$を割り切るということである．

    $V=W_1\oplus W_2$ならば，この上の自己準同型の固有多項式は$\Phi=\varphi_1\varphi_2$なのか．
    例\ref{example-eigenpolynomial}や例\ref{example-determinant-of-triangular-matrices}のように，線型写像も直和の概念を中心に作られている．
    逆に言えば，直和でさえあれば，ここの元が$a_{11}$だろうと，ブロック$A_{11}$だろうと理論は同様に成り立つ．Hermite共役も同じ話だろう．
    巨視と微視を好きに行き来できる．
    直和の構造が，$K[X]$の積構造に写されているが，これを定式化する関手はなんだ？
\end{remark}

\begin{corollary}[最小多項式の代用]
    $V\in\FinVect_K,f\in\End(V)$とする．
    \begin{enumerate}
        \item 次の条件は同値である．\begin{enumerate}[(1)]
            \item $f$は三角化可能である．
            \item $f$の固有多項式は一次式の積に分解する．
        \end{enumerate}
        \item $n=\dim V$とする．\begin{enumerate}
            \item $f$は冪零である．
            \item $f$の固有多項式は$X^n$である．
        \end{enumerate}
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item Cayley-Hamiltonの定理\ref{thm-Cayley-Hamilton}より，(2)と最小多項式が一次式の積に分解することは同値である．
        （1より，固有多項式が一次式の積に分解するなら，それを割り切る最小多項式も一次式の積である．2より，最小多項式が一次式の積なら，$\varphi^n$を割り切る固有多項式もそうである）．
        よって，系\ref{cor-triangulability}より従う．
        \item $\exists m\in[n],\;f^m=0$の時，系\ref{cor-Jordan-form-of-nilpotents}より$f$はJordan行列の直和としての行列表示をもち，例\ref{example-eigenpolynomial}のように，
        $\det(f-X)=X^n$である．逆に，$\Phi_f=X^n$である時，Cayley-Hamiltonの定理\ref{thm-Cayley-Hamilton}.1より，$\varphi$はこれを割り切る$X^m\;(m\in[n])$だから，$f$は冪零である．
    \end{enumerate}
\end{proof}

\begin{definition}[multiplicity of an eigenvalue of a linear mapping]
    $V\in\FinVect_K,f\in\End(V)$とする．$\Phi_f$の根$a$の重複度を，固有値$a$の重複度という．
\end{definition}

\begin{proposition}[一般固有空間の次元は，固有値の重複度に等しい]
    $V\in\FinVect_K,f\in\End(V)$とする．$f$の固有値$a\in K$の重複度を$m$とすると，$\dim\widetilde{V}_{a}=m$である．
\end{proposition}
\begin{proof}
    $d$を$f$の最小多項式$\varphi$の根$a$の重複度とすると，$\varphi=(X-a)^dF$と置ける．$W=\Ker F(f)$と定めると，$V=W\oplus\widetilde{V}_a$である．（$V=\Ker\varphi(f)=\Ker(f-a)^dF(f)$かつ$F(a)\ne 0$なので，補題\ref{lemma-for-triangulization}.2と同じ状況である）．
    $f|_W$の固有多項式を$\Psi$とする．$f|_{\widetilde{V}_a}$の固有多項式は$\dim\widetilde{V}_a=:l$を用いて$(X-a)^l$である（命題\ref{prop-algorithm-for-making-triangular-matrices}）．
    $V=\widetilde{V}_a\oplus W$だから，$\Phi=(X-a)^l\Psi$である．補題\ref{lemma-for-triangulization}より，$(f-a)|_W$は同型だから，$\Psi(a)\ne 0$である．よって，$\Psi$の根$a$の重複度$m$は$l=\dim\widetilde{V}_a$とわかる．
\end{proof}

\section{研究}

\subsection{自己準同型の可換性の特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    すでに線型写像の分解の技法を手にしたから，
    補題\ref{lemma-commutative}や注\ref{remark-1}を一般化する形で，
    自己準同型の可換性の特徴付けが得られると思う．
    系\ref{cor-commutative-linear-mappings-triangulization}も不気味である．
    
    まず，一般固有空間分解が，全て固有空間に退化している場合は，各$f|_{V_a}=a$はスカラー倍写像$a$なので，
    全固有空間$V_a$が$g$-安定な場合に可換になり，それに限ることが分かる．

    実はこれが対角化の理論だったのか！
    第\ref{subsec-可換性と対角化}節で，Hermite内積を備えた空間で考察する
    命題\ref{prop-Hermite-diagonalizability}にて，全てが解決する！
\end{tcolorbox}

\begin{proposition}[可換性は共軛類が重なることと同値である]
    $V\in\FinVect_K,f,g\in\End_K(V)$とし，$x_1,\cdots,x_n\in V$を$V$の基底とする．次の２条件は同値である．
    \begin{enumerate}
        \item $f\circ g=g\circ f$．
        \item $f$の$x_1,\cdots,x_n$に関する行列表示と，$f$の$g(x_1),\cdots,g(x_n)$に関する行列表示とは等しい．
    \end{enumerate}
\end{proposition}

次は補題\ref{lemma-commutative}の拡張となっている．
対角化可能な線型写像$f$については，次のような特徴付けが存在する．

\begin{proposition}
    $V\in\FinVect_K,f\in\End_K(V)$とし，$g\in\End_K(V)$に対する次の２条件を考える：
    \begin{enumerate}[(1)]
        \item $f\circ g=g\circ f$．
        \item $f$の一般固有空間は全て$g$-安定である．
    \end{enumerate}
    (2)$\Rightarrow$(1)であり，$f$が対角化可能である時(2)$\Rightarrow$(1)である．
    また，次が成り立つ．
    \begin{enumerate}[(1)]\setcounter{enumi}{2}
        \item $K=\C$とすると，逆命題「(1)と(2)が同値なら$f$は対角化可能である」が成り立つ．
        即ち，任意の$g\in\End_K(V)$について(2)$\Rightarrow$(1)が成り立つならば，$f$は対角化可能である．
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{description}
        \item[(2)$\Rightarrow$(1)] 
        $a\in\C$を$f$の固有値とし，$m$をその重複度とする．$(f-a)^m(g(\widetilde{V}_a))=0$を示せば良い．
        自己準同型の合成は分配則を満たすから，
        \begin{align*}
            (f-a)^m(g(\widetilde{V}_a))&=(f-a)^m\circ g(\widetilde{V}_a)\\
            &=(f^m-af^{m-1}+a^2f^{m-2}-\cdots+(-1)^ma^m)\circ g(\widetilde{V}_a)\\
            &=(f^m\circ g-af^{m-1}\circ g+a^2f^{m-2}\circ g-\cdots+(-1)^ma^mg)(\widetilde{V}_a)\\
            &=(g\circ f^m-ag\circ f^{m-1}+a^2 g\circ f^{m-2}-\cdots+(-1)^ma^mg)(\widetilde{V}_a)&(\because\;\mathrm{(a)})\\
            &=g\circ(f^m-af^{m-1}+a^2f^{m-2}-\cdots+(-1)^ma^m)(\widetilde{V}_a)\\
            &=g\circ(f-a)^m(\widetilde{V}_a)\\
            &=g((f-a)^m(\widetilde{V}_a))=g(0)=0.
        \end{align*}
        よって，$g(\widetilde{V}_a)\subset\widetilde{V}_a$．
        \item[(1)$\Rightarrow$(2)]
        $f$が対角化可能である時，$V$の固有ベクトルのみからなる基底が存在するから，
        任意の固有値$a\in\C$と対応する固有ベクトル$v\in\Ker(f-a)$について，$f\circ g(v)=g\circ f(v)$を示せば良い．
    
        $\Ker(f-a)$は$g$-安定部分空間だから，$g(\Ker(f-a))\subset\Ker(f-a)$より，$g(v)\in\Ker(f-a)$だから，
        $f(g(v))=a\cdot g(v)$．また，$g(f(v))=g(a\cdot v)=a\cdot g(v)$．
    
        \item[(3)]
        正しいことを証明する．
        $\C$-線型写像$f$は三角化可能であり，$f$の固有値$a_1,\cdots,a_n$について，$V=\widetilde{V}_{a_1}\oplus\cdots\oplus\widetilde{V}_{a_n}$
        と一般固有空間分解できる．
        いま，任意の$g\in\End_\C(V)$に対して$g(\widetilde{V}_{a_i})\subset\widetilde{V}_{a_i}\;(i=1,\cdots,n)$ならば，$f\circ g=g\circ f$が成り立つと仮定する．
        この時，任意の一般固有空間$\widetilde{V}_{a_i}$について，制限写像$f|_{\widetilde{V}_{a_i}}=:f_i,g|_{\widetilde{V}_{a_i}}=:g_i$は
        それぞれ$\widetilde{V}_{a_i}$の自己準同型$f_i:\widetilde{V}_{a_i}\to\widetilde{V}_{a_i},g_i:\widetilde{V}_{a_i}\to\widetilde{V}_{a_i}$を定める．
        $f\circ g=g\circ f$の時，$f_i\circ g_i=g_i\circ f_i$であるが，$g$が（従って$g_i$が）任意だったから，後述の補題より$f$はスカラー写像である：$\exists a\in\C,\;f=a$．
        この時，$a=a_i$となる．よって，$\widetilde{V}_{a_i}=V_{a_i}$である．これが任意の$1\le i\le n$について成り立つのであったから，$f$は対角化可能である．
    \end{description}
\end{proof}

\begin{lemma}[スカラー倍写像の特徴付け]
    $V\in\FinVect_K(V)$とし，$\forall g\in\End_K(V),\;f\circ g=g\circ f$とする．この時，$f$はスカラー倍写像である：$\exists a\in K,\; f=a$．
\end{lemma}
\begin{proof}
    $V$の基底$x_1,\cdots,x_n$に関する$f$の行列表示を$A=(a_{ij})$とする．
    $f$がスカラー倍写像ではないと仮定して，矛盾を導く．即ち，ある$i\ne j$が存在して，$a_{ij}\ne 0$と仮定する．
    すると，行列$B=(b_{ij})$を，$i\ne j$の時$b_{ij}=0\in K$とし，$b_{ii}\ne b_{jj}\in K$とすれば，他の$b_{kk}\;(k\ne i,j)$の値に依らず，
    $BA$の$ij$成分は$\sum^n_{k=1}a_{kj}b_{ik}=a_{ij}b_{ii}$，$AB$の$ij$成分は$\sum^n_{k=1}a_{ik}b_{kj}=a_{ij}b_{jj}$より，$a_{ij}b_{ii}\ne a_{ij}b_{jj}$となるから，$AB\ne BA$である．
    従って，$V$の基底$x_1,\cdots,x_n$が定める同型を$\varphi_x:K^n\to V$とすれば，
    $g$をこの行列$B$が表現する線型写像$g=\varphi_x^{-1}\circ B\times\circ\varphi_x\in\End_K{V}$とすれば，$f\circ g\ne g\circ f$より，矛盾．
    よって，$f$はスカラー写像である．
\end{proof}

\section{漸化式を満たす数列と定数係数線型常微分方程式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    漸化式を満たす数列と定数係数線型常微分方程式は線型代数的には全く同じ構造を持つ．
\end{tcolorbox}

\begin{notation}[多項式環へと情報を移す]\mbox{}
    \begin{enumerate}
        \item 例\ref{example-space-of-sequences}の数列の空間$\Hom_\R(\N,\R)$と，例\ref{example-difference-operator}の
        その上の自己準同型
        \[\xymatrix@R-2pc{
            D:\Hom_\R(\N,\R)\ar[r]&\Hom_\R(\N,\R)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            a\ar@{|->}[r]&b(n):=a(n+1)
        }\]を考える．
        \item $m+1\ge 1$項間漸化式$a_{n+m}=p_1a_{n+m-1}+\cdots+p_{m-1}a_{n+1}+p_ma_n$
        を満たす数列全体からなる部分空間を$W$と置く：
        \[ W=\{a\in\R^\N\mid\forall n\ge 0,\; a(n+m)=p_1a(n+m-1)+\cdots+p_{m-1}a(n+1)+p_ma(n)\}. \]
        \item 実係数多項式を$P=X^m-(p_1X^{m-1}+\cdots+p_{m-1}X+p_m)\in\R[X]$と置くと，$W=\Ker(P(D))$と表せる．
        \item 例\ref{example-difference-operator}で見た通り，$W$は初期条件を与えることで数列が決まる．つまり，次の同型がある：\[\xymatrix@R-2pc{
            G:W\ar[r]&\R^m\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            a=(a_n)\ar@{|->}[r]&{\begin{pmatrix}a_0\\\vdots\\a_{m-1}\end{pmatrix}}
        }\]
    \end{enumerate}
\end{notation}

\begin{theorem}[定数係数線型常微分方程式の解の存在と一意性]
    $m\in\N,p_1,\cdots,p_m,a_0,\cdots,a_{m-1}\in\R$とする．
    $C^\infty$級関数$f:\R\to\R$であって，微分方程式$f^{(m)}=p_1f^{(m-1)}+\cdots+p_{m-1}f'+p_mf$の解であり，初期条件$f(0)=a_0,f'(0)=a_1,\cdots,f^{(m-1)}(0)=a_{m-1}$を満たすものが，ただ一つ存在する．
\end{theorem}

\chapter{単因子とJordan標準形}

\begin{quotation}
    斎藤線形代数の視点から自己準同型の章をまとめ直す．
\end{quotation}

\chapter{双対空間}

\begin{quotation}
    空間$\End_{\Vect_K}(V)$の研究は終わりとし，圏$\Vect_K$での種々の圏論的構成法を考える．
    はっきり言って仕舞えば，以降の章は全て圏論である．
    \begin{enumerate}
        \item 線型空間$V$は双対空間$V^*$を持つ．$V$の基底$\varphi_x:K^n\to V$を定めるごとに，その双対基底$f_1,\cdots,f_n$が定まり，その積写像$(f_1,\cdots,f_n):V\to K^n$として基底の定める同型の逆写像$\varphi_x^{-1}$が構成できる．
        \item 再双対の空間には自然な単射$e_V:V\to V^{**}$が存在する．線型空間$V$の部分空間全体の集合を$\mathcal{S}V$と表すと，この間の逆関手$\bot:\mathcal{S}V\to\mathcal{S}V^*,\top:\mathcal{S}V^*\to\mathcal{S}V$が定まる．これが互いに逆関手であることの証明に，標準的な単射$e_V$が活躍する．
        \item 双対写像$f^*:W^*\to V^*$を定義すると，射影$p:V\to W$の双対写像$p^*:W^*\to V^*$として双対空間の射影子が得られる．これが定める直和分解が$V^*=W^\bot\oplus W'^\bot$だったのである．
        \item Hom集合$\Hom_{\Vect_K}(V,W)$を調べる．
    \end{enumerate}
    結局，圏Vectにおいて，Hom集合$\Hom_{\Vect_K}(V,K)$から初めて，一般のHom集合が線型空間であるところまで議論する．
    双対空間についてのこの章で証明が長くなるとしたら全て普遍構成についてである．構成の前に補空間を準備したりその間に定まる射を記述したりするために行数を食う．
    だが普遍構成はあまりにも強力で，これが示す主張は大体直観的には非自明だ．
\end{quotation}

\section{双対空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    双対空間とその次元を，定理\ref{thm-categorical-basis}の「$V$の基底の行き先を定めるごとに，一意的に線型写像が定まる」というトリックを用いて調べた．
\end{tcolorbox}

\subsection{線型形式の空間}

\begin{definition}[linear form]
    $V$を$K$-線型空間とする．係数体$K$への線型写像$f:V\to K$を，$V$の\textbf{線型形式}という．
    $V^*:=\{f:V\to K\mid fはVの線型形式\}$と表す．
\end{definition}

\begin{example}
    基本的に値写像っぽくなる．とにかく内積のような（自然な同型が取れるという意味でも，双対が組にまとまって座りが良いという意味でも）安定した概念が待ち望まれている．
    \begin{enumerate}
        \item 行ベクトル$a\in M_{1n}(K)$について，$a$倍写像$a\cdot:K^n\to K$は$K^n$の線型形式である．
        \item 関数$f\in C^\infty(\R)$に対し$f(a)\in\R$を対応させる値写像$\ev_a:C^\infty(\R)\to\R$は$C^\infty(\R)$の線型形式である．
        \item 同様に，数列$a\in\R^\N$に対し$\ev_n:\R^\N\to\R$が，多項式$f\in K[X]$に対し，$\ev_a:K[X]\to K$が定まる．
    \end{enumerate}
\end{example}

\begin{definition}[dual space]
    $V^*$は$K$-線型空間になる．これを\textbf{双対空間}と呼ぶ．
\end{definition}

\begin{example}\label{eg-induced-morphism}
    $K^n=M_{n1}(K)$の双対空間$(K^n)^*$は横ベクトルの空間である．$a\in K^n$に対して，${}^t\!a$倍写像を$f_a\in (K^n)^*$とすると，次の同型が取れる：
    \[\xymatrix@R-2pc{
        F:K^n\ar[r]&(K^n)^*\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        a\ar@{|->}[r]&f_a
    }\]
    第$i$射影を$\pr_i=:f_i$と置くと$f_i\in(K^n)^*$で，任意の$a={}^t\!(a_1,\cdots,a_n)\in K^n$について$f_a=a_1f_1+\cdots+a_nf_n$となる．
    従って，$F$は特に，双対空間$(K^n)^*$の基底$f_1,\cdots,f_n$が定める同型となっている．
\end{example}

\subsection{双対基底}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    同型$V\to V^*$は$V$の基底を１組定める毎に定まるもので，自然には存在しない．
    この時の同型とは，双対基底が定める同型である．
    双対基底とは，$V$の基底に対して，「\textbf{基底特性関数}」と呼ぶべき構成$f_i(x_j)=\delta_{ij}$をしたものである．
    $0$とは零元，$1$とは単位元であるが，真理値のような使い方をするのである．
    結局は部分集合とその特性関数のような双対に回収される．集合と圏論の双対というか．

    これを１つ与えることは，非退化双線型形式を１つ定まることに相当する．
\end{tcolorbox}

\begin{proposition}[双対空間の次元]\label{prop-dimention-of-dual-space}
    $V\in\FinVect_K$とする．
    \begin{enumerate}
        \item $x_1,\cdots,x_n$を$V$の基底とする．$i=1,\cdots,n$に対して$f_i(x_j)=\delta_{ij}$
        を満たす線型形式$f_i:V\to K\in V^*$がただ一つ存在する．そして$(f_i)_{i\in[n]}$を集めれば$V^*$の基底になる．
        \item $\dim V=n$ならば$\dim V^*=n$である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] 
        定理\ref{thm-categorical-basis}より，基底の行き先を定めるとそれを満たす線型写像$f_i$は一意に存在する．同様にして，$x_1,\cdots,x_n\in V$を$a_1,\cdots,a_n\in K$に写す線型形式$f:V\to K$もただ一つ存在する．$f=a_1f_1+\cdots+a_nf_n$がそれである．よって，$f_1,\cdots,f_n\in V^*$は基底である．
        \item[2.] 1.より従う．
    \end{description}
\end{proof}

\begin{definition}[dual basis]
    $V$の基底$x_1,\cdots,x_n\in V$に対して，命題の通りに定まる線型形式$f_1,\cdots,f_n\in V^*$を\textbf{双対基底}という．
\end{definition}



\begin{proposition}[双対基底の特徴付け]
    $V\in\FinVect_K$とする．線型形式$f_1,\cdots,f_n:V\to K$について，次の３条件は同値である．
    \begin{enumerate}
        \item $f_1,\cdots,f_n$は$V^*$の基底である．
        \item $F:V\to K^n$を$F(x)={}^t\!(f_1(x),\cdots,f_n(x))$で定めると，これは可逆である．
        \item $x_1,\cdots,x_n$を$V$の基底とすると，行列$A=(f_i(x_j))\in M_n(K)$は可逆である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[(2)$\Rightarrow$(1)] $F$の逆写像を$F^{-1}$とする．$e_i\in K^n\;(i=1,\cdots,n)$を標準基底として，$x_i:=F^{-1}(e_i)$と置くと，まず$x_1,\cdots,x_n$は$V$の基底であり，次にこれは$F(x_i)=e_i$即ち$f_j(e_i)=\delta_{ij}$を満たすものであるから，$f_1,\cdots,f_n$は$x_1,\cdots,x_n$の双対基底である．
        \item[(2)$\Leftrightarrow$(3)] $A$は$F:V\to K^n$の，$x_1,\cdots,x_n$に関する表現行列であるから，２つが同型になるための条件は同値である．
        \item[(1)$\Rightarrow$(3)] $V$の基底$x_1,\cdots,x_n$の双対基底を$g_1,\cdots,g_n$として，これを足掛かりに考える．$g_1,\cdots,g_n$から$f_1,\cdots,f_n$への底の変換行列を$P=(p_{ij})\in\GL_n(K)$とすると，\[f_i=p_{1i}g_1+\cdots+p_{ni}g_n\]であるから，$A=(f_i(x_j))=(p_{ji})={}^t\!P$．よって$A$も正則．
    \end{description}
\end{proof}
\begin{remark}[双対基底の直和が，基底が定める同型の逆射である]
    たくさんの数学的現象が起こっているが整理がつかない．少なくとも，命題を作る時の模範になるだろうと思う．

    $F:V\to K^n$は線型形式の積を取った写像$F={}^t!(f_1,\cdots,f_n)$である．すると，$V$の基底$x_1,\cdots,x_n$が定める同型$\varphi_x:K^n\to V$の逆写像となった：$F=\varphi_x^{-1}$．
    下図の$F$と$\times P$が，行列で言えば転置の関係にある理由がわからない．そういうものが「双対空間」なのだろうか．内積か？内積が関係しているのか？
    \[\xymatrix{
        V\ar[r]^-{\psi_x}\ar[d]_-F&V^*\\
        K^n\ar[r]_-{\varphi_f}\ar[ur]_-{\varphi_g}&V^*\ar[u]_-{\times P}
    }\]
    あまり関係がないが，基底$y=(y_1,\cdots,y_n)$についての双対基底$g_1,\cdots,g_n$を取るとは，基底が定める同型$\varphi_y$について，その逆射を積写像として$g={}^t\!(g_1,\cdots,g_n)$と構成しているに等しい：
    \[\xymatrix{
        V\ar[r]^-f&W\ar@/_1pc/[d]_-g\ar@{.>}[r]^-{\psi_y}&W^*\\
        K^n\ar[u]^-{\varphi_x}\ar[r]^-{\times A}&K^m\ar[u]_-{\varphi_y}\ar[ur]_-{\varphi_g}
    }\]
    この時，確かに$A=(g_i(f(x_j)))_{ij}$即ち，列ベクトルが$\begin{pmatrix}g_1(f(x_j))\\\vdots\\g_n(f(x_j))\end{pmatrix}$と表せる．
\end{remark}

\begin{notation}
    完全に自分だけの記法だが，$W$に基底$y=(y_1,\cdots,y_n)$を定める
    ことで引き起こされる同型たちに，それぞれ次のように名前をつけた：
    \[\xymatrix{
        W\ar@{.>}[r]^-{\psi_y}&W^*\\
        K^m\ar[u]^-{\varphi_y}\ar@{.>}[ur]_-{\varphi_g}
    }\]
\end{notation}

\section{零化空間，再双対空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=射に注目して空間の内部構造に言及する手法の一般化]
    線型空間と双対空間の間に部分空間の対応を定める．
    部分空間全体の集合の間の写像$\bot:SV\to SV^*$と$\top:SV^*\to SV$は互いに逆写像になる．
    「射に注目して核と像」という圏論的な議論の進め方をする．

    $V=(x,y)$と表せるなら，$f:V\to K$は$x$の$K$に出す値と$y$の$K$に反映する値との和写像の分解して考えられる．
    その結果，$V=W\oplus W'$の時，$\bot$は関手性のようなものを持つ$(W\oplus W')^\bot=W^\bot\oplus W'^\bot=V^\bot$ならぬ$V^*$．
    
    この捉え方の有効性は\ref{sec-quotient-space-and-duality}節で詳かになる．
\end{tcolorbox}

\subsection{零化空間・被零化空間}

\begin{proposition}[annihilator, annihilated]
    $V$を線型空間，$V^*$をその双対空間とする．
    \begin{enumerate}
        \item $W\subset V$に対して，$W^\bot:=\{f\in V^*\mid f(W)=0\}$は$V^*$の部分空間である．これを\textbf{零化空間}という．
        \item $W\subset V^*$に対して，$W^\top:=\{x\in V\mid f\in W\Rightarrow f(x)=0\}$は$V$の部分空間である．これを\textbf{被零化空間}という．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] 包含写像$i:W\to V$が定める反変Hom関手$i^*:V^*\to W^*$は，$f:V\to K$に対して$f\circ i=f|_W:W\to K$を対応させる制限写像となる．命題\ref{prop-Hom-sets-are-linear-spaces}より，$i^*$は線型写像である．$W^\bot=\Ker i^*$だから，$W^\top$は部分空間である．
        \item[2.] $W^\top=\cap_{f\in W^*}\Ker f$だから，$W^\top$は$V$の部分空間である．部分空間の任意共通部分が部分空間である．
    \end{description}
\end{proof}
\begin{remark}\mbox{}
    \begin{enumerate}
        \item 部分空間の議論の基本は，「射に注目して核と像」である．$f(W)=0$とは，$f|_W=0$と読み替えるのである．
        \item $W^\bot$は一般的な用法らしいが，本当に，どうしてここでもブール代数的な発想が出てくるのであろうか．
        \item $V$の部分空間$W\subset W'$について，$W^\bot\supset W'^\bot$．$V^*$の部分空間$W\subset W'$について$W^\top\supset W'^\top$となる．なんの反変性か？
    \end{enumerate}
\end{remark}

\begin{proposition}
    $V\in\FinVect$とし，$V^*$をその双対空間とする．
    \begin{enumerate}
        \item $x_1,\cdots,x_n$を，部分空間$W\subset V$の基底$x_1,\cdots,x_m$の延長により得る$V$の基底とする．その双対基底を$f_1,\cdots,f_n\in V^*$とすると，延長分の$f_{m+1},\cdots,f_n$がちょうど$W^\bot$の基底である．従って，$\dim W^\bot=\dim V-\dim W$．
        \item $f_1,\cdots,f_n$を，部分空間$W\subset V^*$の基底$f_1,\cdots,f_m$の延長により得る$V^*$の基底とする．$x_1,\cdots,x_n$を$f_1,\cdots,f_n$が定める同型$F:V\to K^n$による標準基底の逆像とすると，$x_{m+1},\cdots,x_n$がちょうど$W^\top$の基底である．従って，$\dim W^\top=\dim V-\dim W$．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] $W=\langle x_1,\cdots,x_m\rangle$の零化空間$W^\bot$の元$f\in W^\bot$とは，$f=a_1x_1+\cdots+a_nf_n$と表示した時に$f(x_i)=a_i=0$が$i=1,\cdots,m$について成り立つような$f$である．これは$W^\bot=\langle f_{m+1},\cdots,f_n\rangle$である．一次独立な生成系だから，$f_{m+1},\cdots,f_n$は基底である．
        \item[2.] $W=\langle f_1,\cdots,f_m\rangle$の時，この非零化空間は$W^\top=\langle x_{m+1},\cdots,x_n\rangle$である．
    \end{description}
\end{proof}

\begin{corollary}\label{cor-biannihilator-in-finite-situation}
    $V\in\FinVect$とし，$V^*$をその双対空間とする．
    \begin{enumerate}
        \item $V$の部分空間$W$について，$W=(W^\bot)^\top$．
        \item $V^*$の部分空間$W$について，$W=(W^\top)^\bot$．
    \end{enumerate}
    部分空間の全体を$SV,SV^*$と表す．するとこの主張は即ち，関手？$\bot:SV\to SV^*$と$\top:SV^*\to SV$は互いに逆写像であることを言っている．
\end{corollary}
\begin{proof}
    1. $W$の零化空間の非零化空間は$W$を含むので，$W\subset(W^\bot)^\top$．しかし，$\dim(W^\bot)^\top=\dim V-(\dim V-\dim W)=\dim W$より，$W=(W^\bot)^\top$．2も同様．
\end{proof}

\begin{proposition}[零化空間は直和分解を保存する]\label{prop-annihilator-space-and-direct-sum}
    $W,W'\subset V\in\Vect$を部分空間とする．
    \begin{enumerate}
        \item $W^\bot\cap W'^\bot=(W+W')^\bot$．
        \item $W^\bot+W'^\bot=(W\cap W')^\bot$．
        \item $V=W\oplus W'$ならば，$V^*=W^\bot\oplus W'^\bot$．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] $W+W'$の元を零化するなら$W,W'$の元もそれぞれ零化するから$W,W'\supset(W+W')^\bot$より，$W\cap W'\supset(W+W')^\bot$．
        逆に，$f\in W^\bot\cap W'^\bot$とすると，これは$W$の元も$W'$の元も零化するから，任意の$x+x'\in W+W'$について，$f(x+x')=f(x)+f(x')=0$．
        \item[2.] $f\in W^\bot,g\in W'^\bot$とすると，任意の$x\in W\cap W'$について和写像はこれを零化する：$(f+g)(x)=f(x)+g(x)=0$．よって$W^\bot+W'^\bot\subset(W\cap W')^\bot$．$f\in(W\cap W')^\bot$とすると，これが$g\in W^\bot,h\in W'^\bot$を用いて$f=g+h$と分解できることを構成すれば良い．
        $W\cap W'$の，$W$上での補空間を$W_1$，$W'$上での補空間を$W_1'$とすれば，$W=(W\cap W')\oplus W_1, W'=(W\cap W')\oplus W'_1$．続いて$W+W'$の$V$に対する補空間を$W''$とすれば，$V=(W\cap W')\oplus W_1\oplus (W_1'\oplus W'')$と表せる．第二射影，第三射影を$p=\pr_2,q=\pr_3$とおけば，
        次のように引き起こされる写像$g=g'\circ q,h=h'\circ p$を取れば良い．それぞれ，$q$により$W$が零化され，他は$f$と同じ写像，$p$により$W'$とおまけに余分な$W''$も零化され他は$f$と同じ写像に$f$が和の形でかけることがわかるだろう．
        \[\xymatrix{
            W_1'\oplus W''\ar[dr]^-{g'}\\
            V\ar[u]^-q\ar[d]_-p\ar[r]^-f&K\\
            W_1\ar[ur]_-{h'}
        }\]
        \item[3.] $V=W\oplus W'$の時，\begin{align*}
            W^\top\cap W'^\top&=(W+W')^\top=V^\top=0,\\
            W^\top+W'^\top&=(W\cap W')^\top=0^\top=V^*
        \end{align*}
        より，$V^*=W^\top+W'^\top=W^\top\oplus W'^\top$．
    \end{description}
\end{proof}
\begin{remarks}[2の構成に仰天]
    2の$\supset$が成り立つという現象が一番不思議であった．$W\cap W'$を零化する線型形式は$W$を零化するものと$W'$を零化するものとの和の形で表せる．この証明が圏論の言葉を使えばここまで一点の曇りもなく$f=g+h$を満たす$g,h$を構成できるとも思っていなかった．
    構成の内容は，$W\cap W'$を潰す写像$f$は，$W$全域を潰すが他は$f$と同じ写像$g$と$W'$全域を潰すが他は$g$と同じ写像$h$とを用意すれば，$f=g+h$と表せる，ということである．

    命題の内容自体は，$V=(x,y)$と表せるなら，$f:V\to K$は$x$の$K$に出す値と$y$の$K$に反映する値との和写像の分解して考えられるというものを極めて一般的に論じたものである．さらに一般化すれば一般の線型写像についても成り立つだろう．
    
    いま気づいたが，これは直和の普遍性$\Hom(W\oplus W',K)=\Hom(W,K)\oplus\Hom(W',K)$の別表現であろう．$(f,0)\in \Hom(W,K)\oplus\Hom(W',K)$とは，$(f,0)\in (W')^\bot$である．
\end{remarks}

\subsection{再双対空間：謎の飛び道具状態}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    標準的な単射$\ev_V:V\to V^{**}$が存在する．
    これは$\FinVect$に限って可逆であると示せる．
    一般の場合でも示せるのであろうか？

    これは前小節で導入した零化空間による分解$V=W\oplus W'$について，直和に分解する：$e_V=e_V|_W+e_V|_{W'}$．ただし$e_V|_W:W\to(W^\bot)^\bot,e_V|_{W'}:W'\to(W'^\bot)^\bot$で
    $V^{**}=(W^\bot)^\bot\oplus(W'^\bot)^\bot$．

    被零化空間の議論に再双対の自然同型は欠かせない．
    \[(V^*)^\top=\Ker (e_V:V\to V^{**})\]
\end{tcolorbox}

\begin{definition}[bidual space]
    $V^{**}:=(V^*)^*$を\textbf{再双対空間}という．
\end{definition}

\begin{proposition}\label{prop-eV-is-monic}
    $V\in\Vect_K$とする．
    \begin{enumerate}
        \item $\ev_x:V^*\to K$は線型写像である．
        \item $e_V:V\to V^{**}$は線型写像である．
        \item $V$の基底$x_1,\cdots,x_n$の双対基底$f_1,\cdots,f_n\in V^*$の双対基底は$e_V(x_1),\cdots,e_V(x_n)\in V^{**}$である．
        \item $e_V:V\to V^{**}$は単射である．$V$が有限次元ならば可逆である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $f,g\in V^*,a\in K$とすると，\begin{align*}
            \ev_x(f+g)&=(f+g)(x)=f(x)+g(x)=\ev_x(f)+\ev_x(g)\\
            \ev_x(af)&=(af)(x)=a\cdot f(x)=a\ev_x(f).
        \end{align*}
        \item $x,y\in V^*,a\in K$とする．\begin{align*}
            e_V(x+y)&=\ev_{x+y}=\ev_x+\ev_y=e_V(x)+e_V(y),\\
            e_V(ax)&=\ev_{ax}=a\cdot\ev_x=a\cdot e_V(x),
        \end{align*}
        は，$f\in V^*$が線型形式であることから従う．$\ev_{x+y}(f)=f(x+y)=f(x)+f(y)=\ev_x+\ev_y$など．
        \item $e_V(x_i)=\ev_{x_i}:V^*\to K$は，$\ev_{x_i}(f_j)=f_j(x_i)=\delta_{ij}$より，確かに$f_1,\cdots,f_n$の双対基底である．
        \item $e_V$は基底を（再双対）基底に写す線型写像であるから，命題\ref{prop-characterization-of-isomorphism}より可逆である．
        一般の線型空間$V\in\Vect_K$について，$x\in V$に関して$e_V(x)=0$となるための条件を考える．そのためには$\ev_x=0$即ち$\forall f\in V^*,\;f(x)=0$が必要十分だが，これを満たすものは$x=0$のみであることが言いたい．
        なるほど，結局$x\ne 0$の場合，$f\in V^*$を構成して$f(x)\ne 0$であることを言う必要がある．そのために，$p:V\to Kx$を射影とし，$q:V\to V'$をその補空間への射影とすると，$f$を和写像$f=g+h$として構成する．ただし，$g:Kx\to K$は$x$が定める同型，$h:V'\to K$は例写像とでもすれば良い．$\ev_x(f)=f(x)=g(x)=1$である．
        \[\xymatrix{
            Kx\ar@{.>}[dr]^-g_-{\cong}\\
            V\ar[r]_-f\ar[u]^-p\ar[d]_-q&K\\
            V'\ar@{.>}[ur]_-h
        }\]
    \end{enumerate}
\end{proof}
\begin{remark}[どうして線型代数ではこんなにも圏論的視点が大事なのか？]
    再双対空間が同型であることが，圏論的な言葉（命題\ref{prop-characterization-of-isomorphism}）で
    最初に言えて，単射性などは後なのである．しかしこの証明も圏論の力による抽象的な構成をするのが簡明である．
\end{remark}

\begin{corollary}\label{cor-biannihilator-subspace}
    $W\subset V\in\Vect$を部分空間とする．
    \begin{enumerate}
        \item $W=e_V^{-1}((W^\bot)^\bot)$，$W=(W^\bot)^\top$．
        \item $V$が有限次元ならば，同型$e_V:V\to V^{**}$は同型$W\to(W^\bot)^\bot$を引き起こす．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 部分空間$W\subset V$の補空間を$W'$とすると，$V^*=W^\bot\oplus W'^\bot$であり，$V^{**}=(W^\bot)^\bot\oplus(W'^\bot)^\bot$である．この時，$W$上の点$x$の値写像$\ev_x\in e_V(W)$とは，$W$の零化子$f\in W^\bot$を零化する$\ev_x(f)=f(x)=0$から，$e_V(W)\subset(W^\bot)^\bot,e_V(W')\subset (W^\bot)$であるから，標準単射$e_V:V\to V^{**}$は２つの単射$e_V|_{W}:W\to(W^\bot)^\bot,e_V|_{W'}:W'\to(W'^\bot)^\bot$の直和である．
        \[\xymatrix{
            W\ar[d]_-{e_V|_W}&V\ar[l]_-{\pr_1}\ar[r]^-{\pr_2}\ar[d]^-{e_V}&W'\ar[d]^-{e_V|_{W'}}\\
            (W^\bot)^\bot&V^{**}\ar[l]^-{\pr_1}\ar[r]_-{\pr_2}&(W'^\bot)^\bot
        }\]
        $(W^\bot)^\bot$の$e_V$による逆像とは，$e_V|_W$による逆像に等しく，$W$である．

        $(W^\bot)^\top=\{x\in V\mid f\in W^\bot\Rightarrow f(x)=0\}=\{x\in V\mid f\in W^\bot\Rightarrow\ev_x(f)=0\}=\{x\in V\mid \ev_x|_{W^\bot}=0\}=\{x\in V\mid \ev_x\in(W^\bot)^\bot\}$より，$(W^\bot)^\top$も$e_V$による$(W^\bot)^\bot$の逆像である．
        \item $V$が有限次元ならば$e_V$は同型だから，その制限$e_V|_W:W\to e_V(W)=(W^\bot)^\bot$も同型である．
    \end{enumerate}
\end{proof}
\begin{remark}
    系\ref{cor-biannihilator-in-finite-situation}を，一般のVect上で記述し直したものである．
    こんなに微妙で精巧な景色が広がっているとも思わなかったが，圏論の言葉を使えば証明は案外簡明である．
    用いた構造は，線型空間$V$の部分空間全体の集合$SV$上の同型$\top\circ\bot=\id_{SV}$である．$e_V$はこの構造について分解すると言うか，非常にうまく両立するのが上の図式である．
\end{remark}

\section{双対写像}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    反変Hom関手$\Hom_\Vect(-,K)$を$\Hom_\Vect(f,K)=f^*$と言うように${}^*$で表す．
    この行列表示について，$(A\times)^*={}^t\!A\times$の関係が成り立つ（命題\ref{prop-matrix-representation-of-dual-map}）．
    行列を転置させると言う操作は，Hom集合の間の関手を取ってたのである！そんな2-射的な操作だったのか！
\end{tcolorbox}

\subsection{双対写像の定義}

\begin{proposition}[dual mapping]
    $f:V\to W$を$K$-線型写像とする．$g\in W^*$を線型形式$g\circ f:V\to K$に写す写像$f^*:W^*\to V^*$は線型写像である．
    これは$K$との間に定まる反変Hom関手$f^*\Hom_\Vect(W,K)\to\Hom_\Vect(V,K)$に他ならない．これを\textbf{双対写像}という．
\end{proposition}
\begin{proof}
    命題\ref{prop-Hom-sets-are-linear-spaces}として一般的に示せる．
\end{proof}

\begin{proposition}[$\Hom(-,K)$は反変関手である]\mbox{}\label{prop-Hom-K-is-contravariant}
    \begin{enumerate}
        \item $V$を線型空間とすると，$\id^*_V=\id_{V^*}$である．
        \item 線型写像$f,g:V\to W,a\in K$に対し，$(f+g)^*=f^*+g^*$，$(af)^*=af^*$．
        \item 線型写像$f:U\to V,g:V\to W$に対し，$(g\circ f)^*=f^*\circ g^*$．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] $\id^*_V:V^*\to V^*$は線型形式に$\id_V$を合成する関手で，$\id_{V^*}$に等しい．
        \item[2.] 結局双対写像が線型写像である理由と同じ理由でこの関手性が成り立つ．$h\in W^*$に対して$f+g$を合成させるのと，$f,g$を別々に合成させて話を取るのは等しい．$af$を右から合成するのと，$f$を合成して$a$倍するのとは可換である．
        \item[3.] $h\in W^*$とすると，$h\circ(g\circ f)=(h\circ g)\circ f=(g^*(h))\circ f=f^*(g^*(h))$．
    \end{description}
\end{proof}

\subsection{双対写像の行列表示と転置操作}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=双対写像の行列表示]
    $(A\times)^*={}^t\!A\times$が成り立つ．
\end{tcolorbox}

\begin{proposition}[双対写像の行列表示]\label{prop-matrix-representation-of-dual-map}
    $V,W\in\FinVect$とし，$B=(x_1,\cdots,x_n),B'=(y_1,\cdots,y_m)$をそれぞれ$V,W$の基底とする．
    $B^*=(f_1,\cdots,f_n),B'^*=(g_1,\cdots,g_m)$をそれぞれ双対基底とする．
    \begin{enumerate}
        \item $n=m$とし，$f:V\to W$を$x_1,\cdots,x_n$と$y_1,\cdots,y_n$とが定める同型とする．この時，双対写像$f^*:W^*\to V^*$は$g_1,\cdots,g_n$を$f_1,\cdots,f_n$に写す同型である．
        \item $f:V\to W$を線型写像とする．$f$の$B,B'$に関する行列表示を$A\in M_{mn}(K)$とする．双対写像$f^*:W^*\to V^*$の双対基底$B'^*,B^*$に関する行列表示は，転置${}^t\!A\in M_{nm}(K)$である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] $f^*(g_i)=g_i\circ f:V\to K$と言う線型形式についてだが，$g_i\circ f(x_j)=g_i(y_j)=\delta_{ij}$より，$g_i\circ f=f_i$である．
        \item[2.] $h:K^n\to(K^n)^*,h':K^m\to(K^m)^*$を例\ref{eg-induced-morphism}に言うような，$a$を${}^t\!a$倍写像$f_a$に写す線型写像とする．
        \[\xymatrix{
            W^*\ar[rrr]^-{f^*}\ar[dr]^-{g^*_{B'}}&&&V^*\ar[dl]_-{g^*_B}\\
            &(K^m)^n\ar[r]^-{(A\times)^*}&(K^n)^*\\
            K^m\ar[uu]^-{g_{B'^*}}\ar[ur]^-{h'}\ar[rrr]^-{{}^t\!A\times}&&&K^n\ar[uu]_-{g_{B^*}}\ar[ul]^-h
        }\]
        の大外周りが可換であることを示せば良い．上の台形が可換であるのは，行列表示の可換図式$f\circ g_B=g_{B'}\circ(A\times)$を命題\ref{prop-Hom-K-is-contravariant}
        より反変Hom関手$\Hom(-,K)$で写した結果である．左右の三角形が可換なのは，$h,h'$が$K^n$の標準基底$e_1,\cdots,e_n$とその双対基底${}^t\!e_1,\cdots,{}^t\!e_n$とが定める同型だからである．
        実際，$g^*_B(g_{B^*}(e_i))=g^*_B(f_i)=f_i\circ g_B:K^n\to K$は，$f_i\circ g_B(e_j)=f_i(x_j)=\delta_{ij}$より，確かに$e_i$の双対基底である．

        最後に，下の台形が可換であることを示せば良い．
        ここまで論理を簡約したところで，図式追跡をすると，行列積の計算に落ちる．
        $a\in K^m$を任意に取る．これを２通りに図式追跡した結果の$(K^n)^*$上での方程式$(A\times)^*(h'(a))=h({}^t\!A\times(a))$を示せば良い．
        そのために，$x\in K^n$を任意に取れば，体$K$上の方程式に落ち着く．
        左辺は$(A\times)^*(h'(a))=h'(a)\circ(A\times)$だから，この$x$での値は$h'(a)(Ax)={}^taAx\in K$．
        右辺も$h({}^t\!Aa)(x)={}^t\!({}^t\!Aa)x={}^taAx$．
    \end{description}
\end{proof}
\begin{remark}
    初めて重大な事実に気づいた．\textbf{横ベクトルが線型形式の双対写像}なのか．
    だから縦ベクトルと横ベクトルの対が内積なのである．
    数ベクトルの空間$K^n$の標準基底$e_i$の双対基底とは${}^t\!e_i$である．
    そしてこの証明の構造は，相変わらず，一般の線型空間の議論を数ベクトル空間での議論に引き戻している．
    最後の下の台形を示すにあたって，\textbf{他の部分の可換性は抽象的に示したが，その全てのしわ寄せが行列積の計算規則にまとまっている}のが良い．
\end{remark}

\begin{corollary}
    $V\in\Vect$とし，$B=(x_1,\cdots,x_n),B'=(x'_1,\cdots,x'_n)$を$V$の基底とする．$P\in\GL_n(K)$を$B$から$B'$への底の変換行列とすると，
    双対基底$B^*$から$B'^*$への底の変換行列は${}^tP^{-1}$である．
\end{corollary}
\begin{proof}
    命題\ref{prop-transformation-matrix}より，（$P$とは基底$B'$を基底$B$で成分表示したものを列ベクトルにもつ行列だから，）$P$とは$1_V$の基底$B,B'$に関する行列表示である．
    命題より，$(1_V)^*=1_{V^*}$の$B^*,B'^*$に関する行列表示は${}^t\!P$である．
    よって，基底$B'^*,B^*$に関する行列表示は${}^t\!P^{-1}$である．
\end{proof}
\begin{remark}
    $f^*$の行列表示を取るのは転置である．それに，$f^*$の反変性（$f$と向きが逆であること）がここでは現れるのか！
\end{remark}

\subsection{双対写像の核と像と双対空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=双対写像と零化空間を結びつける射影子$p^*$の双対写像としての構成]
    双対空間の内部構造は，双対写像の核と像として記述できる．
    例えば，部分空間の零化空間$W^\bot$は包含写像$i:W\to V$の定める双対写像の核$\Ker i^*$として表せる．

    ここに来て，零化空間と射影子の言葉が合流する．
    元の空間の射影$p$が，双対空間の射影子$p^*$となり，その射影子に沿って双対空間は零化空間に分解する：$\overline{p^*}:W^*\to W'^\bot$は可逆．
\end{tcolorbox}

\begin{proposition}[双対写像の核と像]
    $f:V\to W$を線型写像，$f^*:W^*\to V^*$を双対写像とする．
    \begin{enumerate}
        \item $\Ker f^*=(\Im f)^\bot$．
        \item $\Im f^*=(\Ker f)^\bot$．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $g\in\Ker f^*=\{g\in W^*\mid g\circ f=0\in V^*\}$であるためには，$g(\Im f)=0$であれば良い．即ち，$g\in(\Im f)^\bot$．
        \item $h\in\Im f^*=\{g\circ f\in V^*\mid g\in W^*\}$を取ると，$\exists g\in W^*,\;h=g\circ f$だから$h(\Ker f)=g\circ f(\Ker f)=g(0)=0$より，$h\in(\Ker f)^\bot$．
        
        問題は逆である．$h\in(\Ker f)^\bot$とする．$V'$を$\Ker f$の補空間（$V=V'\oplus\Ker f$）とすると，$\overline{h}:V'\to K$を$\overline{h}=h|_{V'}$と置けば，$h=\overline{h}\oplus 0$と表せる．
        この直和分解については，$f$も次のように命題\ref{prop-pre-homomorphism-thm}から，標準分解により同型$\overline{f}:V'\to\Im f$を定める．これについて，$f=\overline{f}\oplus 0$と表せる．$\Im f$の補空間を$W'$（$W=\Im f\oplus W'$）とすると，次の図式は可換である．
        \[\xymatrix{
            \Im f\ar[d]_-i&V'\ar[l]_-{\overline{f}}\ar[r]^-{\overline{h}}&h(V)\ar[d]^-i\\
            W&V\ar[l]^-f\ar[r]_-h\ar[u]^-{\pr_1}\ar[d]_-{\pr_2}&K\\
            W'\ar[u]^-j&\Ker f\ar[l]^-0\ar[r]_-0&0\ar[u]_-j
        }\]
        これに対して，この図を可換するように$g:W\to K$を構成すれば，$h=g\circ f$が成り立つ．即ち，$\overline{g}:\Im\to h(V)$を$\overline{g}=\overline{h}\circ\overline{f}^{-1}$とし，$g':W'\to K$を零写像$g'=0$などとし，$g=\overline{g}\oplus g'$とすれば，$g\in W^*$で$h=g\circ f$だから，$h\in\Im f^*$．
    \end{enumerate}
\end{proof}
\begin{remark}[部分空間の零化空間は包含写像の定める双対写像の核]\label{remark-annihilator-as-kernel}
    特に$i:W\to V$を包含写像とすれば，$\Ker i^*=(\Im i)^\bot=W^\bot$となる．\textbf{部分空間の零化空間は包含写像の定める双対写像の核}として表せる．
    コツを掴んだので証明は自分でかけた．双対空間についてのこの章で証明が長くなるとしたら全て普遍構成についてである．構成の前に補空間を準備したりその間に定まる射を記述したりするために行数を食う．
\end{remark}

\begin{corollary}[線型写像の双対命題]\label{cor-duality-of-dual-map}
    $f:V\to W$を線型写像，$f^*:W^*\to V^*$を双対写像とする．
    \begin{enumerate}
        \item $f$が単射であることと，$f^*$が全射であることが同値である．
        \item $f$が全射であることと，$f^*$が単射であることが同値である．
        \item $f$が定める全射$p:V\to \Im f$の双対$p^*$は同型$(\Im f)^*\to\Im(f^*)$を定める．$\Im f$が有限次元ならば$\Im f^*$も有限次元で，$\rank f=\rank f^*$である．従って，$A\in M_{mn}(K)$とすると，$A$の階数と${}^t\!A$の階数とは等しい．
        \item $V=W\oplus W'$とし，$p:V\to W,p':V\to W'$を射影とする．この時，$p^*,p'^*$は，同型$W^*\to W'^\bot,W'^*\to W^\bot,W^*\oplus W'^*\to V^*$を定める．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $f$が単射とは，命題\ref{prop-characterization-of-monos-in-terms-of-Kernel}より，$\Ker f=0$と同値．この時命題より，$\Im f^*=(\Ker f)^\bot=0^\bot=V^*$より，$f^*$は全射．
        
        逆に，$f^*$が全射とする．命題の2より，$V^*=\Im f^*=(\Ker f)^\bot$であるから，
        \[\Ker f=((\Ker f)^\bot)^\top=(V^*)^\top=\Ker(e_V:V\to V^{**})=0\]
        より，$f$は単射．最初の等号は系\ref{cor-biannihilator-subspace}より，最後の等号は$e_V$が単射であることによる（命題\ref{prop-eV-is-monic}）．
        \item $f$が全射とは，$\Im f=W$．命題より，$\Ker f^*=(\Im f)^\bot=W^\bot=0$より，$f^*$は単射．
        
        $f^*$が単射とする．命題の1より，$0=\Ker f^*=(\Im f)^\bot$．系\ref{cor-biannihilator-subspace}より，$\Im f=((\Im f)^\bot)^\top=0^\top=W$であるから，$f$は全射．
        \item $f$の標準分解の図式
        \[\xymatrix{
            &\Im f\ar[d]^-i\\
            V\ar[ur]^-p\ar[r]_-f&W
        }\]
        の双対（次の図式の右下三角形）も可換で，$p^*$は単射，$i^*$は全射．
        \[\xymatrix{
            \Im f^*\ar[d]_-i&(\Im f)^*\ar@{.>}[l]_-{\sim}^-{\overline{p^*}}\ar[dl]^-{p^*}\\
            V^*&W^*\ar[l]^-{f^*}\ar[u]_-{i^*}
        }\]
        上の図式が可換であることにより，$\Im p^*=\Im f^*$なので，$\overline{p^*}$は同型．

        $\Im f$が有限次元ならば，命題\ref{prop-dimention-of-dual-space}より$(\Im f)^*$も有限次元で，それと同型な$\Im f^*$も有限次元であり，次元が等しい．従って，$\rank f=\rank f^*$．
        \item $p$は全射で，$\Ker p=W'$だから，命題の2より，$\Im p^*=(\Ker p)^\bot=W'^\bot$で，$p^*$は単射だから，次の同型$\overline{p^*}:W^*\to W'^\bot$が引き起こされる：
        \[\xymatrix{
            W&&W^*\ar@{.>}[dl]_-{\overline{p^*}}\ar[d]^-{p^*}\\
            V=W\oplus W'\ar[u]_-p&W'^\bot\ar[r]_-i&V^*
        }\]
        $p'$についても同様．従って，下図は可換になり，$p^*,p'^*$は同型$p^*\oplus p'^*:W^*\oplus W'^*\to V^*$を定めている：
        \[\xymatrix{
            W^*\ar[d]_-i\ar[r]^-{\overline{p^*}}_-{\sim}\ar[dr]^-{p^*}&W'^\bot\ar[d]^-i\\
            W^*\oplus W'^*\ar[r]^-{p^*\oplus p'^*}&V^*=W^\bot\oplus W'^\bot\\
            W'^*\ar[u]^-j\ar[ur]^-{p'^*}\ar[r]_-{\overline{p'^*}}^-{\sim}&W^\bot\ar[u]_-j
        }\]
    \end{enumerate}
\end{proof}
\begin{remark}[元の空間の射影子が，双対空間の射影子となり，その射影子に沿って双対空間は零化空間に分解する]
    これらの$f$と$f^*$の間の双対命題は，2-圏的な消息が引き出すものなのか？
    最初の1,2の証明は自分でも何をやっているのかわからない．零化空間と非零化空間により議論はスッキリしているが，どうしてこんなにも効果的なのか？
    4もわからない．論理が追えるが，ここに来て零化空間についての命題の総集編となっているが，肝は，\textbf{双対空間は零化空間に直和分解すべし}ということだろうか．
    実際，4での$p^*$の使用は射影子ではないか．
\end{remark}

\section{線型写像の空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=線型空間の集合論的性質を，線型写像を使って圏論的に言い換えることができる]
    $W^V$の部分空間$\Hom(V,W)$に注目する．
    今までの双対空間の議論は$V^*=\Hom_K(V,K)$の場合であった．
    自己準同型の議論は$\End_K(V)$の場合であった．
\end{tcolorbox}

\begin{proposition}
    $\Hom_K(V,W)=\{f\in W^V\mid fは線型写像\}$は$K$-線型部分空間である．
\end{proposition}

\begin{remark}[体の拡大のよるHom集合の縮小：これが複素関数のnature]
    $\Hom_K(V,W)$と体$K$を明示するのが良い．$L$を$K$の拡大体とすると，$\Hom_L(V,W)\subsetneq\Hom_K(V,W)$が成り立つ．
    $K=\R,L=\C$とすれば，複素共軛は$\Hom_\R(\C,\C)$の元だが，$\Hom_\C(\C,\C)$の元ではない．
\end{remark}

\begin{example}
    \[\xymatrix@R-2pc{
        F_f:K[X]\ar[r]&\End(V)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        G\ar@{|->}[r]&G(f)
    }\]
    は線型写像であるというのが命題\ref{prop-functoriality-of-substitution}の結果である．
    この線型写像の核を生成するのが最小多項式である．$\varphi$を$f$の最小多項式とすると，$\Ker F=(\varphi)$である（命題\ref{prop-stable-subspace}）．
\end{example}

\begin{proposition}\label{prop-Hom-sets-are-linear-spaces}
    $V,V',W,W'\in\Vect_K$とする．
    \begin{enumerate}
        \item 線型写像$g:W\to W'$が定める共変Hom関手$g_*:\Hom(V,W)\to\Hom(V,W')$は再び線型写像である$g_*\in\Vect_K$．
        \item 線型写像$h:V'\to V$が定める共変Hom関手$h^*:\Hom(V,W)\to\Hom(V',W)$は再び線型写像である$h^*\in\Vect_K$．
    \end{enumerate}
\end{proposition}
\begin{proof}
    2を示す．$f,g\in\Hom_{\Vect_K}(V,W),a\in K$とする．
    \begin{align*}
        h^*(f+g)&=(f+g)\circ h=f\circ h+g\circ h=h^*(f)+h^*(g)\\
        h^*(af)&=(af)\circ h=a(f\circ h)=a\cdot h^*(f)
    \end{align*}
    が成り立つのは，結局$x\in V'$について，
    \begin{align*}
        (f+g)\circ h(x)&=(f+g)(h(x))=f(h(x))+g(h(x))=(f\circ  h+g\circ h)(x)\\
        (af)\circ h(x)&=(af)(h(x))=a\cdot f(h(x))=a\cdot (f\circ h)(x)
    \end{align*}
    だからである．
\end{proof}

\begin{lemma}
    $k$を体とする．$\varphi:V\to W$を$k$-線型空間の間の線型写像とし，$\varphi^*:W^\vee\to V^\vee$をその双対写像とする．
    この時，
    \begin{enumerate}
        \item $\varphi$が単射であることは，$\varphi^*$が全射であることと同値である．
        \item $\varphi$が全射であることは，$\varphi^*$が単射であることと同値である．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $0\to\Ker\varphi\to V\to W\to\Coker\varphi\to 0$は完全列である．
        \item $k$は$k$加群として入射的．即ち，関手$\Hom(-,k)$は完全となる．
        \item $0\to(\Coker\varphi)^\vee\to W^\vee\to V^\vee\to(\Ker\varphi)^\vee\to 0$は完全列である．
    \end{enumerate}
\end{proof}
\begin{remarks}[欲しかった概念：入射的対象]
    このことが，全単射\[\xymatrix@R-2pc{
        \paren{\F_2^{\oplus S}}^\vee\ar[r]&P(S)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        g\ar@{|->}[r]&\{s\in S\mid g([s])=1\}
    }\]
    を介して，写像$f:V\to W$に対して逆像写像$f^*$の全射／単射性を示す．
\end{remarks}

\begin{corollary}[同型の普遍性]\label{cor-characterization-of-isomorphism}
    線型写像$f:V\to W$に対し，次の条件は同値．
    \begin{enumerate}
        \item $f$は同型．
        \item 任意の線型空間$W'$に対し，$f^*:\Hom(W,W')\to\Hom(V,W')$は同型．
        \item 任意の線型空間$V'$に対し，$f_*:\Hom(V',V)\to\Hom(V',W)$は同型．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{description}
        \item[1$\Rightarrow$2] $g$を$f$の逆写像とすれば，$g^*$が$f^*$の逆写像である．代数法則としても，$g\circ f=\id_V$に対して，$f^*\circ g^*=(g\circ f)^*=(\id_V)^*=\id_{\Hom(V,W')}$．
        \item[2$\Rightarrow$1] $W'=V$とする．$g=f^{*-1}(\id_V)$とすれば，$g\circ f=\id_V$．$W'=W$と置くと，$f^*(f\circ g)=(f\circ g)\circ f=f\circ(g\circ f)=f\circ\id_V=f=f^*(\id_W)$より，$f\circ g=\id_W$．よって，逆射$g$が構成できた．
        \item[1$\Leftrightarrow$3] 同様．
    \end{description}
\end{proof}

\begin{example}[Hom集合の次元は特別なHom集合に引き戻して定める]
    Vectの性質を用いて数ベクトルの空間に引き戻せば，$\dim\Hom(V,W)=\dim V\cdot\dim W$とわかる．
\end{example}

\begin{example}[$V$-値点]
    
\end{example}

\begin{proposition}[直和の普遍性]\label{prop-characterization-of-direct-sum}
    $V,W\in\Vect$とする．
    \begin{enumerate}
        \item $V=V_1\oplus V_2$とし，$i_1:V_1\to V,i_2:V_2\to V$を包含写像とする．この時，$i^*_1\oplus i^*_2:\Hom(V,W)\to\Hom(V_1,W)\oplus\Hom(V_2,W)$は同型である．
        \item $W=W_1\oplus W_2$とし，$p_1:W\to W_1,p_2:W\to W_2$を射影とする．この時，$p_{1*}\oplus p_{2*}:\Hom(V,W)\to\Hom(V,W_1)\oplus\Hom(V,W_2)$は同型である．
    \end{enumerate}
\end{proposition}

\begin{proposition}[完全系列の普遍性]\label{proposition-universality-of-exact-sequence}
    線型写像の列$V'\xrightarrow{f}V\xrightarrow{g}V''$について，次の４条件は全て同値である．
    \begin{enumerate}
        \item $V'\xrightarrow{f}V\xrightarrow{g}V''$は完全系列である．
        \item 任意の$K$-線型空間$W$に対し，$\Hom(W,V')\xrightarrow{f_*}\Hom(W,V)\xrightarrow{g_*}\Hom(W,V'')$は完全系列である．
        \item 任意の$K$-線型空間$W$に対し，$\Hom(V'',W)\xrightarrow{g^*}\Hom(V,W)\xrightarrow{f^*}\Hom(V',W)$は完全系列である．
        \item $V''^*\xrightarrow{g^*}V^*\xrightarrow{f^*}V'^*$は完全系列である．
    \end{enumerate}
\end{proposition}

これを使うと驚くべきことが証明できる．これが私が求めていたものである．
\begin{lemma}
    $K$を体とし，$f:V\to W$を$K$-線型空間の間の線型写像とする．このとき，任意の$K$-線型空間$Z$に対して，
    \begin{enumerate}
        \item $f:V\to W$が単射であることは，$f^*:\Hom_K(W,Z)\to\Hom_K(V,Z)$が全射であることと同値である．
        \item $f:V\to W$が全射であることは，$f^*:\Hom_K(W,Z)\to\Hom_K(V,Z)$が単射であることと同値である．
        \item $f:V\to W$が単射であることは，$f_*:\Hom_K(Z,V)\to\Hom_K(Z,W)$が単射であることと同値である．
        \item $f:V\to W$が全射であることは，$f_*:\Hom_K(Z,V)\to\Hom_K(Z,W)$が全射であることと同値である．
    \end{enumerate}
\end{lemma}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.,2.] 線型写像$f:V\to W$について，次の系列
        \begin{equation}
            \xymatrix@1
            {
            0\ar[r]&\Ker f\ar[r]&V\ar[r]^-f&W\ar[r]&\Coker f\ar[r]&0
            }
            \label{eq-1}
        \end{equation}
        が完全であることと，
        \[\xymatrix@1{
            0\ar[r]&\Hom_K(\Coker f,Z)\ar[r]&\Hom_K(W,Z)\ar[r]^-{f^*}&\Hom_K(V,Z)\ar[r]&\Hom_K(\Ker f,Z)\ar[r]&0
        }\]
        が完全であることとは同値であることから従う．
        \item[3.,4.] 系列\ref{eq-1}が完全であることと，
        \[\xymatrix@1{
            0\ar[r]&\Hom_K(Z,\Ker f)\ar[r]&\Hom_K(Z,V)\ar[r]^-{f_*}&\Hom_K(Z,W)\ar[r]&\Hom_K(Z,\Coker f)\ar[r]&0
        }\]
        が完全であることとは同値であることから従う．
    \end{description}
\end{proof}
\begin{remarks}
    VectとSetsで混乱した点がある．Vectでは，零は零に対応させなければならないので$\Hom(0,Z)=0$であり，一点対象は一般に終対象なので$\Hom(Z,0)=0$である．
    あとは，$\Hom_K(\Im f\oplus\Coker f,Z)=\underbrace{\Hom_K(\Im f,Z)}_{=\Coim f^*}\oplus\underbrace{\Hom_K(\Coker f,Z)}_{=\Ker f^*}$であることも暗黙のうちに考えている．
    これは実は命題\ref{prop-annihilator-space-and-direct-sum}でも考えたはずである．

    だが，「双対写像は反変Hom関手の特別な場合だが，線型代数では反変Hom関手の概念は実は要らない」という説はどうしようか．
\end{remarks}

\begin{itembox}[l]{線型代数の射程}
    正直線型代数よりも集合と位相の方が明らかに一般的だと思っていたが，写像$f$とその逆像写像$f^*$との全射性／単射性の対応の証明を線型代数でされてから，
    表現力としてはどっちもどっちだと感じるようになった．
    まさか圏論の方にもここまでの普遍性があるとは思わなかった．
    二本の世界樹が僕の心の中にどっしりと構えるようになった．
\end{itembox}

\chapter{双線型形式}

\begin{quotation}
    線型空間とその双対空間を考察したいま，これを統合する立場に立てる．この概念をVectの立場から一つのデータ構造と演算で包摂できることが線型代数の威力である．
    
    そもそも双線型写像はVectに生息するわけではないが，うまくcurryingし記法を工夫することで扱える．
    この方法は極めて普遍的であり，実際完全にVect上に取り込める代数的手法である．
    重線型写像とは，テンソル対称に分解するようなVectの射のことである．
    「論理を可換図式がになって，残りは行列積の計算に落とし込む」の手法がさらに鮮やかになる．
    行列はうまく使えばこんな高度な内容を全て行列積一つに落とし込めてしまえる！
    \begin{enumerate}
        \item 双線型形式は双対空間への線型写像と見るcurryingの発想により，行列表示を持つ．
        \item 対称的な双線型形式を調べる．
        \item $\C$-線型空間上のエルミート形式を調べる．
        \item 交代線型形式について用語を定義する．
    \end{enumerate}
\end{quotation}

\section{双線型形式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    行列というデータ構造を左右で使うことで，双線型形式$V\times W\to K$を表現できる．
\end{tcolorbox}

\subsection{双線型形式の定義と例}

\begin{definition}[bilinear form]
    $V,W\in\Vect_K$とする．写像$b:V\times W\to K$が\textbf{双線型形式}であるとは，次の３条件を満たすことをいう．
    \begin{enumerate}
        \item $\forall x,x'\in V,\forall y\in W,\;b(x+x',y)=b(x,y)+b(x',y)$．
        \item $\forall x\in V,y,y'\in W,\;b(x,y+y')=b(x,y)+b(x,y')$．
        \item $\forall a\in K,x\in V,y\in W,\;b(ax,y)=b(x,ay)=ab(x,y)$．
    \end{enumerate}
\end{definition}

\begin{example}[行列$A$が定める双線型形式]
    $A\in M_{mn}(K)$とする．$x\in K^m,\,y\in K^n$に対して，\[b_A(x,y)={}^t\!xAy\in K\]と置くと，$b_A:K^m\times K^n\to K$は双線型形式である．
    これを\textbf{行列$A$が定める双線型形式}という．
\end{example}
\begin{example}[標準双線型形式]
    写像$\langle\;,\;\rangle:V\times V^*\to K$を\[\langle x,f\rangle=f(x)\in K\]で定めると，$\langle\;,\;\rangle$は双線型形式である．
    これは$e_V$にcurryingする前の雛形で，\textbf{標準双線型形式}という．
\end{example}

\subsection{双線型形式の行列表示と変換}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    双線型形式はcurryingによって線型写像とみなせるので，行列表示を持つ．

    変換については，基底$x_1,\cdots,x_m\in V$と$y_1,\cdots,y_n\in W$についての表示を$A\in M_{mn}(K)$とする．
    $V$の基底$x'_1,\cdots,x'_m$への変換を$P\in\GL_m(K)$とすると，$P$の縦ベクトル$p_i$は，$x'_i$を作るための基底$x_1,\cdots,x_m$による献立なので，
    $AP$で達成される．その双対については，${}^t\!QAP$で達成される．テンソルの変換もこの類似である（命題\ref{prop-basis-change-of-tensor}）．
\end{tcolorbox}

\begin{definition}[双線型形式の行列表示]\mbox{}\label{def-matrix-representation-of-bilinear-forms}
    \begin{enumerate}
        \item 双線型形式$b:V\times W\to K$の，基底$x_1,\cdots,x_m\in V$と$y_1,\cdots,y_n\in W$に関する\textbf{行列表示}とは，
        \[(b(x_i,y_j))_{1\le i\le m\\1\le j\le n}=\begin{pmatrix}b(x_1,y_1)&\cdots&b(x_1,y_n)\\\vdots&\ddots&\vdots\\b(x_m,y_1)&\cdots&b(x_m,y_n)\end{pmatrix}\in M_{mn}(K)\]
        を指す．
        \item $b$の行列表示$A$によって得た$A$倍写像$A\times $とは，次の図式を可換にする射$b\circ g\times g':K^{m+n}\to K$である．
        \[\xymatrix{
            K^n\ar[r]^-{g'}\ar[d]_-j&W\ar[d]^-j\\
            K^{m+n}\ar[r]^-{g\times g'}&V\times W\ar[r]^-b&K\\
            K^m\ar[u]^-i\ar[r]_-g&V\ar[u]_-i
        }\]
        しかし，$A$は$1\times(m+n)$行列とはしない．$m\times n$行列とし，左右で分けて書くのである：
        \[b\circ g\times g'(x,y)=b(g(x),g'(y))=b_A(x,y)={}^t\!xAy.\]
        \item 次の写像は可逆である：
        \[\xymatrix@R-2pc{
            \{b\in K^{V\times W}\mid b:V\times W\to Kは双線型形式\}\ar[r]&M_{mn}(K)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            b_A\ar@{|->}[r]&A
        }.\]
    \end{enumerate}
\end{definition}
\begin{remark}
    $V=0$または$W=0$の時，双線型写像とはただの線型写像であるから，$A$がその表現行列になっていることが確認できる．例えば$V=0$の時，これは$W$の基底$y_1,\cdots,y_n$の行き先を並べた行列$(b(y_1)\;\cdots\;b(y_n))$となっている．
\end{remark}

\begin{example}\mbox{}
    \begin{enumerate}
        \item $A\in M_{mn}(K)$の定める双線型写像$b_A$の，$K^m,K^n$の標準基底に関する行列表示は$A$である．
        \item 標準双線型形式$\langle\;,\;\rangle:V\times V^*\to K$の，$V$の基底$x_1,\cdots,x_n$とその双対基底$f_1,\cdots,f_n$に関する行列表示は，単位行列$1$である．
    \end{enumerate}
\end{example}

\begin{proposition}[双線型形式の変換]
    $b:V\times W\to K$を双線型形式とする．
    $V$の基底$B=(x_1,\cdots,x_m)$から$B'=(x_1',\cdots,x_m')$への底の変換行列を$P\in\GL_m(K)$とし，
    $W$の基底$D=(y_1,\cdots,y_n)$から$D'=(y_1',\cdots,y_n')$への底の変換行列を$Q\in\GL_n(K)$とする．
    $B,D$に関する$b$の行列表示を$A$とし，$B',D'$に関する$b$の行列表示を$A'$とすると，$A'={}^t\!PAQ$である．
\end{proposition}
\begin{proof}
    \[\xymatrix{
        K^m\ar[r]^-{g_B}&V\ar[d]&K^m\ar[l]_-{g_{B'}}\ar@/_2pc/[ll]_-{P\times}\\
        K^{m+n}\ar[d]\ar[u]\ar[r]^-{g_B\oplus g_D}&V\times W&K^{m+n}\ar[l]_-{g_{B'}\oplus g_{D'}}\ar[d]\ar[u]\\
        K^n\ar[r]_-{g_D}&W\ar[u]&K^n\ar[l]^-{g_{D'}}\ar@/^2pc/[ll]^-{Q\times}
    }\]
    いま，$B,D$に関する$b$の行列表示が$A$だから，右の方から$(a,a')\in K^m\oplus K^n$を取ると，上の図式が可換だから，
    \begin{align*}
        g_{B'}\oplus g_{D'}(a,a')&=b(g_{B'}(a),g_{D'}(a'))={}^t\!aA'a'\\
        (g_B\oplus g_D)\circ(P\times\oplus Q\times)(a,a')&=b(g_B(Pa),g_D(Qa'))={}^t\!(Pa)AQa'={}^t\!a({}^tPAQ)a'
    \end{align*}
    の２つは等しい．よって，$A'={}^t\!PAQ$．
\end{proof}
\begin{remark}
    これも，「論理を可換図式がになって，残りは行列積の計算に落とし込む」のパターンである．
\end{remark}

\subsection{双線型写像をcurryingしてVectに取り込む：双線型形式の行列表示の特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    双線型写像は，双対空間を考えることで，線型写像として明快に調べることができる．
    それにはcurryingをするのである．$b:V\times W\to K$を$r_b:W\to V^*$と$l_b:V\to W^*$との２通りで見る．
    行列表示では，括弧()をどちらにつけるかの結合の議論に等しい．
    「双線型写像$b:V\times W\to K$の行列表示とは，currying $r_b:W\to V^*$の，基底$B',B^*$に関する行列表示である」とまとまる．
    これがテンソルの力である．

    思えばHom関手とは，curryingしっぱなしだったのか．それがbifunctorか！
\end{tcolorbox}

\begin{proposition}[双線型形式の行列表示の特徴付け]\label{prop-characterization-of-matrix-representation-of-bilinar-form}
    $b:V\times W\to K$を双線型形式とする．$y\in W$に対し，写像$r_b(y):V\to K$を$r_b(y)=b(-,y)$と定める．
    \begin{enumerate}
        \item 写像$r_b(y):V\to K$は線型形式である．
        \item $r_b:W\to V^*$は線型写像である．
        \item $V,W\in\FinVect_K$とする．$B=(x_1,\cdots,x_m),B'=(y_1,\cdots,y_n)$をそれぞれ$V,W$の基底とし，$B^*=(f_1,\cdots,f_m)$を双対基底とする．$b$の$B,B'$に関する行列表示は，線型写像$r_b:W\to V^*$の基底$B',B^*$に関する行列表示に等しい．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $r_b(y)=b(-,y)$は，双線型形式は定義上第一引数に線形性が成り立つから，線型写像である．
        \item \[\xymatrix@R-2pc{
            r_b:W\ar[r]&V^*\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            x\ar@{|->}[r]&r_b(x)=b(-,x)
        }\]
        $x,y\in W,a\in K$とする．双線型形式の第二引数線形性より，
        \begin{align*}
            r_b(x+y)&=b(-,x+y)=b(-,x)+b(-,y)=r_b(x)+r_b(y)\\
            r_b(ax)&=b(-,ax)=ab(-,x)=ar_b(x)
        \end{align*}
        \item 線型写像$r_b:W\to V^*$の基底$B',B^*$に関する行列表示を$A=(a_{ij})$と置くと，$r_b(y_j)$とは$A$の$j$列目の縦ベクトルの成分を用いて$r_b(y_j)=a_{1j}f_1+\cdots+a_{mj}f_m$と表せるから，
        $b(x_i,y_j)$は，
        \begin{align*}
            b(x_i,y_j)&=r_b(y_j)(x_i)\\
            &=(a_{1j}f_1+\cdots+a_{mj}f_m)(x_i)\\
            &=a_{ij}
        \end{align*}
        となる．
    \end{enumerate}
\end{proof}
\begin{remark}[行列というデータ構造]\label{remark-行列というデータ構造}
    3を導くにあたって，第$n\;(n=1,2)$引数線型性しか使っていないので，このアルゴリズムは一般の$n$に拡張できると考えられる．
    しかし，行列のように紙面上には書けなくなるが？

    $b_A(-_1,-_2)$とは，「第二要素は縦ベクトル，第一要素は横ベクトル」と決めたから，第二要素を空間の点として扱って，第一要素を線型形式として扱う$r_b$の表現行列と一致するのである．
    うまく役割分担をすることによって，行列という２次元性を持つデータ構造に入れ込み，計算規則を定めたのである！なんということだ．
    従って，curryingの順番を逆にする$l_b$は，行列が転置される．まさか転置をcurryingに対応させられるとは，こんな次元があったとは思うまい．
\end{remark}

\begin{example}\mbox{}
    \begin{enumerate}
        \item 同様に$l_b(x)=b(x,-):V\to W^*$と置くと，これは$r_b(y)$の双対写像と表現行列が等しく，その転置となる．
        Hom関手の原型がここにある，実は$V^\op\times W\to$みたいな感じなんだな，これが2-圏か？
        \item 標準双線型形式$\langle\;,\;\rangle_V:V\times V^*\to K$を用いて，$b(x,y)=\langle x,r_b(y)\rangle_V=\langle y,l_b(x)\rangle_W$となる$r_b,l_b$がcurryingだったのである．
        \item 標準双線型形式$\langle\;,\;\rangle_V:V\times V^*\to K$のcuurrying $r_{\langle\;,\;\rangle}:V^*\to V^*$は次のような写像なので，$\id_{V^*}$である：
        \[\xymatrix@R-2pc{
            r_{\langle\;,\;\rangle}:V^*\ar[r]&V^*\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            f\ar@{|->}[r]&r_b(f)=\langle-,f\rangle=f
        }\]
    \end{enumerate}
\end{example}

\subsection{非退化な双線型形式は，双対空間への単射を定める}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    Hom関手と双線型写像はbifunctor性という点で似通っている．
    そこで随伴という用語が転用された．
    右成分または左成分について単射な双線型写像$b$は，右または左随伴写像を定める：$b(f(-),y)=b(-,g(y))$．
    これはbifunctorが備わる２つの空間$V,W$の間に必ず備わる対（双対を超える存在）のようなもの．
    「別の空間に跨った内積（の二通りのcurringが左随伴と右随伴）」という直感の持ち方が筋が良いのでは？
    次節以降は$V=W$の場合，即ち空間内に内積の構造が収まっている場合を考える．
\end{tcolorbox}

種々の概念を，curryingによって得る線型写像$r_b$の言葉で曇りなく定義する．

\begin{definition}[non-degenerate, right adjoint]
    $V,W\in\Vect_K$とし，$b:V\times W\to K$を双線型形式とする．
    \begin{enumerate}
        \item $b:V\times W\to K$が\textbf{$W$で非退化}とは，$r_b:W\to V^*$が単射であることをいう．$V$で非退化とは，$l_b:V\to W^*$が単射であることをいう．
        \item $b$が$W$で非退化とする．$f\in\End_K(V)$に対して，$g\in\End_K(W)$が次の図式を可換にする時，$g$は$f$の\textbf{右随伴写像}という．$g$のことも$f^*$で表す．
        \[\xymatrix{
            W\ar[r]^-{r_b}\ar[d]_-g&V^*\ar[d]^-{f^*}\\
            W\ar[r]^-{r_b}&V^*
        }\]
        この図式は，$y\in W$を取って$V^*$上の方程式に換言すれば，
        \begin{align*}
            f^*(r_b(y))&=r_b(g(y))\\
            b(-,y)\circ f=b(f(-),y)&=b(-,g(y))
        \end{align*}
        となる．
        \item $b$が\textbf{非退化}とは，$r_b:W\to V^*$が同型であることをいう．即ち，$V,W$が有限次元である場合は，第一要素も第二要素も単射であることをいう．
        \item $b$の\textbf{階数}とは，$r_b$の階数をいう．
    \end{enumerate}
\end{definition}
\begin{remark}[記号の混用]\mbox{}
    \begin{enumerate}
        \item $b$が$W$で非退化の時，$W\supset\Ker r_b=0$より，$0$との係数比較ができる$\forall x\in V b(x,y)=0\Rightarrow y=0\in W$ということである．一言で言えば，第二成分単射．
        \item well-definednessとしては，$V^*$上の方程式$b(f(-),y)=b(-,g(y))$は確かに$b$が第二成分について単射である時，$g(y)$の値は一意に定まるので，このような写像$g$は一意的である．
        \item 標準双線型形式$b=\langle\;,\;\rangle$は非退化である．$r_b=1_{V^*},l_b=1_{W^*}$だからである．
        \item $f^*$は随伴写像と双対写像で混用されることになるが，厳密に同一視できるのは$\dim V=\dim W$の時，$r_b:W\to V^*$が同型の時に限る．少し強引に思えるが，双線型形式の下では，特に元の空間とその双対空間とはセットで考え勝ちであり，同一視のモチベーションがある．
        \item 逆に言えば，$b$が非退化ならば，$\dim V=\dim W$である．
    \end{enumerate}
\end{remark}

\begin{proposition}[定義の左右対称性]
    $V,W\in\FinVect$とし，$b:V\times W\to K$を双線型形式とする．
    \begin{enumerate}
        \item $r_b:W\to V^*$の階数と$l_b:V\to W^*$の階数とは等しい．
        \item $\dim V=\dim W$とすると，次の３条件は同値である．
        \begin{enumerate}[(1)]
            \item $b$は非退化である．
            \item $b$は$W$で非退化である．
            \item $B,B'$を$V,W$の基底とすると，$b$の$B,B'$に関する行列表示は可逆である．
            \item $l_b:V\to W^*$は同型である．
        \end{enumerate}
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] $V,W$の基底を$B,B'$と定めて，$A$を$b$の行列表示として得たとする．命題\ref{prop-characterization-of-matrix-representation-of-bilinar-form}より，これは$r_b$の$B',B^*$に関する表現行列でもあり，$\rank r_b=\rank A$．注\ref{remark-行列というデータ構造}の通り，$\rank l_b=\rank {}^t\!A$．よって，$\rank r_b=\rank l_b$．
        \item[2. (1)$\Leftrightarrow$(2)] $\dim V=\dim V^*=\dim W$の時，$r_b:W\to V^*$が単射であることと可逆であることは同値（命題\ref{prop-when-dimention-is-same}）．
        \item[(1)$\Leftrightarrow$(3)] $b$の$B,B'$に関する行列表示と，$r_b$の$B',B^*$に関する行列表示は等しい（命題\ref{prop-characterization-of-matrix-representation-of-bilinar-form}）から，$A$の可逆性と$r_b$の可逆性は同値．
        \item[(1)$\Leftrightarrow$(4)] 1より，$r_b$が最大ランクであることと$l_b$が最大ランクであることは同値．
    \end{description}
\end{proof}

\subsection{随伴写像}

\begin{proposition}[随伴写像の行列表示は双対写像の行列表示の転置と共軛である]
    $V,W\in\FinVect$，$b:V\times W\to K$を非退化な双線型形式とする．
    $f:V\to V$を線型写像とし，$f^*:W\to W$をその右随伴写像とする．
    $B,B'$をそれぞれ$V,W$の基底とし，$B,B'$に関する$b$の行列表示を$P\in\GL_n(K)$とする．
    $f$の$B$に関する行列表示が$A\in M_n(K)$ならば，$B'$に関する随伴写像$f^*$の行列表示は，
    $P^{-1}{}^t\!AP\in M_n(K)$
    である．
\end{proposition}
\begin{proof}
    $f^*$が$f$の随伴であるとは，$f^*$を双対写像$V^*\to V^*$を表す記号としても混用して，
    \[\xymatrix{
        W\ar[r]^-{r_b}\ar[d]_-{随伴f^*}&V^*\ar[d]^-{f^*双対写像}\\
        W\ar[r]_-{r_b}&V^*
    }\]
    が可換であることより，$f$の右随伴写像は$f^*=r_b^{-1}\circ f^*\circ r_b$と表せる．
    $r_b$の$W,V^*$の基底$B',B^*$に関する行列表示も$P$であるから，$f^*$の行列表示は$P^{-1}{}^t\!AP$である．
\end{proof}
\begin{remarks}\mbox{}
    \begin{enumerate}
        \item $f$の$B\subset V$についての行列表示が$A$ならば，$f^*$の$B^*\subset V^*$についての行列表示は${}^t\!A$である．
        \item 非退化な$r_b$の$B,B'\subset W$についての行列表示が$P\in\GL_n(K)$ならば，$f^*\circ r_b$の行列表示は${}^t\!AP$である．
    \end{enumerate}
\end{remarks}

\begin{proposition}[随伴写像は行列の転置に当たる]
    双線型形式$b:M_{nm}(K)\times M_{mn}(K)\to K$を$b(A,B)=\Tr AB$で定める．
    \begin{enumerate}
        \item $b$は非退化である，即ち$r_b:M_{mn}(K)\to M_{nm}(K)^*$同型である．
        \item $C\in M_n(K)$について，$C$倍写像$C\times:M_{nm}(K)\to M_{nm}(K)$の右随伴写像は，右から$C$をかける写像$\times C:M_{mn}(K)\to M_{mn}(K)$である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $E_{ij}\in M_{mn}(K)$を標準基底とする（$1\le i\le m,1\le j\le n$）．
        \[b(E_{j'i'},E_{ij})=\begin{cases}
            1&(i,j)=(i',j')\\
            0&\mathrm{otherwise}
        \end{cases}\]
        より，$r_b(E_{ij})=b(-,E_{ij})$は$E_{ji}$の双対基底である．基底を基底に写すから，命題\ref{prop-characterization-of-isomorphism}より，$r_b:M_{mn}(K)\to M_{nm}(K)^*$は同型であり，$b$は非退化である．

    \end{enumerate}
\end{proof}
\begin{remarks}
    圏論の場合と違って，随伴写像とは，双線型形式$b$に対して定まるものであるな．
    圏論ほどの普遍性がない．
\end{remarks}

\section{対称形式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=単一空間上の双線型形式を考える]
    線型写像が，部分空間に対して言及するための圧倒的効果を持つことを圏論的に見てきた．
    その力を受け継ぐように，空間上に定められた
    内積の構造は，空間の基底の取り方（正規直交基底の概念）などを基底するだけの基本的対象としてふさわしい．
    内積の表現行列が対角行列になるようなものを直交基底と呼んでいるのであって，直交の概念が先にあるわけではない．
    $b(x,-)$の核として平面の方程式を与えることなど，高校数学ではポピュラーな話題である．
\end{tcolorbox}

\subsection{対称形式と２次形式}

\begin{definition}[symmetric (form), quadratic form]
    $V\in\Vect_K$とする．
    \begin{enumerate}
        \item 双線型形式$b:V\times V\to K$が\textbf{対称的}であるとは，次を満たすことをいう：\[\forall x,y\in V,\;b(x,y)=b(y,x).\]
        \item 写像$q:V\to K$が\textbf{２次形式}であるとは，次が成り立つことをいう：
        \begin{enumerate}[(1)]
            \item $\forall a\in K,\forall x\in V,\;q(ax)=a^2q(x)$．
            \item $b(x,y)=q(x+y)-q(x)-q(y)$によって定まる写像$b:V\times V\to K$は双線型形式である．
        \end{enumerate}
    \end{enumerate}
    この$b$を\textbf{$q$に伴う双線型形式}という．
\end{definition}

\begin{remark}\mbox{}
    \begin{enumerate}
        \item $b(x,x)=4q(x)-q(x)-q(x)=2q(x)$より，$K$の標数が２でなければ$V$の二次形式と$V$の対称形式とは一対一に対応する．
        \item 対称形式については，第一成分と第二成分で非退化になる条件が同値になるから，「非退化」の概念は退化して１つになる．
    \end{enumerate}
\end{remark}

\begin{example}[行列$A$が定める双線型形式]
    $A\in M_n(K)$を対称行列とすれば，これが定める双線型形式$b_A(x,y)={}^t\!xAy$は対称である．
    行列というデータ構造をそう作ったからである．$b_A$が非退化であるための必要十分条件は$A$が可逆であることである．
\end{example}

\begin{example}
    $V=C([0,1])$とすると，次は非退化対称形式である：\[\xymatrix@R-2pc{
        V\times V\ar[r]&\R\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (f,g)\ar@{|->}[r]&\int^1_0f(x)g(x)dx
    }\]
\end{example}

\subsection{直交と非退化対称形式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    （非退化な）対称形式$b:V\times V\to K$に関して，$K$の標数が２でなければ直交基底が存在する（系\ref{cor-existence-of-orthogonal-basis}）．

    零化空間の概念が双対空間の部分空間として安定な概念であった．
    これが対称形式の理論では，直交として引き継がれる．
    命題\ref{prop-Hermite-diagonalizability}での証明のように，
    標準的な分解は直交の言葉で与えられる．
\end{tcolorbox}

\begin{definition}[orthogonal complement, orthonormal basis]
    $b$を$V$上の対称形式とする．
    \begin{enumerate}
        \item 部分空間$W\subset V$に対し，$W^\perp = \{ x\in V\mid \forall y\in W,\;b(x,y)=0 \}$を，\textbf{$W$の$b$に関する直交（補空間）}と言う．$V^\perp$を$b$の\textbf{核}と言う．
        \item $W\subset V$を部分空間とする．$b:V\times V\to K$の制限$W\times W\to K$が定める$W$の双線型形式を$b$の$W$への\textbf{制限}と呼び，$b_W$で表す．
        \item $V$の基底$x_1,\cdots,x_n$に関する$b$の行列表示が対角行列であるとき，$x_1,\cdots,x_n$は\textbf{$b$に関する直交基底}であると言う．$b$の行列表示が単位行列であるとき，$x_1,\cdots,x_n$は\textbf{$b$の正規直交基底}であると言う．
    \end{enumerate}
\end{definition}
\begin{remark}[直交と零化空間，直交の核としての表示]\label{remark-orthogonal-as-kernel}\mbox{}
    \begin{enumerate}
        \item $W\subset V$の$b:V\times V\to K$に関する直交$W^\perp$は，$b$のcurrying $r_b:V\to V^*$
        による零化空間$W^\bot\subset V^*$の逆像$W^\perp=r_b^{-1}(W^\bot)$である．
        $b$が$V$上で定まっているとき$r_b:V\to V^*$は同型になっているから，これは綺麗な同一視である．
        \item 零化空間は包含写像$i:W\to V$の双対$i^*:V^*\to W^*$を用いて$W^\bot=\Ker i^*$と表せたから（注\ref{remark-annihilator-as-kernel}），直交$W^\perp$は合成写像
        \[V\xrightarrow{r_b}V^*\xrightarrow{i^*}W^*\]
        の核である．こっちの方がわかりやすい，直交とは零化空間の「$r_b$による引き戻し」である．
    \end{enumerate}
\end{remark}

\begin{proposition}[空間の直交に沿った分解]\label{prop-decomposition-along-orthogonal-space}
    $V\in\FinVect$とし，$b$をその上の対称形式とする．$W\subset V$を部分空間とし，$b_W:W\times W\to K$をそこへの制限とする．
    \begin{enumerate}
        \item 次の３条件は同値．
        \begin{enumerate}[(1)]
            \item $b_W$は非退化である．
            \item $V=W\oplus W^\perp$．
            \item $W\cap W^\perp=0$．
        \end{enumerate}
        特に，$b$が非退化であることは，$V^\perp=0$によって特徴付けられる．
        \item $b$が非退化ならば，$\dim V=\dim W+\dim W^\perp$．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] $i:W\to V$を包含写像とする．
        \item[(1)$\Rightarrow$(2)]
        直交$W^\perp$は，注\ref{remark-orthogonal-as-kernel}の通り，$i^*\circ r_b:V\to V^*\to W^*$の核である．
        $b_W$が非退化とは，$r_{b_W}:W\to\Hom_K(W,K)$が単射であるから，合成$V\xrightarrow{r_b}V^*\xrightarrow{i^*}W^*$の$W$への制限が同型であるということである．
        標準分解が次の通りだからである：
        \[\xymatrix{
            W\ar[r]^-{r_b}\ar[dr]_-{\overline{r_b}}&V^*\ar[r]^-{i^*}&W^*\\
            &r_b(W)\ar@{.>}[u]_-j\ar[ur]_-{\overline{i^*}}
        }\]
        従って命題\ref{prop-pre-homomorphism-thm}より，$V=W\oplus\Ker (i^*\circ r_b)=W\oplus W^\perp$．
        \item[(2)$\Rightarrow$(3)] は明らか．今回$W,W^\perp\subset V$であるから，$V=W\oplus W^\perp$であって， $V\simeq W\oplus W^\perp$ではない，ということだろうか．内部直和？
        \item[(3)$\Rightarrow$(1)] $W\cap W^\perp$とは，合成$W\xrightarrow{i} V\xrightarrow{r_b}V^*\xrightarrow{i^*}W^*$の核が$0$（単射）ということと同値．
        また$\dim W=\dim W^*$（命題\ref{prop-dimention-of-dual-space}）より，これは次元定理\ref{cor-thm-of-dimention}より，全射でもあるから，従って$r_{b_W}$は可逆である（系\ref{cor-invertible-if-全単射}）．よって，$b_W$は非退化である．
        \item[2.]
        1.より．\footnote{斎藤先生は(1)$\Rightarrow$(2)の議論を部分的に再現している．何故だろうか．内部直和からすぐに$\dim V=\dim W+\dim W^\perp$を結論づけてはいけない理由があるのだろうか．}
    \end{description}
\end{proof}
\begin{remarks}
    思った以上に主張が強い．対象線型形式を備えた空間$(V,b)$は，任意のその上では$b_W$が非退化な部分空間$W$について，それとそれに直交する部分とに分解できる．
\end{remarks}

\begin{corollary}\label{cor-existence-of-orthogonal-basis}
    $V\in\FinVect$とし，$b$をその上の対称形式とする．
    \begin{enumerate}
        \item $W$を$V$の部分空間とし，$W^\perp$をその直交とする．$b,b_W$がいずれも非退化ならば，$b_{W^\perp}$も非退化である．
        \item $K$の標数が$2$でなければ，$b$の直交基底が存在する．
        \item $V=W\oplus W'$かつ$W'\subset V^\perp$とすると，次の２条件は同値である．
        \begin{enumerate}[(1)]
            \item $b_W$が非退化．
            \item $W'=V^\perp$．
        \end{enumerate}
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $b_W$が非退化だから，$V=W\oplus W^\perp$となる．すると，直和の普遍性より，（あるいは単に合成$j^*\circ r_b\circ j$と考えることより）$r_b|_{W^\perp}=j^*\circ r_b\circ j:W^\perp\to W^{\perp*}$も同型である．
        \[\xymatrix{
            W\ar[d]_-i\ar[r]^-{r_b|_W}_-{\sim}&W^*\\
            V=W\oplus W^\perp\ar[r]^-{r_b}_-{\sim}&V^*\ar[u]_-{i^*}\ar[d]^-{j^*}\\
            W^\perp\ar[u]^-j\ar[r]^-{r_b|_{W^\perp}}&W^{\perp*}
        }\]
        \item $\dim V$に関する帰納法で示す．$b=0$ならば任意の基底は直交基底であるから，$b\ne 0$とする．すると，$K$の標数が$2$でないならば，$b(x,x)\ne 0$を満たす$x\in V$が存在する．
        すると，$b|_{Kx}$は非退化だから，命題より$V=Kx\oplus(Kx)^\perp$である．帰納法の仮定より，$(Kx)^\perp$には直交基底がある．これに$x$を加えて延長することで$V$の直交基底を得る．\footnote{対角行列になることを言っていない気がする}
        \item $r_b=r_{b_W}\oplus 0$だから，$\Ker r_b=\Ker r_{b_W}\oplus W'$である．よって，$W'=V\perp$と$r_{b_W}$が非退化であることが同値．
        \[\xymatrix{
            W\ar[r]^-{r_{b_W}}\ar[d]_-i&W^*\\
            V\ar[r]^-{r_b}&V^*\ar[u]_-{i^*}\ar[d]^-{j^*}\\
            W'\ar[u]^-{j}\ar[r]^-0&W'^*
        }\]
    \end{enumerate}
\end{proof}
\begin{remarks}
    先生の記述がすごく雑になっている気がする．
\end{remarks}

\begin{lemma}
    $K$の標数が$2$でないとする．
    $b\ne 0$ならば，$\exists x\in V,\;b(x,x)\ne 0$．
\end{lemma}
\begin{proof}
    $b(x,y)=\frac{1}{2}(b(x+y,x+y)-b(x,x)-b(y,y))$だから，とだけ書いてある．
\end{proof}

\subsection{随伴写像}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    対称形式はcurryingによって同じ写像を作り出すから（$r_b=l_b$），
    対称形式の下では，右随伴写像と左随伴写像が一致する．
\end{tcolorbox}

\begin{definition}[adjoint mapping]
    $V\in\Vect$とし，$b$をその上の非退化対象形式とする．$f\in\End(V)$に対して，
    $r_b=l_b$であるから，右随伴写像$f^*_r$と左随伴写像$f^*_l$が一致する．これを\textbf{随伴写像}という．
    \[\xymatrix{
        V\ar[r]^-{r_b}\ar[d]_-{f_r^*}&V^*\ar[d]^-{f^*}&V\ar[l]_-{l_b}\ar[d]^-{f^*_l}\\
        V\ar[r]^-{r_b}&V^*&V\ar[l]_-{l_b}
    }\]
\end{definition}

\begin{definition}[symmetric transformation, orthogonal transformation]
    $V\in\Vect$とし，$b$をその上の非退化対称形式とする．
    \begin{enumerate}
        \item $f\in\End(V)$が随伴写像$f^*$と等しい時，$f$は$b$に関して\textbf{対称変換}であるという．
        \item $f\in\End(V)$が随伴写像$f^*$の逆写像である時，$f$は$b$に関して\textbf{直交変換}であるという．
    \end{enumerate}
\end{definition}
\begin{remark}
    これが対称行列と直交行列を生み出す理論か！
    随伴写像と双対写像の同一視がなされたら転置の理論も合流して，
    なんと綺麗な模様か．
    $f$に対して，双対写像$f^*:V^*\to V^*$の双対基底に関する行列表示は転置になる．
    随伴写像$f^*:V\to V$の行列表示はさらにその転置と，共軛になる．
    従って確かに対合的に戻ってきていて，$f=f^*$や$f^{*-1}$となる可能性がある．
    しかし，直接図式を可換にする関係があるのは随伴と双対で，随伴と元の$f$とでは使い方の向きが違うと思われる．
\end{remark}

\begin{example}[標準内積]
    $V=K^n$とし，$b:K^n\times K^n\to K$を，単位行列が定める非退化対称形式$b(x,y)={}^t\!xy$とする．
    双対基底が定める同型を$\varphi:V\to V^*$とすると，双対空間の間の$A$倍写像$\times A:V^*\to V^*$の随伴写像は${}^t\!A$倍写像となる．
    \[\xymatrix{
        V\ar[r]^-{r_b=\varphi}\ar@{.>}[d]&V^*\ar[d]^-{A\times}\\
        V\ar[r]_-{r_b=\varphi}&V^*
    }\]
    これは${}^t\!(Ax)y={}^t\!x({}^t\!Ay)$ということである．
    従って，$A$倍写像が対称変換であるための条件は，$A$が対称行列であることと同値である．
    直交変換であるための条件は${}^t\!AA=1$である．これは，$A$の列ベクトル$Ae_1,\cdots,Ae_n$が$K^n$の正規直交基底であることに同値である．\footnote{$b$の表現行列が$1$になることと結びつかない}
\end{example}

\subsection{実数上の対称形式と符号数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    $\FinVect_\R$上の対称形式には，符号数が定まる．
\end{tcolorbox}

\begin{proposition}[直交基底とlaw of inertia]
    $V\in\FinVect_\R$とし，$b$をその上の対称形式とする．
    \begin{enumerate}
        \item $b$に関する直交基底$x_1,\cdots,x_n$であって，$b(x_i,x_i)\in\{0,\pm 1\}\;(i\in[n])$を満たすものが存在する．
        \item (慣性律) $x_1,\cdots,x_n$と$y_1,\cdots,y_n$を$b$に関する直交基底であって，
        \begin{align*}
            b(x_i,x_i)&=\begin{cases}
                1&1\le i\le rのとき,\\
                -1&r<i\le r+sのとき,\\
                0&r+s<i\le nのとき,
            \end{cases}\\
            b(y_i,y_i)&=\begin{cases}
                1&1\le i\le r'のとき,\\
                -1&r'<i\le r'+s'のとき,\\
                0&r'+s'<i\le nのとき,
            \end{cases}
        \end{align*}
        を満たすものとする．このとき，$r=r',s=s'$である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 系\ref{cor-existence-of-orthogonal-basis}.2より，直交基底$x_1,\cdots,x_n\in V$が存在する．$b(x_i,x_i)\ne 0$なる$i\in[n]$に対して，$x_i$を$\frac{x_i}{\sqrt{|b(x_i,x_i)|}}$で置き換えれば良い．
        \item $V$の部分空間を次のように定める．\begin{align*}
            V_+&=\langle x_1,\cdots,x_n\rangle,&V_-&=\langle x_{r+1},\cdots,x_{r+s}\rangle,&V_0&=\langle x_{r+s+1},\cdots,x_n\rangle\\
            V'_+&=\langle y_1,\cdots,y_n\rangle,&V'_-&=\langle y_{r+1},\cdots,y_{r+s}\rangle,&V'_0&=\langle y_{r+s+1},\cdots,y_n\rangle
        \end{align*}
        系\ref{cor-existence-of-orthogonal-basis}.3より，$V_+\oplus V_-$と$V'_+,V'_-$上で$b$は非退化だから，
        $V_0=V'_0=V^\perp$．従って，$\dim V_++\dim V_-=\dim V'_++\dim V'_-=\dim V-\dim V^\perp$．
        
        今，$V_+\supset V_+\cap(V'_-\oplus V^\perp)=0$である．何故なら，この元$x\in V_+\cap(V'_-\oplus V^\perp)$は$x\in V_+$より$b(x,x)\ge 0$で，$x\in V'_-\oplus V^\perp$より$b(x,x)\le 0$なので，$b(x,x)=0$よって$x\in\Ker b=0$である．
        同様に$V_-\supset V_-\cap(V'_+\oplus V^\perp)=0$であるから，
        \begin{align*}
            \dim V_++\dim V'_-&\le\dim V-\dim V^\perp,&\dim V'_++\dim V_-&\le\dim V-\dim V^\perp
        \end{align*}
        ２式の左辺の和は$2(\dim V-\dim V^\perp)$であるから，これは等号が成り立つ．以上より，$\dim V_+=\dim V'_+,\dim V_-=\dim V'_-$
    \end{enumerate}
\end{proof}

\begin{definition}[positive definite, negative definite, signature]
    $V\in\Vect_\R$とし，$b$をその上の対称形式とする．
    \begin{enumerate}
        \item 次が成り立つとき，$b$を\textbf{正定値}という：$\forall x\in V\setminus\{0\},\;b(x,x)>0$．$-b$が正定値であることを，\textbf{負定値}であるという．
        \item 命題の条件を満たす$b$に関する直交基底$B=(x_1,\cdots,x_n)$について，自然数の対$(r,s)\in\N^2$のことを，$b$の\textbf{符号数}という．
        \item $b$の符号数が$(r,s)$であるとは，$b$を次のように表現する$V$の基底が存在するということである：\[\begin{pmatrix}1_r&0&0\\0&1_s&0\\0&0&0\end{pmatrix}\]
        \item 従って，$b$が正定値とは，符号数が$(\dim V,0)$であり，$b$を単位行列に表現する$V$の基底が存在するような非退化対称形式をいう．
    \end{enumerate}
\end{definition}

\section{エルミート形式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    $\C$の内積を考える．すると，「対称」の語が「エルミート」となり，「直交」の語が「ユニタリー」となる．
    自然を説明する力が増すのと同時に，用語にも神秘性が帯びる．
    これは，$V$の共軛を考えることで双線型形式に帰着される，
    双線型性を複素共役によって崩した概念である．
    でも何故か対称行列の方がHermite共軛の退化した概念だと思えるのが複素数の不思議なところである．
    対角化の理論はエルミート形式において決着する．
    右側が崩れていることがHom関手の流儀と異なる点が気になる．
\end{tcolorbox}

\subsection{エルミート形式の定義}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    Hermite形式とは，双線型写像$V\times V_\C\to\C$のことである．
    これについての随伴の表現行列は$\o{{}^t\!A}$となる．
\end{tcolorbox}

\begin{definition}[hermitian form, adjoint matrix, hermitian matrix]
    $V\in\Vect_\C$とする．
    \begin{enumerate}
        \item 写像$h:V\times V\longrightarrow\mathbb{C}$が\textbf{エルミート形式}であるとは，次の条件を満たすことを言う．
        \begin{enumerate}[(1)]
            \item $\forall x,x',y\in V \hspace{3mm} [h(x+x',y)=h(x,y)+h(x',y)]$
            \item $\forall x,y,y'\in V \hspace{3mm} [h(x,y+y')=h(x,y)+h(x,y')]$
            \item $\forall a\in\mathbb{C}, x,y\in V \hspace{3mm} [h(ax,y)=h(x,\overline{a}y)=ah(x,y)]$
            \item $\forall x,y\in V \hspace{3mm} h(y,x)=\overline{h(x,y)}$
        \end{enumerate}
        \item $A\in M_n(\mathbb{C})$に対して，$A^*=\overline{{}^t\!A}$と置き，これを$A$の\textbf{随伴行列}と呼ぶ．$A\in M_n(\mathbb{C})$が$A=A^*$を満たす時，$A$は\textbf{エルミート行列}であると言う．
    \end{enumerate}
\end{definition}

\begin{example}[Hermite行列が定めるHermite形式]
    $A$をHermite行列とする．次の写像$h_A$はHermite形式である：
    \[\xymatrix@R-2pc{
        h_A:\C^n\ar[r]&\C^n\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (x,y)\ar@{|->}[r]&{}^t\!xA\overline{y}
    }\]
    $h_A$が正定値であることを，Hermite行列$A$が正定値であるという．
\end{example}

\begin{example}[対称形式の複素化]
    $V\in\Vect_\R$とし，$b$をその上の対称形式とする．複素化$V_\C$上の写像$h$を
    \[\xymatrix@R-2pc{
        h:V_\C\times V_\C\ar[r]&\C\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (x+iy,x'+iy')\ar@{|->}[r]&b(x,x')+b(y,y')+i(b(y,x')-b(x,y'))
    }\]
    で定めると，$h$はHermite形式である．このHermite形式$h$を対称行列$b$の\textbf{複素化}と呼ぶ．
    $b$が正定値なら，$h$も正定値になる．
\end{example}

\begin{definition}[Hermite形式とHermite行列]\mbox{}\label{def-matrix-representation-of-Hermitian-forms}
    \begin{enumerate}
        \item $h:V\times V\to\C$を$\C$-線型空間$V$上のHermite形式とする．$V$の基底$B=(x_1,\cdots,x_n)$に対し，Hermite行列
        \[A=\begin{pmatrix}h(x_1,x_1)&\cdots&h(x_1,x_n)\\\vdots&\ddots&\vdots\\h(x_n,x_1)&\cdots&h(x_x,y_n)\end{pmatrix}\in M_{n}(\C)\]
        を，$h$の基底$B$に関する行列表示という．
        \item $g:\C^n\to V$を基底$B$が定める同型として，$x,y\in\C,\;h(g(x),g(y))={}^t\!xA\overline{y}$となる．
        \item $P\in\GL_n(\C)$を$B$から$B'$への底の変換行列とする．基底$B'$に関する$h$の行列表示は${}^t\!PA\overline{P}$である．
        \item $A$が単位行列であると聞い，$x_1,\cdots,x_n$を正規直交基底という．
        \item 次の写像は可逆である：\[\xymatrix@R-2pc{
            \{V上の\mathrm{Hermite}形式\}\ar[r]&\{A\in M_n(\C)\mid Aは\mathrm{Hermite}行列\}\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            h_A\ar@{|->}[r]&A
        }\]
        \item $\R$-線型写像$r_h:V\to V^*$を\[\xymatrix@R-2pc{
            V\ar[r]&V^*\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            x\ar@{|->}[r]&h(x,-)
        }\]
        と定めると，$r_h(ay)=\overline{a}r_h(y)$である．
    \end{enumerate}
\end{definition}

\subsection{Hermite変換，unitary変換}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    この共軛の概念が随伴写像より先に歴史的に出現したのだろうか．
    源霊性を此処に感じる．
\end{tcolorbox}

\begin{definition}[adjoint, hermitian / self adjoint transformation, unitary transformation]
    $V\in\Vect_\C$とし，$h$をその上のHermite形式とする．
    \begin{enumerate}
        \item $\R$-線型写像$r_h:V\to V^*$が単射である時，$h$は\textbf{非退化}であるという．
        \item 非退化Hermite形式$h$について，$h(f(x),y)=h(x,g(y))$であるとき，$g$を$f$の\textbf{随伴写像}または\textbf{共軛}ともいい，双対写像と同様$f^*$と表す．
        \item $h$が非退化であるとする．$V$の自己準同型$f$が随伴写像$f^*$と等しい時，$f$は$h$に関して\textbf{エルミート変換}または\textbf{自己共軛変換}という．$f^*$が$f$の逆写像であるとき，$f$は$h$に関して\textbf{ユニタリ変換}であるという．
    \end{enumerate}
\end{definition}
\begin{remark}[随伴写像の行列表示]
    非退化Hermite形式$h$の行列表示が$A\in\GL_n(\C)$で，自己準同型$f$の行列表示を$C\in M_n(\C)$とする．
    この時，随伴写像$f^*$の行列表示は$\overline{A}^{-1}C^*\overline{A}\in M_n(\C)$である．

    随伴写像の$f^*$記号は，Hermite共軛からきたのだろうか．はたまたその逆だろうか．
\end{remark}
\begin{remark}[Hermite変換，unitary変換]\mbox{}
    \begin{enumerate}
        \item $f$がHermite変換であるための条件は$\forall x,y\in V,\; h(f(x),y)=h(x,f(y))$が成り立つことである．
        \item $V$が有限次元である時，$f$がunitary変換であるための条件は$\forall x,y\in V,\;h(f(x),f(y))=h(x,y)$が成り立つことである．
    \end{enumerate}
\end{remark}
\begin{remark}
    \begin{quote}
        $\C$-線型空間$V$の共軛を考えると，Hermite形式を双線型形式として調べることができる．
    \end{quote}
\end{remark}

\begin{example}[標準内積]
    $V=\C^n$とする．$h:\C^n\times\C^n\to\C$を単位行列が定める正定値Hermite形式$h(x,y)={}^t\!x\overline{y}$とする．
    この時，$h(Ax,y)=h(x,A^*y)$より，$A$倍写像の随伴写像は$A^*$倍写像である．
    $A$倍写像がHermite変換であるためには，$A=A^*$を満たすHermite行列であれば良い．
    $A$倍写像がunitary変換であるためには，$A^*A=1$であれば良い．この時，$A$は\textbf{ユニタリ行列}であるという．
    $A$がユニタリ行列であるための条件は，$Ae_1,\cdots,Ae_n$が$\C^n$の正規直交基底であることである．\footnote{毎度のことながらここだけがわからない．}
\end{example}

\subsection{対角化の理論}\label{subsec-可換性と対角化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    自己準同型の対角化の理論を内積空間にて深化させる．
    その順序は，
    Hermite形式が備わった空間から一般理論を始めて，
    対称形式の備わった空間での理論に退化させる．
    此処でも複素数の神秘性とは一体何なのであろうか．
    複素化とは一体なんだろうか．

    この一般論より，
    Hermite変換はunitary行列により一斉対角化可能である．
    正規行列，実対称変換
    はそれぞれ，unitary行列，実直交行列を用いて対角化できる．
    互いに可換なものを選べば一斉対角化可能である．
    こうすると，可換性がもう一歩解った気がする．
\end{tcolorbox}

\begin{proposition}[対角化の抽象理論]\label{prop-Hermite-diagonalizability}
    $V\in\FinVect_\C$とし，$h$を$V$の上の正定値Hermite形式とする．
    $S\subset\End_\C(V)$は，次の２条件を満たすとする．
    \begin{enumerate}[(1)]
        \item $f,g\in S\Rightarrow f\circ g=g\circ f$．
        \item $f\in S\Rightarrow f\circ f^*=f^*\circ f$．
    \end{enumerate}
    この時，$V$の正規直交基底であって，それに関する$f\in S$の行列表示が全て対角行列になるものが存在する．
\end{proposition}
\begin{proof}まず，$S$が(1)と次の(3)を満たすならば結論を満たすことを示す．
    \begin{enumerate}[(1)]\setcounter{enumi}{2}
        \item $f\in S\Rightarrow f^*\in S$．
    \end{enumerate}
    \begin{description}
        \item[(1),(3)$\Rightarrow$結論] 
        $\dim V$に関する帰納法で示す．
        系\ref{cor-existence-of-orthogonal-basis}の対称形式の場合と同様，$V$の直交基底が存在し，これを正規化できる．
        $\dim V\le 1$の時，$S$の元は全てスカラー倍写像であるから，その元の行列表示は全て対角写像である．
        $\dim >2$とする．$f\in S$はスカラー倍でないとすると，$f$のある固有値$a\in\C$について，$W=V_a$を固有空間とすれば，$0\subsetneq W\subsetneq V$である．
        今，$W^\perp$を$W$の直交とすると，任意の$g\in S$について，$W,W^\perp$は$g$-安定だと示す：$\forall g\in S,\;g(W)\subset W,g(W^\perp)\subset W^\perp$．
        \begin{quotation}
            $x\in W,g\in S$とすると，(1)より$f\circ g=g\circ f$だから，$f(g(x))=g(f(x))=g(ax)=ag(x)$より，$g(x)\in W$である．

            $x\in W^\perp,g\in S$とすると，(3)より$g^*\in S$だから，(1)より同様にして，任意の$y\in W$について$g^*(y)\in W$．
            よって，$\forall y\in W,\;h(g(x),y)=h(x,g^*(y))=0$だから，$g(x)\in W^\perp$．
        \end{quotation}
        $\dim W,\dim W^\perp<\dim V$だから，帰納法の仮定より，$W$の基底と$W^\perp$の基底で，それに関する$f\in S$の行列表示が全て対角行列になるようなものが存在する．
        此処で，正定値なHermite形式$h$は非退化で，
        $W$への制限も非退化だから，命題\ref{prop-decomposition-along-orthogonal-space}.1より，$V=W\oplus W^\perp$．
        よって，$W$の基底と$W^\perp$の基底とを並べれば良い．
        \item[命題の(3)を用いた証明]
        $S$が条件(1),(2)を満たすとする．$S^*:=\{f^*\mid f\in S\},\tilde{S}:=S\cup S^*$と置くと，$\tilde{S}$は条件(3)を満たす．
        この$\tilde{S}$は条件(1)も満たすことを示す．
        \begin{quotation}
            $f\in S$とすると，(2)より$S_f:=\{f,f^*\}$は条件(1),(3)を満たすから，$V$の正規直交基底$B$が存在して，$f$の$B$に関する行列表示が$D$となる．
            この時，$f^*$の行列表示は対角行列$D^*=\overline{D}$である．

            $a_1,\cdots,a_m\in\C$を$f$の固有値とすると，$P(a_i)=\overline{a_i}\;(i\in[m])$を満たす多項式$P\in\C[X]$が存在する（補題）．
            この$P$を用いると$P(D)=\overline{D}=D^*$だから，$P(f)=f^*$．
            従って，$g\in S$ならば，自己準同型の合成は分配則を満たすから，
            \[f^*\circ g=P(f)\circ g=g\circ P(f)=g\circ f.\]
            であるから，
            \[f^*\circ g^*=(g\circ f)^*=(f\circ g)^*=g^\circ f^*.\]
            よって，$\tilde{S}$は条件(3)も満たす．
        \end{quotation}
        従って，$\tilde{S}$は命題の結論を満たすから，その部分集合$S\subset\tilde{S}$も命題の結論を満たす．
    \end{description}
\end{proof}
\begin{remarks}
    うん，圧倒的に議論が粗くなっている．
    \begin{enumerate}
        \item 直交は随伴で理解しよう．$h(g(x),y)=h(x,g^*(y))$で，零化空間$h(g(x),-)\in W^\bot$に入っている時，直交に入っている$g(x)\in W^\perp$という．
        \item 後半部分の多項式$P\in\C[X]$を噛ませる証明美しいな！
    \end{enumerate}
\end{remarks}
\begin{lemma}
    $V\subset K[X]$を$n$次以下の多項式全体のなす部分空間とし，$a_0,\cdots,a_n$を相異なる$K$の元とする．
    次の線型写像$F$は同型になる．
    \[\xymatrix@R-2pc{
        F:V\ar[r]&K^{n+1}\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        f\ar@{|->}[r]&{\begin{pmatrix}f(a_0)\\\vdots\\f(a_n)\end{pmatrix}}
    }\]
\end{lemma}

\begin{corollary}[Hermite変換の対角化]
    $V\in\FinVect_\C$とし，$h$をその上の正定値Hermite形式とする．$f\in\End_\C(V)$をHermite変換とする．
    \begin{enumerate}
        \item $f$の固有値は全て実数である．
        \item $V$の正規直交基底であって，その基底に関する$f$の行列表示が実対角行列であるようなものが存在する．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $a\in\C$を$f$の固有値とすると，固有ベクトル$x\in V_a\setminus\{0\}$について，$ah(x,x)=h(ax,x)=h(f(x),x)=h(x,f^*(x))=h(x,f(x))=h(x,ax)=\overline{a}h(x,x)$であるが，$h(x,x)>0$より，$a\in\R$である．
        \item 命題\ref{prop-Hermite-diagonalizability}より，$V$の直交基底であって，それに関するHermite変換$f$の行列表示が全て対角行列であるものが存在する．$f$の固有値が全て実数だから対角成分は全て実数である．
    \end{enumerate}
\end{proof}

\begin{example}[normal matrix]
    $A^*A=AA^*$を満たす行列$A\in M_n(\C)$を\textbf{正規行列}という．
    Hermiteならば正規である．

    互いに可換な正規行列$A_1,\cdots,A_m\in M_n(\C)$は，命題\ref{prop-Hermite-diagonalizability}より，
    unitary行列$U\in M_n(\C)$が存在して一斉に対角化できる．
\end{example}

\begin{remark}
    Hermite行列$A$にい対して，$U^{-1}AU$が対角行列ならば，その成分は全て実数である．
\end{remark}

\begin{proposition}[対称変換の対角化]
    $V\in\FinVect_\R$とし，$b$をその上の正定値対称形式とする．$S\subset\End_\R(V)$は次の２条件を満たすとする．
    \begin{enumerate}[(1)]
        \item $f,g\in S\Rightarrow f\circ g=g\circ f$．
        \item $f\in S$ならば，$f$は$b$に関して対称変換である．
    \end{enumerate}
    この時，$V$の正規直交基底であって，それに関する$f\in S$の行列表示が全て対角行列になるようなものが存在する．
\end{proposition}
\begin{proof}
    $V,b,f$の複素化を$V_\C,b_\C,f_\C$とすると，$h:=b_\C$はHermite形式で，$f_\C$は$h$に関してHermite変換になるから，
    系より固有値は全て実数．従って，$V\ne 0$ならば，$f$の固有値$a\in\R$が存在する．
    以降，命題\ref{prop-Hermite-diagonalizability}と同様に証明できる．
\end{proof}

\begin{example}[対称行列の一斉対角化]
    $A_1,\cdots,A_m\in M_n(\R)$が互いに可換な対称行列ならば，
    命題より，直交行列$T\in M_n(\R)$によって一斉に対角化される．
\end{example}

\section{交代形式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    非退化交代形式の場合は，対称形式の場合（系\ref{cor-existence-of-orthogonal-basis}）
    と違って，$K$の標数に依らずに斜交座標が存在する．
    また，非退化交代形式が存在する空間$V$の次元は必ず偶数である．
\end{tcolorbox}

\begin{definition}[alternating bilinear form, symplectic basis]
    $b:V\times V\to K$を双線型形式とする．
    \begin{enumerate}
        \item $b$が\textbf{交代双線型形式}または\textbf{交代形式}であるとは，次が成り立つことをいう：$\forall x\in V,\;b(x,x)=0$．
        \item $b$を$V$上の交代線型形式とする．$V$の基底$x_1,\cdots,x_{2n}$に関する$b$の行列表示が
        \[\begin{pmatrix}0&1_n\\-1_n&0\end{pmatrix}\in M_{2n}(K)\]
        である時，$x_1,\cdots,x_{2n}$を\textbf{斜交基底}という．
    \end{enumerate}
\end{definition}

\begin{remark}[anti-symmetric form]
    双線型形式$b$が\textbf{反対称形式}であるとは，次を満たすことをいう：$\forall x,y\in V,\;b(x,y)=-b(y,x)$．
    交代形式は反対称形式である．$K$の標数が$2$でない限り，反対称形式は交代形式である．
\end{remark}

\begin{remark}[斜交基底の定義]
    斜交基底の定義は行列表示が$-i=\begin{pmatrix}0&1\\-1&0\end{pmatrix}\in M_2(K)$の$n$個の直和であると定義することも多い．またこの転置でも良い．
\end{remark}

\begin{example}[複素構造の定める非退化交代形式]
    複素構造を$J=\begin{pmatrix}0&1_n\\-1_n&0\end{pmatrix}\in M_{2n}(K)$とする．
    $b(x,y)={}^t\!xJy$と置くと，$b:K^{2n}\times K^{2n}\to K$は非退化交代形式である．
\end{example}

\begin{remark}
    双線型形式が交代形式であるためには，その行列表示が交代行列になることが必要十分である．
    $K^n$上の交代形式と交代行列とは一対一に対応する．
\end{remark}

\begin{proposition}\label{prop-existence-of-symplectic-basis}
    $V\in\FinVect_K$とし，$b:V\times V\to K$を非退化交代形式とする．この時$V$の次元は偶数であり，$V$の斜交基底が存在する．
\end{proposition}
\begin{proof}
    
\end{proof}

\chapter{固有値と固有ベクトル}

\begin{quotation}
    斎藤線形代数の視点から双線型形式の章をまとめ直す．
    というのも，双線型形式とは，「２次形式の係数を与える線型形式である」と捉えると少し直観が効くようになる．
    Riemann計量の考え方もここに返ってくる．
\end{quotation}

\section{固有値と特性根}

\section{ユニタリ空間の正規変換}

\section{実計量空間の対称変換}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    対称変換についてのみ，対角化の問題は実数の範囲から出ず，複素線型空間を必要としない．
    実対称行列はHermiteであるから，固有値は全て実数である．
\end{tcolorbox}

\subsection{定義と特徴付け}

\begin{definition}
    実計量空間$V$の線型変換$T\in\End(V)$が$\forall_{x,y\in V}\;(Tx,y)=(x,Ty)$を満たすとき，$T$を\textbf{対称変換}という．
\end{definition}

\begin{lemma}[特徴付け]
    次の３条件は同値．
    \begin{enumerate}
        \item $T$は対称変換である．
        \item $V$の任意の正規直交基底に関する$T$の行列表示は実対称行列である．
        \item $V$のある正規直交基底に関する$T$の行列表示は実対称行列である．
    \end{enumerate}
\end{lemma}

\subsection{対称変換の定める固有空間分解}

\begin{theorem}
    対称変換$T\in\End(V)$の相異なる固有値を$\beta_1,\cdots,\beta_k$とし，対応する固有空間を$W_1,\cdots,W_k$とする．
    \begin{enumerate}
        \item $W_1,\cdots,W_k$は互いに直交する．
        \item $V=W_1\oplus\cdots\oplus W_k$．
    \end{enumerate}
\end{theorem}

\begin{corollary}
    次の２条件は同値．
    \begin{enumerate}
        \item $T\in\End(V)$は適当な正規直交基底に関して対角行列で表せる．
        \item $T\in\End(V)$は対称変換である．
    \end{enumerate}
\end{corollary}

\begin{corollary}
    実正方行列$A$について，次の２条件は同値．
    \begin{enumerate}
        \item 直交行列$P$が存在して，$P^{-1}AP$は対角行列になる．
        \item $A$は対称行列である．
    \end{enumerate}
\end{corollary}

\subsection{射影子の理論}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    ユニタリ空間の場合と全く並行な議論である．
\end{tcolorbox}

\begin{proposition}[射影子の特徴付け]
    線型変換$P\in\End(V)$について，次の２条件は同値．
    \begin{enumerate}
        \item ある部分空間$W$への射影子である：$P:V=W\oplus W^\perp\epi W$．
        \item $P$は対称変換であり，かつ，$P^2=P$を満たす．
    \end{enumerate}
\end{proposition}

\begin{theorem}[スペクトル分解]
    対称変換$T\in\End(V)$の相異なる固有値を$\beta_1,\cdots,\beta_k$とすると，次の条件を満たす射影子$P_1,\cdots,P_k$が一意的に定まる：
    \begin{enumerate}
        \item $P_1+\cdots+P_k=I$．
        \item $\forall_{i\ne j\in[k]}\;P_iP_j=O$．
        \item $T=\beta_1P_1+\cdots+\beta_kP_k$．
    \end{enumerate}
    逆に，(1),(2)を満たす射影子と実数の組は(3)によって対称変換を定める．
\end{theorem}

\subsection{正定値性}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    正定値というのは，固有値が全て正ということであり，$(Tx,x)> 0$という特徴付けは「どう見ても向きが変わらない」ことを表している．
\end{tcolorbox}

\begin{proposition}
    対称変換$T\in\End(V)$について，次の２条件は同値．
    \begin{enumerate}
        \item 固有値が全て正である．
        \item $\forall_{x\in V\setminus\{0\}}\;(Tx,x)>0$．
    \end{enumerate}この
    同値な条件を満たす対称変換を，\textbf{正定値}という．
\end{proposition}

\begin{example}
    任意の線型変換$T\in\End(V)$に対して，随伴変換との積$T^*T$は半正定値な対称変換である．
    ただし，$T^*$とは，ある正規直交基底に関する$T$の表現行列$A$に対して，${}^tA$で定まる線型変換で，$(T^*x,y)=(x,Ty)$で特徴付けられる．

    実際，
    \[(T^*Tx,y)=(Tx,Ty)=(x,T^*Ty)\]
    より対称であり，$x=y$の場合を考えると，$(Tx,Tx)\ge 0$である．等号成立は$x\in\Ker T$のとき．
    $T$が正則ならば$T^*T$は正定値である．

    特に，$T$が対称変換ならば，$T^2$は半正定値対称変換である．$T$が正則ならば$T^2$は正定値である．
\end{example}

\begin{proposition}
    $T$を正定値対称変換とする．$S^2=T$を満たす正定値対称変換$S$がただ一つ存在する．
    これは正定値を半正定値にしても全く同じことが成り立つ．
\end{proposition}

\subsection{正則変換の分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    実線型空間の正則な直交変換$T\in\GL(V)$は，正定値対称変換と直交変換との積として一意的に表せる．
\end{tcolorbox}

\section{２次形式}

\subsection{定義と変換}

\begin{definition}[quadratic form]
    \[F(x_1,\cdots,x_n)=\sum^n_{i,j=1}a_{ij}x_ix_j\]
    を２次形式といい，$a_{ij}=a_{ji}$の仮定の下で考察する．
    \begin{enumerate}
        \item 係数行列$A:=(a_{ij})$を２次形式$F$の行列という．
        \item これを用いて$F(x)={}^t\!xAx$と表せる．これを対称行列$A$の定める２次形式といい，$A[x]$とも表す．
    \end{enumerate}
\end{definition}

\begin{discussion}[２次形式の変換]
    変数のベクトル$x=(x_1,\cdots,x_n)$と$P\in\GL_n(\R)$について，$x=Py$という変数変換を考える．
    すると，
    \begin{align*}
        G(y)=F(x)&={}^t\!xAx={}^t\!(Py)A(Py)={}^t\!y({}^t\!PAP)y\\
        &=({}^t\!PAP)[y]
    \end{align*}
    より，${}^t\!PAP=:G$の定める２次形式に変換される．
\end{discussion}

\begin{theorem}
    ２次形式$F(x)=A[x]$に対し，ある直交行列$P$が存在して，$x=Py$と$A$の固有値$a_1,\cdots,a_n$に対して
    \[
        F(x)=G(y)=a_1y_1^2+a_2y_2^2+\cdots+a_ny_n^2
    \]
    が成り立つ．
\end{theorem}

\subsection{標準形}

\begin{definition}
    ２次形式$F(x)$の\textbf{標準形}を，$F(x)=H(z)=z_1^2+\cdots+z_p^2-z^2_{p+1}-\cdots-z^2_{p+q}$とする．ただし，$p+q$は$A$の階数である．
\end{definition}

\begin{theorem}[Sylvester's law of inertia (1852)]
    ２次形式の標準形は一意的である．
    すなわち，任意の正則な線型変換について，$p,q$は一定である．
\end{theorem}

\begin{definition}
    実対称行列，等価だが二次形式について，
    \begin{enumerate}
        \item $+1$の数$p$を\textbf{正の慣性指数}といい，$-1$の数$q$を負の慣性指数という．
        \item 組$(p,q)$を二次形式$F(x)=A[x]$の\textbf{符号}という．
        \item 差$\sgn(A):=q-p$を\textbf{符号数}という．
    \end{enumerate}
\end{definition}

\subsection{正定値性}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    結局実対称行列の符号の確定方法には，
    \begin{enumerate}
        \item 特性方程式を解く．一般に一番面倒．
        \item 小行列式を見る．正定値と負定値以外の場合は判別できない．
        \item Lagrangeの方法．平方完成をして標準形を手で作る．才能が必要．
    \end{enumerate}
\end{tcolorbox}

\begin{definition}
    ２次形式$F:\R^n\to\R$について，
    \begin{enumerate}
        \item $\forall_{x\in\R^n\setminus\{0\}}\;F(x)>0$を満たすとき，$F$を\textbf{正定値}という．
        \item 等号も許すとき，半正定値という．
    \end{enumerate}
    $F(x)={}^t\!xAx=(Ax,x)$より，実対称行列$A$に対する定義と同値である．
    さらに，$p=n$と同値．
\end{definition}

\begin{theorem}[小行列式による正値性判定法]
    ２次形式$A[x]$について，次の２条件は同値．
    \begin{enumerate}
        \item $A[x]$は正定値である．
        \item $\forall_{k\in[n]}\;\abs{A_k}>0$．
    \end{enumerate}
\end{theorem}

\begin{corollary}
    ２次形式$A[x]$について，次の３条件は同値．
    \begin{enumerate}
        \item $A[x]$は負定値である．
        \item $(-A)[x]$は正定値である．
        \item $\forall_{k\in[n]}\;(-1)^k\abs{A_k}>0$．
    \end{enumerate}
\end{corollary}

\section{二次曲線および二次曲面}

\subsection{合同変換についての補足}

\section{直交変換とくに三次元空間の回転}

\chapter{ベクトルと行列の解析的取り扱い}

\section{行列値関数の微積分}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    微分幾何っぽくなる．
\end{tcolorbox}

\subsection{定義と基本的な結果}

一般の線型空間値関数$A:\R\supset I\to M_{mn}(\R)$について，微積分が出来る．
成分毎に定めることで，行列係数の冪級数$\sum_{p=0}^\infty B_pt^p$を考えることができ，各成分の収束域内では，これは行列値の解析関数を定め，項別微分が可能である．

\begin{lemma}
    ベクトル値関数$x:\R\to\R^n$が微分可能で，$\norm{x}$が定数ならば，$x(t)$と$x'(t)$は各点$t\in\R$で直交する．
\end{lemma}
\begin{proof}
    関数$\norm{x}^2$は定数だから，
    \[x_1^2(t)+\cdots+x_n^2(t)=c\]
    両辺微分して，
    \[2x_1(t)x'_1(t)+\cdots+2x_n(t)x'_n(t)=2x(t)\cdot x'(t)=0.\]
\end{proof}

\subsection{曲線論}

\begin{example}
    一点からの長さをパラメータとする曲線$x:I\to\R^3$を考える．
    すると，$x'$は定数だから，$x''$と直交する．
    \begin{enumerate}
        \item $x''(t)\ne 0$のとき，$\norm{x''(t)}=:\kappa(t)$を\textbf{曲率}といい，$\frac{1}{\kappa(t)}x''(t)$を\textbf{主法線ベクトル}という．
        曲率は，その瞬間を円運動を見なした際の加速度の大きさの逆数で測るのである．すると，質点の質量と速さを$1$とすると，これは\textbf{円運動の半径にあたる}．
        \item 接線ベクトル$a_1:=x'$と主法線ベクトル$a_2:=a_1'/\kappa$の外積$a_3:=a_1\times a_2$を，\textbf{従法線ベクトル(binormal vector)}という．
        $a_1,a_2,a_3$は$\R^3$の正規直交基底をなす．$a_3'=-\tau a_2$を満たす$\tau$を\textbf{捩率}という．これは，座標系の，$a_1$を中心とした回転の強さを表す．正の捩率は，進行方向に対して，右ねじの方向に対する捩れを表す．
        \item 空間内の曲線は，曲率と捩率の２つの関数を与えられれば，向きを保つ合同変換を除いて一意に定まる．
    \end{enumerate}
\end{example}

\begin{proposition}[Frenet-Serret formula]
    \[(a'_1\;a'_2\;a'_3)=(a_1\;a_2\;a_3)\begin{pmatrix}0&-\kappa&0\\\kappa&0&-\tau\\0&\tau&0\end{pmatrix}\]
\end{proposition}

\section{行列の冪級数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    適当な基底変換を施すことにより，収束半径の中にあるかどうかは固有値について考えれば良い．
\end{tcolorbox}

\subsection{行列の冪級数の収束}

\begin{definition}
    行列$X$の冪級数を$\sum_{p=0}^\infty a_pX^p$と定める．
    これに対応する通常の冪級数$\sum^\infty_{p=0}$の収束半径を$\rho$とする．
\end{definition}

\begin{theorem}
    行列$X$の冪級数$\sum_{p=0}^\infty a_pX^p$は，$X$の固有値の絶対値が$\rho$より小さければ収束する．一つでも固有値の絶対値が$\rho$を越えれば発散する．
\end{theorem}

\subsection{行列の指数関数}

\begin{example}
    指数級数$\sum_{p=0}^\infty\frac{1}{p!}X^p$は全ての行列$X$に対して収束する．この和を$\exp X$で表し，実解析的な写像$M_n(\R)\ni X\mapsto\exp X\in \GL_n(\R)$を行列の指数関数という．
    \begin{enumerate}
        \item $X$の固有値を$\al_1,\cdots,\al_n$とすれば，$\exp X$の固有値は$\exp(\al_1),\cdots,\exp(\al_n)$である．
        \item よって$\det(\exp X)=e^{\Tr X}>0$が成り立ち，特に$\Im\exp\subset\GL_n(\R)$である．
    \end{enumerate}
\end{example}

\begin{remark}
    微分可能な行列値関数$A(t)$が，ある行列$X\in M_n(\R)$に関して
    \[A'(t)=XA(t),\quad A(0)=E\]
    を満たすならば，連立微分方程式系の解の存在定理より，$A(t)=\exp tX$となる．
\end{remark}

\begin{proposition}[加法定理]
    ２つの行列$X,Y$が可換ならば，$\exp(X+Y)=\exp X\cdot\exp Y$．特に，任意の行列$X$について，$\exp(-X)=(\exp X)^{-1}$．
\end{proposition}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item $X$が交代行列ならば，$\exp X$は直交行列である．逆に，任意の$t\in\R$に関して$\exp tX$が直交行列ならば，$X$は交代行列である．
        \item $X$が実対称行列ならば，$\exp X$は正値対称行列である．逆に，任意の$t\in\R$に関して$\exp tX$が実対称行列ならば，$X$は実対称行列である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item ${}^t\!X=-X$ならば，${}^t\!\exp X=\exp{}^t\!X=e^{-X}=(\exp X)^{-1}$より，$\exp X$は直交行列である．逆に，任意の
        $\exp{}^ttX$が全て直交行列ならば，$(\exp t({}^t\!X))(\exp tX)=E$．両辺の$0$における微分係数を比較すれば，${}^t\!X+X=O$を得る．
    \end{enumerate}
\end{proof}

\begin{example}
    $X=\begin{pmatrix}0&-\al\\\al&0\end{pmatrix}$ならば，$X^2=\begin{pmatrix}-\al^2&0\\0&-\al^2\end{pmatrix}$と続いていくから，$\exp X=\begin{pmatrix}\cos\al&-\sin\al\\\sin\al&\cos\al\end{pmatrix}$となる．
    行列式$1$の任意の直交行列は，ある交代行列$X$によって，$\exp X$と表される．
\end{example}

\chapter{群と作用}

\begin{quotation}
    行列表示の標準形は，可逆な行列の共役による作用によって解釈できる．有限次元線型空間の自己準同型$f$の行列表示となる行列全体は，共役類をなす．
\end{quotation}

\section{群とその射}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    群論の応用として圏論を見れば，代数系を除いた殆どの群の例は，automorphism group $\Aut_C(A)$として与えられる．
    これが表現に繋がる．
\end{tcolorbox}

\subsection{群の例}

\begin{example}[addiitive group, multiplicative  group]\mbox{}
    \begin{enumerate}
        \item 体$K$は加法について可換群になる．これを\textbf{体の加法群}と呼ぶ．
        \item $K\setminus\{0\}$は乗法について可換群である．これを\textbf{体の乗法群}と呼び，$(K\setminus\{0\},\cdot)=K^\times$と表す．
    \end{enumerate}
\end{example}

\begin{example}[general linear group]\mbox{}
    \begin{enumerate}
        \item $V\in\Vect_K$とする．$V$の自己同型のなす群を$\GL(V):=\Aut_K(V)$と表す．
        \item $V=K^n$の時，$\GL(K^n)=:\GL_n(K):=\{A\in M_n(K)\mid \det A\ne 0\}$を，$K$係数の$n$次\textbf{一般線型群}という．
        \item $n=0$の時は自明群，$n=1$の時$\GL_1(K)=K^\times$，$n\ge 2$の時非可換群である．
        \item $\GL_n(K)$の元と$K^n$の基底は一対一に対応する．よって，$\GL_n(\F_p)$の位数がわかる．
    \end{enumerate}
\end{example}

\begin{example}[symmetric group, cyclic permutation]\mbox{}
    \begin{enumerate}
        \item 集合$X$に対し，$\Aut_\Set(X)=:\Aut(X)$は群となる．
        \item $X=[n]$の時，$\Aut([n])$を$n$次\textbf{対称群}と呼び，$\mathfrak{S}_n$で表す．
        \item $\mathfrak{S}_n$は有限群であり，位数は$n!$である．$n\ge 3$ならば，非可換群である．
        \item $\tau=(123\cdots k)\in\mathfrak{S}_n$を，$\tau(i)=i+1\;(1\le i\le k-1),\tau(k)=1,\tau(i)=i\;(i\ge k+1)$とする．$\sigma\in\mathfrak{S}_n$に対し，$(\sigma(1)\cdots\sigma(k)):=\sigma(1\cdots k)\sigma^{-1}$を\textbf{巡回置換}という．
    \end{enumerate}
\end{example}

\subsection{群準同型の例}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    行列式，置換の符号も群準同型であるが，
    最後の２つの例である冪と回転が不思議すぎる．
\end{tcolorbox}

\begin{proposition}[演算を保つなら単位元と逆元も保つ]
    $f:G\to H$を群準同型とする．
    \begin{enumerate}
        \item $f(1)=1$．
        \item $f(g^{-1})=f(g)^{-1}$．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $f(1)=f(1\cdot 1)=f(1)\cdot f(1)$である．$f(1)\in H$の逆元$f(1)^{-1}$を両辺に左から掛けて，\[1=f(1)^{-1}(f(1)f(1))=(f(1)^{-1}f(1))f(1)=1\cdot f(1)=f(1).\]
        \item $1=f(1)=f(gg^{-1})=f(g)f(g^{-1})$である．$f(g)\in H$の逆元$f(g)^{-1}$を両辺に左から掛けて，\[f(g)^{-1}=f(g^{-1}).\]
    \end{enumerate}
\end{proof}

\begin{example}[加法群の自己準同型の例]\mbox{}
    \begin{enumerate}
        \item $a$倍写像$K\to K$は，体$K$の加法群の自己準同型である．
        \item $a$倍写像$K\to K$は，$K$-線型空間$V$の加法群の自己準同型である．
        \item $a\in K^\times$ならば，これらは可逆である．
        \item $f_x(a)=ax$と$f:K\to V$を定めると，これは体$K$の加法群から$K$-線型空間$V$の加法群への準同型である．
    \end{enumerate}
\end{example}

\begin{example}[行列式]
    $\det:\GL_n(K)\to K^\times$は群の準同型である．
\end{example}

\begin{example}[置換の符号]\label{example-signature-of-permutation}
    置換の符号は次の群準同型$P:\mathfrak{S}_n\to\GL_n(K)$を用いて行列式で定義したのであった（定義\ref{def-permutation-and-signature}）．
    \begin{enumerate}
        \item 
    \[\xymatrix@R-2pc{
        P:\mathfrak{S}_n\ar[r]&\GL_n(K)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        \sigma\ar@{|->}[r]&P(\sigma):=(e_{\sigma(1)}\cdots e_{\sigma(n)})
    }\]
    は単射な準同型である．
    \item $K$の標数が$2$でなければ，次の準同型$\sgn:\mathfrak{S}_n\to\{\pm 1\}$が引き起こされる．
    \[\xymatrix{
        \mathfrak{S}_n\ar[r]^-P\ar[drr]_-{\sgn}&\GL_n(K)\ar[r]^-{\det}&K^\times\\
        &&\{\pm 1\}\ar[u]_-i
    }\]
    \end{enumerate}
\end{example}

\begin{example}[指数表示という群準同型]
    指数を帰納的に定める．次は群準同型である．
    \[\xymatrix@R-2pc{
        \Z\ar[r]&G\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        n\ar@{|->}[r]&g^n
    }\]
\end{example}

\begin{example}[回転という群準同型]
    \[\xymatrix@R-2pc{
        \R\ar[r]&\GL_2(\R)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        t\ar@{|->}[r]&{\begin{pmatrix}\cos t&-\sin t\\\sin t&\cos t\end{pmatrix}}
    }\]
\end{example}

\section{群の作用}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=圏論に通底する表現の精神]
    集合に対称性があることを，群の集合への作用として定式化できる．
    $X$を群やモノイドや圏などの$\End(Y)$の構造を写しとった代数系，$Y$を集合として，
    $\act:X\times Y\to Y$を$X$の$Y$への作用という．
    これのcurryingは$\widehat{\act}:X\to\End(Y)$となり，
    これは$X\to\Aut(Y)$を定める．これを$X$の$Y$上での表現(representation of $X$ on $Y$)という．
    この「上の」の部分が線型代数（体上の加群）や環上の加群の核心でもある．

    こうして，代数系の源霊性は$\End(Y)$にすべきだとわかる．
    $\End(Y)$に追加の構造を持たせるには，$Y$をアーベル群や線型空間とすれば良い．
    この時，作用$\widehat{\act}:X\to\End(Y)$を加群や表現などという．
    これが，代数系の$F$-代数としての定義である．
    この「表現」「作用」の概念を拡張した概念が「関手」だと言える．
    すると集合の概念も代数系の概念も相対化される．
\end{tcolorbox}

\begin{definition}[act / operate]
    $G\in\Grp,X\in\Set$について，群$G$が集合$X$に\textbf{（左から）作用}するとは，
    演算$G\times X\to X$が存在して次を満たすことをいう：
    \begin{description}
        \item[($1_l$)] $\forall g,h\in G,\forall x\in X,\;(g\cdot h)\cdot x=g\cdot(h\cdot x)$．
        \item[($2_l$)] $\forall x\in X,\;1\cdot x=x$．
    \end{description}
    群$G$が集合$X$に左から作用していることを，$G\curvearrowright X$で表す．
\end{definition}

\begin{remark}[curryingして，$F$-代数として]
    これは，$\act(g,\act(h,x))=\act(g\cdot h,x)$ということである．
    即ち，次が可換である．
    \[\xymatrix{
        G\times G\times X\ar[r]^-{(1,\act)}\ar[d]_-{(\cdot_G,1)}&G\times X\ar[d]^-{\act}\\
        G\times X\ar[r]^-{\act}&G
    }\]
    これは，ある性質を満たす関手を指定していることに等しいらしい．
    この見方からすると，全て関手とは何かの表現に等しい．
\end{remark}

\begin{definition}[関手としての群作用]
    $G\in\Grp$を群とし，これが定める圏を$[G]$で表す．
    これは単一対象圏$[G]=\End_{[G]}(I)$である．
    圏$C$の対象$X\in C$への群$G$の作用とは，$F_C(I)=X$を満たす関手$F:[G]\to C$
    の射写像$F_M:G=\End_{[G]}(I)\to\End_C(X)$が定める群準同型$G\to\Aut_C(X)$のことである．
\end{definition}

\begin{remark}[右作用]
    $G$に構造がなかったり，これが可換群である場合は，右作用も左作用とあまり変わらないが，一般的には大きく違い得る．
\end{remark}

\subsection{作用の例}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    $\GL(V)=\End_K(V)$の作用を３つ，自然な作用，共軛による作用，
    引き戻しによる作用見る．
\end{tcolorbox}

\begin{example}[自然な作用]
    $\GL(V)=\End_K(V)$について，
    \[\xymatrix@R-2pc{
        \GL(V)\times V\ar[r]&V\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (f,x)\ar@{|->}[r]&f\cdot x:=f(x)
    }\]を
    $\GL(V)$の$V$への\textbf{自然な作用}と呼ぶ．

    $V=K^n$とし，$\GL(V)=\simeq\GL_n(K)$と同一視すると，自然な\textbf{左}作用は$(A,x)\mapsto Ax$で定まる．
\end{example}

\begin{example}[共軛による作用]\label{example-action-of-conjugate}
    \[\xymatrix@R-2pc{
        \End_K(V)\times\GL(V)\ar[r]&\End_K(V)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (g,f)\ar@{|->}[r]&g\cdot f=f^{-1}gf
    }\]
    と言う右作用を，$\GL(V)$の$\End(V)$への\textbf{共役による作用}と言う．
\end{example}

\begin{example}[双線型形式への引き戻しによる作用]\mbox{}\label{example-action-of-pullback-bilinear-forms}
    \begin{enumerate}
        \item $V\in\Vect_K$に対して，$B(V)=\{V上の双線型形式b:V\times V\to K\}$と置く．
        \item 双線型形式$b$の$f\in\Aut(V)$による引き戻し$f^*b$を$f^*b(x,y)=b(f(x),f(y))$で定める．
        \[\xymatrix{
            V\times V\ar[r]^-b&K\\
            V\times V\ar[u]^-f\ar@{.>}[ur]_-{f^*b}
        }\]
        \item この時，次の$\GL(V)$の右作用を\textbf{引き戻しによる作用}という．
        \[\xymatrix@R-2pc{
            B(V)\times\GL(V)\ar[r]&B(V)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (b,f)\ar@{|->}[r]&b\cdot f:=f^*b
        }\]
        \item $V=K^n$とした時，次の同型（定義\ref{def-matrix-representation-of-bilinear-forms}）により$M_n(K)\simeq B(K^n)$を同一視すると，この作用は$(A,P)\mapsto {}^t\!PAP$である．
        \[\xymatrix@R-2pc{
            M_n(K)\ar[r]&B(K^n)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            A\ar@{|->}[r]&b_A
        }\]
    \end{enumerate}
\end{example}

\begin{example}[Hermite形式への引き戻しによる作用]\mbox{}\label{example-action-of-pullback-hermitian-forms}
    \begin{enumerate}
        \item $V\in\Vect_\C$に対して，$H(V)=\{V上の\;\mathrm{Hermitian \;form}\;h:V\times V\to\C\}$と置く．
        \item Hermite形式$h$の$f\in\Aut(V)$による引き戻し$f^*h$を$f^*h(x,y)=h(f(x),f(y))$で定める．
        \item この時，次の$\GL(V)$の右作用を\textbf{引き戻しによる作用}という．
        \[\xymatrix@R-2pc{
            H(V)\times\GL(V)\ar[r]&H(V)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (h,f)\ar@{|->}[r]&h\cdot f:=f^*h
        }\]
        \item $V=\C^n$とした時，次の同型（定義\ref{def-matrix-representation-of-Hermitian-forms}）により$\{A\in M_n(\C)\mid Aは\;\mathrm{Hermitian\;matrix}\}=H_n(\C)\simeq H(\C^n)$を同一視すると，この作用は$(A,P)\mapsto {}^t\!PA\overline{P}$である．
        \[\xymatrix@R-2pc{
            H_n(\C)\ar[r]&H(\C^n)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            A\ar@{|->}[r]&h_A
        }\]
    \end{enumerate}
\end{example}

\begin{example}[群の群へのleft translation, 共軛による作用]
    $G$を群とし，$X=G$も群とする．
    \begin{enumerate}
        \item $G$の乗法$\cdot_G$は$G\times X\to X$と見ると，$G$の$X=G$への作用と見れる．これを$G$の\textbf{左移動による作用}という．
        \item $g\in G,x\in X=G$について$g\cdot x=gxg^{-1}$と置くと，再び$X$への作用$G\times X\to X$を定める．これを$G$の\textbf{共軛による作用}という．
    \end{enumerate}
\end{example}

\begin{example}[群の群への作用]
    群の準同型$f:G\to H$は，$g\in G,x\in H$に対して$g\cdot x=f(g)x$と置くことで，$G$の$H$への左作用が定まる．
    \[\xymatrix@R-2pc{
        G\times H\ar[r]^-{(f,1_H)}&H\times H\ar[r]^-{\cdot_H}&H\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (g,x)\ar@{|->}[r]&(f(g),x)\ar@{|->}[r]&f(g)\cdot_Hx
    }\]
    $G=H$で$f=1_G$の時が，$G$の左移動による作用である．
\end{example}

\subsection{作用のcurrying}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    \[\{GのXへの作用\}\to\Hom_\Grp(G,\Aut(X))\]
    が可逆であることを示す．
    ここで，共変Hom関手$g_*$の概念が自然に現れることを見る．圏論の源霊性である．
    Cayleyの世界．圏論で$f\circ g$を$fg$と略するのも，群論の背景があるからなのだろうな．
\end{tcolorbox}

\begin{proposition}
    $G\in\Grp,X\in\Set$とする．
    \begin{enumerate}
        \item $g\in G$に対し，次の写像$g_*$は可逆である．\[\xymatrix@R-2pc{
            g_*:X\ar[r]&X\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            x\ar@{|->}[r]&gx
        }\]
        従って，$g\in G$を$g_*\in\Aut(X)$に写す写像$G\to\Aut(X)$は群準同型である．
        \item $f:G\to\Aut(X)$を群準同型とする．次の写像は$G$の$X$への作用である．\[\xymatrix@R-2pc{
            \cdot:G\times X\ar[r]&X\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (g,x)\ar@{|->}[r]&f(g)(x)
        }\]
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item まず，$\forall g,h\in G,\;(gh)_*=g_*\circ h_*$が成り立つ：$\forall x\in X,\;(gh)_*(x)=(gh)x=g(hx)=g(h_*(x))=g_*\circ h_*(x)$．
        すると，任意の$g\in G$について，$g_*\circ(g^{-1})_*=(g^{-1})_*\circ g_*=1_*=\id_X$だから，$g_*$の逆写像は$(g^{-1})_*$である．よって，$g_*$は可逆である．
        \item \begin{align*}
            gh\cdot x\overset{def}{=}f(gh)(x)&=(f(g)\circ f(h))(x)\\
            &=f(g)(f(h)(x))\\
            &=g\cdot(h\cdot x)
        \end{align*}
        また，$f(1)$は$\Aut(X)$の単位元$\id_X$だから，$1\cdot x\overset{def}{=}f(1)(x)=x$．
    \end{enumerate}
\end{proof}
\begin{remarks}
    この$f:G\to\Aut(X)$ってのが共変関手の概念なんじゃないのか？
\end{remarks}

\begin{example}[対称群の恒等写像]
    対称群の恒等写像$1_{\Aut([n])}:\Aut([n])\to\Aut([n])$は，命題より，$\Aut([n])=\mathfrak{S}_n$の$[n]=\{1,2,\cdots,n\}$への作用のcurryingである．
\end{example}

\subsection{軌道と共軛類}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    行列の共軛類が，まさか群の軌道として定式化できるとは全く非自明だ．
    標準形の理論はこの共軛類に分類した後に，完全代表系としてふさわしい行列を見つけることである．
\end{tcolorbox}

\begin{definition}[orbit, transitive]
    $G$が集合$X$に左から作用するとする．
    \begin{enumerate}
        \item $x\in X$について，$Gx=\{gx\in X\mid g\in G\}$を$x$の\textbf{G軌道}という．
        \item $G$の$X$への作用が\textbf{可移}または\textbf{推移的}であるとは，$\exists x\in X,\;X=Gx$が成り立つことをいう．なおこの時，$\forall x\in X,\;Gx=X$が成り立つ．
    \end{enumerate}
\end{definition}

\begin{example}[回転，平行移動]\mbox{}
    \begin{enumerate}
        \item $G=\R$の$\R^2$への作用を
        \[t\cdot\begin{pmatrix}x\\y\end{pmatrix}=\begin{pmatrix}\cos t&-\sin t\\\sin t&\cos t\end{pmatrix}\begin{pmatrix}x\\y\end{pmatrix}\]
        で定める．$r:=\sqrt{x^2+y^2}\ne  0$ならば，$\begin{pmatrix}x\\y\end{pmatrix}$の$G$-軌道は半径$r$の円である．
        \item $V\in\Vect$について，その部分空間$W$は加法により$V$に作用する．
        $x\in V$の$W$-軌道は$\{x+w\in V\mid w\in W\}$となる．
    \end{enumerate}
\end{example}

\begin{example}[conjugacy class]\mbox{}
    \begin{enumerate}
        \item $\GL_n(K)$の$M_n(K)$への共軛による作用（例\ref{example-action-of-conjugate}）に関する$\GL_n(K)$-軌道を，$M_n(K)$の\textbf{共軛類}と呼ぶ．
        \item $\GL_n(K)$の$M_n(K)$への引き戻しによる右作用（例\ref{example-action-of-pullback-bilinear-forms}）$(P,A)\mapsto{}^t\!PAP$を考える．
        \begin{enumerate}[(a)]
            \item $M_n(K)$の部分集合$\{A\in M_n(K)\mid AはあるVの基底についてのbの行列表示である\}$はこの作用に関する$\GL_n(K)$-軌道である．
            \item $M_n(\R)$の部分集合$\{A\in M_n(\R)\mid Aは対称行列であり，b_Aの符号数は(r,s)である\}$はこの作用に関する$\GL_n(K)$-軌道である．
        \end{enumerate}
        \item $\GL_n(\C)$の$M_n(\C)$への引き戻しによる右作用（例\ref{example-action-of-pullback-hermitian-forms}）$(P,A)\mapsto{}^t\!PA\overline{P}$を考える．
        $M_n(\C)$の部分集合$\{A\in M_n(\C)\mid A正定値\mathrm{Hermite}行列\}$はこの作用に関する$\GL_n(\C)$-軌道である．
    \end{enumerate}
\end{example}

\section{部分群}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    核や像や零化空間に注目するなどの部分空間の手法は，
    部分群の研究だったのか！
    線型空間とは，体という群の拡張の作用だからである．
\end{tcolorbox}

\begin{definition}[subgroup, normal subgroup]
    $G$を群とし，$H\subset G$を部分集合とする．
    \begin{enumerate}
        \item $H$が\textbf{部分群}とは，次の３条件が満たされることをいう．
        \begin{enumerate}[(1)]
            \item （積の閉性）$\forall g,h\in H,\;gh\in H$．
            \item （逆元の閉性）$\forall g\in H,\;g^{-1}\in H$．
            \item （単位元の閉性）$1\in H$．
        \end{enumerate}
        \item 部分群$K$が次も満たす時，これを\textbf{正規部分群}といい，$K\triangleleft G$と書く．
        \item \begin{enumerate}[(1)]\setcounter{enumii}{3}
            \item $\forall g\in G,\forall k\in K,\;gkg^{-1}\in K$．
        \end{enumerate}
        \item $G$が可換ならば任意の部分群は正規である．
    \end{enumerate}
\end{definition}

\subsection{核と像と固定部分群としての部分群}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    非退化な対称形式，エルミート形式，交代形式に対して，直交群，ユニタリ群，斜交群が定義される．
\end{tcolorbox}

\begin{proposition}[kernel, image, stabilizer]\mbox{}
    $f:G\to H$を群準同型とする．
    \begin{enumerate}
        \item $f(G)$は$H$の部分群である．これを$f$の\textbf{像}と呼び，$\Im f$と書く．
        \item fiber $f^{-1}(1)$は$G$の正規部分群である．これを$f$の\textbf{核}と呼び，$\Ker f$と書く．
        \item $G$が集合$X$に左から作用するとする．$x\in X$に対して$G_x=\{g\in G\mid gx=x\}$は$G$の部分群である．これを$x$の\textbf{固定部分群}という．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $g,h\in G$とする．
        \begin{align*}
            \Im f\ni f(gh)&=f(g)f(h)\\
            \Im f\ni f(g^{-1})&=f(g)^{-1}\\
            \Im f\ni f(1_G)&=1_H
        \end{align*}
        \item $f(1)=1$より$1\in f^{-1}(1)$である．$g,h\in f^{-1}(1)$とする．$f(gh)=f(g)f(h)=1\cdot 1=1$より，$gh\in f^{-1}(1)$．$f(g^{-1})=f(g)^{-1}=1^{-1}=1$より，$g^{-1}\in f^{-1}(1)$．続いて，$k\in G$とすると，$f(kgk^{-1})=f(k)1f(k)^{-1}=1$より，$kgk^{-1}\in f^{-1}(1)$．
        \item $1x=x$より$1\in G_x$である．$g,h\in G_x$とする．$(gh)x=gx=x$より，$gh\in G_x$．$x=1x=(g^{-1}g)x=g^{-1}x$より，$g^{-1}\in G_x$である．
    \end{enumerate}
\end{proof}

\begin{example}[special linear group]
    群準同型$\det:\GL_n(K)\to K^\times$の核を\textbf{特殊線型群}と呼び，$\SL_n(K)$で表す．
\end{example}

\begin{example}[alternating group]
    置換の符号$\sgn:\mathfrak{S}_n\to\{\pm 1\}$の核を，$n$次の\textbf{交代群}と呼び，$\mathfrak{A}_n$で表す．
\end{example}

\begin{example}[群の共軛類とcentralizer]群$G$の$X=G$への共軛による作用を考える．
    \begin{enumerate}
        \item $g\in G$の$G$-軌道$\{hgh^{-1}\in G\mid h\in G\}$のことを$g$の\textbf{共軛類}という．
        \item $g\in G$の固定部分群$Z_G(g)=\{h\in G\mid gh=hg\}$を$g$の\textbf{中心化群}という．
    \end{enumerate}
\end{example}

\begin{example}[orthogonal group, special orthogonal group, symplectic group]
    $V\in\FinVect_K$とし，例\ref{example-action-of-pullback-bilinear-forms}の$\GL(V)$の，$V$上の双線型形式全体の空間$B(V)$への引き戻しによる右作用を考える．
    \begin{enumerate}
        \item $b\in B(V)$を非退化対称形式とする．$b$の固定部分群$O(V,b)=O_b(V):=\{f\in\GL(V)\mid \forall x,y\in V,\;b(f(x),f(y))=b(x,y)\}$は，$b$に関する直交変換全体の群となる．これを$b$の\textbf{直交群}という．
        \item $V=K^n$，$b$を標準的な対称形式$b(x,y)={}^t\!xy$とすると，固定部分群は直交行列全体の集合$O_n(V):=O(V,b)=\{A\in\GL_n(K)\mid AA^{-1}=1\}$となる．これを\textbf{$n$次直交群}という．
        \item $\det:O_n(K)\to K^\times$の核$SO_n(K):=O_n(K)\cap\SL_n(K)$を$n$次\textbf{特殊直交群}という．
        \item $V$を偶数次元とする．命題\ref{prop-existence-of-symplectic-basis}より，$B(V)$の非退化交代形式からなる部分集合$A(V)$は$\GL(V)$-軌道である．
        \item 非退化交代形式$b\in B(V)$の固定部分群$Sp(V,b)=Sp_b(V):=\{f\in\GL(V)\mid \forall x,y\in V,\;b(f(x),f(y))=b(x,y)\}$を$b$の\textbf{斜交群}という．
        \item $V=K^{2n}$，$b$を交代行列$J=\begin{pmatrix}0&1_n\\-1_n&0\end{pmatrix}$が定める非退化交代形式とする時，$Sp_{2n}(K):=Sp(V,b)=\{A\in\GL_{2n}(K)\mid {}^t\!AJA=J\}$を\textbf{$2n$次斜交群}という．実は$Sp_{2n}(K)\subset\SL_{2n}(K)$である．
    \end{enumerate}
\end{example}

\begin{example}[unitary group]
    $V\in\FinVect_\C$とし，例\ref{example-action-of-pullback-hermitian-forms}の$\GL(\C)$の，$V$上のHermite形式全体の空間$H(V)$への引き戻しによる右作用を考える．
    \begin{enumerate}
        \item 正定値Hermite形式$h$の固定部分群$U(V,h)=U_h(V):=\{f\in\GL(V)\mid\forall x,y\in V,\;h(f(x),f(y))=h(x,y)\}$は$h$に関するunitary変換全体からなる．これを\textbf{ユニタリ群}という．
        \item $V=\C^n$，$h$を標準的なHermite形式$h(x,y)={}^t\!x\overline{y}$とすると，固定部分群は$U_n:=U(V,h)=\{A\in\GL_n(\C)\mid AA^*=1\}$となる．これを\textbf{$n$次ユニタリ群}という．
        \item $\det:U_n\to\C^\times$の核$SU_n:=U_n\cap\SL_n(\C)$を$n$次\textbf{特殊ユニタリ群}という．
    \end{enumerate}
\end{example}

\subsection{群の位数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    作用について命題を立てると，単なる群の概念よりも射程が広くなる．圏論の祈り？
\end{tcolorbox}

\begin{proposition}
    有限群$G$が有限集合$X$に作用しているとする．$x\in X$に対して，次が成り立つ：\[|Gx|=\frac{|G|}{|G_x|}.\]
\end{proposition}
\begin{proof}
    軌道$Gx$とは次の写像$f$の像$\Im f$である．
    \[\xymatrix@R-2pc{
        f:G\ar[r]&X\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        g\ar@{|->}[r]&gx
    }\]
    各$y\in Gx$に対して，fiber $f^{-1}(y)$の元の個数が固定部分群$G_x$の元の数と等しいことを示す．

    任意に$g\in f^{-1}(y)$とする．即ち$gx=y$．
    この下で，
    \begin{align*}
        g'\in f^{-1}(y)&\Leftrightarrow g'x=y=gx\\
        &\Leftrightarrow g^{-1}g'x=x\\
        &\Leftrightarrow g^{-1}g'\in G_x
    \end{align*}
    より，$f^{-1}(y)=gG_x$と表せる．これはつまり，次の同型を定めたことになる．
    \[\xymatrix@R-2pc{
        g_*:H\ar[r]&f^{-1}(y)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        h\ar@{|->}[r]&gh
    }\]
\end{proof}
\begin{remarks}
    この命題は，次の$\overline{f}$が同型写像であることを言っている．
    \[\xymatrix{
        G\ar[r]^-f\ar[d]_-p&X\\
        G/R_f\ar@{.>}[ur]_-{\overline{f}}
    }\]
\end{remarks}

\begin{corollary}\mbox{}
    \begin{enumerate}
        \item $f:G\to H$を群準同型とし，$G$を有限群であるとする．この時，$|G|=|\Im f|\cdot|\Ker f|$が成り立つ．
        \item $G$を有限群とする．$g\in G$に対し， $|\{Gの共軛類\}|=\frac{|G|}{|Z_G (g)|}$が成り立つ．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $f$が定める$G$の$H$への作用を次のように定める：\[\xymatrix@R-2pc{
            G\times H\ar[r]&H\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (g,h)\ar@{|->}[r]&f(g)h
        }\]
        この時，単位元$e\in H$について，固定部分群が$\Ker f$であり，$G$-軌道$G_e$が$\Im f$である．よって，命題より従う．
        \item $G$の$G$への共軛による作用を考える．この時，元$g\in G$の固定部分群が中心化群$Z_G(g)$であり，$G$軌道$Gg$が$g$の共軛類である．よって，命題より従う．
    \end{enumerate}
\end{proof}

\begin{problem}
    $p$を素数とする．
    \begin{enumerate}
        \item $\GL_2(\F_p)$の共軛類の個数
        \item $\GL_2(\F_p)$の各協約類の元の個数
    \end{enumerate}
\end{problem}

\chapter{商空間}

\begin{quotation}
    部分空間（包含写像）の双対概念が商空間である．
    標準単射が双対写像としては標準全射としてひっくり返るのを，双対空間の章でみた．

    単射というのは$\Im$だけ残して同型であり，全射というのは$\Ker$だけ残して同型な
    線型写像であるというのが，このシリーズを通して重要であった命題\ref{prop-pre-homomorphism-thm}の世界観である．

    部分空間は非常に扱いやすい概念であったが，どうして一転して商空間となると，
    どこか別世界に飛ばされたかのように心細くなるのだろうか．$p$に飛ばされるか$i$に飛ばされるかの違いだが，実はいずれも離陸していない．
    写像の概念．

    なお，通奏低音として商空間$K[X]/(f)$があり，$\deg f=1$の時は$=K$．同伴行列が係数体に退化する時が因数定理と理解できる？
\end{quotation}

\section{well-defined}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    集合の全射に生じる特別な関係を見る．
    これはSetについての消息の特別な場合としてVectに昇華されるだけでなく，
    完全系列の普遍性（命題\ref{proposition-universality-of-exact-sequence}）の
    特別な場合としても示せる．

    つまり，底流するのは，$R_f$という「写像が定める同値関係」の概念が，
    核の概念の母体だったのである．
\end{tcolorbox}

\begin{discussion}[双対性で見る]
    \[\xymatrix{
        &W\ar@{.>}[dl]_-g\ar[dr]^-f\\
        X\ar[rr]^-i&&Y
    }\]
    包含写像$i:X\to Y$に沿ってこの$f:W\to X$が分解することは，制限の逆であり，$f(W)\subset i(X)$という像の間の関係$\Im f\subset \Im i$が必要．
    反対圏を考えると，分解する条件は$\Ker p\subset\Ker f$である．核と余核が逆になり，$i,f$の関係性が逆転する．
\end{discussion}

\begin{corollary}[全射の研究のVectへの持ち上げ]\label{cor-universality-of-quotient-space}
    $V,V',W$を線型空間とし，$p:V\to V'$を全射線型写像とする．
    線型写像$f:V\to W$に対して，次の条件は同値である．
    \begin{enumerate}
        \item $f=g\circ p$を満たす線型写像$g:V'\to W$が存在する．
        \item $\Ker p\subset\Ker f$である．
    \end{enumerate}
    この時の$g$は一意的である．
    \[\xymatrix{
        V\ar@{->>}[r]^-p\ar[dr]_-f&V'\ar@{.>}[d]^-g\\
        &W
    }\]
\end{corollary}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] 
        $\Ker f=\Ker g\circ p=\Ker p\cup p^{-1}(\Ker g)$より．
        \item[(2)$\Rightarrow$(1)] 
        $\Ker p\subset\Ker f$の時，$R_p\subset R_f$であることを示す．$(x,y)\in R_p$即ち$p(x)=p(y)$とする．この時，$p(x-y)=p(x)-p(y)=0$より$x-y\in\Ker p$だから$x-y\in\Ker f$でもあり，$f(x)=f(y)$即ち$(x,y)\in R_f$が従う．
        従って，$g:V'\to W$が存在する．これが線型写像であることを示せば良い．$y,y'\in V',a\in K$を任意に取ると，$p$は全射だから，$x,x'\in V$が存在して$p(x)=y,p(x')=y'$が成り立つ．よって，
        \begin{align*}
            g(y+y')&=g(p(x+x'))=f(x+x')=f(x)+f(x')=g(y)+g(y'),\\
            g(ay)&=g(p(ax))=af(x)=ag(y).
        \end{align*}
    \end{description}
\end{proof}
\begin{remarks}
    ただ一つ存在する$g$というのが，$f,p$が線型写像であるときに線型であるというのが証明の全てである．
    この$g$の一意性が肝である．元々Set上でも一意的なのであるが．
    これはつまり関手が単射であるということだが，Homの上に定まるのも線型写像であるので，核が潰れていると言えるのであろう．
\end{remarks}

\section{商空間の定義}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable, title=商空間とは指定した部分空間に対して全射線型写像に導かれる空間である]
    全射線型写像$p:V\to V'$に対し，$V$の部分空間$\Ker p$が定まる．逆に，
    $W\subset V$を部分空間とすると，これを核とするような全射線型写像$p:V\to V'$が存在する．この時の値域$V'$が商空間$V/W$である．

    この空間の元は，$p$が全射だから，$x\in V$を用いて$p(x)$と表せるようなものである．これを慣例として$\overline{x}$と表す．
    これは各$x\in V$の$W$軌道$Wx\subset V$である．これを\textbf{類}という．
    従って$\overline{x}=\overline{y}$とは同じ軌道に属することだから$x-y\in W=\Ker p$と同値であり，この点において直感的な\textbf{集合論の足場}に着陸させて議論を行う．

    商空間$V/W$の基底は，$W$の基底を$V$に延長したものの像$0,\cdots,0,\overline{x_{m+1}},\cdots,\overline{x_n}$として得られる．
    これは竟に，\textbf{補空間に普遍的な名前がついた}のである．
\end{tcolorbox}

\begin{proposition}[quotient space, canonical surjection,  class]
    $V\in\Vect_K$とし，$W$を部分空間とする．$x\in V$に対して，$\overline{x}$を$x$の$W$-軌道$Wx=\{x+w\in V\mid w\in W\}$とする．これを$x$の\textbf{類}と呼び，これらを集めた集合$V/W$を\textbf{商空間}という．この対応を$p:V\to V/W$とする．
    \begin{enumerate}
        \item $p:V\to V/W$は全射であり，$p(x)=p(y)$は$x-y\in W$と同値である．
        \item 写像$+:V/W\times V/W\to V/W$と$\cdot:K\times V/W\to V/W$で，それぞれ次の図式を可換にするようなものが唯一つ存在する．
        \[\xymatrix{
            V\times V\ar[r]^-+\ar[d]_-{p\times p}&V\ar[d]^-p&K\times V\ar[r]^-{\cdot}\ar[d]_-{\id_K\times p}&V\ar[d]^-p\\
            V/W\times V/W\ar[r]^-+&V/W&K\times V/W\ar[r]^-{\cdot}&V/W
        }\]
        これを$V/W$上の加法とスカラー倍と定めると，代数法則$\overline{x}+\overline{y}:=\overline{x+y},a\overline{x}=\overline{ax}$が成り立つ．
        \item $V/W$はこの加法とスカラー倍について線型空間となる．
        \item 全射$p:V\to V/W$は線型写像である．これを\textbf{標準全射}という．
        \item 標準全射$p:V\to V/W$の核は$W$である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $p$は全射となるように値域$V/W$を定めた．また，値$p(x),p(y)$はそれぞれ$Wx,Wy$と定めたのだから，
        \begin{align*}
            p(x)=p(y)\quad:\Leftrightarrow\quad&x\in Wy\\
            \quad\Leftrightarrow\quad&\exists w\in W,\;y+w=x\\
            \quad\Leftrightarrow\quad&\exists w\in W,\; (x-y)=w\\
            \quad\Leftrightarrow\quad&x-y\in W.
        \end{align*}
        \item 次の線型写像$\cdot:V/W\times V/W\to V/W$の存在を示せば良い：
        \[\xymatrix{
            V\times V\ar[r]^-+\ar[dr]^-{p\circ +}\ar[d]_-{p\times p}&V\ar[d]^-p\\
            V/W\times V/W\ar@{.>}[r]^-+&V/W
        }\]
        いま，$p:V\to V/W$は全射だから，その積も全射である．実際，任意の$(\o{x},\o{y})\in V/W\times V/W$に対して，逆像は空でない：$(p\times p)^{-1}(\o{x},\o{y})\ni (p^{-1}(\o{x}),p^{-1}(\o{y}))$．
        また，$\Ker p\times p=\Ker p\times\Ker p=W\times W$であるが，$\Ker p\circ +=\{(x,y)\in V\times V\mid x+y\in W\}$であり，これは$W\times W$を含んでいるので，$\Ker p\times p\subset\Ker p\circ +$である．
        スカラー倍についても全く同様．
        \item 2.より，$p(x)+p(y)=p(x+y),ap(x)=p(ax)$であるから，$V$が線型空間であることから，$V/W$が線型空間であることも持ち上がる．
        \item 2.の条件が$p$が線型写像であることの公理そのものである．
        \item 定義から，$p(0)=W0=W$である．
    \end{enumerate}
\end{proof}
\begin{remarks}
    流れるような定義である．最初の定義だけで全ての事実が持ち上がる．
    これを媒介するのが圏の言葉で，まるでcalm technology．
    \begin{enumerate}
        \item まず，$p:V\to V/W$を，$p(x)=Wx\;(x\in V)$として定義したら，$\Ker p=W$である．また集合論の翻訳$p(x)=p(y)\Leftrightarrow x-y\in W$も存在する．
        \item すると，ただ一つ自然な加法とスカラー倍の遺伝の仕方がある．このfunctorityの系\ref{cor-universality-of-quotient-space}による翻訳が証明しやすくて鮮やかである．一意性も勝手に従う．
    \end{enumerate}
\end{remarks}

\subsection{商空間の基底}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable, title=商空間とは指定した部分空間に対して全射線型写像に導かれる空間である]
    商空間の基底を考えるにあたっては，商空間は補空間が生成するものだということを前面に押し出す．
    こちらを定義に据えても良かったが，あまり自然ではないだろう．
\end{tcolorbox}

\begin{remark}
    このような構成も，実際の運用は次の同型$p':V'\to V/W$を念頭に行う方が直観が効くだろう．

    なお，商空間$V/W$から$V$へ標準的な単射は見当たらない．
    即ち，内部に言及して還元論的に議論しない限り一般的には射影が見つからない．
\end{remark}

\begin{proposition}
    $V\in\Vect_K$とし，$W$を部分空間とし，$V'$をその補空間とする：$V=W\oplus V'$．標準全射$p:V\to V/W$の$V'$への制限$p':=p|_{V'}:V'\to V/W$は同型である．
\end{proposition}
\begin{proof}
    全射$p:V\to V/W$について，命題\ref{prop-pre-homomorphism-thm}より，
    定義域から$\Ker p=W$を除くと同型が生まれる．
\end{proof}

\begin{corollary}[商空間の基底は，延長したものの像]
    $x_1,\cdots,x_n$を$V$の基底，$x_1,\cdots,x_m$を$W$の基底とすると，
    $\overline{x_{m+1}},\cdots,\overline{x_n}$が$V/W$の基底である．
    従って，$\dim V/W=\dim V-\dim W$．
\end{corollary}
\begin{proof}
    $V':=\langle x_{m+1},\cdots,x_n\rangle$とすれば$V=W\oplus V'$であるから，命題より同型$p|_{V'}:V'\to V/W$が定まる．
    これによる$x_{m+1},\cdots,x_n$の像は$V/W$の基底である．
\end{proof}

\begin{example}[多項式の剰余類]
    $V=K[X]$とし，$f\in K[X]$を$n$次多項式とし，$V'$を$n$次以下の多項式全体のなす部分空間とする．
    いま，$K[X]=(f)\oplus V'$が成り立つから，標準同型$V'\to K[X]/(f)$が得られる．
    特に$f$が一次式の時，$V'=K$となるから，この標準同型は因数定理である．
\end{example}

\begin{proposition}
    $V\in\Vect_K$とする．任意の部分空間$W\subset V$と，これが定める商空間$p:V\to W/V$について，
    写像
    \[\xymatrix@R-2pc{
        f:\{Vの部分空間V'\mid W\subset V'\}\ar[r]&\{V/Wの部分空間\}\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        V'\ar@{|->}[r]&V'/W
    }\]
    は可逆である．
\end{proposition}
\begin{proof}
    $f=p_*$である．実際，$p(V')=\Im p|_{V'}=V'/W$である．
    今回はこれが全単射であること，即ち，$p^*$が逆射となっていることを示す．
    \begin{description}
        \item[$p^*\circ f=\id$] $p^*(V'/W)=V'$は，$p_*(V')=V'/W$の同値命題である（$f(X)=Y\Leftrightarrow X=f^{-1}(Y)$の例という意味で）．
        \item[$f\circ p^*=\id$] $f(p^{-1}(W'))$は，$V':=p^{-1}(W')$とおくと，$W'=p(V')=V'/W$と同値だから，$f(p^{-1}(W'))=V'/W=W'$が従う．
    \end{description}
\end{proof}
\begin{remarks}[$f$は一体どういう関手か？]
    部分空間との双対性がわかりやすい．$W$を一点に潰したのが商空間と思っても納得する命題だし，
    補空間と見てもいいし，$\hat{\C}$の反転のようにも見れる気がする．

    $f$は一体どういう関手か？と思ったが，像写像$p_*$と同一人物か．これが可逆だと言っているのだから，逆写像は$p^*$か．
    これは，Hom関手の零か．
\end{remarks}

\section{商空間と線型写像}\label{sec-quotient-space-and-duality}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable, title=商空間の普遍性]
    前節の商空間の定義で得たものを，射の言葉で表現すると次の通りである．
    $V$上の商空間$V/W$とは，$W\subset\Ker f$となる$f:V\to V'$について，分解するような足場のことである．
    好きに創出する足場．これを\textbf{商空間の普遍性}という．

    $V$は，部分空間$W$とその補空間である商空間$W/V$とに分解して捉える．
    これに対応する双対空間の見方は，$W^*\simeq V^*/W^\bot$と$(V/W)^*\simeq W^\bot$である．
    ここで，双対空間の理論における零化空間の有効性が前面に踊り出る．
\end{tcolorbox}

\subsection{商空間の普遍性}

\begin{proposition}[商空間の普遍性]\label{prop-universality-of-quotient-spaces}
    $V,V'\in\Vect_K$とし，$W$を$V$の部分空間とし，$f:V\to V'$を線型写像とする．
    次の２条件は同値である．
    \begin{enumerate}
        \item $g\circ p=f$を満たす線型写像$g:V/W\to V'$が存在する．
        \item $f(W)=0$である．
    \end{enumerate}
    \[\xymatrix{
        V\ar@{->>}[r]^-p\ar[dr]_-f&V/W\ar@{.>}[d]^-g\\
        &V'
    }\]
    この時，条件を満たす$g:V/W\to V'$は唯一つである．
\end{proposition}
\begin{proof}
    系\ref{cor-universality-of-quotient-space}より，$g:V/W\to V'$の存在条件は$\Ker f\supset\Ker p=W$と同値．
\end{proof}

\begin{corollary}
    さらに$W'$を$V'$の部分空間とし，$p':V'\to V'/W'$を標準全射とする．
    $f(W)\subset W'$ならば，次を可換にする線型写像$g:V/W\to V'/W'$が唯一つ存在する．
    \[\xymatrix{
        V\ar@{->>}[r]^-p\ar[d]_-f\ar@{.>}[dr]&V/W\ar@{.>}[d]^-g\\
        V'\ar[r]^-{p'}&V'/W'
    }\]
\end{corollary}
\begin{proof}
    $p'\circ f$について再び命題を適用すれば良い．
    これは$\Ker p\subset\Ker p'\circ f$ということで，$f(\Ker p)\supset\Ker p'$ということである．
\end{proof}
\begin{remarks}[行列の言葉への翻訳]
    図式には書き込んでいないが，右上から左下に至る対角線が，命題の$g$である．これを$p':V'\to V'/W'$について合成すれば良いので，確かに命題の特別の場合にあたる．

    また，この命題の条件とは，基底をとって考えると，
    \[\xymatrix{
        K^n\ar[dr]^-{x_1,\cdots,x_n}&&&K^{n-m}\ar[dl]_-{\o{x_{m+1}},\cdots,\o{x_n}}\\
        &V\ar[r]^-p\ar[d]^-{\times A}_-f&V/W\ar@{.>}[d]^-{\o{f}}\\
        &V'\ar[r]^-{p'}&V'/W'\\
        K^{n'}\ar[ur]_-{y_1,\cdots,y_{n'}}&&&K^{n'-m'}\ar[ul]_-{\o{y_{m'+1}},\cdots,\o{y_{n'}}}
    }\]
    である．
    \[A=\begin{pmatrix}A_{11}&A_{12}\\A_{21}&A_{22}\end{pmatrix}\quad(A_{11}\in M_{m'm}(K))\]
    と置くと，条件$f(W)\subset W'$とは，$A_{21}=0$に当たる．
    この時，うまく$\Ker p$の元が$\Ker p'$に入り，ちゃんと潰れる．
    こうして，$\o{f}$が存在し，その行列表示は$A_{22}$となる．
\end{remarks}

\begin{definition}[induced linear mapping]\mbox{}
    \begin{enumerate}
        \item 命題の状況下で，$g$を$\overline{f}$と書き，$f$によって\textbf{引き起こされた線型写像}という．可換図式を読むと$\overline{f}(\overline{x})=f(x)$となる．
        \item 系の状況下での$g$も$\overline{f}$と書き，これも$f$によって\textbf{引き起こされた線型写像}という．可換図式を読むと$\overline{f}(\overline{x})=\overline{f(x)}$となる．
    \end{enumerate}
\end{definition}

\begin{example}[companion matrix]\label{example-companion-matrix}
    $f=X^n+a_1X^{n-1}+\cdots+a_{n-1}X+a_n\in K[X]$とし，$V=K[X]/(f)$とする．$f$の剰余類である．
    すると，$X$倍写像$K[X]\to K[X]$が$V$に引き起こす自己準同型$F\in\End_K(V)$の，$V$の基底$\overline{1},\overline{X},\cdots,\overline{X^{n-1}}$に関する行列表示が，多項式$f$の同伴行列である．
    $V$は$\overline{1}$によって生成される$F$-安定部分空間と一致する．まるで「ロケット鉛筆」である．

    各$\overline{1},\overline{X},\cdots,\overline{X^{n-1}}$とは$(f)$-軌道で，ちょうど$n$次以上の項が折り畳まれた状態となる随分見通しの良い商空間である．
\end{example}

\subsection{準同型定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=準同型定理]
    Vectでは，単射は$\Ker f$の退化（命題\ref{prop-characterization-of-monos-in-terms-of-Kernel}），全射は余核$V'\setminus\Im f$の退化（命題\ref{prop-pre-homomorphism-thm}）で表されるから，この２つの
    像と核の言葉で，任意の射$f$から同型を導ける．
    ここに来てこれら２つの命題はお役御免である．

    Set上の標準分解について，$R_f$の役割が$\Ker f$となるのみである．
    そして$R_f$が自明な同値関係であることは，$\Ker f=0$となることに同値で，これが単射であることである．
    全射であるとは$\Coker f$が退化することである．
    これらの表現に完全列が使われたときにはあまりの鮮やかさに卒倒することになる．
\end{tcolorbox}

\begin{proposition}[fundamental theorem on homomorphisms, canonical decomposition]\label{prop-homomorphism-thm}
    $V,V'\in\Vect_K$とし，$f:V\to V'$を$K$-線型写像とする．$f$が引き起こす線型写像$\overline{f}:V/\Ker f\to\Im f$は同型である．
    \[\xymatrix{
        V\ar[r]^-f\ar[d]_-p&V'\\
        V/\Ker f\ar[r]^-{\overline{f}}&\Im f\ar[u]_-i
    }\]
\end{proposition}
\begin{proof}
    任意の$f(x)\in\Im f$に対して，$\overline{x}\in\overline{f}^{-1}(f(x))$であるから，$\overline{f}$は全射である．次に$\Ker\overline{f}=0$を示す．
    任意に$\overline{x}\in\Ker\overline{f}$を取ると$\overline{f}(\overline{x})=0$である．すると，$f(x)=0$である．
\end{proof}
\begin{remarks}
    これが全ての抽象代数学の雛形になるのか．それであって圏論的である．素晴らしく眺めがいい．
    余核，余像の概念もやっとわかる．
\end{remarks}

\begin{remark}[Gilbert Strangによってfundamental theorem of linear algebraとしても教育されている]
    各行列$A\in M_{mn}(K)$によって，次が定まる．
    \begin{tabular}{l|l|l}
        像&$\Im(A)$&列空間\\
        核&$\Ker(A)$&零空間\\
        余像&$\Coim(A)=\Im({}^t\!A)$&行空間\\
        余核&$\Coker(A)=\Ker({}^t\!A)$&
    \end{tabular}
    線型写像$f:V\to W$について，
    \begin{align*}
        V&=\Ker f\oplus\Coim f,&W&=\Im f\oplus\Coker f
    \end{align*}
    が成り立つ．これは次元定理(rank-nullity theorem)を含意する．
    なお，階数とは像の次元であり，退化次数とは核の次元をいい，これについての関係だからrank-nullity theoremという．
    また，この分解は基底に依らない標準的な分解で，ただの補空間ではなく，直交補空間である．
    \begin{align*}
        \Ker A&=(\Coim {}^t\!A)^\bot,&\Im A&=(\Coker {}^t\!A)^\bot
    \end{align*}
    \[\xymatrix{
        V\ar[r]^-f\ar[d]&W\ar[d]\\
        \Coim f:=V/\Ker f\ar[r]&\Im f=:W/\Coker f
    }\]
\end{remark}

\begin{example}[最小多項式再考]
    $V\in\Vect_K,f\in\End_K(V)$とする．
    最小多項式とは，自己準同型$f$の和と積を取ることを考え，まずはその核を定めようとした理論である．
    \begin{enumerate}
        \item $f$-値写像を次のように定める：\[\xymatrix@R-2pc{
            e_f:K[X]\ar[r]&\End_K(V)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            F\ar@{|->}[r]&F(f)
        }\]
        $\Ker e_f\supsetneq 0$とし，$\varphi$を$f$の最小多項式とすると，命題\ref{prop-characterization-of-minimal-polynomial}より，$\Ker e_f=(\varphi)$であり，$\Im e_f=K[f]$である．
        準同型定理により，$e_f$は同型$K[X]/(\varphi)\to K[f]$を定めるから，$\deg\varphi=:d$とすると，$\o{1},\cdots,\o{X^{d-1}}$の$\o{e_f}$による値，即ち，$e_f(1),\cdots,e_f(X^{d-1})$，即ち，
        $1,f,\cdots,f^{d-1}$が$K[f]=\Im e_f$の基底であるとわかる．
        \[\xymatrix{
            K[X]\ar[r]^-{e_f}\ar[d]_-p&\End_K(V)\\
            K[X]/(\varphi)\ar[r]^-{\o{e_f}}&K[f]\ar[u]_-i
        }\]
        \item さらに，次の合成を$e_x:K[X]\to V$とおく：\[\xymatrix@R-2pc{
            K[X]\ar[r]^-{e_f}&\End(V)\ar[r]^-{\ev_x}&V\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            F\ar@{|->}[r]&F(f)\ar@{|->}[r]&F(f)(x)
        }\]
        $W:=\Im e_x$を有限次元とし，$m:=\dim W$を置くと，準同型定理より$\dim K[X]/\Ker e_x=m$もわかる．
        すると，全射$e_x:K[X]\to W$は，$f\in\End(V)$をどんな多項式に代入して$x$-値を取るかによって，$W$上に準同型を定めているから，命題\ref{prop-existence-of-minimal-polynomial}より，$\Ker e_x=(\varphi_x)$を満たすような$m$次のmonicな多項式$\varphi_x$が定まる．
        するとさらに準同型定理より，$x,f(x),\cdots,f^{m-1}(x)$は$W=\Im e_x$の基底である．$f^m(x)=a_1f^{m-1}(x)+\cdots+a_{m-1}f(x)a_mx$と置くと，$\varphi_x=X^m-(a_1X^{m-1}+\cdots+a_{m-1}X+a_m)$である．$W=\Im e_x$は$x$によって生成される$f$-安定部分空間となる．
    \end{enumerate}
    真の応用が出来るほどの理解に至っていない．
\end{example}

\begin{corollary}
    $W,W'$を$V$の部分空間とする．
    \begin{enumerate}
        \item 包含写像$i:W'\to W+W'$が引き起こす写像$W'/(W\cap W')\to(W+W')/W$は同型である．
        \item $W\supset W'$とする．標準写像$V/W'\to V/W$は同型$(V/W')/(W/W')\to V/W$を引き起こす．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{description}
        \item[1.] 基本的には，まず$(W+W')/W$を考えるとこれは$W$の補空間で，$W+W'=(W+W')/W\oplus W$．
        すると$i$は値域$(W+W')/W$の範囲内で全射となる．
        この時の$i$の核は$W\cap W'$であるから，準同型定理により従う．
        \[\xymatrix{
            W'/\Ker\tilde{i}\ar@{.>}[r]^-{\o{i}}&(W+W')/W\ar[d]\\
            W'\ar[u]^-{p}\ar[ur]^-{\tilde{i}}\ar[r]^-i\ar[dr]_-0&W+W'\\
            &W\ar[u]
        }\]
        \item[1'.] 
        \[\xymatrix{
            W'\ar[r]^-i\ar[d]&W+W'\ar[d]^-p\\
            W'/(W\cap W')\ar@{.>}[r]^-{\sim}&(W+W')/W
        }\]
        $p\circ i$は全射であり，核は$W\cap W'$であるから，準同型定理より，同型$W'/(W\cap W')\to(W+W')/W$が定まる．
        確かに，全射性については任意の$\overline{x}$について，代表元$x$をうまく取れば$\exists x\in W,\;p^{-1}(\overline{x})=p(x)$であり，
        単射性については，$x\in W$が$p(i(x))=p(x)=\overline{0}$であることは，$\exists y\in W,\;x+y=0$であることと同値で，これは$x\in W'$でもあることと同値である．
        \item[2.] 写像$V/W'\to V/W$は全射で，その核は$W/W'$であるから，準同型定理より，同型$(V/W')/(W/W')\to V/W$が定まる．
    \end{description}
\end{proof}
\begin{remarks}
    2.について，限られた資源を取り合っていて，$i$が単射なのだから，$p$は全射である．
    \[\xymatrix{
        V/W'\ar[d]_-p\ar[r]&V\ar[d]^-{i\oplus p}&W'\ar[d]^-i\\
        V/W\ar[r]&V&W\ar[l]
    }\]
    $i:W'\to W$が単射の時，$p:V/W'\to V/W$は全射という対応が少し双対っぽい．
\end{remarks}

\subsection{双対命題}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    部分空間と商空間の双対性が，準同型定理$\overline{f}:V/\Ker f\to\Im f$によりはっきり現れる．
    この２つの表裏一体の圏が，準同型定理によって繋がれるのである．
    逆に繋がれないような圏Topは代数系とはまた違う雰囲気を持つ．
    \begin{enumerate}
        \item 部分空間の双対空間は，双対空間の零化空間による商空間と同型である．
        \item 商空間の双対空間は，零化空間と同型である．
    \end{enumerate}
\end{tcolorbox}

\begin{proposition}\label{prop-fundamental-theorem-of-dual-maps}
    $V\in\Vect_K$とし，$W$を部分空間とする．$W$の零化空間$W^\bot$について，次が成り立つ．
    \begin{enumerate}
        \item 包含写像$i:W\to V$の双対写像$i^*:V^*\to W^*$は，同型$V^*/W^\bot\to W^*$を引き起こす．
        \item 標準全射$p:V\to V/W$の双対写像$p^*:(V/W)^*\to V^*$は同型$(V/W)^*\to W^\bot$を定める．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 系\ref{cor-duality-of-dual-map}より$i^*$は全射であり，その核が$W^\bot$であるから，これに準同型定理を適用すれば良い．
        \item 命題\ref{prop-universality-of-quotient-spaces}より，$p^*$の像は$W$を潰す線型形式$f(W)=0$からなる集合$W^\bot$であり，またその対応$p^*$は単射であるから．
    \end{enumerate}
\end{proof}

\begin{definition}[cokernel]
    $K$-線型写像$V\to W$に関して，商空間$W/\Im f$を$f$の\textbf{余核}と呼び，$\Coker f$と表す．
\end{definition}

\begin{definition}[presentation by generators and relations : 生成元と関係式による表示]\label{def-presentation-by-generator-and-its-relation}
    $x_1,\cdots,x_m$を$V$の生成系とすると，全射
    \[\xymatrix@R-2pc{
        F:K^m\ar[r]&V\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (a_1,\cdots,a_m)\ar@{|->}[r]&a_1x_1+\cdots+a_mx_m
    }\]
    が定まる．$f_1,\cdots,f_n\in K^m$を$\Ker F\subset K^m$の生成系とし，
    線型写像$G:K^n\to K^m$を$f_1,\cdots,f_n$で定める：
    \[\xymatrix@R-2pc{
        G:K^n\ar[r]&K^m\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (b_1,\cdots,b_n)\ar@{|->}[r]&b_1f_1+\cdots+b_nf_n
    }\]
    すると$F$は同型$\Coker(G)=K^m/\Im G=K^m/\langle f_1,\cdots,f_n\rangle\to V$を引き起こす．
    この同型$\Coker(G)\xrightarrow{\sim}V$を，$V$の生成元$x_1,\cdots,x_m$と\textbf{関係式}$f_1,\cdots,f_n$による\textbf{表示}という．
\end{definition}
\begin{remarks}[presentation by generators and relationsとは自由生成のことで，自由関手$T$による$T$-代数として定式化できる]
    線型空間$V$を定義したい場合，線型独立かどうかを考慮せず，生成元$x_1,\cdots,x_m$を揃えて
    風呂敷を広げまくってから，これまた線型独立かは考慮しないが潰すべき空間の生成元となる条件$f_1,\cdots,f_n$を揃えて，
    これについて潰す事で，線型空間$V$を得ることをいう．
    これは条件$f_1,\cdots,f_n$が定める線型写像についての余核の構造を用いているから，それを明らかにした形式的定義が上記の議論である．\footnote{A mathematical structure is said to be presented by generators and relations if it is obtained from a structure freely generated by a set of generators by imposing relations among these generators.\url{https://ncatlab.org/nlab/show/generators+and+relations}}
    $G$の存在とは，点だと思っていた$f_1,\cdots,f_n\in K^m$に対して，対応する双対基底としての意味を与えるものである．
\end{remarks}

\subsection{研究}

\begin{proposition}[$\R$の商空間としての構成]
    有理数列の空間$\Q^\N$の収束列のなす部分空間
    $V=\{ x=(x_n)_{n\in\N} \in\Q^\N\mid\lim_{n\to\infty} x_nは収束する \}$
    と$0$に収束する列のなす部分空間
    $W=\{x=(x_n)_{n\in\N}\in\Q^\N\mid\lim_{x\to\infty} x_n=0\}$
    を考える．
    このとき，$x\in V$に対し，$\lim_{n\to\infty}x_n\in\mathbb{R}$を対応させる写像$f:V\longrightarrow \mathbb{R}$は，同型$\overline{f}:V/W\longrightarrow\mathbb{R}$をひきおこす．
    つまり，$W$を核とする標準全射$g:V\longrightarrow V/W\subset V$が存在して，以下の図式は可換になる．
    \[\xymatrix{
        V\ar[d]_-g\ar[dr]^-f\\
        V/W\ar[r]_-{\overline{f}}&\R
    }\]
\end{proposition}


\chapter{テンソル積と外積}

\begin{quotation}
    第5,6章は些かVectの話からは脱線し，
    行列のメディア的なexploitの方法を模索していた．
    テンソル積は，その議論を引き戻す形で，圏Vect上での普遍性の言葉で定義される．
    即ち，多重線型写像のVect内での表現である．\footnote{ずっと可換図式が同じ圏の中に収まらないと思って居たが，縦に考えれば良いのか！}
    \begin{enumerate}
        \item 双線型形式を拡張して，双線型写像を定義する．双線型写像全体の空間は，テンソル積として表せる．
        \item テンソル積$V\otimes W$とは，$V\times W$からの双線型写像が一意的に分解するような空間である．
        \item テンソル積を定める普遍射を考える．
        \item 外積の空間はテンソル積の商として定義される．
    \end{enumerate}
\end{quotation}

\section{双線型写像}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    双線型写像は，双線型形式の拡張であり，圏をなすが，圏論的議論を簡単には受け付けないようになっている．
    ベクトルの和やスカラー倍や行列積は双線型写像である．$e:V\times\Hom(V,W)\to W$も双線型写像である．
    直積の普遍性などは，Vectではどのようになっているのか？
    ここらへんにテンソル積の本質が隠れているのかもしれない．
\end{tcolorbox}

\begin{definition}[bilinear mapping]
    $V,W,V'\in\Vect_K$とする．写像$f:V\times W\to V'$が\textbf{双線型写像}であるとは，次の３条件を満たすことをいう．
    \begin{enumerate}
        \item $\forall x,x'\in V\forall y\in W,\;f(x+x',y)=f(x,y)+f(x',y)$．
        \item $\forall x\in V,y,y'\in W,\;f(x,y+y')=f(x,y)+f(x,y')$．
        \item $\forall a\in K,\forall x\in V,\forall y\in W,\;f(ax,y)=f(x,ay)=af(x,y)$．
    \end{enumerate}
\end{definition}

\begin{example}[少し連続写像みたいな，数学の基調となる模様をなしているのを感じる]\mbox{}
    \begin{enumerate}
        \item 体の乗法$\cdot:K\times K\to K$は$K$-双線型写像である．まさか！\textbf{どうして線型代数は代数の基調をなすのか？}
        \item $K$-線型空間$V$のスカラー倍$\cdot:K\times V\to V$は$K$-双線型写像である．
        \item 行列とベクトルの積$M_n(K)\times K^n\to K^n$は$K$-双線型写像である．
    \end{enumerate}
\end{example}

\begin{proposition}
    $V,W,V',V''\in\Vect_K$とする．写像$f:V\times W\to V'$が双線型形式で，$g:V'\to V''$が線型写像ならば，合成$g\circ f:V\times W\to V''$は双線型写像である．
\end{proposition}
\begin{proof}
    集合論的には，$f,g$の線形性を引き継いで終わりである．
    可換図式で示そうとしたが簡単には示せない．
\end{proof}

\section{テンソル積}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable, title=直積に当たるもの]
    「直和」は集合論的には直積であったが，Vect上にはずっと「直積」のような概念が足りなかった．
    つまり，次の普遍性（命題\ref{prop-distributive-law-in-categorical-sense}）を満たすような概念$\otimes$である：
    \[(V_1\oplus V_2)\otimes W\to(V_1\otimes W)\oplus(V_2\otimes W).\]
    これは濃度の議論で散々見た．現代の「和」「積」の概念は抽象されて，圏論に宿っている．
    またあるいは，$\dim(V\otimes W)=\dim V\cdot\dim W$を満たすような何かである．

    直和の方は，「射の様子が定まれば対象は同型を除いて一意に定まる」という系\ref{cor-characterization-of-isomorphism}と，直和についての命題\ref{prop-characterization-of-direct-sum}よりい，任意の$K$-線型空間$V'$に対し，自然な写像
    \[\Hom(V\oplus W,V')\to\Hom(V,V')\times\Hom(W,V')\]
    で特徴付けられる，一方でテンソル積$V\otimes W$は，任意の$K$-線型空間$V'$に対して，自然な同型
    \[\Hom(V\otimes W,V')\to\mathrm{Bilinear}(V\times W,V')\]
    が存在するように定義する．
\end{tcolorbox}

\begin{history}
    元々は応力tensorの研究から生じた多次元配列というデータ構造である．
    \begin{definition}[stress tensor]
        応力テンソル$T$とは，弾性体$U\subset\R^3$の内部のある曲面$S$にかかる力$F$が$F=\int_ST$として得られるような対象$T$である．
    \end{definition}
    曲面$S$のパラメータ表示$x:\R^2\supset D\to U$を１つ定めれば\footnote{名前を$x$としている！やはり変数$x$とは関手なんだな．}，右辺は
    \[\int_DT\left(x(s,t);\frac{\partial x}{\partial s}\wedge\frac{\partial x}{\partial t}\right)dsdt\]
    となる．
\end{history}

\subsection{テンソル積の定義と普遍性}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    生成の言葉で定義することができる．
    直和の全体空間が$V\times W$だったので，直積の全体空間を広げると$K^{(V\times W)}$となる．
\end{tcolorbox}

\begin{definition}[テンソル積]
    双線型写像の公理が，線型空間の範囲内で実現するように割る．
    これは，$V\times W$の元を適切に同一視することで実現されるが，
    厳密には，形式的基底からなる集合$X$から，それをハメル基底とする線型空間$K^{(X)}$を構成する手法が与えられているので（所感\ref{remarks-K^(X)の構成意志}），
    この言葉で定める．
    \begin{description}
        \item[生成元と関係式による表示（定義\ref{def-presentation-by-generator-and-its-relation}）] \mbox{}\\
        テンソル積$V\otimes W$とは，$V\times W$を生成元の集合とし，関係式を次の３つとすることで得られる：
        \begin{enumerate}[(1)]
            \item $x,x'\in V,y\in W,\;(x+x',y)=(x,y)+(x',y)$．
            \item $x\in V,y,y'\in W,\;(x,y+y')=(x,y)+(x,y')$．
            \item $a\in K,x\in V,y\in W,\;(ax,y)=(x,ay)=a(x,y)$．
        \end{enumerate}
        \item[商空間としての構成] \mbox{}\\
        台空間$K^{(V\times W)}=\{h\in\Hom_K(V\times W,K)\mid h(x,y)\ne 0なる(x,y)\in V\times Wは有限個\}$に対し，次のように部分空間$R_1,R_2,R_3$と定める．標準基底$e_{x,y}$を，$\{(x,y)\}\subset K^{(V\times W)}$の特性関数とする．
        \begin{align*}
            R_1&=\langle e_{x+x',y}-e_{x,y}-e_{x',y}\mid x,x'\in V,y\in W\rangle,\\
            R_2&=\langle e_{x,y+y'}-e_{x,y}-e_{x,y'}\mid x\in V,y,y'\in W\rangle,\\
            R_3&=\langle e_{ax,y}-ae_{x,y},e_{x,ay}-ae_{x,y}\mid a\in K,x\in V,y\in W\rangle.
        \end{align*}
        $R:=R_1+R_2+R_3$についての商空間$K^{(V\times W)}/R$をテンソル積$V\otimes W$という．
    \end{description}
\end{definition}

\begin{proposition}[テンソル積の普遍性による特徴付け]\label{prop-universality-of-tensor-product}
    $V\otimes W:=K^{(V\times W)}/R$とする．
    \begin{enumerate}
        \item 
    次のように定めた写像$\otimes$は双線型である．
    \[\xymatrix@R-2pc{
        \otimes:V\times W\ar[r]&V\otimes W\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (x,y)\ar@{|->}[r]&x\otimes y=\overline{e_{x,y}}
    }\]
    \item 次の条件が成り立つ．
    \begin{quote}
        任意の$K$-線型空間$V'$に対して，次の写像は可逆になる．
        \[\xymatrix@R-2pc{
            \Hom(V\otimes W,V')\ar[r]&\mathrm{Bilinear}(V\times W,V')\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            f\ar@{|->}[r]&b_f
        }\]
        ただし，$b_f(x,y)=f(x\otimes y)$と定めた．
    \end{quote}
    \end{enumerate}
    即ち，普遍双線型写像が存在し，それの反変Hom関手$\otimes^*:\Map(V\otimes W,V')\to\Hom(V\times W,V')$は一般に全射でも単射でもないが，これが引き起こす写像$\otimes^*:\Hom(V\otimes W,V')\to\mathrm{Bilinear}(V\times W,V')$は可逆である．
    \[\xymatrix{
            V\times W\ar[dr]^-g\ar[d]_-{\otimes}\\
            V\otimes W\ar[r]_-f&V'
        }\]
\end{proposition}
\begin{proof}
    まず後者の主張から示す．与えられた集合の同型を，２つに分解して$p^*\circ F:\Hom(V\otimes W,V')\xrightarrow{\sim}\mathrm{Bilinear}(V\times W,V')$のことだと同定する形で示す．
    \begin{description}
        \item[2. 写像が可逆である] 
        $V'\in\Vect_K$を任意に取る．次の写像$F$は，各$(x,y)\in V\times W$の行き先を定めるごとに，基底$e_{x,y}\in K^{(V\times W)}$の行き先が決まるわけであるから，$h\in\Hom(K^{(V\times W)},V')$が一つ定まることを意味する，命題\ref{prop-categorical-basis-infinity}より可逆な写像である．
        \[\xymatrix@R-2pc{
            F:\Hom(K^{(V\times W)},V')\ar[r]^-{\sim}&\Map(V\times W,V')\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            h:K^{(V\times W)}\to V'\ar@{|->}[r]&F(h)(x,y)=:g(x,y)=h(e_{x,y})
        }\]
        標準全射$p:K^{(V\times W)}\to K^{(V\times W)}/R$に対して$p^*:\Hom(K^{(V\times W)}/R,V')\to\Hom(K^{(V\times W)},V')$を反変Hom関手とすると，命題\ref{prop-universality-of-quotient-spaces}よりこれは単射であり，その像は$\Im p^*=\{h\in\Hom(K^{(V\times W)},V')\mid h(R)=0\}$である．
        あとは，$h(R)=0\Leftrightarrow g=F(h)\in\mathrm{Bilinear}(V\times W,V')$を示せば，$F(\Im p^*)=\mathrm{Bilinear}(V\times W,V')$なのだから，$F|_{\Im p^*}\circ p^*$を考えれば，次の図式を可換にする全単射（即ち同型）$\Hom(K^{(V\times W)}/R,V')\to\mathrm{Bilinear}(V\times W,V')$（可逆と示したいところの写像）が定まったこととなる．
        \[\xymatrix{
            \Hom(K^{(V\times W)},V')\ar[r]^-F_-{\sim}&\Map(V\times W,V')\\
            \Hom(K^{(V\times W)}/R,V')\ar[u]^-{p^*}\ar@{.>}[r]^-{\sim ?}&\mathrm{Bilinear}(V\times W,V')\ar[u]_-i
        }\]
        従って，$\Ker h\supset R$と，$F(h)$が双線型写像になることとが同値であることを示す．
        実は，条件$h(R_i)=0\;(i=1,2,3)$が，それぞれ双線型写像の公理(1),(2),(3)に対応する．よって，写像
        \[F\circ p^*:\Hom(V\otimes W,V')\to\mathrm{Bilinear}(V\times W,V')\]
        は可逆である．
        
        この時，テンソル積からの線型写像$f:V\otimes  W\to V'$に対して，対応する双線型写像$F(p^*(f))$とは，
        \[\xymatrix@R-2pc{
            F(p^*(f))=g:V\times W\ar[r]&V'\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (x,y)\ar@{|->}[r]&p^*(f)(e_{x,y})
        }\]
        で，$p^*(f)(e_{x,y})=f(\overline{e_{x,y}})=f(x\otimes y)$であるから，確かに$p^*\circ f=b_f$となっている．
        \[\xymatrix{
            K^{(V\times W)}\ar@{->>}[r]^-p\ar@{.>}[dr]&K^{(V\times W)}/R=V\otimes W\ar[d]^-f\\
            &V'
        }\]
        \item[1. 双線型写像である]
        特に$V'=V\otimes W$，$f=\id_{V\otimes W},h=p$とすれば，対応する双線型写像は$\otimes:V\times W\to V\otimes W$である．
        \[\xymatrix@R-2pc{
            \Hom(V\otimes W,V\otimes W)\ar[r]^-{p^*}&\Hom(K^{(V\times W)},V\otimes W)\ar[r]^-F&\Map(V\times W,V\otimes W)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            \id_{V\otimes W}\ar@{|->}[r]&p\ar@{|->}[r]&F(p)=:\otimes
        }\]
    \end{description}
\end{proof}
\begin{remarks}[テンソル積の普遍性とは]\mbox{}
    \begin{enumerate}
        \item 前半の議論についてであるが，テンソル積から出る射$\Hom(V\otimes W,V')$と双線型写像の圏での射$\mathrm{Bilinear}(V\times W,V')$にどういう仕組みで対応がついたかというと，$f:V\otimes W\to V'$を実現しているのは，この背後にいる線型写像$K^{(V\times W)}\to V'$であり，これに翻訳するのが標準全射$p$の反変Hom関手$p^*:\Hom(K^{(V\times W)}/R,V')\to\Hom(K^{(V\times W)},V')$．
        次にこれを基底の対応に還元すると$V\times W\to V'$を得る．これは直接的には命題\ref{prop-categorical-basis-infinity}によるように見えるが，ここまで含めて$K^{(X)}$という概念装置を使用した意図である．
        すると，綺麗にこの写像は双線型になっているのである（そう定義したので）．一度Set上に引き戻して２つの圏VectとBilinearを結んでいるので議論は少し迂回しているように見えるが，これが今回の定義の方針である．
        普遍構成のみが採用されるべき利点もよくわかるだろう．
        まとめると，$p^*$が後援呼び出し写像（彼が商空間がwell-definedである理由）で，$F$が基底の集合$V\times W$の呼び出し写像．$K^{(V\times W)}$は基底の集合$V\times W$上の有限形式和全体からなる集合である．
        \item テンソル積の普遍性は，双線型写像$V\times W\to V'$を$\Vect_K$に埋め込んだものである．
        $V\times W$をうまく割ることでこれが$\Vect_K$内で実現できるというテクノロジーがある．
        \item テンソル積の普遍性は，商空間の普遍性と基底が定める同型との組み合わせとして理解すると見通しが良いから，この構成をしたのであろう．
        $\otimes$が標準全射のような働きをする（実際には一般には全射でない）のは，実際にそう定義できるからである．$F$は同型であり，自由生成についての関手のようなものに思える．
        \[\xymatrix{
            V\times W\ar@/^1pc/[rr]^-{\otimes}\ar[r]\ar@{.>}[drr]&K^{(V\times W)}\ar@{->>}[r]^-{p}\ar@{.>}[dr]\ar@{=>}@/^1pc/[l]^-{F}&K^{(V\times W)}/R=V\otimes W\ar[d]^-f\ar@{=>}@/^1pc/[l]^-{p^*}\\
            &&V'
        }\]
        これはどの圏の上の図式だろうか．
        テンソルの概念が実用的なのは$R$の割り方がうまく，合成関手$F\circ p^*$による$\Hom_K(V\otimes W,V')$像がちょうど双線型写像になる点である．
        これは図式の外の消息で，事前に$R$が調節してあるわけだ．図式自体はどのように$R$を取っても圏$\Vect_K$上で成り立つ．
    \end{enumerate}
\end{remarks}

\begin{definition}[tensor product, universal bilinear map]
    $V,W\in\Vect_K$とする．
    \begin{enumerate}
        \item $K$-線型空間$V\otimes W$を\textbf{$V$と$W$の$K$上のテンソル積}という．
        \item $(x,y)\in V\times W$に対して，$e_{x,y}\in K^{(V,W)}$の類$x\otimes y\in V\otimes W$を，$x$と$y$の\textbf{テンソル積}という．\footnote{$e_{x+x',y}$の類（$R$-軌道）の中には，$e_{x,y}+e_{x',y}$も含まれるわけだ．こういう同値関係を商空間によって生成して，無理矢理双線型写像の公理を満たすようにしている}
        \item $K$-双線型写像$\otimes:V\times W\to V\otimes W$を\textbf{普遍双線型写像}と呼ぶ．
    \end{enumerate}
\end{definition}

\subsection{分解可能テンソル}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=テンソル積に乗り込む基底]
    普遍双線型写像$\otimes:V\times W\to V\otimes W$は，（振る舞いの似ている標準全射とは違って，）
    一般には全射ではなく（実際$\otimes^*$も始域と終域をそれぞれ線型写像の圏と双線型写像の圏に限らない限り全単射ではない），
    従って$\otimes^*:\Hom(V\otimes W,K)\to\Hom(V\times W,K)$も一般には単射ではない．
    これは圏を跨ぐからであり，この普遍双線型写像は制限して使うものである．
    つまり，線型写像と双線型写像の話に限れば可逆である．
\end{tcolorbox}

\begin{definition}[simple / decomposable tensor]
    テンソル積$V_1\otimes\cdots\otimes V_k$の元$x$が\textbf{単純テンソル}であるとは，
    次を満たすことをいう：
    \[\exists v_i\in V_i(i\in[k]),\;x=v_1\otimes\cdots\otimes v_k.\]
\end{definition}

\begin{proposition}[分解不可能テンソルの存在]
    $V$の基底を$x_1,x_2$，$W$の基底を$y_1,y_2$とする．
    $t=ax_1\otimes y_1+bx_1\otimes y_2+cx_2\otimes y_1+dx_2\otimes y_2\in V\otimes W$について，
    次の２条件は同値である．
    \begin{enumerate}
        \item $t$は分解可能テンソルである．
        \item $ad=bc$である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] $x=\alpha x_1+\beta x_2,y=\gamma y_1+\delta y_2$と置くと，
        \[x\otimes y=\alpha\gamma x_1\otimes y_1+\alpha\delta x_1\otimes y_2+\beta\gamma x_2\otimes y_1+\beta\delta x_2\otimes y_2\]
        となる．この時，$ad=\alpha\beta\gamma\delta=bc$．
        \item[(2)$\Rightarrow$(1)] $a=b=c=d=0$の場合は$t=0\otimes 0$．$a\ne 0$の場合は，
        $t=ax_1\otimes y_1+bx_1\otimes y_2+cx_2\otimes y_1+\frac{bc}{a}x_2\otimes y_2$だから，$t=\frac{1}{a}(ax_1+bx_2)\otimes(ay_1+cy_2)$と表せる．$b\ne 0,c\ne 0,d\ne 0$の場合も同様．
    \end{description}
\end{proof}
\begin{remarks}[平方完成が出来るか＝重解を持つかを判定する判別式の一般化か！]
    要は平方完成であろう，$V,W$の元の積に分解できるかは，剰余項が残るかに他ならない．

    $ad=bc$に関する代数的現象に，偶然の一致を見ている．完全に行列を通過した議論が出来るだろうと思っていたが，こうも直接的とは．
    次元が上がったら，係数行列の行列式$=0$という条件に命題が拡張されるだろうか．
\end{remarks}

\begin{proposition}[decomposable tensorの行き先が定まればテンソル積からの線型写像が定まる]\label{prop-linear-map-from-tensor-product-is-determined-by-basis-destination}
    $V,W,V'\in\Vect_K$とする．線型写像$f,g:V\otimes W\to V'$に対して，次の２条件は同値．
    \begin{enumerate}
        \item $f=g$．
        \item $\forall x\in V,y\in W,\;f(x\otimes y)=g(x\otimes y)$．
    \end{enumerate}
    \[\xymatrix{
        V\times W\ar[r]^-{\otimes}\ar@{.>}[dr]&V\otimes W\ar[d]^-{f,g}\\
        &V'
    }\]
\end{proposition}
\begin{proof}
    2は，普遍双線型写像の反変Hom関手が定める全単射$\otimes^*:\Hom(V\otimes W,V')\to\Hom(V\times W,V')$について，$\otimes^*(f)=\otimes^*(g)$と同値である．
    従って，命題\ref{prop-universality-of-tensor-product}.2より，$\otimes^*$は全単射だから，２つは同値．
\end{proof}
\begin{remarks}[基底と基本テンソルのズレ]
    この命題の肝は，$V\otimes W$の元は$x\otimes y\;(x\in V,y\in W)$の形では尽くされないことである．
    $V\times W$の元を基底として自由生成した（ものを$R$で割った）ためである．
    しかし，その後援である$V\times W$の元は$(x,y)\;(x\in V,y\in W)$で尽くされる．
    従って，これらについて試せば十分である．これを\textbf{分解可能テンソル}という．
    線型空間$V,V'$とその基底$B,B'$に対して，
    テンソル積の基底は$B\times B'$であるから，本当に必要な数はこれよりも少ない．
\end{remarks}

\begin{proposition}[テンソルの非可換条件]
    $x,y\in V$について，次の条件は同値である．
    \begin{enumerate}
        \item $x,y$は一次独立．
        \item $x\otimes y\ne y\otimes x$．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] $x\otimes y=y\otimes x$とすると，命題\ref{prop-tensors}より，$y=ax\land x=a^{-1}y$を得るが，これは$x,y$が一次独立であることに矛盾．よって，$x\otimes y\ne y\otimes x$．
        あるいは直接的には，$x,y$が一次独立の時，$\langle x,y\rangle\otimes\langle x,y\rangle$の基底が$x\otimes x,x\otimes y,y\otimes x,y\otimes y$であるため．
        \item[(2)$\Rightarrow$(1)] 対偶を示す．$x,y$が一次独立の時，$\exists k\in K,\; y=kx$であるから，$x\otimes y=kx\otimes x=y\otimes x$．
    \end{description}
\end{proof}
\begin{remarks}
    $V\otimes W\simeq W\otimes V$が成り立つのだが，一つの空間内では可換条件は上の命題で与えられる．
\end{remarks}

\subsection{テンソル積の基底からの特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=行列の再定義・直和と直積が行列の全てである]
    本義に戻ると，テンソル積とは，２つの線型空間$V,V'$から，その２つの基底$B,B'$同士の直積集合$B\times B'$が自由生成する線型空間$K^{B\times B'}$で，普遍性を満たすもの（生成写像$\otimes$が双線型となるもの）と考えることが出来る（系\ref{cor-the-basis-of-tensor-product}）．
    これはつまり，
    テンソル積を双線型写像の手法で，行列として表示することができる，という理論である．
    前節の構成で，これが達成できているのか，テンソル積という新たに導入したテクノロジーの検証を試みる道は，随分不思議な旅になる，見たことのない景色である．
    
    到達点は，命題\ref{prop-distributive-law-in-categorical-sense}だ．
    この圏論的な普遍構成の上での分配法則が，行列的なものを作っている．
    いや，むしろ，\textbf{これが行列というもの}か．
    これで，テンソル積というテクノロジーと併せて，行列という代数的手法は任意の圏上で
    一般化されたと言えるのではないか？
\end{tcolorbox}

\begin{proposition}\label{prop-column-vector-of-a-matrix}
    $V,W\in\Vect_K$とする．$\dim W=1$とし，$y$を$W$の基底とする．
    \begin{enumerate}
        \item 普遍双線型写像$\otimes:V\times W\to V\otimes W$の固定$f:=-\otimes y:V\to V\otimes W$は同型である．
        \item $\dim V=1$の時，固定$x\otimes -:W\to V\otimes W$も同型である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 双線型写像$(x,ay)\mapsto ax$が定める，次の線型写像$g$が逆写像となっている．
        \[\xymatrix@R-2pc{
            g:V\otimes W\ar[r]&V\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            x\otimes ay\ar@{|->}[r]&ax
        }\]
        実際，$x\in V$について，$g\circ f(x)=g(x\otimes y)=x$である．続いて，$f\circ g=\id_{V\otimes W}$を示す．
        命題\ref{prop-linear-map-from-tensor-product-is-determined-by-basis-destination}より，任意にとった$a\in K,x\in V$に対して$f\circ g(x\otimes ay)=x\otimes ay$を示せば良い．
        実際，$f(g(x\otimes ay))=f(ax)=ax\otimes y=x\otimes ay$である．
        \item 1と同様．
    \end{enumerate}
\end{proof}
\begin{remarks}
    噛み砕けば，$V\times W$は，例え$\dim W=1$としても，集合としては$V$とは同型ではない．
    が，線型空間としては，基底$B\subset V$に対して，$B$の上で自由生成するのと，$B\times\{y\}$の上で自由生成するのとでは，同じである．
    これの表現としての線型写像$g$がこんなに不思議になるのは興味深い．
    それにしても，$\R^2$に対して，$\R\otimes\R$は次元は１なのか．
\end{remarks}

\begin{example}
    体の乗法$\cdot:K\times K\to K$が定める線型写像
    \[\xymatrix@R-2pc{
        K\otimes K\ar[r]&K\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        a\otimes b\ar@{|->}[r]&ab
    }\]
    は同型である．スカラー倍が定める線型写像$V\otimes K\to V,K\otimes W\to W$も同型である．
\end{example}

\begin{definition}[圏論的な意味での部分空間]
    次の命題の写像$i_1,i_2$より，$V',W'$をそれぞれ$V,W$の部分空間として，$V'\otimes W'$を$V\otimes W$の
    部分空間と考えることができる．包含写像に当たる射が取れるからである．構成としては，全く違う商写像の像であるので，とても部分集合とは見做せない集合であることに注意．
\end{definition}

\begin{proposition}[普遍構成の分配法則]\label{prop-distributive-law-in-categorical-sense}
    $V,W\in\Vect$とする．
    \begin{enumerate}
        \item $V=V_1\oplus V_2$の時，次の線型写像は同型である．
        \[\xymatrix@R-2pc{
            f:V\otimes W\ar[r]&(V_1\otimes W)\oplus(V_2\otimes W)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (x_1,x_2)\otimes y\ar@{|->}[r]&(x_1\otimes y,x_2\otimes y)
        }\]
        \item $W=W_1\oplus W_2$の時，次の線型写像は同型である．
        \[\xymatrix@R-2pc{
            f:V\otimes W\ar[r]&(V\otimes W_1)\oplus(V\otimes W_2)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (y_1,y_2)\otimes y\ar@{|->}[r]&(x\otimes y_1,x\otimes y_2)
        }\]
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 結局は和の普遍性である．$i_1,i_2$を標準単射とし，次の２つの線型写像$g_1,g_2$の和を$g_1+g_2=:g:(V_1\otimes W)\oplus(V_2\otimes W)\to V\otimes W$とすると，これが逆写像であると示す．
        \[\xymatrix@R-2pc{
            i_1:V_1\otimes W\ar[r]&(V\otimes W_1)\oplus(V\otimes W_2),&i_2:V_2\otimes W\ar[r]&(V\otimes W_1)\oplus(V\otimes W_2),\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            x_1\otimes y\ar@{|->}[r]&(x_1\otimes y,0)&x_2\otimes y\ar@{|->}[r]&(0,x_2\otimes y)
        }\]
        \[\xymatrix@R-2pc{
            g_1:V_1\otimes W\ar[r]&(V\otimes W_1)\oplus(V\otimes W_2),&g_2:V_2\otimes W\ar[r]&(V\otimes W_1)\oplus(V\otimes W_2),\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            x_1\otimes y\ar@{|->}[r]&(x_1,0)\otimes y&x_2\otimes y\ar@{|->}[r]&(0,x_2)\otimes y
        }\]
        \[\xymatrix{
            V_1\otimes W\ar[dr]^-{g_1}\ar[d]_-{i_1}\\
            (V_1\otimes W)\oplus(V_2\otimes W)\ar[r]^-g&(V_1\oplus V_2)\otimes W\\
            V_2\otimes W\ar[u]^-{i_2}\ar[ur]_-{g_2}
        }\]
        $g\circ f=\id_{(V_1\oplus V_2)\otimes W}$を示す．$x_1\in V_1,x_2\in V_2,y\in W$を任意に取る．$g(f((x_1,x_2)\otimes y))=g(x_1\otimes y,x_2\otimes y)=x_1\otimes y+x_2\otimes y=(x_1+ x_2)\otimes y$．\footnote{斎藤先生が$(x_1+ x_2)\otimes y$も$(x_1,x_2)\otimes y$も混用するのは，内部直和と外部直和を同一視しているからか？いや，定める双線型写像と定まる線型写像とを使い分けているだけですね(1/15/2021)．}

        $f\circ g=\id_{(V\otimes W_1)\oplus(V\otimes W_2)}$を示す．$x_1\in V_1,x_2\in V_2,y\in W$を任意に取る．
        $f(g(x_1\otimes y,0))=f((x_1,0)\otimes y)=(x_1\otimes y,0)$．第二成分についても同じ．
        \item 1と同様．
    \end{enumerate}
\end{proof}
\begin{remarks}[結局直和こそが行列なのである]
    ここに来て，直和に命が吹き込まれる．
    これが行列というものか！と了解された．
\end{remarks}
\begin{remark}[無限分配法則]\label{remark-テンソル積の無限分配法則}
    無限直和のテンソル積には，$(\bigoplus_{i\in I}V_i)\otimes(\bigoplus_{j\in J}W_j)\simeq\bigoplus_{i\in I,j\in J}(V_i\otimes W_j)$が成り立つ．
    しかし無限直積について，$(\prod_{i\in I}V_i)\otimes(\prod_{j\in J}W_j)\to\prod_{i\in I,j\in J}(V_i\otimes W_j)$は一般には同型ではない．
\end{remark}

\begin{corollary}[テンソル空間の基底は基底のテンソル積]\label{cor-the-basis-of-tensor-product}
    $x_1,\cdots,x_n$が$V$の基底で，$y_1,\cdots,y_m$が$W$の基底ならば，$x_1\otimes y_1,\cdots,x_n\otimes y_1,\cdots,x_1\otimes y_m,\cdots,x_n\otimes y_m$は$V\otimes W$の基底である．
    従って，$\dim(V\times W)=\dim V\cdot\dim W$．
\end{corollary}
\begin{proof}
    $W=Ky_1\oplus\cdots\oplus Ky_m$より，命題\ref{prop-distributive-law-in-categorical-sense}より，
    直和分解$V\times W=(V\otimes Ky_1)\oplus\cdots\oplus(V\otimes Ky_m)$が得られる．
    各$j\in[m]$に対して，$x_1\otimes y_j,\cdots,x_n\otimes y$は$V\otimes Ky_j$の基底である（命題\ref{prop-column-vector-of-a-matrix}）．
    よって，これを並べると，$V\otimes W$の基底を得る．
\end{proof}
\begin{remarks}[普遍の語の由来]
    こうして，形式的に$x\otimes y$という記号を導入して，
    基底$B\subset V,B'\subset V'$が生成する空間をテンソル積$V\otimes W$とし，
    最も自由生成なという意味で普遍的な双線型写像$V\times W\to V\otimes W$を考えると，
    これもテンソル積の定義として採用できる．
\end{remarks}

\begin{remark}[数学と物理でのテンソル]
    系より，$V\otimes W$の元は$\sum^n_{i=1}\sum^m_{j=1}a_{ij}x_i\otimes y_j$と表せる．
    物理では係数$(a_{ij})$の方をテンソルと呼ぶことが多い．
\end{remark}

\begin{example}[双線型形式の定める線型写像]
    $x_1,\cdots,x_n$を$V$の基底で，$y_1,\cdots,y_m$を$W$の基底とする．
    双線型形式$b:V\times W\to K$に対して，$A=(a_{ij})\in M_{mn}(K)$をその行列表示とする．
    $b$が定める線型写像を$f:V\otimes W\to K$とすると，$f(x_i\otimes y_j)=a_{ij}$である．
\end{example}
\begin{remarks}
    なるほど！なんだか行列のplace holderみたいだ．
    もちろん正規直交に取れば全部１である．
    テンソルが行列になる理由，反変と共変が数学と物理で違う理由，多分全部ここにある．
\end{remarks}

\subsection{テンソルの変換}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=テンソルの変換]
    テンソル$V\times W$は，$V$の基底変換$P\in\GL_m(K)$と$W$の基底変換$Q\in\GL_n(K)$とに対して，
    $P$に対しては共変に，$Q$に対しては反変に変換される．変換後の係数行列を$B$とすると，$A=PB{}^t\!Q$となる．
\end{tcolorbox}

\begin{proposition}[元の間の対応の研究]\label{prop-tensors}
    $x\in V,y\in W$とする．
    \begin{enumerate}
        \item 次の２条件は同値である．
        \begin{enumerate}[(1)]
            \item $x\otimes y\ne 0$．
            \item $x\ne 0\land y\ne 0$．
        \end{enumerate}
        \item $x\ne 0\land y\ne 0$とする．$x'\in V,y'\in W$に対して，次の２条件は同値．
        \begin{enumerate}[(1)]
            \item $x\otimes y=x'\otimes y'$．
            \item $x'=ax,y'=a^{-1}y$を満たす$a\in K^\times$が存在する．
        \end{enumerate}
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item (1)$\Rightarrow$(2)は対偶が成り立つ．$x=0\lor y=0$の時，$x\otimes y=0(x\otimes y)=0$．
        (2)$\Rightarrow$(1)については，$x\ne 0\land y\ne 0$である時，$x\ne 0$であるから，$x\otimes y\in Kx\otimes W$と見ると，$y\in W$と対応する（命題\ref{prop-column-vector-of-a-matrix}）．$y\ne 0$より，$x\otimes y\ne 0$がわかる．
        \item (1)$\Rightarrow$(2)は，$V=Kx\oplus V',W=Ky\oplus W'$とみて，$x'=ax+x'',y'=by+y''$と置く．
        すると，命題\ref{prop-distributive-law-in-categorical-sense}より，
        \begin{align*}
            x'\otimes y'&=(ax+x'')\otimes(by+y'')\\
            &=abx\otimes y+bx''\otimes y+ax\otimes y''+x''\otimes y''=x\otimes y
        \end{align*}
        であるから，系\ref{cor-the-basis-of-tensor-product}から係数比較をして，$ab=1,x''=0,y''=0$．
        (2)$\Rightarrow$(1)はテンソル積の定義より．
    \end{enumerate}
\end{proof}
\begin{remarks}
    1.はまさか命題\ref{prop-column-vector-of-a-matrix}を経由するとは．
    2.の$x\otimes y=x'\otimes y'$は，同値命題がたくさん思いつくから，この程度の複雑度になったら「式に置く」になるのか．
    なんだか受験数学に戻ってきたようだ．(1)$\Rightarrow$(2)は強い．
\end{remarks}

\begin{proposition}[テンソルの変換]\label{prop-basis-change-of-tensor}
    $x_1,\cdots,x_m\in V$と$x'_1,\cdots,x'_m\in V$を$V$の基底とし，$y_1,\cdots,y_n\in W$と$y'_1,\cdots,y'_n\in W$を$W$の基底とする．
    \begin{itemize}
        \item $P\in\GL_m(K)$を$x_1,\cdots,x_m$から$x'_1,\cdots,x'_m$への底の変換行列とし，
        \item $Q\in\GL_n(K)$を$y_1,\cdots,y_n$から$y'_1,\cdots,y'_n$への底の変換行列とする．
    \end{itemize}
    係数行列$A=(a_{ij}),B=(b_{ij})\in M_{mn}(K)$に対し，次の２条件は同値であることを示せ．
    \begin{enumerate}
        \item $\sum^m_{i=1}\sum^n_{j=1}a_{ij}x_i\otimes y_j=\sum^m_{i=1}\sum^n_{j=1}b_{ij}x'_i\otimes y'_j$．
        \item $A=PB{}^t\!Q$．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}[(a)]
        \item \begin{align*}
            P&=\begin{pmatrix}p_{11}&\cdots&q_{1m}\\\vdots&\ddots&\vdots\\p_{m1}&\cdots&p_{mm}\end{pmatrix},&Q&=\begin{pmatrix}q_{11}&\cdots&q_{1n}\\\vdots&\ddots&\vdots\\q_{n1}&\cdots&q_{nn}\end{pmatrix},
        \end{align*}
        とすると，
        \begin{align*}
            x'_i&=p_{1i}x_1+\cdots+p_{mi}x_m,&y'_j&=q_{1j}y_1+\cdots+q_{nj}y_n
        \end{align*}
        より，
        \begin{align*}
            X':=\begin{pmatrix}x'_1\otimes y'_1&\cdots&x'_m\otimes y'_1\\\vdots&\ddots&\vdots\\x'_1\otimes y'_n&\cdots&x'_m\otimes y'_n\end{pmatrix}&=\begin{pmatrix}x_1\otimes y'_1&\cdots&x_m\otimes y'_1\\\vdots&\ddots&\vdots\\x_1\otimes y'_n&\cdots&x_m\otimes y'_n\end{pmatrix}\underbrace{\begin{pmatrix}p_{11}&\cdots&q_{1m}\\\vdots&\ddots&\vdots\\p_{m1}&\cdots&p_{mm}\end{pmatrix}}_{=P}\\
            &=\underbrace{\begin{pmatrix}q_{11}&\cdots&q_{n1}\\\vdots&\ddots&\vdots\\q_{1n}&\cdots&q_{nn}\end{pmatrix}}_{={}^t\!Q}\begin{pmatrix}x_1\otimes y_1&\cdots&x_m\otimes y_1\\\vdots&\ddots&\vdots\\x_1\otimes y_n&\cdots&x_m\otimes y_n\end{pmatrix}P
        \end{align*}
        であるから，$X'={}^t\!QXP$というテンソル空間$V\otimes W$についての基底変換則を得る．
        これを用いると，
        \begin{align*}
            XA&=X'B\\
            &=({}^t\!QXP)B\\
            &=XPB{}^t\!Q&(この操作は転置だけでは正当化できないのか？)
        \end{align*}
        より，係数行列に注目して，$A=PB{}^t\!Q$．
        \item いま，\begin{align*}
            b_{ij}x'_i\otimes y'_j&=b_{ij}\sum^n_{l=1} q_{lj}x'_i\otimes y_l\\
            &=b_{ij}\sum^m_{k=1}\sum^n_{l=1}p_{ki}q_{lj}x_k\otimes y_l
        \end{align*}
        より，基底$x_k\otimes y_l$の係数を比較して，$a_{kl}=\sum^m_{i=1}\sum^n_{j=1}p_{ki}b_{ij}q_{lj}$．これは$A=PB{}^t\!Q$に同値．
    \end{enumerate}
\end{proof}
\begin{remarks}
    証明(a)は，双対空間との積（もはや内積ではなく完全なる行列積）による表示を使った．
    (b)は各元への還元論に終始した．
\end{remarks}

\subsection{係数拡大}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable ,colbacktitle=ForestGreen!40!white, coltitle=black,fonttitle=\bfseries\sffamily,
    title=空間]
    基底を追えば，ほとんどの空間と双線型写像が，Vect上で表現できていることが分かる．
    テンソル積は些か形式的な構成であるから，意味論を深く考えるよりも基底を追う以上の意味論がない．
\end{tcolorbox}

\begin{example}[複素化とテンソル積：実軸上の点に対する複素線型変換]
    $V\in\Vect_\R$とし，$V_\C$をその複素化とする．
    スカラー倍$\C\times V\to V_\C$は，テンソル積への同型$\C\otimes_\R V\to V_\C$を定める．
    \[\xymatrix{
        \C\times V\ar[r]^-{\otimes}\ar[dr]_-{\cdot}&\C\otimes_\R V\ar@{.>}[d]\\
        &V_\C
    }\]
    例\ref{example-complexification}の複素数的な技巧的な構成は，普遍双線型写像$\otimes$に吸収されて，テンソル積として形式的に再構成されるわけである．
    こうして，複素化とは，体の包含射に沿った係数体の拡大である．
\end{example}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item $K$を体とする．$K[X]\otimes K[Y]\simeq K[X,Y]$である．
        \item $\C\otimes_\R[X]\simeq\C[X]$である．
    \end{enumerate}
\end{proposition}
\begin{proof}
    多項式空間の基底を考えることより，$K[X]=\bigoplus^\infty_{n=0}KX^n$であることが分かる．
    \begin{enumerate}
        \item 次が同型であることを示す．\[\xymatrix@R-2pc{
            f:K[X]\otimes K[Y]\ar[r]&K[X,Y]\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            f\otimes g\ar@{|->}[r]&fg
        }\]
        注\ref{remark-テンソル積の無限分配法則}より，
        \begin{align*}
            K[X]\otimes K[Y]&=\paren{\bigoplus^\infty_{n=0}KX^n}\otimes\paren{\bigoplus^\infty_{n=0}KY^n}\\
            &=\bigoplus_{n=0}^\infty\bigoplus_{m=0}^\infty KX^n\otimes Y^m
        \end{align*}
        である．$K[X,Y]$の基底も$X^nY^m$であるから，$f$は基底$X^n\otimes Y^m$と$X^nY^m$とが定める同型である．

        \item 次が同型であることを示す．\[\xymatrix@R-2pc{
            g:\C\otimes_\R\R[X]\ar[r]&\C[X]\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            a\otimes f\ar@{|->}[r]&af
        }\]
        注\ref{remark-テンソル積の無限分配法則}より，実数の複素化は複素数である$\C\otimes_\R\R=\R_\C=\C$ということに注意して，
        \begin{align*}
            \C\otimes_\R\R[X]&=\C\otimes_\R\paren{\bigoplus^\infty_{n=0}\R X^n}\\
            &\cong\bigoplus^\infty_{n=0}\C\otimes_\R\R X^n=\bigoplus^\infty_{n=0}\C X^n=\C[X]\footnote{全部イコールで繋ぐのはまずいという鶴崎さんからの指摘}
        \end{align*}
        より．途中の同型は，基底$1\otimes X^0,\cdots,1\otimes X^n,\cdots,i\otimes X^0,\cdots,i\otimes X^n,\cdots\in\C\otimes_\R\paren{\bigoplus^\infty_{n=0}\R X^n}$と$X^0,\cdots,X^n,\cdots,iX^0,\cdots,iX^n,\cdots\in\bigoplus^\infty_{n=0}\C X^n$とが定める同型であることから従う．
    \end{enumerate}
\end{proof}
\begin{remarks}
    $K[X]\otimes K[Y]$の基底は$X^n\otimes Y^m\;(n,m\ge 0)$．
\end{remarks}

\section{線型写像のテンソル積}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    
\end{tcolorbox}

\subsection{線型写像のテンソル積とその行列表示}

\begin{definition}[tensor product]
    $f:V\to V',g:W\to W'$に対して，次の線型写像を$f$と$g$の\textbf{テンソル積}$f\otimes g$という：
    \[\xymatrix@R-2pc{
        V\otimes W\ar[r]&V'\otimes W'\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        x\otimes y\ar@{|->}[r]&f(x)\otimes g(y)
    }\]
\end{definition}

\begin{proposition}[行列のテンソル積]\label{prop-tensor-product-of-matrices}
    $f:V\to V',g:W\to W'$を線型写像とする．
    \begin{enumerate}
        \item $\Ker(f\otimes g)=(\Ker f\otimes W)+(V\otimes\Ker g)$である．
        \item $\Im(f\otimes g)=(\Im f)\otimes(\Im g)$である．$\Im f,\Im g$が有限次元ならば，$\Im(f\otimes g)$も有限次元で，$\rank(f\otimes g)=\rank f\cdot\rank g$である．
        \item $V,V',W,W'$を有限次元とし，$f:V\to V'$の基底$x_1,\cdots,x_n\in V$と$y_1,\cdots,y_m\in V'$に関する行列表示を$A\in M_{mn}(K)$とし，$g:W\to W'$の基底$x'_1,\cdots,x'_{n'}\in W$と$y'_1,\cdots,y'_{m'}\in W'$に関する行列表示を$B\in M_{m'n'}(K)$とする．
        この時，$f\otimes g:V\otimes W\to V'\otimes W'$の，基底$x_1\otimes x'_1,\cdots,x_n\otimes x'_1,\cdots,x_1\otimes x'_{n'},\cdots,x_n\otimes x'_{n'}$と$y_1\otimes y'_1,\cdots,y_m\otimes y'_1,\cdots,y_1\otimes y'_{m'},\cdots,y_m\otimes y'_{m'}$に関する行列表示は，行列のテンソル積
        \[A\otimes B=\begin{pmatrix}Ab_{11}&\cdots&Ab_{1n'}\\\vdots&\ddots&\vdots\\Ab_{m'1}&\cdots&Ab_{m'b'}\end{pmatrix}\in M_{(mm')(nn')}(K)\]
        である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[1,2.] 
        線型写像$f,g$による空間の標準分解$V=\Ker f\oplus V_1,W=\Ker g\oplus W_1$を考え，$\o{f}:V_1\to\Im f,\o{g}:W_1\to\Im g$をそれぞれが定める同型とする．
        これについて，テンソル積の基底からの特徴づけ\ref{prop-distributive-law-in-categorical-sense}より，
        \[V\otimes W=(\Ker f\otimes\Ker g)\oplus(\Ker f\otimes W_1)\oplus(V_1\otimes\Ker g)\oplus(V_1\otimes W_1)\]
        と分解できる．この前半３項$(\Ker f\otimes\Ker g)\oplus(\Ker f\otimes W_1)\oplus(V_1\otimes\Ker g)=(\Ker f\otimes W)+(V\otimes\Ker g)$への$f\otimes g$の制限は，$x\otimes y\;(x=0\lor y=0)$より，$0$である．
        一方で，$V_1\otimes W_1$への制限は同型$\o{f}\otimes\o{g}$となる（積写像$f\times g$が同型な双線型写像を定めるので，$f\otimes g=\otimes^*(f\times g)$も同型）．
        よって，標準分解\ref{prop-homomorphism-thm}より，
        \begin{align*}
            \Ker(f\otimes g)&=(\Ker f\otimes W)+(V\otimes\Ker g),\\
            \Im (f\otimes g)&=(\Im f)\otimes(\Im g).
        \end{align*}
        \item[3.]
        $f\otimes g$による基底$x_j\otimes x'_{j'}$の行き先が$A\otimes B$の$jj'$成分であるから，
        \begin{align*}
            f(x_j)&=\sum^m_{i=1}a_{ij}y_i,&f(x_{j'})&=\sum^{m'}_{i'=1}b_{i'j'}y'_{i'},
        \end{align*}
        であるから，
        \begin{align*}
            (f\otimes g)(x_j\otimes x'_{j'})&=f(x_j)\otimes g(x'_{j'})=\paren{\sum^m_{i=1}a_{ij}y_i}\otimes\paren{\sum^{m'}_{i'=1}b_{ii'j'}y'_{i'}}\\
            &=\sum^m_{i=1}\sum^{m'}_{i'=1}a_{ij}b_{i'j'}(y_i\otimes y'_{i'})=\sum^{m}_{i=1}a_{ij}(b_{1j'}y_i\otimes y'_1+\cdots+b_{m'j'}y_i\otimes y'_{m'})
        \end{align*}
        より，この$y_1\otimes y'_1,\cdots,y_m\otimes y'_1,\cdots,y_1\otimes y'_{m'},\cdots,y_m\otimes y'_{m'}$の係数を順に縦に並べると，$A$の列ベクトルを右の添字だけを残して$a_j=\begin{pmatrix}a_{1j}\\\vdots\\a_{mj}\end{pmatrix}$と表すと，
        \[\begin{pmatrix}a_jb_{1j'}\\\vdots\\a_jb_{m'j'}\end{pmatrix}\in M_{(mm')1}\]
        となる．よって結論を得る．
    \end{description}
\end{proof}
\begin{remarks}
    線型写像のテンソル積は，標準分解で見る．生き残るのは，$\o{f}\times\o{g}$のみで，その他は零写像となる．
    基底の順番は，$X=\begin{pmatrix}x_1\otimes y_1&\cdots&x_m\otimes y_1\\\vdots&\ddots&\vdots\\x_1\otimes y_n&\cdots&x_m\otimes y_n\end{pmatrix}$を横に読んでいく順番である．
    なぜならば，$XA$というように係数行列$A$を得たいからである．
\end{remarks}

\begin{corollary}\label{cor-tensor-product-of-linear-maps}\mbox{}
    \begin{enumerate}
        \item $f:V\to V',g:W\to W'$が全射(resp. 単射)ならば，$f\otimes g:V\otimes W\to V'\otimes W'$も全射(resp. 単射)である．
        \item $V'\subset V,W'\subset W$を部分空間とする．商空間への標準全射のテンソル積$V\otimes W\to(V/V')\otimes(W/W')$は，同型\[\o{p\otimes p'}:(V\otimes W)/(V'\otimes W+V\otimes W')\to (V/V')\otimes(W/W')\]を引き起こす．
        \item $V,W\in\FinVect_K$とし，$f\in\End_K(V),g\in\End_K(W)$とする．$\Tr(f\otimes g)=\Tr g\cdot\Tr g,\det(f\otimes g)=(\det f)^{\dim W}(\det g)^{\dim V}$である．
    \end{enumerate}
\end{corollary}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item 命題\ref{prop-tensor-product-of-matrices}で示した標準分解による議論より，
        \begin{align*}
            \Ker(f\otimes g)&=(\Ker f\otimes W)+(V\otimes\Ker g),\\
            \Im (f\otimes g)&=(\Im f)\otimes(\Im g).
        \end{align*}
        よって，$\Ker f=\Ker g=0\Rightarrow\Ker(f\otimes g)=0$．また，$\Im(f\otimes g)=V\otimes W\Rightarrow \Im f=V\land\Im g=W$．
        \item 標準全射を$p:V\to V/V',p':W\to W/W'$とする．
        \begin{enumerate}[(a)]
            \item $p,p'$は全射だから，$p\otimes p'$も全射．
            \item $\Ker(p\otimes p')=(\Ker p\otimes W)+(V\otimes\Ker p')=V'\otimes W+V\otimes W'$である．
        \end{enumerate}
        準同型定理（標準分解）\ref{prop-homomorphism-thm}より，$\o{p\otimes p'}:(V\otimes W)/(V'\otimes W+V\otimes W')\to (V/V')\otimes(W/W')$を引き起こす．
        \item 命題\ref{prop-tensor-product-of-matrices}より，
        \begin{enumerate}[(a)]
            \item 
            \begin{align*}
                \Tr(f\otimes g)&=\Tr(A\otimes B)=\sum^{m'}_{i'=1}\Tr Ab_{i'i'}=\Tr A\cdot\Tr B=\Tr f\cdot\Tr g\footnote{トレースが線型写像に定まるっていつ示したんだっけ？}
            \end{align*}
            を得る．
            \item 
            \begin{align*}
                \det(f\otimes g)&=\det((f\otimes 1)\circ(1\otimes g))=\det(f\otimes 1)\cdot\det(1\otimes g)=\det(A\otimes 1)\cdot\det(1\otimes B)\\
                &=(\det A)^{\dim W}(\det B)^{\dim V}=(\det f)^{\dim W}(\det g)^{\dim V}.
            \end{align*}
        \end{enumerate}
    \end{enumerate}
\end{proof}
\begin{remarks}
    3.のtraceについての証明で，命題\ref{prop-tensor-product-of-matrices}.3使えたのか！
\end{remarks}

\begin{notation}
    線型形式$f:V\to K$と$y\in W$に対して，線型写像$f\otimes y:V\to W$とは，
    \[\xymatrix@R-2pc{
        f\otimes y:V\ar[r]&W\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        x\ar@{|->}[r]&f(x)y
    }\]
    を表すものとする．$g:W\to K$も線型形式として，$f\otimes g:V\otimes W\to K$を
    \[\xymatrix@R-2pc{
        f\otimes g:V\otimes W\ar[r]&K\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (x,y)\ar@{|->}[r]&f(x)g(y)
    }\]
    とする．
\end{notation}

\begin{example}[線型写像の空間の基底]
    $V,W\in\Vect_K$とする．
    \begin{enumerate}
        \item $V$の基底を$x_1,\cdots,x_n$とし，$f_1,\cdots,f_n\in V^*$を対応する双対基底とする．$y_1,\cdots,y_m$を$W$の基底とする．
        $f:V\to W$を線型写像とし，その$x_1,\cdots,x_n$と$y_1,\cdots,y_m$に関する行列表示を$A=(a_{ij})\in M_{mn}(K)$とすると，$f=\sum^m_{i=1}\sum^n_{j=1}a_{ij}f_j\otimes y_i$が成り立つ．
        \item 
        $x_1,\cdots,x_m\in V,y_1,\cdots,y_n\in W$を基底とし，$f_1,\cdots,f_m\in V^*,g_1,\cdots,g_n\in W^*$をそれらの双対基底とする．
        $b:V\times W\to K$を双線型形式とし，その$x_1,\cdots,x_m$と$y_1,\cdots,y_n$に関する行列表示を$A=(a_{ij})\in M_{mn}(K)$とする．$b$が定める線型写像$V\otimes W\to K$とは，$\sum^m_{i=1}\sum^n_{j=1}a_{ij}f_i\otimes g_j$である．
    \end{enumerate}
\end{example}

\subsection{完全系列による特徴づけ}

\begin{proposition}
    線型写像の列$V'\xrightarrow{f}V\xrightarrow{g}V''$について，次の３条件は同値．
    \begin{enumerate}
        \item $V'\xrightarrow{f}V\xrightarrow{g}V''$は完全系列である．
        \item 任意の$W\in\Vect_K$に対し，$V'\otimes W\xrightarrow{f\otimes 1}V\otimes W\xrightarrow{g\otimes 1}V''\otimes W$は完全系列である．
        \item 任意の$W\in\Vect_K$に対し，$W\otimes V'\xrightarrow{1\otimes f}W\otimes V\xrightarrow{1\otimes g}W\otimes V''$は完全系列である．
    \end{enumerate}
\end{proposition}

\section{外積と行列式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=外積代数とその圏と，行列式という言葉]
    外積代数とは，テンソル積にさらに条件を貸した部分代数である，この構成をまず商空間の言葉$p:V^{\otimes r}\to\Lambda^rV$で定義する．
    この間の線型写像はHom集合$f^{\otimes r}:V^{\otimes r}\to W^{\otimes r}$を制限して得る交代的な重線型形式$\wedge^rf:\Lambda^rV\to\Lambda^rW$となる．
    すると，テンソル積の構成も商空間の言葉で行ったから，その特殊化として，普遍交代$r$線型写像$p\circ\otimes^r:V^{\times r}\to\Lambda^rV$が全く同様に定まる．
    これに沿って，$r$次外冪からの線型写像が，交代$r$重線型写像と1対1に対応する：$(p\circ\otimes^r)^*:\Hom_K(\Lambda^rV,W)\to\mathrm{Alt}_r(V^{\times r},W)$．
    以上により，テンソル積から，完全に新しい対象とその間の射を定めてしまった．
    このテンソル積$V^{\otimes r}$からの構成を，普遍構成の言葉で整備して終わりにしたい．
    \begin{itemize}
        \item 直和の外積代数$\Lambda^r(V\oplus W)$は，外積代数のテンソル積の直和$\bigoplus_{p=0}^r\Lambda^pV\otimes\Lambda^{r-p}W$と同型である．
        \item 線型写像の空間の間に定まる$\Lambda^r:\Hom_K(V,W)\to\Hom_K(\Lambda^rV,\Lambda^rW)$は共変Hom関手で，単射・全射性を保存する．
        \item 
    \end{itemize}
    以上の外積代数の構造「交代的な多重線型写像」のうち，規格化されたものとして特徴付けられるのは行列式である．
    \textbf{複雑な代数ではないのだが，データ構造が非常に込み入っていて，手計算では見通しが悪い．そんな状況に一筋の光を差し込んでくれるのが行列式という言葉である}．
\end{tcolorbox}

\subsection{外積代数の定義}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=外積]
    外積とは，クロス積の代数的法則を抽出して得られる形式的な代数的構成である．
    この構成は完全に関手$\Lambda:\Vect_K\to\Alg_K$として定式化される．

    ここでは，交代性$v\wedge v=0$を満たす代数を構成するのに，テンソル積と同様にして商空間の方法を用いることとする．
\end{tcolorbox}

\begin{notation}
    $V\in\Vect_K$について，
    \[V^{\otimes r}=V\otimes V\otimes\cdots\otimes V\;(r\in\N)\]
    とする．
\end{notation}

\begin{definition}[exterior / Grassmann algebra, exterior power]
    $V\in\Vect_K$とし，$r\in\N$とする．
    \begin{enumerate}
        \item ベクトル空間$V$の\textbf{外積代数}$\Lambda V$とは，$V$上のfree graded-commutative algebraである．忘却関手$\Lambda V\to V$の値は，１次(degree)の元とみなされる．係数体の元が$0$次．
        \item $V^{\otimes r}$の部分空間
        \[R_r:=\langle x_1\otimes\cdots\otimes x_i\otimes\cdots\otimes x_r\mid 1\le i<j\le r,x_i=x_j\rangle\]
        による商$V^{\otimes r}/R_r$を，$V$の\textbf{$r$次外冪}と呼び，$\Lambda^rV$で表す．
        $x_1\otimes\cdots\otimes x_r\in V^{\otimes r}$の像を$x_1\wedge\cdots\wedge x_r\in\Lambda^rV$で表す．
    \end{enumerate}
\end{definition}
\begin{example}\mbox{}
    \begin{enumerate}
        \item $r=0$の時は，$\Lambda^0V=V^{\otimes 0}=K$．
        \item $r=1$の時は，$\Lambda^1V=V^{\otimes 1}=V$．
        \item $V=K$の時，$\Lambda^rK=0\;(r\ge 2)$．
    \end{enumerate}
\end{example}

\begin{proposition}[外積]
    $V\in\Vect_K$とし，$p+q=r$を自然数とする．自然な同型$V^{\otimes p}\otimes V^{\otimes q}\to V^{\otimes r}$に対応する双線型写像$V^{\otimes p}\times V^{\otimes q}\to V^{\otimes r}$は，双線型写像
    \[\wedge:\Lambda^p V\times\Lambda^qV\to\Lambda^rV\]
    を引き起こす．
\end{proposition}
\begin{proof}
    名前$\wedge$を付けたかったのが双線型写像の方であったというだけで，自然な同型$V^{\otimes p}\otimes V^{\otimes q}\to V^{\otimes r}$が
    線型写像$\Lambda^p V\otimes\Lambda^qV\to\Lambda^rV$を引き起こすことを示せば良い．
    次の図式を可換にする線型写像の存在を示せば良い．ただし，商写像を$p:V^{\otimes p}\to\Lambda^pV,q:V^{\otimes q}\to\Lambda^qV,r:V^{\otimes r}\to\Lambda^rV$とした．
    \[\xymatrix{
        V^{\otimes p}\otimes V^{\otimes q}\ar[r]^-{\cong}\ar[d]_-{p\otimes q}&V^{\otimes r}\ar[d]^-{r}\\
        \Lambda^pV\otimes\Lambda^qV\ar@{.>}[r]&\Lambda^rV
    }\]
    いま，$\Lambda^pV\otimes\Lambda^qV=V^{\otimes p}\otimes V^{\otimes p}\to V^{\otimes r}$であり，$R_p\otimes V^{\otimes p}+V^{\otimes q}\otimes R_q\subset R_r$であるから，上の線型写像$\Lambda^p V\otimes\Lambda^qV\to\Lambda^rV$は一意的に存在する．
\end{proof}
\begin{remarks}[外積代数の特徴づけ]
    「圏論の言葉で言えば、外積代数は普遍構成によって与えられる、ベクトル空間の圏上の函手の典型である。」
    外積代数$\Lambda V$の$\Lambda$とは生成関手で，$V$の通常のスカラー積と和に加えて，外積$\wedge$の３つの演算（双線型写像）で自由生成される代数系をいう．

    $(V^{\otimes p}/R_p)\otimes(V^{\otimes q}/R_q)=V^{\otimes(p+q)}/(R_p\otimes V^{\otimes p}+V^{\otimes p}\otimes R_q)$は，命題\ref{prop-distributive-law-in-categorical-sense}のように，和と商についての代数法則として覚えてしまっても良いのかもしれない．
\end{remarks}

\begin{definition}[exterior product / wedge product]
    命題の双線型写像$\wedge:\Lambda^p V\times\Lambda^qV\to\Lambda^rV$による$(s,t)$の像を中置記法$s\wedge t$でかき，$s$と$t$の\textbf{外積}という．
\end{definition}

\subsection{多重線型写像：テンソル積の射}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=外冪が定義する交代$r$重線型写像]
    テンソル積の普遍性を繰り返し用いることより，
    $r$重線型写像
    \[\xymatrix@R-2pc{
        V^{\times r}\ar[r]&V^{\otimes r}\\
        (x_1,\cdots,x_r)\ar@{|->}[r]&x_1\otimes\cdots\otimes x_r
    }\]
    が引き起こす写像$\Hom_K(V^{\otimes r},W)\to\mathrm{Mulinear}_r(V^{\times r},W)$は可逆である．
    交代$r$重線型写像とは，この部分可逆写像可逆写像$\Hom(\Lambda^rV,W)\to\mathrm{Alt}_r(V^{\times r},W)$が定めるクラスである．
    これはテンソル積の普遍性に含まれているもので，$p\circ\otimes^{\times r}$を普遍交代$r$重線型写像という．
\end{tcolorbox}

\begin{definition}[$r$-ple linear mapping, alternating]
    $V\in\Vect_K,r\in\N$とする．
    \begin{enumerate}
        \item 写像$f:V^{\times r}=V\times V\times\cdots\times V\to W$が\textbf{$r$重線型写像}であるとは，次の２条件が成り立つことをいう．
        \begin{enumerate}[(1)]
            \item $\forall i\in[r],\;\forall x_1,\cdots,x_r,y_i\in V,\;f(x_1,\cdots,x_i+y_i,\cdots x_r)=f(x_1,\cdots,x_i,\cdots,x_r)+f(x_1,\cdots,y_i,\cdots,x_r)$．
            \item $\forall i\in[r],\;\forall a\in K,\;\forall x_1,\cdots,x_r\in V,\;f(x_1,\cdots,ax_i,\cdots,x_r)=af(x_1,\cdots,x_i,\cdots,x_r)$．
        \end{enumerate}
        \item $r$多重線型写像$f:V^{\times r}\to W$が\textbf{交代}であるとは，次が成り立つことをいう：$\forall x_1,\cdots,x_r\in V,\; [\exists i,j\in[r]\;\;x_i=x_j\Rightarrow f(x_1,\cdots,x_r)=0]$．
    \end{enumerate}
\end{definition}
\begin{example}[行列式が定める交代$n$重線型写像]\mbox{}\label{example-determinant-1}
    \begin{enumerate}
        \item $r=0$の時は，$V^{\times 0}=0=\{0\}$であり，任意の写像$\{0\}\to W$は$0$重線型写像で交代である．$r=1$のときもそうである．
        $f:V^{\times r}\to W$が交代$r$重線型写像で$g:V'\to V$が線型写像ならば，合成$f\circ g^{\times r}:V'^{\times r}\to V^{\times r}\to W$も交代$r$重線型写像である．
        \item 行列を縦ベクトルの組と考えて$M_n(K)=(K^n)^{\times n}$をみなす．行列式が定める写像$\det:(K^n)^{\times n}=M_n(K)\to K$は交代$n$重線型写像である．
        \item $f_1,\cdots,f_r:V\to K$を線型形式とする．次の写像$f_1\wedge\cdots\wedge f_r:V^{\times r}\to K$は交代$r$重線型形式である．
        \[\xymatrix@R-2pc{
            f_1\wedge\cdots\wedge f_r:V^{\times r}\ar[r]&K\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (x_1,\cdots,x_r)\ar@{|->}[r]&\det(f_i(x_j))
        }\]
    \end{enumerate}
\end{example}

\begin{proposition}[交代$r$重線型写像]
    $V,W\in\Vect_K$とする．自然な可逆写像$\Hom_K(V^{\otimes r},W)\to\mathrm{Mulinear}_r(V^{\times r},W)$は，可逆写像$\Hom(\Lambda^rV,W)\to\mathrm{Alt}_r(V^{\times r},W)$を引き起こす．
\end{proposition}
\begin{proof}
    線型写像$f:V^{\otimes r}\to W$に対応する$r$重線型写像$V^{\times r}\to W$が交代であるための必要十分条件は$f(R_r)=0$であることである．
    従って，商空間の普遍性\ref{prop-universality-of-quotient-spaces}より，次の写像は存在し，また可逆である．
    \[\xymatrix{
        V^{\otimes r}\ar[r]^-p\ar[d]&\Lambda^rV\ar@{.>}[dl]\\
        W
    }\]
\end{proof}
\begin{remarks}
    これは構成を商空間の言葉を用いて巧妙に作ったためである．
\end{remarks}

\begin{definition}[universal alternating $r$-ple linear mapping]\label{def-universal-alternating-r-ple-linear-map}
    $\Lambda^rV$の恒等写像$\id_{\Lambda^rV}$に対応する交代$r$重線型写像$V^{\times r}\to\Lambda^rV$は，合成写像$p\circ\otimes^{\times r}:V^{\times r}\to\Lambda^rV$である．これを\textbf{普遍交代$r$重線型写像}という．
    \[\xymatrix{
        V^{\times r}\ar[r]^-{\otimes^{\times r}}\ar@{.>}[d]&V^{\otimes r}\ar[r]^-p&\Lambda^rV\ar[dll]^-{\id_{\Lambda^rV}}\\
        W=\Lambda^rV
    }\]
    これは普遍双線型写像$\otimes$と同様な，次のような写像である，便宜的に$\wedge$という名前をつける．
    \[\xymatrix@R-2pc{
        \wedge:V^{\times r}\ar[r]&\Lambda^rV\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (x_1,\cdots,x_r)\ar@{|->}[r]&x_1\wedge\cdots\wedge x_r
    }\]
\end{definition}

\subsection{交代$r$重線型写像：外積代数の射}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=交代$r$重線型写像の性質]
    交代$r$重線型写像の性質を調べることによって，外積代数に迫る．
    自由生成の代数なので，極めて形式的な議論となる．基本的には，外積代数の定義から帰納的に示される．
\end{tcolorbox}

\begin{proposition}[交代性]\label{prop-交代線型写像の計算規則}
    $V\in\Vect_K,r\in\N,f:V^{\times r}\to W$を交代$r$重線型写像とする．
    置換$\sigma\in\mathfrak{S}_n$に対し，
    \[f(x_{\sigma(1)},\cdots,x_{\sigma(r)})=\sgn(\sigma)f(x_1,\cdots,x_r)\]
    が成り立つ．
\end{proposition}

\begin{corollary}
    $s\in\Lambda^pV,t\in\Lambda^qV$ならば，$t\wedge s=(-1)^{pq}s\wedge t$である．
\end{corollary}

\subsection{外積代数の構造}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=exterior algebra is a free graded-commutative algebra]
    ２つの外積代数$\Lambda V,\Lambda W$の外積演算は階層的に定められている：$\coprod_{p+q=r\\p,q\in\N}(\wedge:\Lambda^pV\otimes\Lambda^qV\to\Lambda^rV)$．
    この２つの演算を結合して，外積代数の直和$\Lambda V\coprod\Lambda W$を定義したい．
    これを内部直和として解釈すると，内部の構造が見えてくる．
    $r$次外冪は，パスカルの三角形のような生成原理で到達される元であるので，二項展開と同じ構造になる：$\Lambda^r(V\oplus W)\cong\bigoplus^r_{p=0}(\Lambda^pV\otimes\Lambda^{r-p}W)$．

    $n$次元空間$V$の$r$次外冪$\Lambda^rV$は$\begin{pmatrix}\dim V\\r\end{pmatrix}$次元である．$x\wedge y+y\wedge x=0$という規則があり，順番に関しては線型従属であるためである．
\end{tcolorbox}

\begin{notation}
    $f:V\to W$を線型写像とする．次の交代$r$重線型写像
    \[\xymatrix@R-2pc{
        V^{\times r}\ar[r]^-{f^{\times r}}&W^{\times r}\ar[r]^-{\wedge}&\Lambda^rW\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (x_1,\cdots,x_r)\ar@{|->}[r]&(f(x_1),\cdots,f(x_r))\ar@{|->}[r]&f(x_1)\wedge\cdots\wedge f(x_r)
    }\]
    が定める線型写像を
    \[\xymatrix@R-2pc{
        \wedge^rf:\Lambda^rV\ar[r]&\Lambda^rW\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        x_1\wedge\cdots\wedge x_r\ar@{|->}[r]&f(x_1)\wedge\cdots\wedge f(x_r)
    }\]
    と表すこととする．
    \[\xymatrix{
        V^{\times r}\ar[r]^-{p\circ\otimes^{\times r}}\ar[d]_-{\wedge\circ f^{\times r}}&\Lambda^rV\ar[dl]^-{\wedge^rf}\\
        \Lambda^rW
    }\]
\end{notation}

\begin{proposition}[２つの外積代数の間の外積演算の階層構造の結合]\label{prop-coproduct-of-exterior-algebras}
    $V,W\in\Vect_K,r\in\N$とする．$p+q=r$を満たす自然数に対し，線型写像
    \[\xymatrix@R-2pc{
        \wedge\circ(\Lambda^pi\otimes\Lambda^qj):\Lambda^pV\otimes\Lambda^qW\ar[r]&\Lambda^r(V\oplus W)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        s\otimes w\ar@{|->}[r]&s\wedge t
    }\]
    を\footnote{より正確には，$s\otimes t\mapsto (s,0)\otimes(0,t)\mapsto (s,0)\wedge(0,t)$と表すべきなのかもしれないが，$V,W$の元と$V\oplus W$の元とを同一視した．}，包含写像$i:V\to V\oplus W,j:W\to V\oplus W$が引き起こす線型写像$\wedge^pi:\Lambda^pV\to\Lambda^p(V\oplus W),\wedge^qj:\Lambda^qV\to\Lambda^q(V\oplus W)$のテンソル積と外積$\wedge:\Lambda^p(V\oplus W)\otimes\Lambda^q(V\oplus W)\to\Lambda^r(V\oplus W)$との合成とする．
    これらの直和
    \[f:=\coprod_{p+q=r\\p,q\in\N}(\wedge\circ(\wedge^pi\otimes\wedge^qj)):\begin{array}{l}
        \Lambda^rV\oplus(\Lambda^{r-1}V\otimes W)\oplus(\Lambda^{r-2}V\otimes\Lambda^1W)\oplus\\
        \cdots\oplus(V\otimes\Lambda^{r-1}W)\oplus\Lambda^rW
    \end{array}\to\Lambda^r(V\oplus W)\]
    は同型である．
\end{proposition}
\begin{proof}\mbox{}
    \begin{description}
        \item[逆写像の構成] 交代$r$重線型写像
        \[\xymatrix@R-2pc{
            g:(V\oplus W)^{\times r}\ar[r]&\bigoplus^r_{p=0}(\Lambda^pV\otimes\Lambda^{r-p}W)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (x_1+y_1,\cdots,x_r+y_r)\ar@{|->}[r]&\sum^n_{p=0}\sum_{\sigma\in\mathfrak{S}_r^{(p)}}\sgn(\sigma)\cdot (x_{\sigma(1)}\wedge\cdots\wedge x_{\sigma(p)})\otimes(y_{\sigma(p+1)}\wedge\cdots\wedge y_{\sigma(r)})
        }\]
        が定める線型写像$h:\Lambda^r(V\oplus W)\to\bigoplus^r_{p=0}(\Lambda^pV\otimes\Lambda^{r-p}W)$が$f$の逆写像となっていることを示す．
        ただし，$\mathfrak{S}_r^{(p)}:=\{\sigma\in\mathfrak{S}_r\mid\sigma(1)<\sigma(2)<\cdots<\sigma(p),\sigma(p+1)<\sigma(p+2)<\cdots<\sigma(r)\}$と定めた．
        \item[逆写像であることの証明] 
        $0\le p\le r,x_1,\cdots,x_p\in V,\;y_1,\cdots,y_{r-p}\in W$を任意に取る．
        \begin{align*}
            h(f((x_1\wedge\cdots\wedge x_p)\otimes(y_1\wedge\cdots\wedge y_{r-p})))&=h(x_1\wedge\cdots\wedge x_p\wedge y_1\wedge\cdots\wedge y_{r-p})\\
            &=g(x_1,\cdots,x_p,y_1,\cdots,y_{r-p})\\
            &=(x_1\wedge\cdots\wedge x_p)\otimes(y_1\wedge\cdots\wedge y_{r-p}).
        \end{align*}
        また，$x_1,\cdots,x_r\in V,\;y_1,\cdots,y_r\in W$とすると，
        \begin{align*}
            f(g((x_1+y_1)\wedge\cdots\wedge(x_r+y_r)))&=f(g(x_1+y_1,\cdots,x_r+y_t))\\
            &=\sum^n_{p=0}\sum_{\sigma\in\mathfrak{S}_r^{(p)}}\sgn(\sigma)\cdot (x_{\sigma(1)}\wedge\cdots\wedge x_{\sigma(p)})\otimes(y_{\sigma(p+1)}\wedge\cdots\wedge y_{\sigma(r)}\\
            &=(x_1+y_1)\wedge\cdots\wedge(x_r+y_r).&命題\ref{prop-交代線型写像の計算規則}に従って括る
        \end{align*}
    \end{description}
\end{proof}
\begin{remarks}
    多重線形性というものが手強すぎるために，$g$を定義するのにたくさんの演算の知識が必要となった．
    が，本質的にはこれだけである．
    $f$の階層別に定義されたwedge積はわかりやすい．分配法則を適用すれば良い．これを戻すためには，計算規則\ref{prop-交代線型写像の計算規則}に沿った展開が必要になる．
\end{remarks}

\begin{corollary}[外積代数の次元]\label{cor-basis-of-exterior-algebra}
    $x_1,\cdots,x_n$が$V$の基底ならば，$x_{i_1}\wedge\cdots\wedge x_{i_r}\;(1\le i_1<i_2<\cdots<i_r\le n)$は$\Lambda^rV$の基底である．
    特に，$r=\dim V$ならば$\dim\Lambda^rV=1$である．$r>\dim V\Leftrightarrow \dim\Lambda^rV=0$である．
\end{corollary}
\begin{proof}
    数学的帰納法による．
    \begin{enumerate}
        \item $r\le 1$ならば，$\Lambda^0V=K,\Lambda^1V=V$より，成り立つ．
        \item $r\ge 2$として，$n=\dim V$に関する帰納法で示す．
        \begin{enumerate}[(1)]
            \item $r\ge 2,n\le 1$ならば，$\Lambda^1V=0$である．
            \item $n\ge 2$とし，$W:=\langle x_1,\cdots,x_{n-1}$とすると，$V=W\oplus Kx_n$と分解できる．命題より，標準的な同型$\Lambda^rW\oplus(\Lambda^{r-1}W\otimes Kx_n)\to\Lambda^rV$がある．
        \end{enumerate}
    \end{enumerate}
\end{proof}

\begin{example}[行列式の射程]
    行列式は，規格化された交代多重線型形式として特徴付けられる写像で，これによって種々の写像が定義できる極めて普遍的な言葉である．
    \begin{enumerate}
        \item $V:=K^n$を縦ベクトルの空間とする．例\ref{example-determinant-1}の行列式が定める$n$重交代線型写像$V^{n}\to K;(a_1,\cdots,a_n)\mapsto\det(a_i)$が定める線型写像$\det:\Lambda^nV\to K$は\textbf{同型}である．
        $p+q=n$ならば，外積演算$\wedge$に関する引き戻し$\wedge^*\det=\det\circ\wedge:\Lambda^pV\times\Lambda^qV\to K$は非退化であり，同型$\Lambda^qV\to(\Lambda^pV)^*$を定める．curryingの一般化のようなものである．
        \item $V=\R^3$をベクトルの空間とし，基底$e_2\wedge e_3,e_3\wedge e_1,e_1\wedge e_2\in\Lambda^2V$と$e_1,e_2,e_3\in V$とが定める同型$\Lambda^2V\to V$に対応する交代双線型形式$\times:V\times V\to V$を\textbf{ベクトル積}という．ちょうど外積は，このベクトル積の代数法則を抽出して自由生成される代数系となっている．
        \item 開集合$U\subset\R^3$上の各点にベクトルを定義する関数$U\to\R^3$を，$U$上の\textbf{ベクトル場}という．
        \item 開集合$U\subset\R^3$上の各点に線型形式を定義する関数$U\to(\R^3)^*=(\Lambda^1\R^3)^*$を，$U$上の１次\textbf{微分形式}という．関数$U\to(\Lambda^2\R^3)^*$を２次微分形式と呼ぶ．
        \item ベクトル場は反変テンソル場であり（ベクトルを位置ベクトルだと思うと，点の座標と同じ変換を受けるため），１次微分形式は共変テンソル場である（接ベクトル空間の基底のようなものであるため）．
        \item 前述の同型$\R^3\to(\Lambda^2\R^3)^*$により，２次微分形式をベクトル場と考えたものを，\textbf{軸性(axial)ベクトル場}，または擬ベクトルという．座標の反転に対し符号が変わらない（向きが反転する）という特徴づけを持つ．このとき通常のベクトル場は\textbf{極性(polar)ベクトル場}という．古典電磁気学において，電場は極性ベクトル場の例で，磁束密度は軸性ベクトル場の例である．極性ベクトル場が微分１形式に対応し，軸性ベクトル場が微分２形式に対応するのである．前者では線積分やrotを考え，後者では面積分やdivを考えるベクトル場である．
    \end{enumerate}
\end{example}

\begin{proposition}[???]
    $x,y\in V$とする．
    \begin{enumerate}
        \item 次の２条件は同値である．
        \begin{enumerate}[(1)]
            \item $x\wedge y\ne 0$．
            \item $x,y$は一次独立．
        \end{enumerate}
        \item $x,y$は一次独立とする．$x',y'\in V$について，次の２条件は同値である．
        \begin{enumerate}[(1)]
            \item $x\wedge y=x'\wedge y'$．
            \item $x'=ax+by,y'=cx+dy$を満たす$\begin{pmatrix}a&c\\b&d\end{pmatrix}\in\SL_2(K)$が存在する．
        \end{enumerate}
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item \begin{description}
            \item[(1)$\Rightarrow$(2)] $ax+by=0$とする，$(ax+by)\wedge y=0,(ax+by)\wedge x=0$から，それぞれ$a=0,b=0$が従う．
            \item[(2)$\Rightarrow$(1)] $V$の$\bracket{x,y}$に関する補空間を$V'$とすると，$V=(Kx\oplus Ky)\oplus V'$と表せる．
            命題\ref{prop-coproduct-of-exterior-algebras}より，2次外冪の空間は$\Lambda^2V=\Lambda^2(Kx\oplus Ky)\oplus(Kx\oplus Ky)\otimes V'\oplus\Lambda^2V'$と表せる．
            今，$x\wedge y\in\Lambda^2(Kx\oplus Ky)$は基底である（系\ref{cor-basis-of-exterior-algebra}）．
            よって，$x\wedge y\ne 0$である．
        \end{description}
        \item \begin{description}
            \item[(1)$\Rightarrow$(2)] $r=3$についても1と同様の議論より，
            \begin{align*}
                (x\wedge y)\wedge x'&=(x'\wedge y')\wedge x'=0\\
                (x\wedge y)\wedge y'&=(x'\wedge y')\wedge y'=0
            \end{align*}
            から，$x,y,x'$と$x,y,y'$は一次従属．\footnote{斎藤先生は$\Lambda^2V$の直和分解を用いて論じている．}
            \item[(1)$\Rightarrow$(2) 斎藤先生] 
            2次外冪の空間は$\Lambda^2V=\Lambda^2(Kx\oplus Ky)\oplus(Kx\oplus Ky)\otimes V'\oplus\Lambda^2V'$と表せることより，
            \begin{align*}
                x'&=(ax+by)+x'',&y'&=(cx+dy)+y'',
            \end{align*}
            と置くと，
            \begin{align*}
                x'\wedge y'&=(ax+by)\wedge(cx+dy)+(ax+by)\oplus y''-(cx+dy)\oplus x''+x''\wedge y''
            \end{align*}
            と展開できる．いま，\footnote{まじで分からない}
        \end{description}
    \end{enumerate}
\end{proof}
\begin{remarks}
    命題\ref{prop-coproduct-of-exterior-algebras}の運用ヤバイな．$\wedge$になりきれない$\otimes$が存在するのか．では次の計算規則はどういう意味論がつくのか．$\wedge:\Lambda^2V\times\Lambda^2V\to\Lambda^2(Kx\otimes Ky)\oplus\Lambda^2(V)\oplus\Lambda^2V'$は変だ．なんだこれは．
    \begin{align*}
        x'\wedge y'&=(ax+by)\wedge(cx+dy)+(ax+by)\wedge y''-(cx+dy)\wedge x''+x''\wedge y''
    \end{align*}
\end{remarks}

\subsection{線型写像の外積}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=線型写像の外積の構成は共変Hom関手]
    $\Lambda^r:\Hom_K(V,W)\to\Hom_K(\Lambda^rV,\Lambda^rW)$は共変Hom関手で，単射・全射性を保存するということか．
    また，線型写像の外冪の行列表示の成分は，元の線型写像の行列表示の小行列式となる．
\end{tcolorbox}

\begin{proposition}[線型写像の外積の構成は共変Hom関手]
    $f:V\to W$を線型写像とし，$r\in\N$とする．
    \begin{enumerate}
        \item $f$が全射ならば$\Lambda^rf$も全射である．
        \item $f$が単射ならば$\Lambda^rf$も単射である．
        \item $\Im(\Lambda^rf)=\Lambda^r\Im f$である．従って，$\rank\Lambda^rf=\begin{pmatrix}\rank f\\r\end{pmatrix}$であり，$r>\rank f$と$\Lambda^rf=0$とは同値である．
        \item $f$の基底$x_1,\cdots,x_n\in V$と$y_1,\cdots,y_m\in W$とに関する行列表示を$A\in M_{mn}(K)$とする．$\Lambda^rf$の基底$x_{j_1}\wedge\cdots\wedge x_{j_r}$と$y_{i_1}\wedge\cdots\wedge y_{i_r}$に関する行列表示$M_{\begin{pmatrix}m\\r\end{pmatrix}\begin{pmatrix}n\\r\end{pmatrix}}(K)$の，$(i_1\cdots i_r)(j_1\cdots j_r)$成分\footnote{この意味論が実はよくわかっていない．$(i_1\cdots i_r)=(1\cdots r)$の時に１で，$i_1\cdots i_r=(r\cdots 1)$の時に$\begin{pmatrix}n\\r\end{pmatrix}$であるはず}は$A$の小行列式$\det(a_{i_kj_l})$である．特に，$V=W$かつ$r=\dim V$ならば，$\Lambda^rf$は$\det f$倍写像である．
    \end{enumerate}
\end{proposition}
\begin{proof}\mbox{}
    \begin{enumerate}
        \item $f$が全射ならば，$f^{\otimes r}:V^{\otimes r}\to W^{\otimes r}$も全射線型写像である（系\ref{cor-tensor-product-of-linear-maps}）．
        よって，$\Lambda^rf$も全射である（$f^{\otimes r}$が全射ならば$q\circ f^{\otimes r}$も全射であるため）．
        \[\xymatrix{
            V^{\times r}\ar[d]_-{f^{\times r}}\ar[r]^-{\otimes^r}&V^{\otimes r}\ar[d]_-{f^{\otimes r}}\ar[r]^-p&\Lambda^rf\ar@{.>}[d]^-{\Lambda^rf}\\
            W^{\times r}\ar[r]_-{\otimes^r}&W^{\otimes r}\ar[r]_-q&\Lambda^rW
        }\]
        \item $f$が単射のとき，$W=V\oplus V'$かつ$f:V\to W$が包含写像である場合について示せば十分である．そしてこの場合は，外積代数の直和についての命題\ref{prop-coproduct-of-exterior-algebras}により，同型$\bigoplus^r_{p=0}(\Lambda^pV\otimes\Lambda^{r-p}V')\to\Lambda^rW$が存在するので，その$\Lambda^rV$への制限$\Lambda^rf$は単射である．
        \item $f$を，全射$p:V\to\Im f$と単射$i:\Im f\to W$とに分解して考える．
        \[\xymatrix{
            V\ar[r]^-f\ar[dr]_-p&W\\
            &\Im f\ar[u]_-i
        }\]
        すると，（共変関手性より，）$\Lambda^r(i\circ p)=\Lambda^ri\circ\Lambda^rp$であるから，
        \begin{align*}
            \Im(\Lambda^rf)&=\Im(\Lambda^ri\circ\Lambda^rp)\\
            &=\Im(\Lambda^ri)&\because pが全射より，1.から\Lambda^rpも全射\\
            &=\Lambda^r\Im f.&後述
        \end{align*}
        包含写像$i$の定める線型写像
        $\Lambda^ri:\Lambda^r\Im f\to\Lambda^rW=\Lambda^r(\Im f\oplus W_1)$は（$W$の$\Im f$に対する補空間を$W_1$と置いた），
        も包含写像であり，その値域は$\Lambda^r\Im f$である．実際，
        同型
        \[\bigoplus^r_{p=0}\paren{\Lambda^p\Im f\otimes\Lambda^{r-p}W_1}\to\Lambda^rW\]
        の$\Lambda^r\Im f$への制限であるから．
        \item 第$(i_1\cdots i_r)(j_1\cdots j_r)$成分とは，基底$x_{j_1}\wedge\cdots\wedge x_{j_r}\in\Lambda^rV$の$\Lambda^rf$による値の，基底$y_{i_1}\wedge\cdots\wedge y_{i_r}$に関する係数であるから，
        \begin{align*}
            \Lambda^rf ( x_{j_1} \wedge\cdots\wedge x_{j_r} ) &= f(x_{j_1}) \wedge\cdots\wedge f(x_{j_r})\\
            &= (a_{1j_1}y_1+\cdots+a_{mj_1}y_m)\wedge\cdots\wedge(a_{1j_r}y_1+\cdots+a_{mj_r}y_m)\\
            &= (a_{1j_1}y_1+\cdots+a_{mj_1}y_m)\wedge\cdots\wedge(a_{1j_r}y_1+\cdots+a_{mj_r}y_m)\\
            &= \sum_{単射f\in\Map([r],[m])}a_{f(1)j_1}\cdots a_{f(r)j_r}\cdot y_{f(1)}\wedge\cdots\wedge y_{f(r)}\qquad\because 他の項は=0となるため\\
            &= \sum_{ 1\le i_1<\cdots<i_r\le m,\sigma\in\mathfrak{S}_r }\sgn(\sigma)\cdot a_{i_{\sigma(1)}j_1}\cdots a_{i_{\sigma(r)}j_r}\cdot y_{i_1}\wedge\cdots\wedge y_{i_r}\qquad\because 整理した\\
            &= \sum_{1\le i_1<\cdots<i_r\le m}\det(a_{i_kj_l})y_{i_1}\wedge\cdots\wedge y_{i_r}.
        \end{align*}
    \end{enumerate}
\end{proof}
\begin{remarks}
    $\Lambda^r:\Hom_K(V,W)\to\Hom_K(\Lambda^rV,\Lambda^rW)$は共変Hom関手で，単射・全射性を保存するということか．
\end{remarks}

\subsection{交代化作用素}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable,
    title=交代化作用素]
    テンソル積$V^{\otimes r}$から，外積代数$(V^{\otimes r})^\alt$を抽出する構成を一般化するために，射影子の言葉で定義する．
    $p:V^{\otimes r}\to\Lambda^rV=V^{\otimes r}/R_r$を外積代数を構成する時に用いた標準全射とすると，$\Ker p=R_r$の補空間として$(V^{\otimes r})^{\alt}$を定義したということに他ならない．
\end{tcolorbox}

\begin{notation}\mbox{}
    \begin{enumerate}
        \item $\sigma\in\mathfrak{S}_r$に対し，$V^{\otimes r}$の自己準同型$\sigma^*$を，$\sigma^*(x_1\otimes\cdots\otimes x_r)=x_{\sigma(1)}\otimes\cdots\otimes x_{\sigma(r)}$で定める．
        これは$x_1,\cdots,x_r$などを値点と見て射$r\to V^{\otimes r}$と見れば，この射に対する反変Hom関手として定式化できることを意識した記法であろう．
        \item 部分空間を
        \[(V^{\otimes r})^\alt:=\{x\in V^{\otimes r}\mid \forall\sigma\in\mathfrak{S}_r,\;\sigma^*(x)=\sgn(\sigma)\cdot x\}\]
        と表す．
    \end{enumerate}
\end{notation}

\begin{proposition}[alternizer]
    $K$の標数$p$は$p=0$または$p>r$とする．この時，標準全射$V^{\otimes r}\to\Lambda^rV$の$(V^{\otimes r})^\alt$への制限$f:(V^{\otimes r})^\alt\to\Lambda^rV$は同型である．
\end{proposition}
\begin{proof}
    $r=0$の時，$V^{\otimes r}=\Lambda^rV=(V^{\otimes r})^\alt=K$で，$r=1$の時は$V^{\otimes r}=\Lambda^rV=(V^{\otimes r})^\alt=V$であるから，$r\ge 2$の場合について示せば十分である．
    従って，$-1\ne 1$と仮定する．
    \begin{description}
        \item[射影子$e_\alt$の構成] 
        $V$の自己準同型$e_\alt\in\End_K(V^{\otimes r})$を，$e_\alt:=\frac{1}{r!}\sum_{\sigma\in\mathfrak{S}_r}\sgn(\sigma)\cdot \sigma^*$と定めると，$e_{\alt}$は射影子で（即ち$e^2=e$をみたし），$\Im e_\alt=(V^{\otimes r})^\alt$であることを示す．
        \begin{enumerate}
            \item \begin{align*}
                e^2_\alt&=\frac{1}{(r!)^2}\sum_{\sigma,\tau\in\mathfrak{S}_r}\sgn(\sigma)\sgn(\tau)\sigma^*\circ\tau^*\\
                &=\frac{1}{(r!)^2}\sum_{\sigma,\tau\in\mathfrak{S}_r}\sgn(\sigma\tau)(\tau\sigma)^*\\
                &=e_\alt
            \end{align*}
            \item 
        \end{enumerate}
    \end{description}
\end{proof}

\end{document}